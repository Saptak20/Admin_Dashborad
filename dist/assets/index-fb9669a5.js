var iL=Object.defineProperty;var aL=(e,t,r)=>t in e?iL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var za=(e,t,r)=>(aL(e,typeof t!="symbol"?t+"":t,r),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const h of o)if(h.type==="childList")for(const d of h.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function r(o){const h={};return o.integrity&&(h.integrity=o.integrity),o.referrerPolicy&&(h.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?h.credentials="include":o.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function n(o){if(o.ep)return;o.ep=!0;const h=r(o);fetch(o.href,h)}})();var yi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function oL(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),r}var Bj={exports:{}},l_={},Fj={exports:{}},lr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pg=Symbol.for("react.element"),sL=Symbol.for("react.portal"),lL=Symbol.for("react.fragment"),cL=Symbol.for("react.strict_mode"),uL=Symbol.for("react.profiler"),hL=Symbol.for("react.provider"),dL=Symbol.for("react.context"),fL=Symbol.for("react.forward_ref"),pL=Symbol.for("react.suspense"),mL=Symbol.for("react.memo"),gL=Symbol.for("react.lazy"),uE=Symbol.iterator;function yL(e){return e===null||typeof e!="object"?null:(e=uE&&e[uE]||e["@@iterator"],typeof e=="function"?e:null)}var Uj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Vj=Object.assign,Gj={};function qd(e,t,r){this.props=e,this.context=t,this.refs=Gj,this.updater=r||Uj}qd.prototype.isReactComponent={};qd.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};qd.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function qj(){}qj.prototype=qd.prototype;function _S(e,t,r){this.props=e,this.context=t,this.refs=Gj,this.updater=r||Uj}var xS=_S.prototype=new qj;xS.constructor=_S;Vj(xS,qd.prototype);xS.isPureReactComponent=!0;var hE=Array.isArray,Wj=Object.prototype.hasOwnProperty,bS={current:null},Hj={key:!0,ref:!0,__self:!0,__source:!0};function Zj(e,t,r){var n,o={},h=null,d=null;if(t!=null)for(n in t.ref!==void 0&&(d=t.ref),t.key!==void 0&&(h=""+t.key),t)Wj.call(t,n)&&!Hj.hasOwnProperty(n)&&(o[n]=t[n]);var s=arguments.length-2;if(s===1)o.children=r;else if(1<s){for(var y=Array(s),w=0;w<s;w++)y[w]=arguments[w+2];o.children=y}if(e&&e.defaultProps)for(n in s=e.defaultProps,s)o[n]===void 0&&(o[n]=s[n]);return{$$typeof:pg,type:e,key:h,ref:d,props:o,_owner:bS.current}}function vL(e,t){return{$$typeof:pg,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function wS(e){return typeof e=="object"&&e!==null&&e.$$typeof===pg}function _L(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var dE=/\/+/g;function Ob(e,t){return typeof e=="object"&&e!==null&&e.key!=null?_L(""+e.key):t.toString(36)}function T0(e,t,r,n,o){var h=typeof e;(h==="undefined"||h==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(h){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case pg:case sL:d=!0}}if(d)return d=e,o=o(d),e=n===""?"."+Ob(d,0):n,hE(o)?(r="",e!=null&&(r=e.replace(dE,"$&/")+"/"),T0(o,t,r,"",function(w){return w})):o!=null&&(wS(o)&&(o=vL(o,r+(!o.key||d&&d.key===o.key?"":(""+o.key).replace(dE,"$&/")+"/")+e)),t.push(o)),1;if(d=0,n=n===""?".":n+":",hE(e))for(var s=0;s<e.length;s++){h=e[s];var y=n+Ob(h,s);d+=T0(h,t,r,y,o)}else if(y=yL(e),typeof y=="function")for(e=y.call(e),s=0;!(h=e.next()).done;)h=h.value,y=n+Ob(h,s++),d+=T0(h,t,r,y,o);else if(h==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return d}function Gy(e,t,r){if(e==null)return e;var n=[],o=0;return T0(e,n,"","",function(h){return t.call(r,h,o++)}),n}function xL(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Gi={current:null},k0={transition:null},bL={ReactCurrentDispatcher:Gi,ReactCurrentBatchConfig:k0,ReactCurrentOwner:bS};function Kj(){throw Error("act(...) is not supported in production builds of React.")}lr.Children={map:Gy,forEach:function(e,t,r){Gy(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Gy(e,function(){t++}),t},toArray:function(e){return Gy(e,function(t){return t})||[]},only:function(e){if(!wS(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};lr.Component=qd;lr.Fragment=lL;lr.Profiler=uL;lr.PureComponent=_S;lr.StrictMode=cL;lr.Suspense=pL;lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bL;lr.act=Kj;lr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Vj({},e.props),o=e.key,h=e.ref,d=e._owner;if(t!=null){if(t.ref!==void 0&&(h=t.ref,d=bS.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(y in t)Wj.call(t,y)&&!Hj.hasOwnProperty(y)&&(n[y]=t[y]===void 0&&s!==void 0?s[y]:t[y])}var y=arguments.length-2;if(y===1)n.children=r;else if(1<y){s=Array(y);for(var w=0;w<y;w++)s[w]=arguments[w+2];n.children=s}return{$$typeof:pg,type:e.type,key:o,ref:h,props:n,_owner:d}};lr.createContext=function(e){return e={$$typeof:dL,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:hL,_context:e},e.Consumer=e};lr.createElement=Zj;lr.createFactory=function(e){var t=Zj.bind(null,e);return t.type=e,t};lr.createRef=function(){return{current:null}};lr.forwardRef=function(e){return{$$typeof:fL,render:e}};lr.isValidElement=wS;lr.lazy=function(e){return{$$typeof:gL,_payload:{_status:-1,_result:e},_init:xL}};lr.memo=function(e,t){return{$$typeof:mL,type:e,compare:t===void 0?null:t}};lr.startTransition=function(e){var t=k0.transition;k0.transition={};try{e()}finally{k0.transition=t}};lr.unstable_act=Kj;lr.useCallback=function(e,t){return Gi.current.useCallback(e,t)};lr.useContext=function(e){return Gi.current.useContext(e)};lr.useDebugValue=function(){};lr.useDeferredValue=function(e){return Gi.current.useDeferredValue(e)};lr.useEffect=function(e,t){return Gi.current.useEffect(e,t)};lr.useId=function(){return Gi.current.useId()};lr.useImperativeHandle=function(e,t,r){return Gi.current.useImperativeHandle(e,t,r)};lr.useInsertionEffect=function(e,t){return Gi.current.useInsertionEffect(e,t)};lr.useLayoutEffect=function(e,t){return Gi.current.useLayoutEffect(e,t)};lr.useMemo=function(e,t){return Gi.current.useMemo(e,t)};lr.useReducer=function(e,t,r){return Gi.current.useReducer(e,t,r)};lr.useRef=function(e){return Gi.current.useRef(e)};lr.useState=function(e){return Gi.current.useState(e)};lr.useSyncExternalStore=function(e,t,r){return Gi.current.useSyncExternalStore(e,t,r)};lr.useTransition=function(){return Gi.current.useTransition()};lr.version="18.3.1";Fj.exports=lr;var be=Fj.exports;const Ie=Rr(be);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wL=be,SL=Symbol.for("react.element"),PL=Symbol.for("react.fragment"),TL=Object.prototype.hasOwnProperty,kL=wL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,EL={key:!0,ref:!0,__self:!0,__source:!0};function Xj(e,t,r){var n,o={},h=null,d=null;r!==void 0&&(h=""+r),t.key!==void 0&&(h=""+t.key),t.ref!==void 0&&(d=t.ref);for(n in t)TL.call(t,n)&&!EL.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)o[n]===void 0&&(o[n]=t[n]);return{$$typeof:SL,type:e,key:h,ref:d,props:o,_owner:kL.current}}l_.Fragment=PL;l_.jsx=Xj;l_.jsxs=Xj;Bj.exports=l_;var P=Bj.exports,V1={},Yj={exports:{}},Ca={},Jj={exports:{}},Qj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Le,Be){var nt=Le.length;Le.push(Be);e:for(;0<nt;){var Xe=nt-1>>>1,Ge=Le[Xe];if(0<o(Ge,Be))Le[Xe]=Be,Le[nt]=Ge,nt=Xe;else break e}}function r(Le){return Le.length===0?null:Le[0]}function n(Le){if(Le.length===0)return null;var Be=Le[0],nt=Le.pop();if(nt!==Be){Le[0]=nt;e:for(var Xe=0,Ge=Le.length,it=Ge>>>1;Xe<it;){var gt=2*(Xe+1)-1,Pt=Le[gt],Nt=gt+1,or=Le[Nt];if(0>o(Pt,nt))Nt<Ge&&0>o(or,Pt)?(Le[Xe]=or,Le[Nt]=nt,Xe=Nt):(Le[Xe]=Pt,Le[gt]=nt,Xe=gt);else if(Nt<Ge&&0>o(or,nt))Le[Xe]=or,Le[Nt]=nt,Xe=Nt;else break e}}return Be}function o(Le,Be){var nt=Le.sortIndex-Be.sortIndex;return nt!==0?nt:Le.id-Be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;e.unstable_now=function(){return h.now()}}else{var d=Date,s=d.now();e.unstable_now=function(){return d.now()-s}}var y=[],w=[],k=1,E=null,I=3,j=!1,z=!1,L=!1,q=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Le){for(var Be=r(w);Be!==null;){if(Be.callback===null)n(w);else if(Be.startTime<=Le)n(w),Be.sortIndex=Be.expirationTime,t(y,Be);else break;Be=r(w)}}function W(Le){if(L=!1,N(Le),!z)if(r(y)!==null)z=!0,Je(H);else{var Be=r(w);Be!==null&&rt(W,Be.startTime-Le)}}function H(Le,Be){z=!1,L&&(L=!1,F(he),he=-1),j=!0;var nt=I;try{for(N(Be),E=r(y);E!==null&&(!(E.expirationTime>Be)||Le&&!Me());){var Xe=E.callback;if(typeof Xe=="function"){E.callback=null,I=E.priorityLevel;var Ge=Xe(E.expirationTime<=Be);Be=e.unstable_now(),typeof Ge=="function"?E.callback=Ge:E===r(y)&&n(y),N(Be)}else n(y);E=r(y)}if(E!==null)var it=!0;else{var gt=r(w);gt!==null&&rt(W,gt.startTime-Be),it=!1}return it}finally{E=null,I=nt,j=!1}}var Z=!1,re=null,he=-1,we=5,Oe=-1;function Me(){return!(e.unstable_now()-Oe<we)}function Se(){if(re!==null){var Le=e.unstable_now();Oe=Le;var Be=!0;try{Be=re(!0,Le)}finally{Be?Ue():(Z=!1,re=null)}}else Z=!1}var Ue;if(typeof U=="function")Ue=function(){U(Se)};else if(typeof MessageChannel<"u"){var We=new MessageChannel,qe=We.port2;We.port1.onmessage=Se,Ue=function(){qe.postMessage(null)}}else Ue=function(){q(Se,0)};function Je(Le){re=Le,Z||(Z=!0,Ue())}function rt(Le,Be){he=q(function(){Le(e.unstable_now())},Be)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Le){Le.callback=null},e.unstable_continueExecution=function(){z||j||(z=!0,Je(H))},e.unstable_forceFrameRate=function(Le){0>Le||125<Le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):we=0<Le?Math.floor(1e3/Le):5},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return r(y)},e.unstable_next=function(Le){switch(I){case 1:case 2:case 3:var Be=3;break;default:Be=I}var nt=I;I=Be;try{return Le()}finally{I=nt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Le,Be){switch(Le){case 1:case 2:case 3:case 4:case 5:break;default:Le=3}var nt=I;I=Le;try{return Be()}finally{I=nt}},e.unstable_scheduleCallback=function(Le,Be,nt){var Xe=e.unstable_now();switch(typeof nt=="object"&&nt!==null?(nt=nt.delay,nt=typeof nt=="number"&&0<nt?Xe+nt:Xe):nt=Xe,Le){case 1:var Ge=-1;break;case 2:Ge=250;break;case 5:Ge=1073741823;break;case 4:Ge=1e4;break;default:Ge=5e3}return Ge=nt+Ge,Le={id:k++,callback:Be,priorityLevel:Le,startTime:nt,expirationTime:Ge,sortIndex:-1},nt>Xe?(Le.sortIndex=nt,t(w,Le),r(y)===null&&Le===r(w)&&(L?(F(he),he=-1):L=!0,rt(W,nt-Xe))):(Le.sortIndex=Ge,t(y,Le),z||j||(z=!0,Je(H))),Le},e.unstable_shouldYield=Me,e.unstable_wrapCallback=function(Le){var Be=I;return function(){var nt=I;I=Be;try{return Le.apply(this,arguments)}finally{I=nt}}}})(Qj);Jj.exports=Qj;var AL=Jj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CL=be,Aa=AL;function dt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var eO=new Set,hm={};function wu(e,t){md(e,t),md(e+"Capture",t)}function md(e,t){for(hm[e]=t,e=0;e<t.length;e++)eO.add(t[e])}var Bs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),G1=Object.prototype.hasOwnProperty,ML=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fE={},pE={};function IL(e){return G1.call(pE,e)?!0:G1.call(fE,e)?!1:ML.test(e)?pE[e]=!0:(fE[e]=!0,!1)}function jL(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function OL(e,t,r,n){if(t===null||typeof t>"u"||jL(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function qi(e,t,r,n,o,h,d){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=h,this.removeEmptyString=d}var xi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){xi[e]=new qi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];xi[t]=new qi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){xi[e]=new qi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){xi[e]=new qi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){xi[e]=new qi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){xi[e]=new qi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){xi[e]=new qi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){xi[e]=new qi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){xi[e]=new qi(e,5,!1,e.toLowerCase(),null,!1,!1)});var SS=/[\-:]([a-z])/g;function PS(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(SS,PS);xi[t]=new qi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(SS,PS);xi[t]=new qi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(SS,PS);xi[t]=new qi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){xi[e]=new qi(e,1,!1,e.toLowerCase(),null,!1,!1)});xi.xlinkHref=new qi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){xi[e]=new qi(e,1,!1,e.toLowerCase(),null,!0,!0)});function TS(e,t,r,n){var o=xi.hasOwnProperty(t)?xi[t]:null;(o!==null?o.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(OL(t,r,o,n)&&(r=null),n||o===null?IL(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=r===null?o.type===3?!1:"":r:(t=o.attributeName,n=o.attributeNamespace,r===null?e.removeAttribute(t):(o=o.type,r=o===3||o===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Zs=CL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qy=Symbol.for("react.element"),Gh=Symbol.for("react.portal"),qh=Symbol.for("react.fragment"),kS=Symbol.for("react.strict_mode"),q1=Symbol.for("react.profiler"),tO=Symbol.for("react.provider"),rO=Symbol.for("react.context"),ES=Symbol.for("react.forward_ref"),W1=Symbol.for("react.suspense"),H1=Symbol.for("react.suspense_list"),AS=Symbol.for("react.memo"),Il=Symbol.for("react.lazy"),nO=Symbol.for("react.offscreen"),mE=Symbol.iterator;function wp(e){return e===null||typeof e!="object"?null:(e=mE&&e[mE]||e["@@iterator"],typeof e=="function"?e:null)}var ln=Object.assign,Db;function Fp(e){if(Db===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Db=t&&t[1]||""}return`
`+Db+e}var Rb=!1;function Nb(e,t){if(!e||Rb)return"";Rb=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(w){var n=w}Reflect.construct(e,[],t)}else{try{t.call()}catch(w){n=w}e.call(t.prototype)}else{try{throw Error()}catch(w){n=w}e()}}catch(w){if(w&&n&&typeof w.stack=="string"){for(var o=w.stack.split(`
`),h=n.stack.split(`
`),d=o.length-1,s=h.length-1;1<=d&&0<=s&&o[d]!==h[s];)s--;for(;1<=d&&0<=s;d--,s--)if(o[d]!==h[s]){if(d!==1||s!==1)do if(d--,s--,0>s||o[d]!==h[s]){var y=`
`+o[d].replace(" at new "," at ");return e.displayName&&y.includes("<anonymous>")&&(y=y.replace("<anonymous>",e.displayName)),y}while(1<=d&&0<=s);break}}}finally{Rb=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Fp(e):""}function DL(e){switch(e.tag){case 5:return Fp(e.type);case 16:return Fp("Lazy");case 13:return Fp("Suspense");case 19:return Fp("SuspenseList");case 0:case 2:case 15:return e=Nb(e.type,!1),e;case 11:return e=Nb(e.type.render,!1),e;case 1:return e=Nb(e.type,!0),e;default:return""}}function Z1(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case qh:return"Fragment";case Gh:return"Portal";case q1:return"Profiler";case kS:return"StrictMode";case W1:return"Suspense";case H1:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case rO:return(e.displayName||"Context")+".Consumer";case tO:return(e._context.displayName||"Context")+".Provider";case ES:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case AS:return t=e.displayName||null,t!==null?t:Z1(e.type)||"Memo";case Il:t=e._payload,e=e._init;try{return Z1(e(t))}catch{}}return null}function RL(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Z1(t);case 8:return t===kS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Jl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function iO(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function NL(e){var t=iO(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,h=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(d){n=""+d,h.call(this,d)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(d){n=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Wy(e){e._valueTracker||(e._valueTracker=NL(e))}function aO(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=iO(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function z0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function K1(e,t){var r=t.checked;return ln({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function gE(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Jl(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function oO(e,t){t=t.checked,t!=null&&TS(e,"checked",t,!1)}function X1(e,t){oO(e,t);var r=Jl(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Y1(e,t.type,r):t.hasOwnProperty("defaultValue")&&Y1(e,t.type,Jl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function yE(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Y1(e,t,r){(t!=="number"||z0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Up=Array.isArray;function ad(e,t,r,n){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Jl(r),t=null,o=0;o<e.length;o++){if(e[o].value===r){e[o].selected=!0,n&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function J1(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(dt(91));return ln({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function vE(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(dt(92));if(Up(r)){if(1<r.length)throw Error(dt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Jl(r)}}function sO(e,t){var r=Jl(t.value),n=Jl(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function _E(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function lO(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Q1(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?lO(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Hy,cO=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,o){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Hy=Hy||document.createElement("div"),Hy.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Hy.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function dm(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Zp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$L=["Webkit","ms","Moz","O"];Object.keys(Zp).forEach(function(e){$L.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zp[t]=Zp[e]})});function uO(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Zp.hasOwnProperty(e)&&Zp[e]?(""+t).trim():t+"px"}function hO(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,o=uO(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,o):e[r]=o}}var zL=ln({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ew(e,t){if(t){if(zL[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(dt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(dt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(dt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(dt(62))}}function tw(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rw=null;function CS(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var nw=null,od=null,sd=null;function xE(e){if(e=yg(e)){if(typeof nw!="function")throw Error(dt(280));var t=e.stateNode;t&&(t=f_(t),nw(e.stateNode,e.type,t))}}function dO(e){od?sd?sd.push(e):sd=[e]:od=e}function fO(){if(od){var e=od,t=sd;if(sd=od=null,xE(e),t)for(e=0;e<t.length;e++)xE(t[e])}}function pO(e,t){return e(t)}function mO(){}var $b=!1;function gO(e,t,r){if($b)return e(t,r);$b=!0;try{return pO(e,t,r)}finally{$b=!1,(od!==null||sd!==null)&&(mO(),fO())}}function fm(e,t){var r=e.stateNode;if(r===null)return null;var n=f_(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(dt(231,t,typeof r));return r}var iw=!1;if(Bs)try{var Sp={};Object.defineProperty(Sp,"passive",{get:function(){iw=!0}}),window.addEventListener("test",Sp,Sp),window.removeEventListener("test",Sp,Sp)}catch{iw=!1}function LL(e,t,r,n,o,h,d,s,y){var w=Array.prototype.slice.call(arguments,3);try{t.apply(r,w)}catch(k){this.onError(k)}}var Kp=!1,L0=null,B0=!1,aw=null,BL={onError:function(e){Kp=!0,L0=e}};function FL(e,t,r,n,o,h,d,s,y){Kp=!1,L0=null,LL.apply(BL,arguments)}function UL(e,t,r,n,o,h,d,s,y){if(FL.apply(this,arguments),Kp){if(Kp){var w=L0;Kp=!1,L0=null}else throw Error(dt(198));B0||(B0=!0,aw=w)}}function Su(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function yO(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function bE(e){if(Su(e)!==e)throw Error(dt(188))}function VL(e){var t=e.alternate;if(!t){if(t=Su(e),t===null)throw Error(dt(188));return t!==e?null:e}for(var r=e,n=t;;){var o=r.return;if(o===null)break;var h=o.alternate;if(h===null){if(n=o.return,n!==null){r=n;continue}break}if(o.child===h.child){for(h=o.child;h;){if(h===r)return bE(o),e;if(h===n)return bE(o),t;h=h.sibling}throw Error(dt(188))}if(r.return!==n.return)r=o,n=h;else{for(var d=!1,s=o.child;s;){if(s===r){d=!0,r=o,n=h;break}if(s===n){d=!0,n=o,r=h;break}s=s.sibling}if(!d){for(s=h.child;s;){if(s===r){d=!0,r=h,n=o;break}if(s===n){d=!0,n=h,r=o;break}s=s.sibling}if(!d)throw Error(dt(189))}}if(r.alternate!==n)throw Error(dt(190))}if(r.tag!==3)throw Error(dt(188));return r.stateNode.current===r?e:t}function vO(e){return e=VL(e),e!==null?_O(e):null}function _O(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=_O(e);if(t!==null)return t;e=e.sibling}return null}var xO=Aa.unstable_scheduleCallback,wE=Aa.unstable_cancelCallback,GL=Aa.unstable_shouldYield,qL=Aa.unstable_requestPaint,Pn=Aa.unstable_now,WL=Aa.unstable_getCurrentPriorityLevel,MS=Aa.unstable_ImmediatePriority,bO=Aa.unstable_UserBlockingPriority,F0=Aa.unstable_NormalPriority,HL=Aa.unstable_LowPriority,wO=Aa.unstable_IdlePriority,c_=null,Ko=null;function ZL(e){if(Ko&&typeof Ko.onCommitFiberRoot=="function")try{Ko.onCommitFiberRoot(c_,e,void 0,(e.current.flags&128)===128)}catch{}}var wo=Math.clz32?Math.clz32:YL,KL=Math.log,XL=Math.LN2;function YL(e){return e>>>=0,e===0?32:31-(KL(e)/XL|0)|0}var Zy=64,Ky=4194304;function Vp(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function U0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,o=e.suspendedLanes,h=e.pingedLanes,d=r&268435455;if(d!==0){var s=d&~o;s!==0?n=Vp(s):(h&=d,h!==0&&(n=Vp(h)))}else d=r&~o,d!==0?n=Vp(d):h!==0&&(n=Vp(h));if(n===0)return 0;if(t!==0&&t!==n&&!(t&o)&&(o=n&-n,h=t&-t,o>=h||o===16&&(h&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-wo(t),o=1<<r,n|=e[r],t&=~o;return n}function JL(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function QL(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,o=e.expirationTimes,h=e.pendingLanes;0<h;){var d=31-wo(h),s=1<<d,y=o[d];y===-1?(!(s&r)||s&n)&&(o[d]=JL(s,t)):y<=t&&(e.expiredLanes|=s),h&=~s}}function ow(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function SO(){var e=Zy;return Zy<<=1,!(Zy&4194240)&&(Zy=64),e}function zb(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function mg(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-wo(t),e[t]=r}function e4(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-wo(r),h=1<<o;t[o]=0,n[o]=-1,e[o]=-1,r&=~h}}function IS(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-wo(r),o=1<<n;o&t|e[n]&t&&(e[n]|=t),r&=~o}}var Cr=0;function PO(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var TO,jS,kO,EO,AO,sw=!1,Xy=[],Fl=null,Ul=null,Vl=null,pm=new Map,mm=new Map,Dl=[],t4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function SE(e,t){switch(e){case"focusin":case"focusout":Fl=null;break;case"dragenter":case"dragleave":Ul=null;break;case"mouseover":case"mouseout":Vl=null;break;case"pointerover":case"pointerout":pm.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":mm.delete(t.pointerId)}}function Pp(e,t,r,n,o,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:h,targetContainers:[o]},t!==null&&(t=yg(t),t!==null&&jS(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function r4(e,t,r,n,o){switch(t){case"focusin":return Fl=Pp(Fl,e,t,r,n,o),!0;case"dragenter":return Ul=Pp(Ul,e,t,r,n,o),!0;case"mouseover":return Vl=Pp(Vl,e,t,r,n,o),!0;case"pointerover":var h=o.pointerId;return pm.set(h,Pp(pm.get(h)||null,e,t,r,n,o)),!0;case"gotpointercapture":return h=o.pointerId,mm.set(h,Pp(mm.get(h)||null,e,t,r,n,o)),!0}return!1}function CO(e){var t=eu(e.target);if(t!==null){var r=Su(t);if(r!==null){if(t=r.tag,t===13){if(t=yO(r),t!==null){e.blockedOn=t,AO(e.priority,function(){kO(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function E0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=lw(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);rw=n,r.target.dispatchEvent(n),rw=null}else return t=yg(r),t!==null&&jS(t),e.blockedOn=r,!1;t.shift()}return!0}function PE(e,t,r){E0(e)&&r.delete(t)}function n4(){sw=!1,Fl!==null&&E0(Fl)&&(Fl=null),Ul!==null&&E0(Ul)&&(Ul=null),Vl!==null&&E0(Vl)&&(Vl=null),pm.forEach(PE),mm.forEach(PE)}function Tp(e,t){e.blockedOn===t&&(e.blockedOn=null,sw||(sw=!0,Aa.unstable_scheduleCallback(Aa.unstable_NormalPriority,n4)))}function gm(e){function t(o){return Tp(o,e)}if(0<Xy.length){Tp(Xy[0],e);for(var r=1;r<Xy.length;r++){var n=Xy[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Fl!==null&&Tp(Fl,e),Ul!==null&&Tp(Ul,e),Vl!==null&&Tp(Vl,e),pm.forEach(t),mm.forEach(t),r=0;r<Dl.length;r++)n=Dl[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Dl.length&&(r=Dl[0],r.blockedOn===null);)CO(r),r.blockedOn===null&&Dl.shift()}var ld=Zs.ReactCurrentBatchConfig,V0=!0;function i4(e,t,r,n){var o=Cr,h=ld.transition;ld.transition=null;try{Cr=1,OS(e,t,r,n)}finally{Cr=o,ld.transition=h}}function a4(e,t,r,n){var o=Cr,h=ld.transition;ld.transition=null;try{Cr=4,OS(e,t,r,n)}finally{Cr=o,ld.transition=h}}function OS(e,t,r,n){if(V0){var o=lw(e,t,r,n);if(o===null)Zb(e,t,n,G0,r),SE(e,n);else if(r4(o,e,t,r,n))n.stopPropagation();else if(SE(e,n),t&4&&-1<t4.indexOf(e)){for(;o!==null;){var h=yg(o);if(h!==null&&TO(h),h=lw(e,t,r,n),h===null&&Zb(e,t,n,G0,r),h===o)break;o=h}o!==null&&n.stopPropagation()}else Zb(e,t,n,null,r)}}var G0=null;function lw(e,t,r,n){if(G0=null,e=CS(n),e=eu(e),e!==null)if(t=Su(e),t===null)e=null;else if(r=t.tag,r===13){if(e=yO(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return G0=e,null}function MO(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(WL()){case MS:return 1;case bO:return 4;case F0:case HL:return 16;case wO:return 536870912;default:return 16}default:return 16}}var zl=null,DS=null,A0=null;function IO(){if(A0)return A0;var e,t=DS,r=t.length,n,o="value"in zl?zl.value:zl.textContent,h=o.length;for(e=0;e<r&&t[e]===o[e];e++);var d=r-e;for(n=1;n<=d&&t[r-n]===o[h-n];n++);return A0=o.slice(e,1<n?1-n:void 0)}function C0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Yy(){return!0}function TE(){return!1}function Ma(e){function t(r,n,o,h,d){this._reactName=r,this._targetInst=o,this.type=n,this.nativeEvent=h,this.target=d,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(h):h[s]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?Yy:TE,this.isPropagationStopped=TE,this}return ln(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Yy)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Yy)},persist:function(){},isPersistent:Yy}),t}var Wd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},RS=Ma(Wd),gg=ln({},Wd,{view:0,detail:0}),o4=Ma(gg),Lb,Bb,kp,u_=ln({},gg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:NS,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==kp&&(kp&&e.type==="mousemove"?(Lb=e.screenX-kp.screenX,Bb=e.screenY-kp.screenY):Bb=Lb=0,kp=e),Lb)},movementY:function(e){return"movementY"in e?e.movementY:Bb}}),kE=Ma(u_),s4=ln({},u_,{dataTransfer:0}),l4=Ma(s4),c4=ln({},gg,{relatedTarget:0}),Fb=Ma(c4),u4=ln({},Wd,{animationName:0,elapsedTime:0,pseudoElement:0}),h4=Ma(u4),d4=ln({},Wd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),f4=Ma(d4),p4=ln({},Wd,{data:0}),EE=Ma(p4),m4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},g4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},y4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function v4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=y4[e])?!!t[e]:!1}function NS(){return v4}var _4=ln({},gg,{key:function(e){if(e.key){var t=m4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=C0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?g4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:NS,charCode:function(e){return e.type==="keypress"?C0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?C0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),x4=Ma(_4),b4=ln({},u_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),AE=Ma(b4),w4=ln({},gg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:NS}),S4=Ma(w4),P4=ln({},Wd,{propertyName:0,elapsedTime:0,pseudoElement:0}),T4=Ma(P4),k4=ln({},u_,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),E4=Ma(k4),A4=[9,13,27,32],$S=Bs&&"CompositionEvent"in window,Xp=null;Bs&&"documentMode"in document&&(Xp=document.documentMode);var C4=Bs&&"TextEvent"in window&&!Xp,jO=Bs&&(!$S||Xp&&8<Xp&&11>=Xp),CE=String.fromCharCode(32),ME=!1;function OO(e,t){switch(e){case"keyup":return A4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function DO(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Wh=!1;function M4(e,t){switch(e){case"compositionend":return DO(t);case"keypress":return t.which!==32?null:(ME=!0,CE);case"textInput":return e=t.data,e===CE&&ME?null:e;default:return null}}function I4(e,t){if(Wh)return e==="compositionend"||!$S&&OO(e,t)?(e=IO(),A0=DS=zl=null,Wh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jO&&t.locale!=="ko"?null:t.data;default:return null}}var j4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function IE(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!j4[e.type]:t==="textarea"}function RO(e,t,r,n){dO(n),t=q0(t,"onChange"),0<t.length&&(r=new RS("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Yp=null,ym=null;function O4(e){WO(e,0)}function h_(e){var t=Kh(e);if(aO(t))return e}function D4(e,t){if(e==="change")return t}var NO=!1;if(Bs){var Ub;if(Bs){var Vb="oninput"in document;if(!Vb){var jE=document.createElement("div");jE.setAttribute("oninput","return;"),Vb=typeof jE.oninput=="function"}Ub=Vb}else Ub=!1;NO=Ub&&(!document.documentMode||9<document.documentMode)}function OE(){Yp&&(Yp.detachEvent("onpropertychange",$O),ym=Yp=null)}function $O(e){if(e.propertyName==="value"&&h_(ym)){var t=[];RO(t,ym,e,CS(e)),gO(O4,t)}}function R4(e,t,r){e==="focusin"?(OE(),Yp=t,ym=r,Yp.attachEvent("onpropertychange",$O)):e==="focusout"&&OE()}function N4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return h_(ym)}function $4(e,t){if(e==="click")return h_(t)}function z4(e,t){if(e==="input"||e==="change")return h_(t)}function L4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var To=typeof Object.is=="function"?Object.is:L4;function vm(e,t){if(To(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var o=r[n];if(!G1.call(t,o)||!To(e[o],t[o]))return!1}return!0}function DE(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function RE(e,t){var r=DE(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=DE(r)}}function zO(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?zO(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function LO(){for(var e=window,t=z0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=z0(e.document)}return t}function zS(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function B4(e){var t=LO(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&zO(r.ownerDocument.documentElement,r)){if(n!==null&&zS(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=r.textContent.length,h=Math.min(n.start,o);n=n.end===void 0?h:Math.min(n.end,o),!e.extend&&h>n&&(o=n,n=h,h=o),o=RE(r,h);var d=RE(r,n);o&&d&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),h>n?(e.addRange(t),e.extend(d.node,d.offset)):(t.setEnd(d.node,d.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var F4=Bs&&"documentMode"in document&&11>=document.documentMode,Hh=null,cw=null,Jp=null,uw=!1;function NE(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;uw||Hh==null||Hh!==z0(n)||(n=Hh,"selectionStart"in n&&zS(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Jp&&vm(Jp,n)||(Jp=n,n=q0(cw,"onSelect"),0<n.length&&(t=new RS("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Hh)))}function Jy(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Zh={animationend:Jy("Animation","AnimationEnd"),animationiteration:Jy("Animation","AnimationIteration"),animationstart:Jy("Animation","AnimationStart"),transitionend:Jy("Transition","TransitionEnd")},Gb={},BO={};Bs&&(BO=document.createElement("div").style,"AnimationEvent"in window||(delete Zh.animationend.animation,delete Zh.animationiteration.animation,delete Zh.animationstart.animation),"TransitionEvent"in window||delete Zh.transitionend.transition);function d_(e){if(Gb[e])return Gb[e];if(!Zh[e])return e;var t=Zh[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in BO)return Gb[e]=t[r];return e}var FO=d_("animationend"),UO=d_("animationiteration"),VO=d_("animationstart"),GO=d_("transitionend"),qO=new Map,$E="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ec(e,t){qO.set(e,t),wu(t,[e])}for(var qb=0;qb<$E.length;qb++){var Wb=$E[qb],U4=Wb.toLowerCase(),V4=Wb[0].toUpperCase()+Wb.slice(1);ec(U4,"on"+V4)}ec(FO,"onAnimationEnd");ec(UO,"onAnimationIteration");ec(VO,"onAnimationStart");ec("dblclick","onDoubleClick");ec("focusin","onFocus");ec("focusout","onBlur");ec(GO,"onTransitionEnd");md("onMouseEnter",["mouseout","mouseover"]);md("onMouseLeave",["mouseout","mouseover"]);md("onPointerEnter",["pointerout","pointerover"]);md("onPointerLeave",["pointerout","pointerover"]);wu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wu("onBeforeInput",["compositionend","keypress","textInput","paste"]);wu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gp));function zE(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,UL(n,t,void 0,e),e.currentTarget=null}function WO(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],o=n.event;n=n.listeners;e:{var h=void 0;if(t)for(var d=n.length-1;0<=d;d--){var s=n[d],y=s.instance,w=s.currentTarget;if(s=s.listener,y!==h&&o.isPropagationStopped())break e;zE(o,s,w),h=y}else for(d=0;d<n.length;d++){if(s=n[d],y=s.instance,w=s.currentTarget,s=s.listener,y!==h&&o.isPropagationStopped())break e;zE(o,s,w),h=y}}}if(B0)throw e=aw,B0=!1,aw=null,e}function Wr(e,t){var r=t[mw];r===void 0&&(r=t[mw]=new Set);var n=e+"__bubble";r.has(n)||(HO(t,e,2,!1),r.add(n))}function Hb(e,t,r){var n=0;t&&(n|=4),HO(r,e,n,t)}var Qy="_reactListening"+Math.random().toString(36).slice(2);function _m(e){if(!e[Qy]){e[Qy]=!0,eO.forEach(function(r){r!=="selectionchange"&&(G4.has(r)||Hb(r,!1,e),Hb(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qy]||(t[Qy]=!0,Hb("selectionchange",!1,t))}}function HO(e,t,r,n){switch(MO(t)){case 1:var o=i4;break;case 4:o=a4;break;default:o=OS}r=o.bind(null,t,r,e),o=void 0,!iw||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),n?o!==void 0?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):o!==void 0?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function Zb(e,t,r,n,o){var h=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var d=n.tag;if(d===3||d===4){var s=n.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(d===4)for(d=n.return;d!==null;){var y=d.tag;if((y===3||y===4)&&(y=d.stateNode.containerInfo,y===o||y.nodeType===8&&y.parentNode===o))return;d=d.return}for(;s!==null;){if(d=eu(s),d===null)return;if(y=d.tag,y===5||y===6){n=h=d;continue e}s=s.parentNode}}n=n.return}gO(function(){var w=h,k=CS(r),E=[];e:{var I=qO.get(e);if(I!==void 0){var j=RS,z=e;switch(e){case"keypress":if(C0(r)===0)break e;case"keydown":case"keyup":j=x4;break;case"focusin":z="focus",j=Fb;break;case"focusout":z="blur",j=Fb;break;case"beforeblur":case"afterblur":j=Fb;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=kE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=l4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=S4;break;case FO:case UO:case VO:j=h4;break;case GO:j=T4;break;case"scroll":j=o4;break;case"wheel":j=E4;break;case"copy":case"cut":case"paste":j=f4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=AE}var L=(t&4)!==0,q=!L&&e==="scroll",F=L?I!==null?I+"Capture":null:I;L=[];for(var U=w,N;U!==null;){N=U;var W=N.stateNode;if(N.tag===5&&W!==null&&(N=W,F!==null&&(W=fm(U,F),W!=null&&L.push(xm(U,W,N)))),q)break;U=U.return}0<L.length&&(I=new j(I,z,null,r,k),E.push({event:I,listeners:L}))}}if(!(t&7)){e:{if(I=e==="mouseover"||e==="pointerover",j=e==="mouseout"||e==="pointerout",I&&r!==rw&&(z=r.relatedTarget||r.fromElement)&&(eu(z)||z[Fs]))break e;if((j||I)&&(I=k.window===k?k:(I=k.ownerDocument)?I.defaultView||I.parentWindow:window,j?(z=r.relatedTarget||r.toElement,j=w,z=z?eu(z):null,z!==null&&(q=Su(z),z!==q||z.tag!==5&&z.tag!==6)&&(z=null)):(j=null,z=w),j!==z)){if(L=kE,W="onMouseLeave",F="onMouseEnter",U="mouse",(e==="pointerout"||e==="pointerover")&&(L=AE,W="onPointerLeave",F="onPointerEnter",U="pointer"),q=j==null?I:Kh(j),N=z==null?I:Kh(z),I=new L(W,U+"leave",j,r,k),I.target=q,I.relatedTarget=N,W=null,eu(k)===w&&(L=new L(F,U+"enter",z,r,k),L.target=N,L.relatedTarget=q,W=L),q=W,j&&z)t:{for(L=j,F=z,U=0,N=L;N;N=Mh(N))U++;for(N=0,W=F;W;W=Mh(W))N++;for(;0<U-N;)L=Mh(L),U--;for(;0<N-U;)F=Mh(F),N--;for(;U--;){if(L===F||F!==null&&L===F.alternate)break t;L=Mh(L),F=Mh(F)}L=null}else L=null;j!==null&&LE(E,I,j,L,!1),z!==null&&q!==null&&LE(E,q,z,L,!0)}}e:{if(I=w?Kh(w):window,j=I.nodeName&&I.nodeName.toLowerCase(),j==="select"||j==="input"&&I.type==="file")var H=D4;else if(IE(I))if(NO)H=z4;else{H=N4;var Z=R4}else(j=I.nodeName)&&j.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(H=$4);if(H&&(H=H(e,w))){RO(E,H,r,k);break e}Z&&Z(e,I,w),e==="focusout"&&(Z=I._wrapperState)&&Z.controlled&&I.type==="number"&&Y1(I,"number",I.value)}switch(Z=w?Kh(w):window,e){case"focusin":(IE(Z)||Z.contentEditable==="true")&&(Hh=Z,cw=w,Jp=null);break;case"focusout":Jp=cw=Hh=null;break;case"mousedown":uw=!0;break;case"contextmenu":case"mouseup":case"dragend":uw=!1,NE(E,r,k);break;case"selectionchange":if(F4)break;case"keydown":case"keyup":NE(E,r,k)}var re;if($S)e:{switch(e){case"compositionstart":var he="onCompositionStart";break e;case"compositionend":he="onCompositionEnd";break e;case"compositionupdate":he="onCompositionUpdate";break e}he=void 0}else Wh?OO(e,r)&&(he="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(he="onCompositionStart");he&&(jO&&r.locale!=="ko"&&(Wh||he!=="onCompositionStart"?he==="onCompositionEnd"&&Wh&&(re=IO()):(zl=k,DS="value"in zl?zl.value:zl.textContent,Wh=!0)),Z=q0(w,he),0<Z.length&&(he=new EE(he,e,null,r,k),E.push({event:he,listeners:Z}),re?he.data=re:(re=DO(r),re!==null&&(he.data=re)))),(re=C4?M4(e,r):I4(e,r))&&(w=q0(w,"onBeforeInput"),0<w.length&&(k=new EE("onBeforeInput","beforeinput",null,r,k),E.push({event:k,listeners:w}),k.data=re))}WO(E,t)})}function xm(e,t,r){return{instance:e,listener:t,currentTarget:r}}function q0(e,t){for(var r=t+"Capture",n=[];e!==null;){var o=e,h=o.stateNode;o.tag===5&&h!==null&&(o=h,h=fm(e,r),h!=null&&n.unshift(xm(e,h,o)),h=fm(e,t),h!=null&&n.push(xm(e,h,o))),e=e.return}return n}function Mh(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function LE(e,t,r,n,o){for(var h=t._reactName,d=[];r!==null&&r!==n;){var s=r,y=s.alternate,w=s.stateNode;if(y!==null&&y===n)break;s.tag===5&&w!==null&&(s=w,o?(y=fm(r,h),y!=null&&d.unshift(xm(r,y,s))):o||(y=fm(r,h),y!=null&&d.push(xm(r,y,s)))),r=r.return}d.length!==0&&e.push({event:t,listeners:d})}var q4=/\r\n?/g,W4=/\u0000|\uFFFD/g;function BE(e){return(typeof e=="string"?e:""+e).replace(q4,`
`).replace(W4,"")}function e0(e,t,r){if(t=BE(t),BE(e)!==t&&r)throw Error(dt(425))}function W0(){}var hw=null,dw=null;function fw(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var pw=typeof setTimeout=="function"?setTimeout:void 0,H4=typeof clearTimeout=="function"?clearTimeout:void 0,FE=typeof Promise=="function"?Promise:void 0,Z4=typeof queueMicrotask=="function"?queueMicrotask:typeof FE<"u"?function(e){return FE.resolve(null).then(e).catch(K4)}:pw;function K4(e){setTimeout(function(){throw e})}function Kb(e,t){var r=t,n=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(n===0){e.removeChild(o),gm(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=o}while(r);gm(t)}function Gl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function UE(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Hd=Math.random().toString(36).slice(2),Ho="__reactFiber$"+Hd,bm="__reactProps$"+Hd,Fs="__reactContainer$"+Hd,mw="__reactEvents$"+Hd,X4="__reactListeners$"+Hd,Y4="__reactHandles$"+Hd;function eu(e){var t=e[Ho];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Fs]||r[Ho]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=UE(e);e!==null;){if(r=e[Ho])return r;e=UE(e)}return t}e=r,r=e.parentNode}return null}function yg(e){return e=e[Ho]||e[Fs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Kh(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(dt(33))}function f_(e){return e[bm]||null}var gw=[],Xh=-1;function tc(e){return{current:e}}function Kr(e){0>Xh||(e.current=gw[Xh],gw[Xh]=null,Xh--)}function Fr(e,t){Xh++,gw[Xh]=e.current,e.current=t}var Ql={},ji=tc(Ql),ta=tc(!1),du=Ql;function gd(e,t){var r=e.type.contextTypes;if(!r)return Ql;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o={},h;for(h in r)o[h]=t[h];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function ra(e){return e=e.childContextTypes,e!=null}function H0(){Kr(ta),Kr(ji)}function VE(e,t,r){if(ji.current!==Ql)throw Error(dt(168));Fr(ji,t),Fr(ta,r)}function ZO(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var o in n)if(!(o in t))throw Error(dt(108,RL(e)||"Unknown",o));return ln({},r,n)}function Z0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ql,du=ji.current,Fr(ji,e),Fr(ta,ta.current),!0}function GE(e,t,r){var n=e.stateNode;if(!n)throw Error(dt(169));r?(e=ZO(e,t,du),n.__reactInternalMemoizedMergedChildContext=e,Kr(ta),Kr(ji),Fr(ji,e)):Kr(ta),Fr(ta,r)}var Ms=null,p_=!1,Xb=!1;function KO(e){Ms===null?Ms=[e]:Ms.push(e)}function J4(e){p_=!0,KO(e)}function rc(){if(!Xb&&Ms!==null){Xb=!0;var e=0,t=Cr;try{var r=Ms;for(Cr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ms=null,p_=!1}catch(o){throw Ms!==null&&(Ms=Ms.slice(e+1)),xO(MS,rc),o}finally{Cr=t,Xb=!1}}return null}var Yh=[],Jh=0,K0=null,X0=0,Ua=[],Va=0,fu=null,Is=1,js="";function Hc(e,t){Yh[Jh++]=X0,Yh[Jh++]=K0,K0=e,X0=t}function XO(e,t,r){Ua[Va++]=Is,Ua[Va++]=js,Ua[Va++]=fu,fu=e;var n=Is;e=js;var o=32-wo(n)-1;n&=~(1<<o),r+=1;var h=32-wo(t)+o;if(30<h){var d=o-o%5;h=(n&(1<<d)-1).toString(32),n>>=d,o-=d,Is=1<<32-wo(t)+o|r<<o|n,js=h+e}else Is=1<<h|r<<o|n,js=e}function LS(e){e.return!==null&&(Hc(e,1),XO(e,1,0))}function BS(e){for(;e===K0;)K0=Yh[--Jh],Yh[Jh]=null,X0=Yh[--Jh],Yh[Jh]=null;for(;e===fu;)fu=Ua[--Va],Ua[Va]=null,js=Ua[--Va],Ua[Va]=null,Is=Ua[--Va],Ua[Va]=null}var Ea=null,ka=null,tn=!1,_o=null;function YO(e,t){var r=Ga(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function qE(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ea=e,ka=Gl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ea=e,ka=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=fu!==null?{id:Is,overflow:js}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ga(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ea=e,ka=null,!0):!1;default:return!1}}function yw(e){return(e.mode&1)!==0&&(e.flags&128)===0}function vw(e){if(tn){var t=ka;if(t){var r=t;if(!qE(e,t)){if(yw(e))throw Error(dt(418));t=Gl(r.nextSibling);var n=Ea;t&&qE(e,t)?YO(n,r):(e.flags=e.flags&-4097|2,tn=!1,Ea=e)}}else{if(yw(e))throw Error(dt(418));e.flags=e.flags&-4097|2,tn=!1,Ea=e}}}function WE(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ea=e}function t0(e){if(e!==Ea)return!1;if(!tn)return WE(e),tn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!fw(e.type,e.memoizedProps)),t&&(t=ka)){if(yw(e))throw JO(),Error(dt(418));for(;t;)YO(e,t),t=Gl(t.nextSibling)}if(WE(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(dt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ka=Gl(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ka=null}}else ka=Ea?Gl(e.stateNode.nextSibling):null;return!0}function JO(){for(var e=ka;e;)e=Gl(e.nextSibling)}function yd(){ka=Ea=null,tn=!1}function FS(e){_o===null?_o=[e]:_o.push(e)}var Q4=Zs.ReactCurrentBatchConfig;function Ep(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(dt(309));var n=r.stateNode}if(!n)throw Error(dt(147,e));var o=n,h=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===h?t.ref:(t=function(d){var s=o.refs;d===null?delete s[h]:s[h]=d},t._stringRef=h,t)}if(typeof e!="string")throw Error(dt(284));if(!r._owner)throw Error(dt(290,e))}return e}function r0(e,t){throw e=Object.prototype.toString.call(t),Error(dt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function HE(e){var t=e._init;return t(e._payload)}function QO(e){function t(F,U){if(e){var N=F.deletions;N===null?(F.deletions=[U],F.flags|=16):N.push(U)}}function r(F,U){if(!e)return null;for(;U!==null;)t(F,U),U=U.sibling;return null}function n(F,U){for(F=new Map;U!==null;)U.key!==null?F.set(U.key,U):F.set(U.index,U),U=U.sibling;return F}function o(F,U){return F=Zl(F,U),F.index=0,F.sibling=null,F}function h(F,U,N){return F.index=N,e?(N=F.alternate,N!==null?(N=N.index,N<U?(F.flags|=2,U):N):(F.flags|=2,U)):(F.flags|=1048576,U)}function d(F){return e&&F.alternate===null&&(F.flags|=2),F}function s(F,U,N,W){return U===null||U.tag!==6?(U=n1(N,F.mode,W),U.return=F,U):(U=o(U,N),U.return=F,U)}function y(F,U,N,W){var H=N.type;return H===qh?k(F,U,N.props.children,W,N.key):U!==null&&(U.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===Il&&HE(H)===U.type)?(W=o(U,N.props),W.ref=Ep(F,U,N),W.return=F,W):(W=N0(N.type,N.key,N.props,null,F.mode,W),W.ref=Ep(F,U,N),W.return=F,W)}function w(F,U,N,W){return U===null||U.tag!==4||U.stateNode.containerInfo!==N.containerInfo||U.stateNode.implementation!==N.implementation?(U=i1(N,F.mode,W),U.return=F,U):(U=o(U,N.children||[]),U.return=F,U)}function k(F,U,N,W,H){return U===null||U.tag!==7?(U=lu(N,F.mode,W,H),U.return=F,U):(U=o(U,N),U.return=F,U)}function E(F,U,N){if(typeof U=="string"&&U!==""||typeof U=="number")return U=n1(""+U,F.mode,N),U.return=F,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case qy:return N=N0(U.type,U.key,U.props,null,F.mode,N),N.ref=Ep(F,null,U),N.return=F,N;case Gh:return U=i1(U,F.mode,N),U.return=F,U;case Il:var W=U._init;return E(F,W(U._payload),N)}if(Up(U)||wp(U))return U=lu(U,F.mode,N,null),U.return=F,U;r0(F,U)}return null}function I(F,U,N,W){var H=U!==null?U.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return H!==null?null:s(F,U,""+N,W);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case qy:return N.key===H?y(F,U,N,W):null;case Gh:return N.key===H?w(F,U,N,W):null;case Il:return H=N._init,I(F,U,H(N._payload),W)}if(Up(N)||wp(N))return H!==null?null:k(F,U,N,W,null);r0(F,N)}return null}function j(F,U,N,W,H){if(typeof W=="string"&&W!==""||typeof W=="number")return F=F.get(N)||null,s(U,F,""+W,H);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case qy:return F=F.get(W.key===null?N:W.key)||null,y(U,F,W,H);case Gh:return F=F.get(W.key===null?N:W.key)||null,w(U,F,W,H);case Il:var Z=W._init;return j(F,U,N,Z(W._payload),H)}if(Up(W)||wp(W))return F=F.get(N)||null,k(U,F,W,H,null);r0(U,W)}return null}function z(F,U,N,W){for(var H=null,Z=null,re=U,he=U=0,we=null;re!==null&&he<N.length;he++){re.index>he?(we=re,re=null):we=re.sibling;var Oe=I(F,re,N[he],W);if(Oe===null){re===null&&(re=we);break}e&&re&&Oe.alternate===null&&t(F,re),U=h(Oe,U,he),Z===null?H=Oe:Z.sibling=Oe,Z=Oe,re=we}if(he===N.length)return r(F,re),tn&&Hc(F,he),H;if(re===null){for(;he<N.length;he++)re=E(F,N[he],W),re!==null&&(U=h(re,U,he),Z===null?H=re:Z.sibling=re,Z=re);return tn&&Hc(F,he),H}for(re=n(F,re);he<N.length;he++)we=j(re,F,he,N[he],W),we!==null&&(e&&we.alternate!==null&&re.delete(we.key===null?he:we.key),U=h(we,U,he),Z===null?H=we:Z.sibling=we,Z=we);return e&&re.forEach(function(Me){return t(F,Me)}),tn&&Hc(F,he),H}function L(F,U,N,W){var H=wp(N);if(typeof H!="function")throw Error(dt(150));if(N=H.call(N),N==null)throw Error(dt(151));for(var Z=H=null,re=U,he=U=0,we=null,Oe=N.next();re!==null&&!Oe.done;he++,Oe=N.next()){re.index>he?(we=re,re=null):we=re.sibling;var Me=I(F,re,Oe.value,W);if(Me===null){re===null&&(re=we);break}e&&re&&Me.alternate===null&&t(F,re),U=h(Me,U,he),Z===null?H=Me:Z.sibling=Me,Z=Me,re=we}if(Oe.done)return r(F,re),tn&&Hc(F,he),H;if(re===null){for(;!Oe.done;he++,Oe=N.next())Oe=E(F,Oe.value,W),Oe!==null&&(U=h(Oe,U,he),Z===null?H=Oe:Z.sibling=Oe,Z=Oe);return tn&&Hc(F,he),H}for(re=n(F,re);!Oe.done;he++,Oe=N.next())Oe=j(re,F,he,Oe.value,W),Oe!==null&&(e&&Oe.alternate!==null&&re.delete(Oe.key===null?he:Oe.key),U=h(Oe,U,he),Z===null?H=Oe:Z.sibling=Oe,Z=Oe);return e&&re.forEach(function(Se){return t(F,Se)}),tn&&Hc(F,he),H}function q(F,U,N,W){if(typeof N=="object"&&N!==null&&N.type===qh&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case qy:e:{for(var H=N.key,Z=U;Z!==null;){if(Z.key===H){if(H=N.type,H===qh){if(Z.tag===7){r(F,Z.sibling),U=o(Z,N.props.children),U.return=F,F=U;break e}}else if(Z.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===Il&&HE(H)===Z.type){r(F,Z.sibling),U=o(Z,N.props),U.ref=Ep(F,Z,N),U.return=F,F=U;break e}r(F,Z);break}else t(F,Z);Z=Z.sibling}N.type===qh?(U=lu(N.props.children,F.mode,W,N.key),U.return=F,F=U):(W=N0(N.type,N.key,N.props,null,F.mode,W),W.ref=Ep(F,U,N),W.return=F,F=W)}return d(F);case Gh:e:{for(Z=N.key;U!==null;){if(U.key===Z)if(U.tag===4&&U.stateNode.containerInfo===N.containerInfo&&U.stateNode.implementation===N.implementation){r(F,U.sibling),U=o(U,N.children||[]),U.return=F,F=U;break e}else{r(F,U);break}else t(F,U);U=U.sibling}U=i1(N,F.mode,W),U.return=F,F=U}return d(F);case Il:return Z=N._init,q(F,U,Z(N._payload),W)}if(Up(N))return z(F,U,N,W);if(wp(N))return L(F,U,N,W);r0(F,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,U!==null&&U.tag===6?(r(F,U.sibling),U=o(U,N),U.return=F,F=U):(r(F,U),U=n1(N,F.mode,W),U.return=F,F=U),d(F)):r(F,U)}return q}var vd=QO(!0),eD=QO(!1),Y0=tc(null),J0=null,Qh=null,US=null;function VS(){US=Qh=J0=null}function GS(e){var t=Y0.current;Kr(Y0),e._currentValue=t}function _w(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function cd(e,t){J0=e,US=Qh=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Qi=!0),e.firstContext=null)}function Za(e){var t=e._currentValue;if(US!==e)if(e={context:e,memoizedValue:t,next:null},Qh===null){if(J0===null)throw Error(dt(308));Qh=e,J0.dependencies={lanes:0,firstContext:e}}else Qh=Qh.next=e;return t}var tu=null;function qS(e){tu===null?tu=[e]:tu.push(e)}function tD(e,t,r,n){var o=t.interleaved;return o===null?(r.next=r,qS(t)):(r.next=o.next,o.next=r),t.interleaved=r,Us(e,n)}function Us(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var jl=!1;function WS(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rD(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ns(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ql(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,pr&2){var o=n.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),n.pending=t,Us(e,r)}return o=n.interleaved,o===null?(t.next=t,qS(n)):(t.next=o.next,o.next=t),n.interleaved=t,Us(e,r)}function M0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,IS(e,r)}}function ZE(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var o=null,h=null;if(r=r.firstBaseUpdate,r!==null){do{var d={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};h===null?o=h=d:h=h.next=d,r=r.next}while(r!==null);h===null?o=h=t:h=h.next=t}else o=h=t;r={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:h,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Q0(e,t,r,n){var o=e.updateQueue;jl=!1;var h=o.firstBaseUpdate,d=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var y=s,w=y.next;y.next=null,d===null?h=w:d.next=w,d=y;var k=e.alternate;k!==null&&(k=k.updateQueue,s=k.lastBaseUpdate,s!==d&&(s===null?k.firstBaseUpdate=w:s.next=w,k.lastBaseUpdate=y))}if(h!==null){var E=o.baseState;d=0,k=w=y=null,s=h;do{var I=s.lane,j=s.eventTime;if((n&I)===I){k!==null&&(k=k.next={eventTime:j,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var z=e,L=s;switch(I=t,j=r,L.tag){case 1:if(z=L.payload,typeof z=="function"){E=z.call(j,E,I);break e}E=z;break e;case 3:z.flags=z.flags&-65537|128;case 0:if(z=L.payload,I=typeof z=="function"?z.call(j,E,I):z,I==null)break e;E=ln({},E,I);break e;case 2:jl=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,I=o.effects,I===null?o.effects=[s]:I.push(s))}else j={eventTime:j,lane:I,tag:s.tag,payload:s.payload,callback:s.callback,next:null},k===null?(w=k=j,y=E):k=k.next=j,d|=I;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;I=s,s=I.next,I.next=null,o.lastBaseUpdate=I,o.shared.pending=null}}while(1);if(k===null&&(y=E),o.baseState=y,o.firstBaseUpdate=w,o.lastBaseUpdate=k,t=o.shared.interleaved,t!==null){o=t;do d|=o.lane,o=o.next;while(o!==t)}else h===null&&(o.shared.lanes=0);mu|=d,e.lanes=d,e.memoizedState=E}}function KE(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(o!==null){if(n.callback=null,n=r,typeof o!="function")throw Error(dt(191,o));o.call(n)}}}var vg={},Xo=tc(vg),wm=tc(vg),Sm=tc(vg);function ru(e){if(e===vg)throw Error(dt(174));return e}function HS(e,t){switch(Fr(Sm,t),Fr(wm,e),Fr(Xo,vg),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Q1(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Q1(t,e)}Kr(Xo),Fr(Xo,t)}function _d(){Kr(Xo),Kr(wm),Kr(Sm)}function nD(e){ru(Sm.current);var t=ru(Xo.current),r=Q1(t,e.type);t!==r&&(Fr(wm,e),Fr(Xo,r))}function ZS(e){wm.current===e&&(Kr(Xo),Kr(wm))}var on=tc(0);function ev(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Yb=[];function KS(){for(var e=0;e<Yb.length;e++)Yb[e]._workInProgressVersionPrimary=null;Yb.length=0}var I0=Zs.ReactCurrentDispatcher,Jb=Zs.ReactCurrentBatchConfig,pu=0,sn=null,Wn=null,ii=null,tv=!1,Qp=!1,Pm=0,eB=0;function ki(){throw Error(dt(321))}function XS(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!To(e[r],t[r]))return!1;return!0}function YS(e,t,r,n,o,h){if(pu=h,sn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,I0.current=e===null||e.memoizedState===null?iB:aB,e=r(n,o),Qp){h=0;do{if(Qp=!1,Pm=0,25<=h)throw Error(dt(301));h+=1,ii=Wn=null,t.updateQueue=null,I0.current=oB,e=r(n,o)}while(Qp)}if(I0.current=rv,t=Wn!==null&&Wn.next!==null,pu=0,ii=Wn=sn=null,tv=!1,t)throw Error(dt(300));return e}function JS(){var e=Pm!==0;return Pm=0,e}function qo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ii===null?sn.memoizedState=ii=e:ii=ii.next=e,ii}function Ka(){if(Wn===null){var e=sn.alternate;e=e!==null?e.memoizedState:null}else e=Wn.next;var t=ii===null?sn.memoizedState:ii.next;if(t!==null)ii=t,Wn=e;else{if(e===null)throw Error(dt(310));Wn=e,e={memoizedState:Wn.memoizedState,baseState:Wn.baseState,baseQueue:Wn.baseQueue,queue:Wn.queue,next:null},ii===null?sn.memoizedState=ii=e:ii=ii.next=e}return ii}function Tm(e,t){return typeof t=="function"?t(e):t}function Qb(e){var t=Ka(),r=t.queue;if(r===null)throw Error(dt(311));r.lastRenderedReducer=e;var n=Wn,o=n.baseQueue,h=r.pending;if(h!==null){if(o!==null){var d=o.next;o.next=h.next,h.next=d}n.baseQueue=o=h,r.pending=null}if(o!==null){h=o.next,n=n.baseState;var s=d=null,y=null,w=h;do{var k=w.lane;if((pu&k)===k)y!==null&&(y=y.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),n=w.hasEagerState?w.eagerState:e(n,w.action);else{var E={lane:k,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};y===null?(s=y=E,d=n):y=y.next=E,sn.lanes|=k,mu|=k}w=w.next}while(w!==null&&w!==h);y===null?d=n:y.next=s,To(n,t.memoizedState)||(Qi=!0),t.memoizedState=n,t.baseState=d,t.baseQueue=y,r.lastRenderedState=n}if(e=r.interleaved,e!==null){o=e;do h=o.lane,sn.lanes|=h,mu|=h,o=o.next;while(o!==e)}else o===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function e1(e){var t=Ka(),r=t.queue;if(r===null)throw Error(dt(311));r.lastRenderedReducer=e;var n=r.dispatch,o=r.pending,h=t.memoizedState;if(o!==null){r.pending=null;var d=o=o.next;do h=e(h,d.action),d=d.next;while(d!==o);To(h,t.memoizedState)||(Qi=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),r.lastRenderedState=h}return[h,n]}function iD(){}function aD(e,t){var r=sn,n=Ka(),o=t(),h=!To(n.memoizedState,o);if(h&&(n.memoizedState=o,Qi=!0),n=n.queue,QS(lD.bind(null,r,n,e),[e]),n.getSnapshot!==t||h||ii!==null&&ii.memoizedState.tag&1){if(r.flags|=2048,km(9,sD.bind(null,r,n,o,t),void 0,null),oi===null)throw Error(dt(349));pu&30||oD(r,t,o)}return o}function oD(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=sn.updateQueue,t===null?(t={lastEffect:null,stores:null},sn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function sD(e,t,r,n){t.value=r,t.getSnapshot=n,cD(t)&&uD(e)}function lD(e,t,r){return r(function(){cD(t)&&uD(e)})}function cD(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!To(e,r)}catch{return!0}}function uD(e){var t=Us(e,1);t!==null&&So(t,e,1,-1)}function XE(e){var t=qo();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tm,lastRenderedState:e},t.queue=e,e=e.dispatch=nB.bind(null,sn,e),[t.memoizedState,e]}function km(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=sn.updateQueue,t===null?(t={lastEffect:null,stores:null},sn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function hD(){return Ka().memoizedState}function j0(e,t,r,n){var o=qo();sn.flags|=e,o.memoizedState=km(1|t,r,void 0,n===void 0?null:n)}function m_(e,t,r,n){var o=Ka();n=n===void 0?null:n;var h=void 0;if(Wn!==null){var d=Wn.memoizedState;if(h=d.destroy,n!==null&&XS(n,d.deps)){o.memoizedState=km(t,r,h,n);return}}sn.flags|=e,o.memoizedState=km(1|t,r,h,n)}function YE(e,t){return j0(8390656,8,e,t)}function QS(e,t){return m_(2048,8,e,t)}function dD(e,t){return m_(4,2,e,t)}function fD(e,t){return m_(4,4,e,t)}function pD(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function mD(e,t,r){return r=r!=null?r.concat([e]):null,m_(4,4,pD.bind(null,t,e),r)}function eP(){}function gD(e,t){var r=Ka();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&XS(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function yD(e,t){var r=Ka();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&XS(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function vD(e,t,r){return pu&21?(To(r,t)||(r=SO(),sn.lanes|=r,mu|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Qi=!0),e.memoizedState=r)}function tB(e,t){var r=Cr;Cr=r!==0&&4>r?r:4,e(!0);var n=Jb.transition;Jb.transition={};try{e(!1),t()}finally{Cr=r,Jb.transition=n}}function _D(){return Ka().memoizedState}function rB(e,t,r){var n=Hl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},xD(e))bD(t,r);else if(r=tD(e,t,r,n),r!==null){var o=Vi();So(r,e,n,o),wD(r,t,n)}}function nB(e,t,r){var n=Hl(e),o={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(xD(e))bD(t,o);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var d=t.lastRenderedState,s=h(d,r);if(o.hasEagerState=!0,o.eagerState=s,To(s,d)){var y=t.interleaved;y===null?(o.next=o,qS(t)):(o.next=y.next,y.next=o),t.interleaved=o;return}}catch{}finally{}r=tD(e,t,o,n),r!==null&&(o=Vi(),So(r,e,n,o),wD(r,t,n))}}function xD(e){var t=e.alternate;return e===sn||t!==null&&t===sn}function bD(e,t){Qp=tv=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function wD(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,IS(e,r)}}var rv={readContext:Za,useCallback:ki,useContext:ki,useEffect:ki,useImperativeHandle:ki,useInsertionEffect:ki,useLayoutEffect:ki,useMemo:ki,useReducer:ki,useRef:ki,useState:ki,useDebugValue:ki,useDeferredValue:ki,useTransition:ki,useMutableSource:ki,useSyncExternalStore:ki,useId:ki,unstable_isNewReconciler:!1},iB={readContext:Za,useCallback:function(e,t){return qo().memoizedState=[e,t===void 0?null:t],e},useContext:Za,useEffect:YE,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,j0(4194308,4,pD.bind(null,t,e),r)},useLayoutEffect:function(e,t){return j0(4194308,4,e,t)},useInsertionEffect:function(e,t){return j0(4,2,e,t)},useMemo:function(e,t){var r=qo();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=qo();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=rB.bind(null,sn,e),[n.memoizedState,e]},useRef:function(e){var t=qo();return e={current:e},t.memoizedState=e},useState:XE,useDebugValue:eP,useDeferredValue:function(e){return qo().memoizedState=e},useTransition:function(){var e=XE(!1),t=e[0];return e=tB.bind(null,e[1]),qo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=sn,o=qo();if(tn){if(r===void 0)throw Error(dt(407));r=r()}else{if(r=t(),oi===null)throw Error(dt(349));pu&30||oD(n,t,r)}o.memoizedState=r;var h={value:r,getSnapshot:t};return o.queue=h,YE(lD.bind(null,n,h,e),[e]),n.flags|=2048,km(9,sD.bind(null,n,h,r,t),void 0,null),r},useId:function(){var e=qo(),t=oi.identifierPrefix;if(tn){var r=js,n=Is;r=(n&~(1<<32-wo(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Pm++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=eB++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},aB={readContext:Za,useCallback:gD,useContext:Za,useEffect:QS,useImperativeHandle:mD,useInsertionEffect:dD,useLayoutEffect:fD,useMemo:yD,useReducer:Qb,useRef:hD,useState:function(){return Qb(Tm)},useDebugValue:eP,useDeferredValue:function(e){var t=Ka();return vD(t,Wn.memoizedState,e)},useTransition:function(){var e=Qb(Tm)[0],t=Ka().memoizedState;return[e,t]},useMutableSource:iD,useSyncExternalStore:aD,useId:_D,unstable_isNewReconciler:!1},oB={readContext:Za,useCallback:gD,useContext:Za,useEffect:QS,useImperativeHandle:mD,useInsertionEffect:dD,useLayoutEffect:fD,useMemo:yD,useReducer:e1,useRef:hD,useState:function(){return e1(Tm)},useDebugValue:eP,useDeferredValue:function(e){var t=Ka();return Wn===null?t.memoizedState=e:vD(t,Wn.memoizedState,e)},useTransition:function(){var e=e1(Tm)[0],t=Ka().memoizedState;return[e,t]},useMutableSource:iD,useSyncExternalStore:aD,useId:_D,unstable_isNewReconciler:!1};function po(e,t){if(e&&e.defaultProps){t=ln({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function xw(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ln({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var g_={isMounted:function(e){return(e=e._reactInternals)?Su(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Vi(),o=Hl(e),h=Ns(n,o);h.payload=t,r!=null&&(h.callback=r),t=ql(e,h,o),t!==null&&(So(t,e,o,n),M0(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Vi(),o=Hl(e),h=Ns(n,o);h.tag=1,h.payload=t,r!=null&&(h.callback=r),t=ql(e,h,o),t!==null&&(So(t,e,o,n),M0(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Vi(),n=Hl(e),o=Ns(r,n);o.tag=2,t!=null&&(o.callback=t),t=ql(e,o,n),t!==null&&(So(t,e,n,r),M0(t,e,n))}};function JE(e,t,r,n,o,h,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,h,d):t.prototype&&t.prototype.isPureReactComponent?!vm(r,n)||!vm(o,h):!0}function SD(e,t,r){var n=!1,o=Ql,h=t.contextType;return typeof h=="object"&&h!==null?h=Za(h):(o=ra(t)?du:ji.current,n=t.contextTypes,h=(n=n!=null)?gd(e,o):Ql),t=new t(r,h),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=g_,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=h),t}function QE(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&g_.enqueueReplaceState(t,t.state,null)}function bw(e,t,r,n){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs={},WS(e);var h=t.contextType;typeof h=="object"&&h!==null?o.context=Za(h):(h=ra(t)?du:ji.current,o.context=gd(e,h)),o.state=e.memoizedState,h=t.getDerivedStateFromProps,typeof h=="function"&&(xw(e,t,h,r),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&g_.enqueueReplaceState(o,o.state,null),Q0(e,r,o,n),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function xd(e,t){try{var r="",n=t;do r+=DL(n),n=n.return;while(n);var o=r}catch(h){o=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:t,stack:o,digest:null}}function t1(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ww(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var sB=typeof WeakMap=="function"?WeakMap:Map;function PD(e,t,r){r=Ns(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){iv||(iv=!0,jw=n),ww(e,t)},r}function TD(e,t,r){r=Ns(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var o=t.value;r.payload=function(){return n(o)},r.callback=function(){ww(e,t)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(r.callback=function(){ww(e,t),typeof n!="function"&&(Wl===null?Wl=new Set([this]):Wl.add(this));var d=t.stack;this.componentDidCatch(t.value,{componentStack:d!==null?d:""})}),r}function eA(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new sB;var o=new Set;n.set(t,o)}else o=n.get(t),o===void 0&&(o=new Set,n.set(t,o));o.has(r)||(o.add(r),e=bB.bind(null,e,t,r),t.then(e,e))}function tA(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function rA(e,t,r,n,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ns(-1,1),t.tag=2,ql(r,t,1))),r.lanes|=1),e)}var lB=Zs.ReactCurrentOwner,Qi=!1;function Fi(e,t,r,n){t.child=e===null?eD(t,null,r,n):vd(t,e.child,r,n)}function nA(e,t,r,n,o){r=r.render;var h=t.ref;return cd(t,o),n=YS(e,t,r,n,h,o),r=JS(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Vs(e,t,o)):(tn&&r&&LS(t),t.flags|=1,Fi(e,t,n,o),t.child)}function iA(e,t,r,n,o){if(e===null){var h=r.type;return typeof h=="function"&&!lP(h)&&h.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=h,kD(e,t,h,n,o)):(e=N0(r.type,null,n,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,!(e.lanes&o)){var d=h.memoizedProps;if(r=r.compare,r=r!==null?r:vm,r(d,n)&&e.ref===t.ref)return Vs(e,t,o)}return t.flags|=1,e=Zl(h,n),e.ref=t.ref,e.return=t,t.child=e}function kD(e,t,r,n,o){if(e!==null){var h=e.memoizedProps;if(vm(h,n)&&e.ref===t.ref)if(Qi=!1,t.pendingProps=n=h,(e.lanes&o)!==0)e.flags&131072&&(Qi=!0);else return t.lanes=e.lanes,Vs(e,t,o)}return Sw(e,t,r,n,o)}function ED(e,t,r){var n=t.pendingProps,o=n.children,h=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fr(td,Sa),Sa|=r;else{if(!(r&1073741824))return e=h!==null?h.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Fr(td,Sa),Sa|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=h!==null?h.baseLanes:r,Fr(td,Sa),Sa|=n}else h!==null?(n=h.baseLanes|r,t.memoizedState=null):n=r,Fr(td,Sa),Sa|=n;return Fi(e,t,o,r),t.child}function AD(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Sw(e,t,r,n,o){var h=ra(r)?du:ji.current;return h=gd(t,h),cd(t,o),r=YS(e,t,r,n,h,o),n=JS(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Vs(e,t,o)):(tn&&n&&LS(t),t.flags|=1,Fi(e,t,r,o),t.child)}function aA(e,t,r,n,o){if(ra(r)){var h=!0;Z0(t)}else h=!1;if(cd(t,o),t.stateNode===null)O0(e,t),SD(t,r,n),bw(t,r,n,o),n=!0;else if(e===null){var d=t.stateNode,s=t.memoizedProps;d.props=s;var y=d.context,w=r.contextType;typeof w=="object"&&w!==null?w=Za(w):(w=ra(r)?du:ji.current,w=gd(t,w));var k=r.getDerivedStateFromProps,E=typeof k=="function"||typeof d.getSnapshotBeforeUpdate=="function";E||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(s!==n||y!==w)&&QE(t,d,n,w),jl=!1;var I=t.memoizedState;d.state=I,Q0(t,n,d,o),y=t.memoizedState,s!==n||I!==y||ta.current||jl?(typeof k=="function"&&(xw(t,r,k,n),y=t.memoizedState),(s=jl||JE(t,r,s,n,I,y,w))?(E||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(t.flags|=4194308)):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=y),d.props=n,d.state=y,d.context=w,n=s):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{d=t.stateNode,rD(e,t),s=t.memoizedProps,w=t.type===t.elementType?s:po(t.type,s),d.props=w,E=t.pendingProps,I=d.context,y=r.contextType,typeof y=="object"&&y!==null?y=Za(y):(y=ra(r)?du:ji.current,y=gd(t,y));var j=r.getDerivedStateFromProps;(k=typeof j=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(s!==E||I!==y)&&QE(t,d,n,y),jl=!1,I=t.memoizedState,d.state=I,Q0(t,n,d,o);var z=t.memoizedState;s!==E||I!==z||ta.current||jl?(typeof j=="function"&&(xw(t,r,j,n),z=t.memoizedState),(w=jl||JE(t,r,w,n,I,z,y)||!1)?(k||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(n,z,y),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(n,z,y)),typeof d.componentDidUpdate=="function"&&(t.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof d.componentDidUpdate!="function"||s===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=z),d.props=n,d.state=z,d.context=y,n=w):(typeof d.componentDidUpdate!="function"||s===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),n=!1)}return Pw(e,t,r,n,h,o)}function Pw(e,t,r,n,o,h){AD(e,t);var d=(t.flags&128)!==0;if(!n&&!d)return o&&GE(t,r,!1),Vs(e,t,h);n=t.stateNode,lB.current=t;var s=d&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&d?(t.child=vd(t,e.child,null,h),t.child=vd(t,null,s,h)):Fi(e,t,s,h),t.memoizedState=n.state,o&&GE(t,r,!0),t.child}function CD(e){var t=e.stateNode;t.pendingContext?VE(e,t.pendingContext,t.pendingContext!==t.context):t.context&&VE(e,t.context,!1),HS(e,t.containerInfo)}function oA(e,t,r,n,o){return yd(),FS(o),t.flags|=256,Fi(e,t,r,n),t.child}var Tw={dehydrated:null,treeContext:null,retryLane:0};function kw(e){return{baseLanes:e,cachePool:null,transitions:null}}function MD(e,t,r){var n=t.pendingProps,o=on.current,h=!1,d=(t.flags&128)!==0,s;if((s=d)||(s=e!==null&&e.memoizedState===null?!1:(o&2)!==0),s?(h=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Fr(on,o&1),e===null)return vw(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(d=n.children,e=n.fallback,h?(n=t.mode,h=t.child,d={mode:"hidden",children:d},!(n&1)&&h!==null?(h.childLanes=0,h.pendingProps=d):h=__(d,n,0,null),e=lu(e,n,r,null),h.return=t,e.return=t,h.sibling=e,t.child=h,t.child.memoizedState=kw(r),t.memoizedState=Tw,e):tP(t,d));if(o=e.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return cB(e,t,d,n,s,o,r);if(h){h=n.fallback,d=t.mode,o=e.child,s=o.sibling;var y={mode:"hidden",children:n.children};return!(d&1)&&t.child!==o?(n=t.child,n.childLanes=0,n.pendingProps=y,t.deletions=null):(n=Zl(o,y),n.subtreeFlags=o.subtreeFlags&14680064),s!==null?h=Zl(s,h):(h=lu(h,d,r,null),h.flags|=2),h.return=t,n.return=t,n.sibling=h,t.child=n,n=h,h=t.child,d=e.child.memoizedState,d=d===null?kw(r):{baseLanes:d.baseLanes|r,cachePool:null,transitions:d.transitions},h.memoizedState=d,h.childLanes=e.childLanes&~r,t.memoizedState=Tw,n}return h=e.child,e=h.sibling,n=Zl(h,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function tP(e,t){return t=__({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function n0(e,t,r,n){return n!==null&&FS(n),vd(t,e.child,null,r),e=tP(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function cB(e,t,r,n,o,h,d){if(r)return t.flags&256?(t.flags&=-257,n=t1(Error(dt(422))),n0(e,t,d,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(h=n.fallback,o=t.mode,n=__({mode:"visible",children:n.children},o,0,null),h=lu(h,o,d,null),h.flags|=2,n.return=t,h.return=t,n.sibling=h,t.child=n,t.mode&1&&vd(t,e.child,null,d),t.child.memoizedState=kw(d),t.memoizedState=Tw,h);if(!(t.mode&1))return n0(e,t,d,null);if(o.data==="$!"){if(n=o.nextSibling&&o.nextSibling.dataset,n)var s=n.dgst;return n=s,h=Error(dt(419)),n=t1(h,n,void 0),n0(e,t,d,n)}if(s=(d&e.childLanes)!==0,Qi||s){if(n=oi,n!==null){switch(d&-d){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(n.suspendedLanes|d)?0:o,o!==0&&o!==h.retryLane&&(h.retryLane=o,Us(e,o),So(n,e,o,-1))}return sP(),n=t1(Error(dt(421))),n0(e,t,d,n)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=wB.bind(null,e),o._reactRetry=t,null):(e=h.treeContext,ka=Gl(o.nextSibling),Ea=t,tn=!0,_o=null,e!==null&&(Ua[Va++]=Is,Ua[Va++]=js,Ua[Va++]=fu,Is=e.id,js=e.overflow,fu=t),t=tP(t,n.children),t.flags|=4096,t)}function sA(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),_w(e.return,t,r)}function r1(e,t,r,n,o){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:o}:(h.isBackwards=t,h.rendering=null,h.renderingStartTime=0,h.last=n,h.tail=r,h.tailMode=o)}function ID(e,t,r){var n=t.pendingProps,o=n.revealOrder,h=n.tail;if(Fi(e,t,n.children,r),n=on.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&sA(e,r,t);else if(e.tag===19)sA(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Fr(on,n),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(r=t.child,o=null;r!==null;)e=r.alternate,e!==null&&ev(e)===null&&(o=r),r=r.sibling;r=o,r===null?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),r1(t,!1,o,r,h);break;case"backwards":for(r=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&ev(e)===null){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}r1(t,!0,r,null,h);break;case"together":r1(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function O0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),mu|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(dt(153));if(t.child!==null){for(e=t.child,r=Zl(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Zl(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function uB(e,t,r){switch(t.tag){case 3:CD(t),yd();break;case 5:nD(t);break;case 1:ra(t.type)&&Z0(t);break;case 4:HS(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,o=t.memoizedProps.value;Fr(Y0,n._currentValue),n._currentValue=o;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Fr(on,on.current&1),t.flags|=128,null):r&t.child.childLanes?MD(e,t,r):(Fr(on,on.current&1),e=Vs(e,t,r),e!==null?e.sibling:null);Fr(on,on.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return ID(e,t,r);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Fr(on,on.current),n)break;return null;case 22:case 23:return t.lanes=0,ED(e,t,r)}return Vs(e,t,r)}var jD,Ew,OD,DD;jD=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ew=function(){};OD=function(e,t,r,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,ru(Xo.current);var h=null;switch(r){case"input":o=K1(e,o),n=K1(e,n),h=[];break;case"select":o=ln({},o,{value:void 0}),n=ln({},n,{value:void 0}),h=[];break;case"textarea":o=J1(e,o),n=J1(e,n),h=[];break;default:typeof o.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=W0)}ew(r,n);var d;r=null;for(w in o)if(!n.hasOwnProperty(w)&&o.hasOwnProperty(w)&&o[w]!=null)if(w==="style"){var s=o[w];for(d in s)s.hasOwnProperty(d)&&(r||(r={}),r[d]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(hm.hasOwnProperty(w)?h||(h=[]):(h=h||[]).push(w,null));for(w in n){var y=n[w];if(s=o!=null?o[w]:void 0,n.hasOwnProperty(w)&&y!==s&&(y!=null||s!=null))if(w==="style")if(s){for(d in s)!s.hasOwnProperty(d)||y&&y.hasOwnProperty(d)||(r||(r={}),r[d]="");for(d in y)y.hasOwnProperty(d)&&s[d]!==y[d]&&(r||(r={}),r[d]=y[d])}else r||(h||(h=[]),h.push(w,r)),r=y;else w==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,s=s?s.__html:void 0,y!=null&&s!==y&&(h=h||[]).push(w,y)):w==="children"?typeof y!="string"&&typeof y!="number"||(h=h||[]).push(w,""+y):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(hm.hasOwnProperty(w)?(y!=null&&w==="onScroll"&&Wr("scroll",e),h||s===y||(h=[])):(h=h||[]).push(w,y))}r&&(h=h||[]).push("style",r);var w=h;(t.updateQueue=w)&&(t.flags|=4)}};DD=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ap(e,t){if(!tn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ei(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags&14680064,n|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags,n|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function hB(e,t,r){var n=t.pendingProps;switch(BS(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ei(t),null;case 1:return ra(t.type)&&H0(),Ei(t),null;case 3:return n=t.stateNode,_d(),Kr(ta),Kr(ji),KS(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(t0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,_o!==null&&(Rw(_o),_o=null))),Ew(e,t),Ei(t),null;case 5:ZS(t);var o=ru(Sm.current);if(r=t.type,e!==null&&t.stateNode!=null)OD(e,t,r,n,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(dt(166));return Ei(t),null}if(e=ru(Xo.current),t0(t)){n=t.stateNode,r=t.type;var h=t.memoizedProps;switch(n[Ho]=t,n[bm]=h,e=(t.mode&1)!==0,r){case"dialog":Wr("cancel",n),Wr("close",n);break;case"iframe":case"object":case"embed":Wr("load",n);break;case"video":case"audio":for(o=0;o<Gp.length;o++)Wr(Gp[o],n);break;case"source":Wr("error",n);break;case"img":case"image":case"link":Wr("error",n),Wr("load",n);break;case"details":Wr("toggle",n);break;case"input":gE(n,h),Wr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!h.multiple},Wr("invalid",n);break;case"textarea":vE(n,h),Wr("invalid",n)}ew(r,h),o=null;for(var d in h)if(h.hasOwnProperty(d)){var s=h[d];d==="children"?typeof s=="string"?n.textContent!==s&&(h.suppressHydrationWarning!==!0&&e0(n.textContent,s,e),o=["children",s]):typeof s=="number"&&n.textContent!==""+s&&(h.suppressHydrationWarning!==!0&&e0(n.textContent,s,e),o=["children",""+s]):hm.hasOwnProperty(d)&&s!=null&&d==="onScroll"&&Wr("scroll",n)}switch(r){case"input":Wy(n),yE(n,h,!0);break;case"textarea":Wy(n),_E(n);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(n.onclick=W0)}n=o,t.updateQueue=n,n!==null&&(t.flags|=4)}else{d=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=lO(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=d.createElement(r,{is:n.is}):(e=d.createElement(r),r==="select"&&(d=e,n.multiple?d.multiple=!0:n.size&&(d.size=n.size))):e=d.createElementNS(e,r),e[Ho]=t,e[bm]=n,jD(e,t,!1,!1),t.stateNode=e;e:{switch(d=tw(r,n),r){case"dialog":Wr("cancel",e),Wr("close",e),o=n;break;case"iframe":case"object":case"embed":Wr("load",e),o=n;break;case"video":case"audio":for(o=0;o<Gp.length;o++)Wr(Gp[o],e);o=n;break;case"source":Wr("error",e),o=n;break;case"img":case"image":case"link":Wr("error",e),Wr("load",e),o=n;break;case"details":Wr("toggle",e),o=n;break;case"input":gE(e,n),o=K1(e,n),Wr("invalid",e);break;case"option":o=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=ln({},n,{value:void 0}),Wr("invalid",e);break;case"textarea":vE(e,n),o=J1(e,n),Wr("invalid",e);break;default:o=n}ew(r,o),s=o;for(h in s)if(s.hasOwnProperty(h)){var y=s[h];h==="style"?hO(e,y):h==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,y!=null&&cO(e,y)):h==="children"?typeof y=="string"?(r!=="textarea"||y!=="")&&dm(e,y):typeof y=="number"&&dm(e,""+y):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(hm.hasOwnProperty(h)?y!=null&&h==="onScroll"&&Wr("scroll",e):y!=null&&TS(e,h,y,d))}switch(r){case"input":Wy(e),yE(e,n,!1);break;case"textarea":Wy(e),_E(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Jl(n.value));break;case"select":e.multiple=!!n.multiple,h=n.value,h!=null?ad(e,!!n.multiple,h,!1):n.defaultValue!=null&&ad(e,!!n.multiple,n.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=W0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ei(t),null;case 6:if(e&&t.stateNode!=null)DD(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(dt(166));if(r=ru(Sm.current),ru(Xo.current),t0(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ho]=t,(h=n.nodeValue!==r)&&(e=Ea,e!==null))switch(e.tag){case 3:e0(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&e0(n.nodeValue,r,(e.mode&1)!==0)}h&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ho]=t,t.stateNode=n}return Ei(t),null;case 13:if(Kr(on),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(tn&&ka!==null&&t.mode&1&&!(t.flags&128))JO(),yd(),t.flags|=98560,h=!1;else if(h=t0(t),n!==null&&n.dehydrated!==null){if(e===null){if(!h)throw Error(dt(318));if(h=t.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(dt(317));h[Ho]=t}else yd(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ei(t),h=!1}else _o!==null&&(Rw(_o),_o=null),h=!0;if(!h)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||on.current&1?Hn===0&&(Hn=3):sP())),t.updateQueue!==null&&(t.flags|=4),Ei(t),null);case 4:return _d(),Ew(e,t),e===null&&_m(t.stateNode.containerInfo),Ei(t),null;case 10:return GS(t.type._context),Ei(t),null;case 17:return ra(t.type)&&H0(),Ei(t),null;case 19:if(Kr(on),h=t.memoizedState,h===null)return Ei(t),null;if(n=(t.flags&128)!==0,d=h.rendering,d===null)if(n)Ap(h,!1);else{if(Hn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(d=ev(e),d!==null){for(t.flags|=128,Ap(h,!1),n=d.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)h=r,e=n,h.flags&=14680066,d=h.alternate,d===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=d.childLanes,h.lanes=d.lanes,h.child=d.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=d.memoizedProps,h.memoizedState=d.memoizedState,h.updateQueue=d.updateQueue,h.type=d.type,e=d.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Fr(on,on.current&1|2),t.child}e=e.sibling}h.tail!==null&&Pn()>bd&&(t.flags|=128,n=!0,Ap(h,!1),t.lanes=4194304)}else{if(!n)if(e=ev(d),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ap(h,!0),h.tail===null&&h.tailMode==="hidden"&&!d.alternate&&!tn)return Ei(t),null}else 2*Pn()-h.renderingStartTime>bd&&r!==1073741824&&(t.flags|=128,n=!0,Ap(h,!1),t.lanes=4194304);h.isBackwards?(d.sibling=t.child,t.child=d):(r=h.last,r!==null?r.sibling=d:t.child=d,h.last=d)}return h.tail!==null?(t=h.tail,h.rendering=t,h.tail=t.sibling,h.renderingStartTime=Pn(),t.sibling=null,r=on.current,Fr(on,n?r&1|2:r&1),t):(Ei(t),null);case 22:case 23:return oP(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Sa&1073741824&&(Ei(t),t.subtreeFlags&6&&(t.flags|=8192)):Ei(t),null;case 24:return null;case 25:return null}throw Error(dt(156,t.tag))}function dB(e,t){switch(BS(t),t.tag){case 1:return ra(t.type)&&H0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _d(),Kr(ta),Kr(ji),KS(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ZS(t),null;case 13:if(Kr(on),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(dt(340));yd()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Kr(on),null;case 4:return _d(),null;case 10:return GS(t.type._context),null;case 22:case 23:return oP(),null;case 24:return null;default:return null}}var i0=!1,Ci=!1,fB=typeof WeakSet=="function"?WeakSet:Set,kt=null;function ed(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){mn(e,t,n)}else r.current=null}function Aw(e,t,r){try{r()}catch(n){mn(e,t,n)}}var lA=!1;function pB(e,t){if(hw=V0,e=LO(),zS(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var o=n.anchorOffset,h=n.focusNode;n=n.focusOffset;try{r.nodeType,h.nodeType}catch{r=null;break e}var d=0,s=-1,y=-1,w=0,k=0,E=e,I=null;t:for(;;){for(var j;E!==r||o!==0&&E.nodeType!==3||(s=d+o),E!==h||n!==0&&E.nodeType!==3||(y=d+n),E.nodeType===3&&(d+=E.nodeValue.length),(j=E.firstChild)!==null;)I=E,E=j;for(;;){if(E===e)break t;if(I===r&&++w===o&&(s=d),I===h&&++k===n&&(y=d),(j=E.nextSibling)!==null)break;E=I,I=E.parentNode}E=j}r=s===-1||y===-1?null:{start:s,end:y}}else r=null}r=r||{start:0,end:0}}else r=null;for(dw={focusedElem:e,selectionRange:r},V0=!1,kt=t;kt!==null;)if(t=kt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,kt=e;else for(;kt!==null;){t=kt;try{var z=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(z!==null){var L=z.memoizedProps,q=z.memoizedState,F=t.stateNode,U=F.getSnapshotBeforeUpdate(t.elementType===t.type?L:po(t.type,L),q);F.__reactInternalSnapshotBeforeUpdate=U}break;case 3:var N=t.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(dt(163))}}catch(W){mn(t,t.return,W)}if(e=t.sibling,e!==null){e.return=t.return,kt=e;break}kt=t.return}return z=lA,lA=!1,z}function em(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&e)===e){var h=o.destroy;o.destroy=void 0,h!==void 0&&Aw(t,r,h)}o=o.next}while(o!==n)}}function y_(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Cw(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function RD(e){var t=e.alternate;t!==null&&(e.alternate=null,RD(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ho],delete t[bm],delete t[mw],delete t[X4],delete t[Y4])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ND(e){return e.tag===5||e.tag===3||e.tag===4}function cA(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ND(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Mw(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=W0));else if(n!==4&&(e=e.child,e!==null))for(Mw(e,t,r),e=e.sibling;e!==null;)Mw(e,t,r),e=e.sibling}function Iw(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Iw(e,t,r),e=e.sibling;e!==null;)Iw(e,t,r),e=e.sibling}var gi=null,mo=!1;function Al(e,t,r){for(r=r.child;r!==null;)$D(e,t,r),r=r.sibling}function $D(e,t,r){if(Ko&&typeof Ko.onCommitFiberUnmount=="function")try{Ko.onCommitFiberUnmount(c_,r)}catch{}switch(r.tag){case 5:Ci||ed(r,t);case 6:var n=gi,o=mo;gi=null,Al(e,t,r),gi=n,mo=o,gi!==null&&(mo?(e=gi,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):gi.removeChild(r.stateNode));break;case 18:gi!==null&&(mo?(e=gi,r=r.stateNode,e.nodeType===8?Kb(e.parentNode,r):e.nodeType===1&&Kb(e,r),gm(e)):Kb(gi,r.stateNode));break;case 4:n=gi,o=mo,gi=r.stateNode.containerInfo,mo=!0,Al(e,t,r),gi=n,mo=o;break;case 0:case 11:case 14:case 15:if(!Ci&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){o=n=n.next;do{var h=o,d=h.destroy;h=h.tag,d!==void 0&&(h&2||h&4)&&Aw(r,t,d),o=o.next}while(o!==n)}Al(e,t,r);break;case 1:if(!Ci&&(ed(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){mn(r,t,s)}Al(e,t,r);break;case 21:Al(e,t,r);break;case 22:r.mode&1?(Ci=(n=Ci)||r.memoizedState!==null,Al(e,t,r),Ci=n):Al(e,t,r);break;default:Al(e,t,r)}}function uA(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new fB),t.forEach(function(n){var o=SB.bind(null,e,n);r.has(n)||(r.add(n),n.then(o,o))})}}function uo(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var o=r[n];try{var h=e,d=t,s=d;e:for(;s!==null;){switch(s.tag){case 5:gi=s.stateNode,mo=!1;break e;case 3:gi=s.stateNode.containerInfo,mo=!0;break e;case 4:gi=s.stateNode.containerInfo,mo=!0;break e}s=s.return}if(gi===null)throw Error(dt(160));$D(h,d,o),gi=null,mo=!1;var y=o.alternate;y!==null&&(y.return=null),o.return=null}catch(w){mn(o,t,w)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)zD(t,e),t=t.sibling}function zD(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(uo(t,e),Go(e),n&4){try{em(3,e,e.return),y_(3,e)}catch(L){mn(e,e.return,L)}try{em(5,e,e.return)}catch(L){mn(e,e.return,L)}}break;case 1:uo(t,e),Go(e),n&512&&r!==null&&ed(r,r.return);break;case 5:if(uo(t,e),Go(e),n&512&&r!==null&&ed(r,r.return),e.flags&32){var o=e.stateNode;try{dm(o,"")}catch(L){mn(e,e.return,L)}}if(n&4&&(o=e.stateNode,o!=null)){var h=e.memoizedProps,d=r!==null?r.memoizedProps:h,s=e.type,y=e.updateQueue;if(e.updateQueue=null,y!==null)try{s==="input"&&h.type==="radio"&&h.name!=null&&oO(o,h),tw(s,d);var w=tw(s,h);for(d=0;d<y.length;d+=2){var k=y[d],E=y[d+1];k==="style"?hO(o,E):k==="dangerouslySetInnerHTML"?cO(o,E):k==="children"?dm(o,E):TS(o,k,E,w)}switch(s){case"input":X1(o,h);break;case"textarea":sO(o,h);break;case"select":var I=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!h.multiple;var j=h.value;j!=null?ad(o,!!h.multiple,j,!1):I!==!!h.multiple&&(h.defaultValue!=null?ad(o,!!h.multiple,h.defaultValue,!0):ad(o,!!h.multiple,h.multiple?[]:"",!1))}o[bm]=h}catch(L){mn(e,e.return,L)}}break;case 6:if(uo(t,e),Go(e),n&4){if(e.stateNode===null)throw Error(dt(162));o=e.stateNode,h=e.memoizedProps;try{o.nodeValue=h}catch(L){mn(e,e.return,L)}}break;case 3:if(uo(t,e),Go(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{gm(t.containerInfo)}catch(L){mn(e,e.return,L)}break;case 4:uo(t,e),Go(e);break;case 13:uo(t,e),Go(e),o=e.child,o.flags&8192&&(h=o.memoizedState!==null,o.stateNode.isHidden=h,!h||o.alternate!==null&&o.alternate.memoizedState!==null||(iP=Pn())),n&4&&uA(e);break;case 22:if(k=r!==null&&r.memoizedState!==null,e.mode&1?(Ci=(w=Ci)||k,uo(t,e),Ci=w):uo(t,e),Go(e),n&8192){if(w=e.memoizedState!==null,(e.stateNode.isHidden=w)&&!k&&e.mode&1)for(kt=e,k=e.child;k!==null;){for(E=kt=k;kt!==null;){switch(I=kt,j=I.child,I.tag){case 0:case 11:case 14:case 15:em(4,I,I.return);break;case 1:ed(I,I.return);var z=I.stateNode;if(typeof z.componentWillUnmount=="function"){n=I,r=I.return;try{t=n,z.props=t.memoizedProps,z.state=t.memoizedState,z.componentWillUnmount()}catch(L){mn(n,r,L)}}break;case 5:ed(I,I.return);break;case 22:if(I.memoizedState!==null){dA(E);continue}}j!==null?(j.return=I,kt=j):dA(E)}k=k.sibling}e:for(k=null,E=e;;){if(E.tag===5){if(k===null){k=E;try{o=E.stateNode,w?(h=o.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(s=E.stateNode,y=E.memoizedProps.style,d=y!=null&&y.hasOwnProperty("display")?y.display:null,s.style.display=uO("display",d))}catch(L){mn(e,e.return,L)}}}else if(E.tag===6){if(k===null)try{E.stateNode.nodeValue=w?"":E.memoizedProps}catch(L){mn(e,e.return,L)}}else if((E.tag!==22&&E.tag!==23||E.memoizedState===null||E===e)&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===e)break e;for(;E.sibling===null;){if(E.return===null||E.return===e)break e;k===E&&(k=null),E=E.return}k===E&&(k=null),E.sibling.return=E.return,E=E.sibling}}break;case 19:uo(t,e),Go(e),n&4&&uA(e);break;case 21:break;default:uo(t,e),Go(e)}}function Go(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(ND(r)){var n=r;break e}r=r.return}throw Error(dt(160))}switch(n.tag){case 5:var o=n.stateNode;n.flags&32&&(dm(o,""),n.flags&=-33);var h=cA(e);Iw(e,h,o);break;case 3:case 4:var d=n.stateNode.containerInfo,s=cA(e);Mw(e,s,d);break;default:throw Error(dt(161))}}catch(y){mn(e,e.return,y)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function mB(e,t,r){kt=e,LD(e)}function LD(e,t,r){for(var n=(e.mode&1)!==0;kt!==null;){var o=kt,h=o.child;if(o.tag===22&&n){var d=o.memoizedState!==null||i0;if(!d){var s=o.alternate,y=s!==null&&s.memoizedState!==null||Ci;s=i0;var w=Ci;if(i0=d,(Ci=y)&&!w)for(kt=o;kt!==null;)d=kt,y=d.child,d.tag===22&&d.memoizedState!==null?fA(o):y!==null?(y.return=d,kt=y):fA(o);for(;h!==null;)kt=h,LD(h),h=h.sibling;kt=o,i0=s,Ci=w}hA(e)}else o.subtreeFlags&8772&&h!==null?(h.return=o,kt=h):hA(e)}}function hA(e){for(;kt!==null;){var t=kt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ci||y_(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ci)if(r===null)n.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:po(t.type,r.memoizedProps);n.componentDidUpdate(o,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var h=t.updateQueue;h!==null&&KE(t,h,n);break;case 3:var d=t.updateQueue;if(d!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}KE(t,d,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var y=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":y.autoFocus&&r.focus();break;case"img":y.src&&(r.src=y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var w=t.alternate;if(w!==null){var k=w.memoizedState;if(k!==null){var E=k.dehydrated;E!==null&&gm(E)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(dt(163))}Ci||t.flags&512&&Cw(t)}catch(I){mn(t,t.return,I)}}if(t===e){kt=null;break}if(r=t.sibling,r!==null){r.return=t.return,kt=r;break}kt=t.return}}function dA(e){for(;kt!==null;){var t=kt;if(t===e){kt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,kt=r;break}kt=t.return}}function fA(e){for(;kt!==null;){var t=kt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{y_(4,t)}catch(y){mn(t,r,y)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var o=t.return;try{n.componentDidMount()}catch(y){mn(t,o,y)}}var h=t.return;try{Cw(t)}catch(y){mn(t,h,y)}break;case 5:var d=t.return;try{Cw(t)}catch(y){mn(t,d,y)}}}catch(y){mn(t,t.return,y)}if(t===e){kt=null;break}var s=t.sibling;if(s!==null){s.return=t.return,kt=s;break}kt=t.return}}var gB=Math.ceil,nv=Zs.ReactCurrentDispatcher,rP=Zs.ReactCurrentOwner,Wa=Zs.ReactCurrentBatchConfig,pr=0,oi=null,Dn=null,_i=0,Sa=0,td=tc(0),Hn=0,Em=null,mu=0,v_=0,nP=0,tm=null,Yi=null,iP=0,bd=1/0,Es=null,iv=!1,jw=null,Wl=null,a0=!1,Ll=null,av=0,rm=0,Ow=null,D0=-1,R0=0;function Vi(){return pr&6?Pn():D0!==-1?D0:D0=Pn()}function Hl(e){return e.mode&1?pr&2&&_i!==0?_i&-_i:Q4.transition!==null?(R0===0&&(R0=SO()),R0):(e=Cr,e!==0||(e=window.event,e=e===void 0?16:MO(e.type)),e):1}function So(e,t,r,n){if(50<rm)throw rm=0,Ow=null,Error(dt(185));mg(e,r,n),(!(pr&2)||e!==oi)&&(e===oi&&(!(pr&2)&&(v_|=r),Hn===4&&Rl(e,_i)),na(e,n),r===1&&pr===0&&!(t.mode&1)&&(bd=Pn()+500,p_&&rc()))}function na(e,t){var r=e.callbackNode;QL(e,t);var n=U0(e,e===oi?_i:0);if(n===0)r!==null&&wE(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&wE(r),t===1)e.tag===0?J4(pA.bind(null,e)):KO(pA.bind(null,e)),Z4(function(){!(pr&6)&&rc()}),r=null;else{switch(PO(n)){case 1:r=MS;break;case 4:r=bO;break;case 16:r=F0;break;case 536870912:r=wO;break;default:r=F0}r=HD(r,BD.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function BD(e,t){if(D0=-1,R0=0,pr&6)throw Error(dt(327));var r=e.callbackNode;if(ud()&&e.callbackNode!==r)return null;var n=U0(e,e===oi?_i:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ov(e,n);else{t=n;var o=pr;pr|=2;var h=UD();(oi!==e||_i!==t)&&(Es=null,bd=Pn()+500,su(e,t));do try{_B();break}catch(s){FD(e,s)}while(1);VS(),nv.current=h,pr=o,Dn!==null?t=0:(oi=null,_i=0,t=Hn)}if(t!==0){if(t===2&&(o=ow(e),o!==0&&(n=o,t=Dw(e,o))),t===1)throw r=Em,su(e,0),Rl(e,n),na(e,Pn()),r;if(t===6)Rl(e,n);else{if(o=e.current.alternate,!(n&30)&&!yB(o)&&(t=ov(e,n),t===2&&(h=ow(e),h!==0&&(n=h,t=Dw(e,h))),t===1))throw r=Em,su(e,0),Rl(e,n),na(e,Pn()),r;switch(e.finishedWork=o,e.finishedLanes=n,t){case 0:case 1:throw Error(dt(345));case 2:Zc(e,Yi,Es);break;case 3:if(Rl(e,n),(n&130023424)===n&&(t=iP+500-Pn(),10<t)){if(U0(e,0)!==0)break;if(o=e.suspendedLanes,(o&n)!==n){Vi(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=pw(Zc.bind(null,e,Yi,Es),t);break}Zc(e,Yi,Es);break;case 4:if(Rl(e,n),(n&4194240)===n)break;for(t=e.eventTimes,o=-1;0<n;){var d=31-wo(n);h=1<<d,d=t[d],d>o&&(o=d),n&=~h}if(n=o,n=Pn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*gB(n/1960))-n,10<n){e.timeoutHandle=pw(Zc.bind(null,e,Yi,Es),n);break}Zc(e,Yi,Es);break;case 5:Zc(e,Yi,Es);break;default:throw Error(dt(329))}}}return na(e,Pn()),e.callbackNode===r?BD.bind(null,e):null}function Dw(e,t){var r=tm;return e.current.memoizedState.isDehydrated&&(su(e,t).flags|=256),e=ov(e,t),e!==2&&(t=Yi,Yi=r,t!==null&&Rw(t)),e}function Rw(e){Yi===null?Yi=e:Yi.push.apply(Yi,e)}function yB(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var o=r[n],h=o.getSnapshot;o=o.value;try{if(!To(h(),o))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Rl(e,t){for(t&=~nP,t&=~v_,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-wo(t),n=1<<r;e[r]=-1,t&=~n}}function pA(e){if(pr&6)throw Error(dt(327));ud();var t=U0(e,0);if(!(t&1))return na(e,Pn()),null;var r=ov(e,t);if(e.tag!==0&&r===2){var n=ow(e);n!==0&&(t=n,r=Dw(e,n))}if(r===1)throw r=Em,su(e,0),Rl(e,t),na(e,Pn()),r;if(r===6)throw Error(dt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Zc(e,Yi,Es),na(e,Pn()),null}function aP(e,t){var r=pr;pr|=1;try{return e(t)}finally{pr=r,pr===0&&(bd=Pn()+500,p_&&rc())}}function gu(e){Ll!==null&&Ll.tag===0&&!(pr&6)&&ud();var t=pr;pr|=1;var r=Wa.transition,n=Cr;try{if(Wa.transition=null,Cr=1,e)return e()}finally{Cr=n,Wa.transition=r,pr=t,!(pr&6)&&rc()}}function oP(){Sa=td.current,Kr(td)}function su(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,H4(r)),Dn!==null)for(r=Dn.return;r!==null;){var n=r;switch(BS(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&H0();break;case 3:_d(),Kr(ta),Kr(ji),KS();break;case 5:ZS(n);break;case 4:_d();break;case 13:Kr(on);break;case 19:Kr(on);break;case 10:GS(n.type._context);break;case 22:case 23:oP()}r=r.return}if(oi=e,Dn=e=Zl(e.current,null),_i=Sa=t,Hn=0,Em=null,nP=v_=mu=0,Yi=tm=null,tu!==null){for(t=0;t<tu.length;t++)if(r=tu[t],n=r.interleaved,n!==null){r.interleaved=null;var o=n.next,h=r.pending;if(h!==null){var d=h.next;h.next=o,n.next=d}r.pending=n}tu=null}return e}function FD(e,t){do{var r=Dn;try{if(VS(),I0.current=rv,tv){for(var n=sn.memoizedState;n!==null;){var o=n.queue;o!==null&&(o.pending=null),n=n.next}tv=!1}if(pu=0,ii=Wn=sn=null,Qp=!1,Pm=0,rP.current=null,r===null||r.return===null){Hn=1,Em=t,Dn=null;break}e:{var h=e,d=r.return,s=r,y=t;if(t=_i,s.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){var w=y,k=s,E=k.tag;if(!(k.mode&1)&&(E===0||E===11||E===15)){var I=k.alternate;I?(k.updateQueue=I.updateQueue,k.memoizedState=I.memoizedState,k.lanes=I.lanes):(k.updateQueue=null,k.memoizedState=null)}var j=tA(d);if(j!==null){j.flags&=-257,rA(j,d,s,h,t),j.mode&1&&eA(h,w,t),t=j,y=w;var z=t.updateQueue;if(z===null){var L=new Set;L.add(y),t.updateQueue=L}else z.add(y);break e}else{if(!(t&1)){eA(h,w,t),sP();break e}y=Error(dt(426))}}else if(tn&&s.mode&1){var q=tA(d);if(q!==null){!(q.flags&65536)&&(q.flags|=256),rA(q,d,s,h,t),FS(xd(y,s));break e}}h=y=xd(y,s),Hn!==4&&(Hn=2),tm===null?tm=[h]:tm.push(h),h=d;do{switch(h.tag){case 3:h.flags|=65536,t&=-t,h.lanes|=t;var F=PD(h,y,t);ZE(h,F);break e;case 1:s=y;var U=h.type,N=h.stateNode;if(!(h.flags&128)&&(typeof U.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Wl===null||!Wl.has(N)))){h.flags|=65536,t&=-t,h.lanes|=t;var W=TD(h,s,t);ZE(h,W);break e}}h=h.return}while(h!==null)}GD(r)}catch(H){t=H,Dn===r&&r!==null&&(Dn=r=r.return);continue}break}while(1)}function UD(){var e=nv.current;return nv.current=rv,e===null?rv:e}function sP(){(Hn===0||Hn===3||Hn===2)&&(Hn=4),oi===null||!(mu&268435455)&&!(v_&268435455)||Rl(oi,_i)}function ov(e,t){var r=pr;pr|=2;var n=UD();(oi!==e||_i!==t)&&(Es=null,su(e,t));do try{vB();break}catch(o){FD(e,o)}while(1);if(VS(),pr=r,nv.current=n,Dn!==null)throw Error(dt(261));return oi=null,_i=0,Hn}function vB(){for(;Dn!==null;)VD(Dn)}function _B(){for(;Dn!==null&&!GL();)VD(Dn)}function VD(e){var t=WD(e.alternate,e,Sa);e.memoizedProps=e.pendingProps,t===null?GD(e):Dn=t,rP.current=null}function GD(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=dB(r,t),r!==null){r.flags&=32767,Dn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Hn=6,Dn=null;return}}else if(r=hB(r,t,Sa),r!==null){Dn=r;return}if(t=t.sibling,t!==null){Dn=t;return}Dn=t=e}while(t!==null);Hn===0&&(Hn=5)}function Zc(e,t,r){var n=Cr,o=Wa.transition;try{Wa.transition=null,Cr=1,xB(e,t,r,n)}finally{Wa.transition=o,Cr=n}return null}function xB(e,t,r,n){do ud();while(Ll!==null);if(pr&6)throw Error(dt(327));r=e.finishedWork;var o=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(dt(177));e.callbackNode=null,e.callbackPriority=0;var h=r.lanes|r.childLanes;if(e4(e,h),e===oi&&(Dn=oi=null,_i=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||a0||(a0=!0,HD(F0,function(){return ud(),null})),h=(r.flags&15990)!==0,r.subtreeFlags&15990||h){h=Wa.transition,Wa.transition=null;var d=Cr;Cr=1;var s=pr;pr|=4,rP.current=null,pB(e,r),zD(r,e),B4(dw),V0=!!hw,dw=hw=null,e.current=r,mB(r),qL(),pr=s,Cr=d,Wa.transition=h}else e.current=r;if(a0&&(a0=!1,Ll=e,av=o),h=e.pendingLanes,h===0&&(Wl=null),ZL(r.stateNode),na(e,Pn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)o=t[r],n(o.value,{componentStack:o.stack,digest:o.digest});if(iv)throw iv=!1,e=jw,jw=null,e;return av&1&&e.tag!==0&&ud(),h=e.pendingLanes,h&1?e===Ow?rm++:(rm=0,Ow=e):rm=0,rc(),null}function ud(){if(Ll!==null){var e=PO(av),t=Wa.transition,r=Cr;try{if(Wa.transition=null,Cr=16>e?16:e,Ll===null)var n=!1;else{if(e=Ll,Ll=null,av=0,pr&6)throw Error(dt(331));var o=pr;for(pr|=4,kt=e.current;kt!==null;){var h=kt,d=h.child;if(kt.flags&16){var s=h.deletions;if(s!==null){for(var y=0;y<s.length;y++){var w=s[y];for(kt=w;kt!==null;){var k=kt;switch(k.tag){case 0:case 11:case 15:em(8,k,h)}var E=k.child;if(E!==null)E.return=k,kt=E;else for(;kt!==null;){k=kt;var I=k.sibling,j=k.return;if(RD(k),k===w){kt=null;break}if(I!==null){I.return=j,kt=I;break}kt=j}}}var z=h.alternate;if(z!==null){var L=z.child;if(L!==null){z.child=null;do{var q=L.sibling;L.sibling=null,L=q}while(L!==null)}}kt=h}}if(h.subtreeFlags&2064&&d!==null)d.return=h,kt=d;else e:for(;kt!==null;){if(h=kt,h.flags&2048)switch(h.tag){case 0:case 11:case 15:em(9,h,h.return)}var F=h.sibling;if(F!==null){F.return=h.return,kt=F;break e}kt=h.return}}var U=e.current;for(kt=U;kt!==null;){d=kt;var N=d.child;if(d.subtreeFlags&2064&&N!==null)N.return=d,kt=N;else e:for(d=U;kt!==null;){if(s=kt,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:y_(9,s)}}catch(H){mn(s,s.return,H)}if(s===d){kt=null;break e}var W=s.sibling;if(W!==null){W.return=s.return,kt=W;break e}kt=s.return}}if(pr=o,rc(),Ko&&typeof Ko.onPostCommitFiberRoot=="function")try{Ko.onPostCommitFiberRoot(c_,e)}catch{}n=!0}return n}finally{Cr=r,Wa.transition=t}}return!1}function mA(e,t,r){t=xd(r,t),t=PD(e,t,1),e=ql(e,t,1),t=Vi(),e!==null&&(mg(e,1,t),na(e,t))}function mn(e,t,r){if(e.tag===3)mA(e,e,r);else for(;t!==null;){if(t.tag===3){mA(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Wl===null||!Wl.has(n))){e=xd(r,e),e=TD(t,e,1),t=ql(t,e,1),e=Vi(),t!==null&&(mg(t,1,e),na(t,e));break}}t=t.return}}function bB(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Vi(),e.pingedLanes|=e.suspendedLanes&r,oi===e&&(_i&r)===r&&(Hn===4||Hn===3&&(_i&130023424)===_i&&500>Pn()-iP?su(e,0):nP|=r),na(e,t)}function qD(e,t){t===0&&(e.mode&1?(t=Ky,Ky<<=1,!(Ky&130023424)&&(Ky=4194304)):t=1);var r=Vi();e=Us(e,t),e!==null&&(mg(e,t,r),na(e,r))}function wB(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),qD(e,r)}function SB(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,o=e.memoizedState;o!==null&&(r=o.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(dt(314))}n!==null&&n.delete(t),qD(e,r)}var WD;WD=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ta.current)Qi=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Qi=!1,uB(e,t,r);Qi=!!(e.flags&131072)}else Qi=!1,tn&&t.flags&1048576&&XO(t,X0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;O0(e,t),e=t.pendingProps;var o=gd(t,ji.current);cd(t,r),o=YS(null,t,n,e,o,r);var h=JS();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ra(n)?(h=!0,Z0(t)):h=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,WS(t),o.updater=g_,t.stateNode=o,o._reactInternals=t,bw(t,n,e,r),t=Pw(null,t,n,!0,h,r)):(t.tag=0,tn&&h&&LS(t),Fi(null,t,o,r),t=t.child),t;case 16:n=t.elementType;e:{switch(O0(e,t),e=t.pendingProps,o=n._init,n=o(n._payload),t.type=n,o=t.tag=TB(n),e=po(n,e),o){case 0:t=Sw(null,t,n,e,r);break e;case 1:t=aA(null,t,n,e,r);break e;case 11:t=nA(null,t,n,e,r);break e;case 14:t=iA(null,t,n,po(n.type,e),r);break e}throw Error(dt(306,n,""))}return t;case 0:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:po(n,o),Sw(e,t,n,o,r);case 1:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:po(n,o),aA(e,t,n,o,r);case 3:e:{if(CD(t),e===null)throw Error(dt(387));n=t.pendingProps,h=t.memoizedState,o=h.element,rD(e,t),Q0(t,n,null,r);var d=t.memoizedState;if(n=d.element,h.isDehydrated)if(h={element:n,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){o=xd(Error(dt(423)),t),t=oA(e,t,n,r,o);break e}else if(n!==o){o=xd(Error(dt(424)),t),t=oA(e,t,n,r,o);break e}else for(ka=Gl(t.stateNode.containerInfo.firstChild),Ea=t,tn=!0,_o=null,r=eD(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(yd(),n===o){t=Vs(e,t,r);break e}Fi(e,t,n,r)}t=t.child}return t;case 5:return nD(t),e===null&&vw(t),n=t.type,o=t.pendingProps,h=e!==null?e.memoizedProps:null,d=o.children,fw(n,o)?d=null:h!==null&&fw(n,h)&&(t.flags|=32),AD(e,t),Fi(e,t,d,r),t.child;case 6:return e===null&&vw(t),null;case 13:return MD(e,t,r);case 4:return HS(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=vd(t,null,n,r):Fi(e,t,n,r),t.child;case 11:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:po(n,o),nA(e,t,n,o,r);case 7:return Fi(e,t,t.pendingProps,r),t.child;case 8:return Fi(e,t,t.pendingProps.children,r),t.child;case 12:return Fi(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,o=t.pendingProps,h=t.memoizedProps,d=o.value,Fr(Y0,n._currentValue),n._currentValue=d,h!==null)if(To(h.value,d)){if(h.children===o.children&&!ta.current){t=Vs(e,t,r);break e}}else for(h=t.child,h!==null&&(h.return=t);h!==null;){var s=h.dependencies;if(s!==null){d=h.child;for(var y=s.firstContext;y!==null;){if(y.context===n){if(h.tag===1){y=Ns(-1,r&-r),y.tag=2;var w=h.updateQueue;if(w!==null){w=w.shared;var k=w.pending;k===null?y.next=y:(y.next=k.next,k.next=y),w.pending=y}}h.lanes|=r,y=h.alternate,y!==null&&(y.lanes|=r),_w(h.return,r,t),s.lanes|=r;break}y=y.next}}else if(h.tag===10)d=h.type===t.type?null:h.child;else if(h.tag===18){if(d=h.return,d===null)throw Error(dt(341));d.lanes|=r,s=d.alternate,s!==null&&(s.lanes|=r),_w(d,r,t),d=h.sibling}else d=h.child;if(d!==null)d.return=h;else for(d=h;d!==null;){if(d===t){d=null;break}if(h=d.sibling,h!==null){h.return=d.return,d=h;break}d=d.return}h=d}Fi(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,n=t.pendingProps.children,cd(t,r),o=Za(o),n=n(o),t.flags|=1,Fi(e,t,n,r),t.child;case 14:return n=t.type,o=po(n,t.pendingProps),o=po(n.type,o),iA(e,t,n,o,r);case 15:return kD(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:po(n,o),O0(e,t),t.tag=1,ra(n)?(e=!0,Z0(t)):e=!1,cd(t,r),SD(t,n,o),bw(t,n,o,r),Pw(null,t,n,!0,e,r);case 19:return ID(e,t,r);case 22:return ED(e,t,r)}throw Error(dt(156,t.tag))};function HD(e,t){return xO(e,t)}function PB(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ga(e,t,r,n){return new PB(e,t,r,n)}function lP(e){return e=e.prototype,!(!e||!e.isReactComponent)}function TB(e){if(typeof e=="function")return lP(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ES)return 11;if(e===AS)return 14}return 2}function Zl(e,t){var r=e.alternate;return r===null?(r=Ga(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function N0(e,t,r,n,o,h){var d=2;if(n=e,typeof e=="function")lP(e)&&(d=1);else if(typeof e=="string")d=5;else e:switch(e){case qh:return lu(r.children,o,h,t);case kS:d=8,o|=8;break;case q1:return e=Ga(12,r,t,o|2),e.elementType=q1,e.lanes=h,e;case W1:return e=Ga(13,r,t,o),e.elementType=W1,e.lanes=h,e;case H1:return e=Ga(19,r,t,o),e.elementType=H1,e.lanes=h,e;case nO:return __(r,o,h,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case tO:d=10;break e;case rO:d=9;break e;case ES:d=11;break e;case AS:d=14;break e;case Il:d=16,n=null;break e}throw Error(dt(130,e==null?e:typeof e,""))}return t=Ga(d,r,t,o),t.elementType=e,t.type=n,t.lanes=h,t}function lu(e,t,r,n){return e=Ga(7,e,n,t),e.lanes=r,e}function __(e,t,r,n){return e=Ga(22,e,n,t),e.elementType=nO,e.lanes=r,e.stateNode={isHidden:!1},e}function n1(e,t,r){return e=Ga(6,e,null,t),e.lanes=r,e}function i1(e,t,r){return t=Ga(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function kB(e,t,r,n,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zb(0),this.expirationTimes=zb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zb(0),this.identifierPrefix=n,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function cP(e,t,r,n,o,h,d,s,y){return e=new kB(e,t,r,s,y),t===1?(t=1,h===!0&&(t|=8)):t=0,h=Ga(3,null,null,t),e.current=h,h.stateNode=e,h.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},WS(h),e}function EB(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gh,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function ZD(e){if(!e)return Ql;e=e._reactInternals;e:{if(Su(e)!==e||e.tag!==1)throw Error(dt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ra(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(dt(171))}if(e.tag===1){var r=e.type;if(ra(r))return ZO(e,r,t)}return t}function KD(e,t,r,n,o,h,d,s,y){return e=cP(r,n,!0,e,o,h,d,s,y),e.context=ZD(null),r=e.current,n=Vi(),o=Hl(r),h=Ns(n,o),h.callback=t??null,ql(r,h,o),e.current.lanes=o,mg(e,o,n),na(e,n),e}function x_(e,t,r,n){var o=t.current,h=Vi(),d=Hl(o);return r=ZD(r),t.context===null?t.context=r:t.pendingContext=r,t=Ns(h,d),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ql(o,t,d),e!==null&&(So(e,o,d,h),M0(e,o,d)),d}function sv(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function gA(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function uP(e,t){gA(e,t),(e=e.alternate)&&gA(e,t)}function AB(){return null}var XD=typeof reportError=="function"?reportError:function(e){console.error(e)};function hP(e){this._internalRoot=e}b_.prototype.render=hP.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(dt(409));x_(e,t,null,null)};b_.prototype.unmount=hP.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;gu(function(){x_(null,e,null,null)}),t[Fs]=null}};function b_(e){this._internalRoot=e}b_.prototype.unstable_scheduleHydration=function(e){if(e){var t=EO();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Dl.length&&t!==0&&t<Dl[r].priority;r++);Dl.splice(r,0,e),r===0&&CO(e)}};function dP(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function w_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function yA(){}function CB(e,t,r,n,o){if(o){if(typeof n=="function"){var h=n;n=function(){var w=sv(d);h.call(w)}}var d=KD(t,n,e,0,null,!1,!1,"",yA);return e._reactRootContainer=d,e[Fs]=d.current,_m(e.nodeType===8?e.parentNode:e),gu(),d}for(;o=e.lastChild;)e.removeChild(o);if(typeof n=="function"){var s=n;n=function(){var w=sv(y);s.call(w)}}var y=cP(e,0,!1,null,null,!1,!1,"",yA);return e._reactRootContainer=y,e[Fs]=y.current,_m(e.nodeType===8?e.parentNode:e),gu(function(){x_(t,y,r,n)}),y}function S_(e,t,r,n,o){var h=r._reactRootContainer;if(h){var d=h;if(typeof o=="function"){var s=o;o=function(){var y=sv(d);s.call(y)}}x_(t,d,e,o)}else d=CB(r,t,e,o,n);return sv(d)}TO=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Vp(t.pendingLanes);r!==0&&(IS(t,r|1),na(t,Pn()),!(pr&6)&&(bd=Pn()+500,rc()))}break;case 13:gu(function(){var n=Us(e,1);if(n!==null){var o=Vi();So(n,e,1,o)}}),uP(e,1)}};jS=function(e){if(e.tag===13){var t=Us(e,134217728);if(t!==null){var r=Vi();So(t,e,134217728,r)}uP(e,134217728)}};kO=function(e){if(e.tag===13){var t=Hl(e),r=Us(e,t);if(r!==null){var n=Vi();So(r,e,t,n)}uP(e,t)}};EO=function(){return Cr};AO=function(e,t){var r=Cr;try{return Cr=e,t()}finally{Cr=r}};nw=function(e,t,r){switch(t){case"input":if(X1(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var o=f_(n);if(!o)throw Error(dt(90));aO(n),X1(n,o)}}}break;case"textarea":sO(e,r);break;case"select":t=r.value,t!=null&&ad(e,!!r.multiple,t,!1)}};pO=aP;mO=gu;var MB={usingClientEntryPoint:!1,Events:[yg,Kh,f_,dO,fO,aP]},Cp={findFiberByHostInstance:eu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},IB={bundleType:Cp.bundleType,version:Cp.version,rendererPackageName:Cp.rendererPackageName,rendererConfig:Cp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=vO(e),e===null?null:e.stateNode},findFiberByHostInstance:Cp.findFiberByHostInstance||AB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var o0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!o0.isDisabled&&o0.supportsFiber)try{c_=o0.inject(IB),Ko=o0}catch{}}Ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MB;Ca.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dP(t))throw Error(dt(200));return EB(e,t,null,r)};Ca.createRoot=function(e,t){if(!dP(e))throw Error(dt(299));var r=!1,n="",o=XD;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=cP(e,1,!1,null,null,r,!1,n,o),e[Fs]=t.current,_m(e.nodeType===8?e.parentNode:e),new hP(t)};Ca.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(dt(188)):(e=Object.keys(e).join(","),Error(dt(268,e)));return e=vO(t),e=e===null?null:e.stateNode,e};Ca.flushSync=function(e){return gu(e)};Ca.hydrate=function(e,t,r){if(!w_(t))throw Error(dt(200));return S_(null,e,t,!0,r)};Ca.hydrateRoot=function(e,t,r){if(!dP(e))throw Error(dt(405));var n=r!=null&&r.hydratedSources||null,o=!1,h="",d=XD;if(r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(h=r.identifierPrefix),r.onRecoverableError!==void 0&&(d=r.onRecoverableError)),t=KD(t,null,e,1,r??null,o,!1,h,d),e[Fs]=t.current,_m(e),n)for(e=0;e<n.length;e++)r=n[e],o=r._getVersion,o=o(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new b_(t)};Ca.render=function(e,t,r){if(!w_(t))throw Error(dt(200));return S_(null,e,t,!1,r)};Ca.unmountComponentAtNode=function(e){if(!w_(e))throw Error(dt(40));return e._reactRootContainer?(gu(function(){S_(null,null,e,!1,function(){e._reactRootContainer=null,e[Fs]=null})}),!0):!1};Ca.unstable_batchedUpdates=aP;Ca.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!w_(r))throw Error(dt(200));if(e==null||e._reactInternals===void 0)throw Error(dt(38));return S_(e,t,r,!1,n)};Ca.version="18.3.1-next-f1338f8080-20240426";function YD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(YD)}catch(e){console.error(e)}}YD(),Yj.exports=Ca;var jB=Yj.exports,vA=jB;V1.createRoot=vA.createRoot,V1.hydrateRoot=vA.hydrateRoot;const Am=[{id:"d1",fullName:"Rajesh Kumar",phone:"+91-9876543210",rating:4.5,joinedAt:new Date("2023-01-15"),status:"approved",assignedBusId:"b1",assignedRouteIds:["r1","r2"],totalDistanceKm:1250,totalTrips:85},{id:"d2",fullName:"Priya Sharma",phone:"+91-9876543211",rating:4.8,joinedAt:new Date("2023-03-20"),status:"approved",assignedBusId:"b2",assignedRouteIds:["r3"],totalDistanceKm:980,totalTrips:72},{id:"d3",fullName:"Amit Singh",phone:"+91-9876543212",rating:4.2,joinedAt:new Date("2023-06-10"),status:"pending",totalDistanceKm:0,totalTrips:0},{id:"d4",fullName:"Sunita Devi",phone:"+91-9876543213",rating:4.9,joinedAt:new Date("2022-11-05"),status:"approved",assignedBusId:"b3",assignedRouteIds:["r4","r5"],totalDistanceKm:1580,totalTrips:105},{id:"d5",fullName:"Mohammed Ali",phone:"+91-9876543214",rating:4,joinedAt:new Date("2023-08-01"),status:"pending",totalDistanceKm:0,totalTrips:0}],Nw=[{id:"b1",busNumber:"KA-01-AB-1234",vehicleType:"bus",active:!0,notes:"Regular maintenance completed"},{id:"b2",busNumber:"KA-01-CD-5678",vehicleType:"miniBus",active:!0,notes:"New vehicle"},{id:"b3",busNumber:"KA-01-EF-9012",vehicleType:"bus",active:!0,notes:"AC not working"},{id:"b4",busNumber:"KA-01-GH-3456",vehicleType:"auto",active:!1,notes:"Under repair"}],$w=[{id:"r1",name:"Electronic City to Majestic",code:"EC-MAJ",priorityScore:95},{id:"r2",name:"Whitefield to Silk Board",code:"WF-SB",priorityScore:88},{id:"r3",name:"Banashankari to KR Puram",code:"BS-KRP",priorityScore:92},{id:"r4",name:"Jayanagar to Airport",code:"JN-AIR",priorityScore:97},{id:"r5",name:"Koramangala to Hebbal",code:"KM-HB",priorityScore:85},{id:"r6",name:"BTM Layout to Yeshwanthpur",code:"BTM-YPR",priorityScore:78}],zw=Array.from({length:40},(e,t)=>({id:`t${t+1}`,passengerId:`p${Math.floor(Math.random()*20)+1}`,driverId:Am[Math.floor(Math.random()*Am.length)].id,busId:Nw[Math.floor(Math.random()*Nw.length)].id,routeId:$w[Math.floor(Math.random()*$w.length)].id,distance:Math.floor(Math.random()*50)+5,cost:Math.floor(Math.random()*200)+50,accepted:Math.random()>.1,started:Math.random()>.2,canceled:Math.random()>.9,arrived:Math.random()>.3,reachedDestination:Math.random()>.4,tripCompleted:Math.random()>.5,startedAt:new Date(Date.now()-Math.random()*7*24*60*60*1e3),endedAt:Math.random()>.6?new Date(Date.now()-Math.random()*6*24*60*60*1e3):void 0,fuelPricePerLitre:Math.random()>.7?Math.floor(Math.random()*20)+90:void 0})),OB=Array.from({length:25},(e,t)=>({id:`pay${t+1}`,tripId:zw[Math.floor(Math.random()*zw.length)].id,driverId:Am[Math.floor(Math.random()*Am.length)].id,userId:`u${Math.floor(Math.random()*50)+1}`,amount:Math.floor(Math.random()*300)+30,method:["UPI","Wallet"][Math.floor(Math.random()*2)],createdAt:new Date(Date.now()-Math.random()*30*24*60*60*1e3),status:["success","failed","refunded"][Math.floor(Math.random()*10)>8?Math.random()>.5?1:2:0]})),DB=[{id:"sos1",tripId:"t15",driverId:"d1",userId:"u25",busId:"b1",lat:12.9716,lng:77.5946,reason:"Vehicle breakdown",createdAt:new Date(Date.now()-2*60*60*1e3),status:"open"},{id:"sos2",tripId:"t28",driverId:"d2",userId:"u18",busId:"b2",lat:12.9352,lng:77.6245,reason:"Medical emergency",createdAt:new Date(Date.now()-4*60*60*1e3),status:"ack"},{id:"sos3",driverId:"d4",busId:"b3",lat:12.9698,lng:77.75,reason:"Route deviation",createdAt:new Date(Date.now()-24*60*60*1e3),status:"closed"}],RB={fuelPricePerLitre:100},NB=[{hour:6,riders:45},{hour:7,riders:125},{hour:8,riders:280},{hour:9,riders:320},{hour:10,riders:180},{hour:11,riders:95},{hour:12,riders:110},{hour:13,riders:85},{hour:14,riders:70},{hour:15,riders:90},{hour:16,riders:140},{hour:17,riders:240},{hour:18,riders:290},{hour:19,riders:220},{hour:20,riders:160},{hour:21,riders:85}],$B=[{routeId:"r4",routeName:"Jayanagar to Airport",riders:450},{routeId:"r1",routeName:"Electronic City to Majestic",riders:380},{routeId:"r3",routeName:"Banashankari to KR Puram",riders:340},{routeId:"r2",routeName:"Whitefield to Silk Board",riders:290},{routeId:"r5",routeName:"Koramangala to Hebbal",riders:250},{routeId:"r6",routeName:"BTM Layout to Yeshwanthpur",riders:180}];class zB{constructor(){za(this,"drivers",[...Am]);za(this,"buses",[...Nw]);za(this,"routes",[...$w]);za(this,"trips",[...zw]);za(this,"payments",[...OB]);za(this,"sosEvents",[...DB]);za(this,"settings",{...RB})}async getSettings(){return Promise.resolve({...this.settings})}async updateSettings(t){return this.settings={...this.settings,...t},Promise.resolve()}async listDrivers(t){return t?Promise.resolve(this.drivers.filter(r=>r.status===t)):Promise.resolve([...this.drivers])}async createDriver(t){const r={id:`driver-${Date.now()}`,fullName:t.fullName,phone:t.phone,rating:0,joinedAt:new Date,status:"pending",totalDistanceKm:0,totalTrips:0};return this.drivers.push(r),Promise.resolve({...r})}async approveAndAssignDriver(t){const r=this.drivers.findIndex(o=>o.id===t.driverId),n=this.buses.findIndex(o=>o.id===t.busId);return r!==-1&&(this.drivers[r]={...this.drivers[r],status:"approved",assignedBusId:t.busId,assignedRouteIds:t.routeIds}),n!==-1&&(this.buses[n]={...this.buses[n],assignedDriverId:t.driverId}),Promise.resolve()}async listBuses(){return Promise.resolve([...this.buses])}async createBus(t){const r={id:`bus-${Date.now()}`,busNumber:t.busNumber,vehicleType:t.vehicleType,active:!0,notes:t.notes};return this.buses.push(r),Promise.resolve({...r})}async listRoutes(){return Promise.resolve([...this.routes])}async createRoute(t){const r={id:`route-${Date.now()}`,name:t.name,code:t.code,priorityScore:t.priorityScore};return this.routes.push(r),Promise.resolve({...r})}async listTrips(t){let r=[...this.trips];return t!=null&&t.driverId&&(r=r.filter(n=>n.driverId===t.driverId)),t!=null&&t.routeId&&(r=r.filter(n=>n.routeId===t.routeId)),t!=null&&t.limit&&(r=r.slice(0,t.limit)),Promise.resolve(r)}async listPeakHours(){return Promise.resolve([...NB])}async listPeakRoutes(){return Promise.resolve([...$B])}async listPayments(t){let r=[...this.payments];return t!=null&&t.from&&(r=r.filter(n=>n.createdAt>=t.from)),t!=null&&t.to&&(r=r.filter(n=>n.createdAt<=t.to)),Promise.resolve(r)}async getRevenueSummary(){const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate()),n=new Date(r.getTime()-7*24*60*60*1e3),o=new Date(r.getTime()-30*24*60*60*1e3),h=this.payments.filter(w=>w.status==="success"),d=h.filter(w=>w.createdAt>=r).reduce((w,k)=>w+k.amount,0),s=h.filter(w=>w.createdAt>=n).reduce((w,k)=>w+k.amount,0),y=h.filter(w=>w.createdAt>=o).reduce((w,k)=>w+k.amount,0);return Promise.resolve({today:d,week:s,month:y})}async listSOSEvents(t){return t?Promise.resolve(this.sosEvents.filter(r=>r.status===t)):Promise.resolve([...this.sosEvents])}async updateSOS(t,r){const n=this.sosEvents.findIndex(o=>o.id===t);return n!==-1&&(this.sosEvents[n]={...this.sosEvents[n],status:r}),Promise.resolve()}async listLeaderboard(){const t=this.drivers.filter(o=>o.status==="approved"),r=[...t].sort((o,h)=>o.joinedAt.getTime()-h.joinedAt.getTime()),n=[...t].sort((o,h)=>(h.totalDistanceKm||0)-(o.totalDistanceKm||0));return Promise.resolve({byTenure:r,byDistance:n})}}const LB=new zB,Oi=()=>LB,JD=be.createContext(void 0),Mr=()=>{const e=be.useContext(JD);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e},BB=({children:e})=>{const[t,r]=be.useState(()=>localStorage.getItem("nextstop-theme")||"light");be.useEffect(()=>{localStorage.setItem("nextstop-theme",t),t==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[t]);const n=()=>{r(o=>o==="light"?"dark":"light")};return P.jsx(JD.Provider,{value:{theme:t,toggleTheme:n},children:e})};var QD={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},_A=Ie.createContext&&Ie.createContext(QD),Kl=globalThis&&globalThis.__assign||function(){return Kl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Kl.apply(this,arguments)},FB=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};function eR(e){return e&&e.map(function(t,r){return Ie.createElement(t.tag,Kl({key:r},t.attr),eR(t.child))})}function cr(e){return function(t){return Ie.createElement(UB,Kl({attr:Kl({},e.attr)},t),eR(e.child))}}function UB(e){var t=function(r){var n=e.attr,o=e.size,h=e.title,d=FB(e,["attr","size","title"]),s=o||r.size||"1em",y;return r.className&&(y=r.className),e.className&&(y=(y?y+" ":"")+e.className),Ie.createElement("svg",Kl({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,d,{className:y,style:Kl(Kl({color:e.color||r.color},r.style),e.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),h&&Ie.createElement("title",null,h),e.children)};return _A!==void 0?Ie.createElement(_A.Consumer,null,function(r){return t(r)}):t(QD)}function tR(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}}]})(e)}function VB(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"}}]})(e)}function Lw(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}}]})(e)}function GB(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}}]})(e)}function qB(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}},{tag:"path",attr:{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"}}]})(e)}function xA(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}}]})(e)}function WB(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.488.488 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 00-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"}}]})(e)}function HB(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M16 18l2.29-2.29-4.88-4.88-4 4L2 7.41 3.41 6l6 6 4-4 6.3 6.29L22 12v6z"}}]})(e)}function rR(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"}}]})(e)}function ZB(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}},{tag:"path",attr:{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"}}]})(e)}function KB(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"}}]})(e)}function nR(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}}]})(e)}function wd(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}}]})(e)}function XB(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"}}]})(e)}function a1(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M8 5v14l11-7z"}}]})(e)}function iR(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M20.38 8.57l-1.23 1.85a8 8 0 01-.22 7.58H5.07A8 8 0 0115.58 6.85l1.85-1.23A10 10 0 003.35 19a2 2 0 001.72 1h13.85a2 2 0 001.74-1 10 10 0 00-.27-10.44zm-9.79 6.84a2 2 0 002.83 0l5.66-8.49-8.49 5.66a2 2 0 000 2.83z"}}]})(e)}function bA(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M6 6h12v12H6z"}}]})(e)}function Cm(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 010-5 2.5 2.5 0 010 5z"}}]})(e)}function fP(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}}]})(e)}function $0(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}},{tag:"path",attr:{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"}}]})(e)}function YB(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"}}]})(e)}function JB(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"}}]})(e)}function pP(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"}}]})(e)}function QB(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M7 2v11h3v9l7-12h-4l4-8z"}}]})(e)}function Gs(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4s-8 .5-8 4v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6H6V6h12v5z"}}]})(e)}function e6(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"}}]})(e)}function t6(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm13.5-9l1.96 2.5H17V9.5h2.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}}]})(e)}function r6(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"}}]})(e)}function Mm(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M19 15.18V7c0-2.21-1.79-4-4-4s-4 1.79-4 4v10c0 1.1-.9 2-2 2s-2-.9-2-2V8.82C8.16 8.4 9 7.3 9 6c0-1.66-1.34-3-3-3S3 4.34 3 6c0 1.3.84 2.4 2 2.82V17c0 2.21 1.79 4 4 4s4-1.79 4-4V7c0-1.1.9-2 2-2s2 .9 2 2v8.18A2.996 2.996 0 0018 21c1.66 0 3-1.34 3-3 0-1.3-.84-2.4-2-2.82z"}}]})(e)}function n6(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M13.5 7h-3c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h3c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2zm0 8h-3V9h3v6zM1 15h4v-2H3c-1.1 0-2-.9-2-2V9c0-1.1.9-2 2-2h4v2H3v2h2c1.1 0 2 .9 2 2v2c0 1.1-.9 2-2 2H1v-2zm16 0h4v-2h-2c-1.1 0-2-.9-2-2V9c0-1.1.9-2 2-2h4v2h-4v2h2c1.1 0 2 .9 2 2v2c0 1.1-.9 2-2 2h-4v-2z"}}]})(e)}function aR(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}}]})(e)}function i6(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"}}]})(e)}function a6(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}}]})(e)}function o6(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 22c1.1 0 2-.9 2-2h-4a2 2 0 002 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"}}]})(e)}function oR(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}}]})(e)}function lv(e){return cr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}}]})(e)}const s6=()=>{const e=Oi(),{theme:t}=Mr(),[r,n]=be.useState({totalDrivers:0,activeBuses:0,todayRevenue:0,openSOS:0}),[o,h]=be.useState({totalDrivers:0,activeBuses:0,todayRevenue:0,openSOS:0}),[d,s]=be.useState(!0);be.useEffect(()=>{(async()=>{try{const[k,E,I,j]=await Promise.all([e.listDrivers(),e.listBuses(),e.getRevenueSummary(),e.listSOSEvents("open")]),z={totalDrivers:k.length,activeBuses:E.filter(L=>L.active).length,todayRevenue:I.today,openSOS:j.length};n(z),Object.entries(z).forEach(([L,q])=>{let F=0;const U=q/50,N=setInterval(()=>{F+=U,F>=q&&(F=q,clearInterval(N)),h(W=>({...W,[L]:Math.round(F)}))},30)})}catch(k){console.error("Failed to load KPI data:",k)}finally{s(!1)}})()},[e]);const y=[{title:"Total Drivers",value:o.totalDrivers.toString(),subValue:"Active",icon:oR,trend:"up",trendValue:"+8%",gradient:t==="dark"?"from-blue-500 to-cyan-500":"from-blue-600 to-cyan-600",bgGradient:t==="dark"?"from-blue-500/10 to-cyan-500/10":"from-blue-50 to-cyan-50",description:"Registered drivers"},{title:"Active Buses",value:o.activeBuses.toString(),subValue:"On Route",icon:Gs,trend:"up",trendValue:"+12%",gradient:t==="dark"?"from-green-500 to-emerald-500":"from-green-600 to-emerald-600",bgGradient:t==="dark"?"from-green-500/10 to-emerald-500/10":"from-green-50 to-emerald-50",description:"Currently operational"},{title:"Today's Revenue",value:`₹${o.todayRevenue.toLocaleString("en-IN")}`,subValue:"Earned",icon:pP,trend:"up",trendValue:"+15%",gradient:t==="dark"?"from-yellow-500 to-orange-500":"from-yellow-600 to-orange-600",bgGradient:t==="dark"?"from-yellow-500/10 to-orange-500/10":"from-yellow-50 to-orange-50",description:"Daily earnings"},{title:"Open SOS",value:o.openSOS.toString(),subValue:"Alerts",icon:wd,trend:r.openSOS>0?"down":"stable",trendValue:r.openSOS>0?"-25%":"0%",gradient:t==="dark"?"from-red-500 to-orange-500":"from-red-600 to-pink-600",bgGradient:t==="dark"?"from-red-500/10 to-orange-500/10":"from-red-50 to-pink-50",description:"Emergency alerts"}];return d?P.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(w=>P.jsxs("div",{className:`rounded-2xl p-6 ${t==="dark"?"bg-gray-800/50 backdrop-blur-xl border border-gray-700/50":"bg-white/70 backdrop-blur-xl border border-gray-200/50"} shadow-xl animate-pulse`,children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("div",{className:"w-12 h-12 bg-gray-300 rounded-xl"}),P.jsx("div",{className:"w-16 h-6 bg-gray-300 rounded-full"})]}),P.jsx("div",{className:"h-4 bg-gray-300 rounded mb-2"}),P.jsx("div",{className:"h-8 bg-gray-300 rounded mb-1"}),P.jsx("div",{className:"h-3 bg-gray-300 rounded w-3/4"})]},w))}):P.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:y.map((w,k)=>P.jsxs("div",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-500 hover:scale-105 hover:-translate-y-2 ${t==="dark"?"bg-gray-800/50 backdrop-blur-xl border border-gray-700/50":"bg-white/70 backdrop-blur-xl border border-gray-200/50"} shadow-xl hover:shadow-2xl animate-fade-in cursor-pointer`,style:{animationDelay:`${k*100}ms`},children:[P.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${w.bgGradient} opacity-50 group-hover:opacity-70 transition-opacity duration-300`}),P.jsx("div",{className:`absolute -top-10 -right-10 w-20 h-20 rounded-full bg-gradient-to-br ${w.gradient} opacity-10 group-hover:opacity-20 transition-opacity duration-300 animate-float`}),P.jsx("div",{className:`absolute -bottom-5 -left-5 w-15 h-15 rounded-full bg-gradient-to-br ${w.gradient} opacity-5 group-hover:opacity-15 transition-opacity duration-300 animate-float delay-500`}),P.jsxs("div",{className:"relative z-10",children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${w.gradient} shadow-lg group-hover:scale-110 transition-transform duration-300`,children:P.jsx(w.icon,{className:"text-white text-xl"})}),P.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-bold ${w.trend==="up"?"bg-green-500/20 text-green-500":w.trend==="down"?"bg-red-500/20 text-red-500":"bg-gray-500/20 text-gray-500"}`,children:[w.trend==="up"&&P.jsx(rR,{className:"text-xs"}),w.trend==="down"&&P.jsx(HB,{className:"text-xs"}),P.jsx("span",{children:w.trendValue})]})]}),P.jsx("h3",{className:`text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:w.title}),P.jsxs("div",{className:"flex items-baseline space-x-2 mb-1",children:[P.jsx("span",{className:`text-2xl font-bold bg-gradient-to-r ${w.gradient} bg-clip-text text-transparent`,children:w.value}),P.jsx("span",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:w.subValue})]}),P.jsx("p",{className:`text-xs ${t==="dark"?"text-gray-500":"text-gray-400"}`,children:w.description})]}),P.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:P.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent transform -skew-x-12 animate-shimmer"})})]},k))})};var sR={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.0/LICENSE.txt
 */(function(e,t){(function(r,n){e.exports=n()})(yi,function(){var r={},n={};function o(d,s,y){if(n[d]=y,d==="index"){var w="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",k={};return n.shared(k),n.index(r,k),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([w],{type:"text/javascript"}))),r}}o("shared",["exports"],function(d){function s(c,a,l,f){return new(l||(l=Promise))(function(m,x){function b(O){try{A(f.next(O))}catch(D){x(D)}}function T(O){try{A(f.throw(O))}catch(D){x(D)}}function A(O){var D;O.done?m(O.value):(D=O.value,D instanceof l?D:new l(function(B){B(D)})).then(b,T)}A((f=f.apply(c,a||[])).next())})}function y(c,a){this.x=c,this.y=a}function w(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var k,E;typeof SuppressedError=="function"&&SuppressedError,y.prototype={clone(){return new y(this.x,this.y)},add(c){return this.clone()._add(c)},sub(c){return this.clone()._sub(c)},multByPoint(c){return this.clone()._multByPoint(c)},divByPoint(c){return this.clone()._divByPoint(c)},mult(c){return this.clone()._mult(c)},div(c){return this.clone()._div(c)},rotate(c){return this.clone()._rotate(c)},rotateAround(c,a){return this.clone()._rotateAround(c,a)},matMult(c){return this.clone()._matMult(c)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(c){return this.x===c.x&&this.y===c.y},dist(c){return Math.sqrt(this.distSqr(c))},distSqr(c){const a=c.x-this.x,l=c.y-this.y;return a*a+l*l},angle(){return Math.atan2(this.y,this.x)},angleTo(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith(c){return this.angleWithSep(c.x,c.y)},angleWithSep(c,a){return Math.atan2(this.x*a-this.y*c,this.x*c+this.y*a)},_matMult(c){const a=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=a,this},_add(c){return this.x+=c.x,this.y+=c.y,this},_sub(c){return this.x-=c.x,this.y-=c.y,this},_mult(c){return this.x*=c,this.y*=c,this},_div(c){return this.x/=c,this.y/=c,this},_multByPoint(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint(c){return this.x/=c.x,this.y/=c.y,this},_unit(){return this._div(this.mag()),this},_perp(){const c=this.y;return this.y=this.x,this.x=-c,this},_rotate(c){const a=Math.cos(c),l=Math.sin(c),f=l*this.x+a*this.y;return this.x=a*this.x-l*this.y,this.y=f,this},_rotateAround(c,a){const l=Math.cos(c),f=Math.sin(c),m=a.y+f*(this.x-a.x)+l*(this.y-a.y);return this.x=a.x+l*(this.x-a.x)-f*(this.y-a.y),this.y=m,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:y},y.convert=function(c){if(c instanceof y)return c;if(Array.isArray(c))return new y(+c[0],+c[1]);if(c.x!==void 0&&c.y!==void 0)return new y(+c.x,+c.y);throw new Error("Expected [x, y] or {x, y} point format")};var I=function(){if(E)return k;function c(a,l,f,m){this.cx=3*a,this.bx=3*(f-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(m-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=l,this.p2x=f,this.p2y=m}return E=1,k=c,c.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,l){if(l===void 0&&(l=1e-6),a<0)return 0;if(a>1)return 1;for(var f=a,m=0;m<8;m++){var x=this.sampleCurveX(f)-a;if(Math.abs(x)<l)return f;var b=this.sampleCurveDerivativeX(f);if(Math.abs(b)<1e-6)break;f-=x/b}var T=0,A=1;for(f=a,m=0;m<20&&(x=this.sampleCurveX(f),!(Math.abs(x-a)<l));m++)a>x?T=f:A=f,f=.5*(A-T)+T;return f},solve:function(a,l){return this.sampleCurveY(this.solveCurveX(a,l))}},k}(),j=w(I);let z,L;function q(){return z==null&&(z=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),z}function F(){if(L==null&&(L=!1,q())){const a=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(a){for(let f=0;f<5*5;f++){const m=4*f;a.fillStyle=`rgb(${m},${m+1},${m+2})`,a.fillRect(f%5,Math.floor(f/5),1,1)}const l=a.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&l[f]!==f){L=!0;break}}}return L||!1}var U=1e-6,N=typeof Float32Array<"u"?Float32Array:Array;function W(){var c=new N(9);return N!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function H(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Z(){var c=new N(3);return N!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function re(c){var a=c[0],l=c[1],f=c[2];return Math.sqrt(a*a+l*l+f*f)}function he(c,a,l){var f=new N(3);return f[0]=c,f[1]=a,f[2]=l,f}function we(c,a,l){return c[0]=a[0]+l[0],c[1]=a[1]+l[1],c[2]=a[2]+l[2],c}function Oe(c,a,l){return c[0]=a[0]*l,c[1]=a[1]*l,c[2]=a[2]*l,c}function Me(c,a,l){var f=a[0],m=a[1],x=a[2],b=l[0],T=l[1],A=l[2];return c[0]=m*A-x*T,c[1]=x*b-f*A,c[2]=f*T-m*b,c}var Se,Ue=re;function We(c,a,l){var f=a[0],m=a[1],x=a[2],b=a[3];return c[0]=l[0]*f+l[4]*m+l[8]*x+l[12]*b,c[1]=l[1]*f+l[5]*m+l[9]*x+l[13]*b,c[2]=l[2]*f+l[6]*m+l[10]*x+l[14]*b,c[3]=l[3]*f+l[7]*m+l[11]*x+l[15]*b,c}function qe(){var c=new N(4);return N!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function Je(c,a,l,f){var m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",x=Math.PI/360;a*=x,f*=x,l*=x;var b=Math.sin(a),T=Math.cos(a),A=Math.sin(l),O=Math.cos(l),D=Math.sin(f),B=Math.cos(f);switch(m){case"xyz":c[0]=b*O*B+T*A*D,c[1]=T*A*B-b*O*D,c[2]=T*O*D+b*A*B,c[3]=T*O*B-b*A*D;break;case"xzy":c[0]=b*O*B-T*A*D,c[1]=T*A*B-b*O*D,c[2]=T*O*D+b*A*B,c[3]=T*O*B+b*A*D;break;case"yxz":c[0]=b*O*B+T*A*D,c[1]=T*A*B-b*O*D,c[2]=T*O*D-b*A*B,c[3]=T*O*B+b*A*D;break;case"yzx":c[0]=b*O*B+T*A*D,c[1]=T*A*B+b*O*D,c[2]=T*O*D-b*A*B,c[3]=T*O*B-b*A*D;break;case"zxy":c[0]=b*O*B-T*A*D,c[1]=T*A*B+b*O*D,c[2]=T*O*D+b*A*B,c[3]=T*O*B-b*A*D;break;case"zyx":c[0]=b*O*B-T*A*D,c[1]=T*A*B+b*O*D,c[2]=T*O*D-b*A*B,c[3]=T*O*B+b*A*D;break;default:throw new Error("Unknown angle order "+m)}return c}function rt(){var c=new N(2);return N!=Float32Array&&(c[0]=0,c[1]=0),c}function Le(c,a){var l=new N(2);return l[0]=c,l[1]=a,l}Z(),Se=new N(4),N!=Float32Array&&(Se[0]=0,Se[1]=0,Se[2]=0,Se[3]=0),Z(),he(1,0,0),he(0,1,0),qe(),qe(),W(),rt();const Be=8192;function nt(c,a,l){return a*(Be/(c.tileSize*Math.pow(2,l-c.tileID.overscaledZ)))}function Xe(c,a){return(c%a+a)%a}function Ge(c,a,l){return c*(1-l)+a*l}function it(c){if(c<=0)return 0;if(c>=1)return 1;const a=c*c,l=a*c;return 4*(c<.5?l:3*(c-a)+l-.75)}function gt(c,a,l,f){const m=new j(c,a,l,f);return x=>m.solve(x)}const Pt=gt(.25,.1,.25,1);function Nt(c,a,l){return Math.min(l,Math.max(a,c))}function or(c,a,l){const f=l-a,m=((c-a)%f+f)%f+a;return m===a?l:m}function rr(c,...a){for(const l of a)for(const f in l)c[f]=l[f];return c}let pt=1;function Dt(c,a,l){const f={};for(const m in c)f[m]=a.call(this,c[m],m,c);return f}function zt(c,a,l){const f={};for(const m in c)a.call(this,c[m],m,c)&&(f[m]=c[m]);return f}function et(c){return Array.isArray(c)?c.map(et):typeof c=="object"&&c?Dt(c,et):c}const Vt={};function It(c){Vt[c]||(typeof console<"u"&&console.warn(c),Vt[c]=!0)}function fr(c,a,l){return(l.y-c.y)*(a.x-c.x)>(a.y-c.y)*(l.x-c.x)}function mr(c){return typeof WorkerGlobalScope<"u"&&c!==void 0&&c instanceof WorkerGlobalScope}let Yr=null;function yn(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const Nn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function aa(c,a,l,f,m){return s(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(c,{timestamp:0});try{const b=x==null?void 0:x.format;if(!b||!b.startsWith("BGR")&&!b.startsWith("RGB"))throw new Error(`Unrecognized format ${b}`);const T=b.startsWith("BGR"),A=new Uint8ClampedArray(f*m*4);if(yield x.copyTo(A,function(O,D,B,K,Y){const J=4*Math.max(-D,0),te=(Math.max(0,B)-B)*K*4+J,ae=4*K,ce=Math.max(0,D),Pe=Math.max(0,B);return{rect:{x:ce,y:Pe,width:Math.min(O.width,D+K)-ce,height:Math.min(O.height,B+Y)-Pe},layout:[{offset:te,stride:ae}]}}(c,a,l,f,m)),T)for(let O=0;O<A.length;O+=4){const D=A[O];A[O]=A[O+2],A[O+2]=D}return A}finally{x.close()}})}let Xn,Yn;function Wi(c,a,l,f){return c.addEventListener(a,l,f),{unsubscribe:()=>{c.removeEventListener(a,l,f)}}}function Ia(c){return c*Math.PI/180}function oa(c){return c/Math.PI*180}const Eo={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Ao={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Js="AbortError";function Te(){return new Error(Js)}const ee={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ne(c){return ee.REGISTERED_PROTOCOLS[c.substring(0,c.indexOf("://"))]}const ie="global-dispatcher";class fe extends Error{constructor(a,l,f,m){super(`AJAXError: ${l} (${a}): ${f}`),this.status=a,this.statusText=l,this.url=f,this.body=m}}const _e=()=>mr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ee=function(c,a){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){const f=ne(c.url);if(f)return f(c,a);if(mr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,targetMapId:ie},a)}if(!(/^file:/.test(l=c.url)||/^file:/.test(_e())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(f,m){return s(this,void 0,void 0,function*(){const x=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:_e(),signal:m.signal});let b,T;f.type!=="json"||x.headers.has("Accept")||x.headers.set("Accept","application/json");try{b=yield fetch(x)}catch(O){throw new fe(0,O.message,f.url,new Blob)}if(!b.ok){const O=yield b.blob();throw new fe(b.status,b.statusText,f.url,O)}T=f.type==="arrayBuffer"||f.type==="image"?b.arrayBuffer():f.type==="json"?b.json():b.text();const A=yield T;if(m.signal.aborted)throw Te();return{data:A,cacheControl:b.headers.get("Cache-Control"),expires:b.headers.get("Expires")}})}(c,a);if(mr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,mustQueue:!0,targetMapId:ie},a)}var l;return function(f,m){return new Promise((x,b)=>{var T;const A=new XMLHttpRequest;A.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(A.responseType="arraybuffer");for(const O in f.headers)A.setRequestHeader(O,f.headers[O]);f.type==="json"&&(A.responseType="text",!((T=f.headers)===null||T===void 0)&&T.Accept||A.setRequestHeader("Accept","application/json")),A.withCredentials=f.credentials==="include",A.onerror=()=>{b(new Error(A.statusText))},A.onload=()=>{if(!m.signal.aborted)if((A.status>=200&&A.status<300||A.status===0)&&A.response!==null){let O=A.response;if(f.type==="json")try{O=JSON.parse(A.response)}catch(D){return void b(D)}x({data:O,cacheControl:A.getResponseHeader("Cache-Control"),expires:A.getResponseHeader("Expires")})}else{const O=new Blob([A.response],{type:A.getResponseHeader("Content-Type")});b(new fe(A.status,A.statusText,f.url,O))}},m.signal.addEventListener("abort",()=>{A.abort(),b(Te())}),A.send(f.body)})}(c,a)};function Re(c){if(!c||c.indexOf("://")<=0||c.indexOf("data:image/")===0||c.indexOf("blob:")===0)return!0;const a=new URL(c),l=window.location;return a.protocol===l.protocol&&a.host===l.host}function Ae(c,a,l){l[c]&&l[c].indexOf(a)!==-1||(l[c]=l[c]||[],l[c].push(a))}function Ve(c,a,l){if(l&&l[c]){const f=l[c].indexOf(a);f!==-1&&l[c].splice(f,1)}}class tt{constructor(a,l={}){rr(this,l),this.type=a}}class Ze extends tt{constructor(a,l={}){super("error",rr({error:a},l))}}class wt{on(a,l){return this._listeners=this._listeners||{},Ae(a,l,this._listeners),{unsubscribe:()=>{this.off(a,l)}}}off(a,l){return Ve(a,l,this._listeners),Ve(a,l,this._oneTimeListeners),this}once(a,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},Ae(a,l,this._oneTimeListeners),this):new Promise(f=>this.once(a,f))}fire(a,l){typeof a=="string"&&(a=new tt(a,l||{}));const f=a.type;if(this.listens(f)){a.target=this;const m=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const T of m)T.call(this,a);const x=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const T of x)Ve(f,T,this._oneTimeListeners),T.call(this,a);const b=this._eventedParent;b&&(rr(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(a))}else a instanceof Ze&&console.error(a.error);return this}listens(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)}setEventedParent(a,l){return this._eventedParent=a,this._eventedParentData=l,this}}var Ce={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const $t=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ht(c,a){const l={};for(const f in c)f!=="ref"&&(l[f]=c[f]);return $t.forEach(f=>{f in a&&(l[f]=a[f])}),l}function At(c,a){if(Array.isArray(c)){if(!Array.isArray(a)||c.length!==a.length)return!1;for(let l=0;l<c.length;l++)if(!At(c[l],a[l]))return!1;return!0}if(typeof c=="object"&&c!==null&&a!==null){if(typeof a!="object"||Object.keys(c).length!==Object.keys(a).length)return!1;for(const l in c)if(!At(c[l],a[l]))return!1;return!0}return c===a}function Ft(c,a){c.push(a)}function Ar(c,a,l){Ft(l,{command:"addSource",args:[c,a[c]]})}function vn(c,a,l){Ft(a,{command:"removeSource",args:[c]}),l[c]=!0}function _n(c,a,l,f){vn(c,l,f),Ar(c,a,l)}function nn(c,a,l){let f;for(f in c[l])if(Object.prototype.hasOwnProperty.call(c[l],f)&&f!=="data"&&!At(c[l][f],a[l][f]))return!1;for(f in a[l])if(Object.prototype.hasOwnProperty.call(a[l],f)&&f!=="data"&&!At(c[l][f],a[l][f]))return!1;return!0}function Yt(c,a,l,f,m,x){c=c||{},a=a||{};for(const b in c)Object.prototype.hasOwnProperty.call(c,b)&&(At(c[b],a[b])||l.push({command:x,args:[f,b,a[b],m]}));for(const b in a)Object.prototype.hasOwnProperty.call(a,b)&&!Object.prototype.hasOwnProperty.call(c,b)&&(At(c[b],a[b])||l.push({command:x,args:[f,b,a[b],m]}))}function nr(c){return c.id}function cn(c,a){return c[a.id]=a,c}class ot{constructor(a,l,f,m){this.message=(a?`${a}: `:"")+f,m&&(this.identifier=m),l!=null&&l.__line__&&(this.line=l.__line__)}}function Jn(c,...a){for(const l of a)for(const f in l)c[f]=l[f];return c}class Ur extends Error{constructor(a,l){super(l),this.message=l,this.key=a}}class Co{constructor(a,l=[]){this.parent=a,this.bindings={};for(const[f,m]of l)this.bindings[f]=m}concat(a){return new Co(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}const Qs={kind:"null"},mt={kind:"number"},Zt={kind:"string"},Wt={kind:"boolean"},$n={kind:"color"},rs={kind:"projectionDefinition"},Mo={kind:"object"},Gt={kind:"value"},Cu={kind:"collator"},Io={kind:"formatted"},Mu={kind:"padding"},ja={kind:"colorArray"},el={kind:"numberArray"},Jr={kind:"resolvedImage"},Iu={kind:"variableAnchorOffsetCollection"};function bi(c,a){return{kind:"array",itemType:c,N:a}}function Pr(c){if(c.kind==="array"){const a=Pr(c.itemType);return typeof c.N=="number"?`array<${a}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${a}>`}return c.kind}const Dg=[Qs,mt,Zt,Wt,$n,rs,Io,Mo,bi(Gt),Mu,el,ja,Jr,Iu];function uc(c,a){if(a.kind==="error")return null;if(c.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!uc(c.itemType,a.itemType))&&(typeof c.N!="number"||c.N===a.N))return null}else{if(c.kind===a.kind)return null;if(c.kind==="value"){for(const l of Dg)if(!uc(l,a))return null}}return`Expected ${Pr(c)} but found ${Pr(a)} instead.`}function df(c,a){return a.some(l=>l.kind===c.kind)}function jo(c,a){return a.some(l=>l==="null"?c===null:l==="array"?Array.isArray(c):l==="object"?c&&!Array.isArray(c)&&typeof c=="object":l===typeof c)}function Oo(c,a){return c.kind==="array"&&a.kind==="array"?c.itemType.kind===a.itemType.kind&&typeof c.N=="number":c.kind===a.kind}const ff=.96422,Rg=.82521,Ng=4/29,tl=6/29,$g=3*tl*tl,_x=tl*tl*tl,xx=Math.PI/180,bx=180/Math.PI;function pf(c){return(c%=360)<0&&(c+=360),c}function rl([c,a,l,f]){let m,x;const b=gf((.2225045*(c=mf(c))+.7168786*(a=mf(a))+.0606169*(l=mf(l)))/1);c===a&&a===l?m=x=b:(m=gf((.4360747*c+.3850649*a+.1430804*l)/ff),x=gf((.0139322*c+.0971045*a+.7141733*l)/Rg));const T=116*b-16;return[T<0?0:T,500*(m-b),200*(b-x),f]}function mf(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function gf(c){return c>_x?Math.pow(c,1/3):c/$g+Ng}function nl([c,a,l,f]){let m=(c+16)/116,x=isNaN(a)?m:m+a/500,b=isNaN(l)?m:m-l/200;return m=1*vf(m),x=ff*vf(x),b=Rg*vf(b),[yf(3.1338561*x-1.6168667*m-.4906146*b),yf(-.9787684*x+1.9161415*m+.033454*b),yf(.0719453*x-.2289914*m+1.4052427*b),f]}function yf(c){return(c=c<=.00304?12.92*c:1.055*Math.pow(c,1/2.4)-.055)<0?0:c>1?1:c}function vf(c){return c>tl?c*c*c:$g*(c-Ng)}const wx=Object.hasOwn||function(c,a){return Object.prototype.hasOwnProperty.call(c,a)};function il(c,a){return wx(c,a)?c[a]:void 0}function hc(c){return parseInt(c.padEnd(2,c),16)/255}function sa(c,a){return Kt(a?c/100:c,0,1)}function Kt(c,a,l){return Math.min(Math.max(a,c),l)}function ns(c){return!c.some(Number.isNaN)}const Do={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function eo(c,a,l){return c+l*(a-c)}function is(c,a,l){return c.map((f,m)=>eo(f,a[m],l))}class Xt{constructor(a,l,f,m=1,x=!0){this.r=a,this.g=l,this.b=f,this.a=m,x||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[a,l,f,m]))}static parse(a){if(a instanceof Xt)return a;if(typeof a!="string")return;const l=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=il(Do,f);if(m){const[b,T,A]=m;return[b/255,T/255,A/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const b=f.length<6?1:2;let T=1;return[hc(f.slice(T,T+=b)),hc(f.slice(T,T+=b)),hc(f.slice(T,T+=b)),hc(f.slice(T,T+b)||"ff")]}if(f.startsWith("rgb")){const b=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[T,A,O,D,B,K,Y,J,te,ae,ce,Pe]=b,ge=[D||" ",Y||" ",ae].join("");if(ge==="  "||ge==="  /"||ge===",,"||ge===",,,"){const ve=[O,K,te].join(""),Ne=ve==="%%%"?100:ve===""?255:0;if(Ne){const Fe=[Kt(+A/Ne,0,1),Kt(+B/Ne,0,1),Kt(+J/Ne,0,1),ce?sa(+ce,Pe):1];if(ns(Fe))return Fe}}return}}const x=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[b,T,A,O,D,B,K,Y,J]=x,te=[A||" ",D||" ",K].join("");if(te==="  "||te==="  /"||te===",,"||te===",,,"){const ae=[+T,Kt(+O,0,100),Kt(+B,0,100),Y?sa(+Y,J):1];if(ns(ae))return function([ce,Pe,ge,ve]){function Ne(Fe){const Qe=(Fe+ce/30)%12,ft=Pe*Math.min(ge,1-ge);return ge-ft*Math.max(-1,Math.min(Qe-3,9-Qe,1))}return ce=pf(ce),Pe/=100,ge/=100,[Ne(0),Ne(8),Ne(4),ve]}(ae)}}}(a);return l?new Xt(...l,!1):void 0}get rgb(){const{r:a,g:l,b:f,a:m}=this,x=m||1/0;return this.overwriteGetter("rgb",[a/x,l/x,f/x,m])}get hcl(){return this.overwriteGetter("hcl",function(a){const[l,f,m,x]=rl(a),b=Math.sqrt(f*f+m*m);return[Math.round(1e4*b)?pf(Math.atan2(m,f)*bx):NaN,b,l,x]}(this.rgb))}get lab(){return this.overwriteGetter("lab",rl(this.rgb))}overwriteGetter(a,l){return Object.defineProperty(this,a,{value:l}),l}toString(){const[a,l,f,m]=this.rgb;return`rgba(${[a,l,f].map(x=>Math.round(255*x)).join(",")},${m})`}static interpolate(a,l,f,m="rgb"){switch(m){case"rgb":{const[x,b,T,A]=is(a.rgb,l.rgb,f);return new Xt(x,b,T,A,!1)}case"hcl":{const[x,b,T,A]=a.hcl,[O,D,B,K]=l.hcl;let Y,J;if(isNaN(x)||isNaN(O))isNaN(x)?isNaN(O)?Y=NaN:(Y=O,T!==1&&T!==0||(J=D)):(Y=x,B!==1&&B!==0||(J=b));else{let ge=O-x;O>x&&ge>180?ge-=360:O<x&&x-O>180&&(ge+=360),Y=x+f*ge}const[te,ae,ce,Pe]=function([ge,ve,Ne,Fe]){return ge=isNaN(ge)?0:ge*xx,nl([Ne,Math.cos(ge)*ve,Math.sin(ge)*ve,Fe])}([Y,J??eo(b,D,f),eo(T,B,f),eo(A,K,f)]);return new Xt(te,ae,ce,Pe,!1)}case"lab":{const[x,b,T,A]=nl(is(a.lab,l.lab,f));return new Xt(x,b,T,A,!1)}}}}Xt.black=new Xt(0,0,0,1),Xt.white=new Xt(1,1,1,1),Xt.transparent=new Xt(0,0,0,0),Xt.red=new Xt(1,0,0,1);class as{constructor(a,l,f){this.sensitivity=a?l?"variant":"case":l?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,l){return this.collator.compare(a,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const ju=["bottom","center","top"];class Ou{constructor(a,l,f,m,x,b){this.text=a,this.image=l,this.scale=f,this.fontStack=m,this.textColor=x,this.verticalAlign=b}}class li{constructor(a){this.sections=a}static fromString(a){return new li([new Ou(a,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof li?a:li.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}}class Tn{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Tn)return a;if(typeof a=="number")return new Tn([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(const l of a)if(typeof l!="number")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]]}return new Tn(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,l,f){return new Tn(is(a.values,l.values,f))}}class ci{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof ci)return a;if(typeof a=="number")return new ci([a]);if(Array.isArray(a)){for(const l of a)if(typeof l!="number")return;return new ci(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,l,f){return new ci(is(a.values,l.values,f))}}class un{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof un)return a;if(typeof a=="string"){const f=Xt.parse(a);return f?new un([f]):void 0}if(!Array.isArray(a))return;const l=[];for(const f of a){if(typeof f!="string")return;const m=Xt.parse(f);if(!m)return;l.push(m)}return new un(l)}toString(){return JSON.stringify(this.values)}static interpolate(a,l,f,m="rgb"){const x=[];if(a.values.length!=l.values.length)throw new Error(`colorArray: Arrays have mismatched length (${a.values.length} vs. ${l.values.length}), cannot interpolate.`);for(let b=0;b<a.values.length;b++)x.push(Xt.interpolate(a.values[b],l.values[b],f,m));return new un(x)}}class Tr extends Error{constructor(a){super(a),this.name="RuntimeError"}toJSON(){return this.message}}const zg=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ui{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof ui)return a;if(Array.isArray(a)&&!(a.length<1)&&a.length%2==0){for(let l=0;l<a.length;l+=2){const f=a[l],m=a[l+1];if(typeof f!="string"||!zg.has(f)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new ui(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,l,f){const m=a.values,x=l.values;if(m.length!==x.length)throw new Tr(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${l.toString()}`);const b=[];for(let T=0;T<m.length;T+=2){if(m[T]!==x[T])throw new Tr(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${m[T]}, to[${T}]: ${x[T]}`);b.push(m[T]);const[A,O]=m[T+1],[D,B]=x[T+1];b.push([eo(A,D,f),eo(O,B,f)])}return new ui(b)}}class Di{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Di({name:a,available:!1}):null}}class Qn{constructor(a,l,f){this.from=a,this.to=l,this.transition=f}static interpolate(a,l,f){return new Qn(a,l,f)}static parse(a){return a instanceof Qn?a:Array.isArray(a)&&a.length===3&&typeof a[0]=="string"&&typeof a[1]=="string"&&typeof a[2]=="number"?new Qn(a[0],a[1],a[2]):typeof a=="object"&&typeof a.from=="string"&&typeof a.to=="string"&&typeof a.transition=="number"?new Qn(a.from,a.to,a.transition):typeof a=="string"?new Qn(a,a,1):void 0}}function jr(c,a,l,f){return typeof c=="number"&&c>=0&&c<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof l=="number"&&l>=0&&l<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[c,a,l,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[c,a,l,f]:[c,a,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function os(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Qn||c instanceof Xt||c instanceof as||c instanceof li||c instanceof Tn||c instanceof ci||c instanceof un||c instanceof ui||c instanceof Di)return!0;if(Array.isArray(c)){for(const a of c)if(!os(a))return!1;return!0}if(typeof c=="object"){for(const a in c)if(!os(c[a]))return!1;return!0}return!1}function jt(c){if(c===null)return Qs;if(typeof c=="string")return Zt;if(typeof c=="boolean")return Wt;if(typeof c=="number")return mt;if(c instanceof Xt)return $n;if(c instanceof Qn)return rs;if(c instanceof as)return Cu;if(c instanceof li)return Io;if(c instanceof Tn)return Mu;if(c instanceof ci)return el;if(c instanceof un)return ja;if(c instanceof ui)return Iu;if(c instanceof Di)return Jr;if(Array.isArray(c)){const a=c.length;let l;for(const f of c){const m=jt(f);if(l){if(l===m)continue;l=Gt;break}l=m}return bi(l||Gt,a)}return Mo}function Bt(c){const a=typeof c;return c===null?"":a==="string"||a==="number"||a==="boolean"?String(c):c instanceof Xt||c instanceof Qn||c instanceof li||c instanceof Tn||c instanceof ci||c instanceof un||c instanceof ui||c instanceof Di?c.toString():JSON.stringify(c)}class to{constructor(a,l){this.type=a,this.value=l}static parse(a,l){if(a.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!os(a[1]))return l.error("invalid value");const f=a[1];let m=jt(f);const x=l.expectedType;return m.kind!=="array"||m.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(m=x),new to(m,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ir={string:Zt,number:mt,boolean:Wt,object:Mo};class Ri{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");let f,m=1;const x=a[0];if(x==="array"){let T,A;if(a.length>2){const O=a[1];if(typeof O!="string"||!(O in ir)||O==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);T=ir[O],m++}else T=Gt;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return l.error('The length argument to "array" must be a positive integer literal',2);A=a[2],m++}f=bi(T,A)}else{if(!ir[x])throw new Error(`Types doesn't contain name = ${x}`);f=ir[x]}const b=[];for(;m<a.length;m++){const T=l.parse(a[m],m,Gt);if(!T)return null;b.push(T)}return new Ri(f,b)}evaluate(a){for(let l=0;l<this.args.length;l++){const f=this.args[l].evaluate(a);if(!uc(this.type,jt(f)))return f;if(l===this.args.length-1)throw new Tr(`Expected value to be of type ${Pr(this.type)}, but found ${Pr(jt(f))} instead.`)}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const Oa={"to-boolean":Wt,"to-color":$n,"to-number":mt,"to-string":Zt};class Da{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");const f=a[0];if(!Oa[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&a.length!==2)return l.error("Expected one argument.");const m=Oa[f],x=[];for(let b=1;b<a.length;b++){const T=l.parse(a[b],b,Gt);if(!T)return null;x.push(T)}return new Da(m,x)}evaluate(a){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(a);case"color":{let l,f;for(const m of this.args){if(l=m.evaluate(a),f=null,l instanceof Xt)return l;if(typeof l=="string"){const x=a.parseColor(l);if(x)return x}else if(Array.isArray(l)&&(f=l.length<3||l.length>4?`Invalid rgba value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:jr(l[0],l[1],l[2],l[3]),!f))return new Xt(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Tr(f||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"padding":{let l;for(const f of this.args){l=f.evaluate(a);const m=Tn.parse(l);if(m)return m}throw new Tr(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"numberArray":{let l;for(const f of this.args){l=f.evaluate(a);const m=ci.parse(l);if(m)return m}throw new Tr(`Could not parse numberArray from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"colorArray":{let l;for(const f of this.args){l=f.evaluate(a);const m=un.parse(l);if(m)return m}throw new Tr(`Could not parse colorArray from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"variableAnchorOffsetCollection":{let l;for(const f of this.args){l=f.evaluate(a);const m=ui.parse(l);if(m)return m}throw new Tr(`Could not parse variableAnchorOffsetCollection from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"number":{let l=null;for(const f of this.args){if(l=f.evaluate(a),l===null)return 0;const m=Number(l);if(!isNaN(m))return m}throw new Tr(`Could not convert ${JSON.stringify(l)} to number.`)}case"formatted":return li.fromString(Bt(this.args[0].evaluate(a)));case"resolvedImage":return Di.fromString(Bt(this.args[0].evaluate(a)));case"projectionDefinition":return this.args[0].evaluate(a);default:return Bt(this.args[0].evaluate(a))}}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const Du=["Unknown","Point","LineString","Polygon"];class _f{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Du[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let l=this._parseColorCache.get(a);return l||(l=Xt.parse(a),this._parseColorCache.set(a,l)),l}}class al{constructor(a,l,f=[],m,x=new Co,b=[]){this.registry=a,this.path=f,this.key=f.map(T=>`[${T}]`).join(""),this.scope=x,this.errors=b,this.expectedType=m,this._isConstant=l}parse(a,l,f,m,x={}){return l?this.concat(l,f,m)._parse(a,x):this._parse(a,x)}_parse(a,l){function f(m,x,b){return b==="assert"?new Ri(x,[m]):b==="coerce"?new Da(x,[m]):m}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=a[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[m];if(x){let b=x.parse(a,this);if(!b)return null;if(this.expectedType){const T=this.expectedType,A=b.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||A.kind!=="value"){if(T.kind==="projectionDefinition"&&["string","array"].includes(A.kind)||["color","formatted","resolvedImage"].includes(T.kind)&&["value","string"].includes(A.kind)||["padding","numberArray"].includes(T.kind)&&["value","number","array"].includes(A.kind)||T.kind==="colorArray"&&["value","string","array"].includes(A.kind)||T.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(A.kind))b=f(b,T,l.typeAnnotation||"coerce");else if(this.checkSubtype(T,A))return null}else b=f(b,T,l.typeAnnotation||"assert")}if(!(b instanceof to)&&b.type.kind!=="resolvedImage"&&this._isConstant(b)){const T=new _f;try{b=new to(b.type,b.evaluate(T))}catch(A){return this.error(A.message),null}}return b}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,l,f){const m=typeof a=="number"?this.path.concat(a):this.path,x=f?this.scope.concat(f):this.scope;return new al(this.registry,this._isConstant,m,l||null,x,this.errors)}error(a,...l){const f=`${this.key}${l.map(m=>`[${m}]`).join("")}`;this.errors.push(new Ur(f,a))}checkSubtype(a,l){const f=uc(a,l);return f&&this.error(f),f}}class dc{constructor(a,l){this.type=l.type,this.bindings=[].concat(a),this.result=l}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const l of this.bindings)a(l[1]);a(this.result)}static parse(a,l){if(a.length<4)return l.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const f=[];for(let x=1;x<a.length-1;x+=2){const b=a[x];if(typeof b!="string")return l.error(`Expected string, but found ${typeof b} instead.`,x);if(/[^a-zA-Z0-9_]/.test(b))return l.error("Variable names must contain only alphanumeric characters or '_'.",x);const T=l.parse(a[x+1],x+1);if(!T)return null;f.push([b,T])}const m=l.parse(a[a.length-1],a.length-1,l.expectedType,f);return m?new dc(f,m):null}outputDefined(){return this.result.outputDefined()}}class Ru{constructor(a,l){this.type=l.type,this.name=a,this.boundExpression=l}static parse(a,l){if(a.length!==2||typeof a[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const f=a[1];return l.scope.has(f)?new Ru(f,l.scope.get(f)):l.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class Nu{constructor(a,l,f){this.type=a,this.index=l,this.input=f}static parse(a,l){if(a.length!==3)return l.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=l.parse(a[1],1,mt),m=l.parse(a[2],2,bi(l.expectedType||Gt));return f&&m?new Nu(m.type.itemType,f,m):null}evaluate(a){const l=this.index.evaluate(a),f=this.input.evaluate(a);if(l<0)throw new Tr(`Array index out of bounds: ${l} < 0.`);if(l>=f.length)throw new Tr(`Array index out of bounds: ${l} > ${f.length-1}.`);if(l!==Math.floor(l))throw new Tr(`Array index must be an integer, but found ${l} instead.`);return f[l]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class $u{constructor(a,l){this.type=Wt,this.needle=a,this.haystack=l}static parse(a,l){if(a.length!==3)return l.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=l.parse(a[1],1,Gt),m=l.parse(a[2],2,Gt);return f&&m?df(f.type,[Wt,Zt,mt,Qs,Gt])?new $u(f,m):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pr(f.type)} instead`):null}evaluate(a){const l=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!f)return!1;if(!jo(l,["boolean","string","number","null"]))throw new Tr(`Expected first argument to be of type boolean, string, number or null, but found ${Pr(jt(l))} instead.`);if(!jo(f,["string","array"]))throw new Tr(`Expected second argument to be of type array or string, but found ${Pr(jt(f))} instead.`);return f.indexOf(l)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class la{constructor(a,l,f){this.type=mt,this.needle=a,this.haystack=l,this.fromIndex=f}static parse(a,l){if(a.length<=2||a.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=l.parse(a[1],1,Gt),m=l.parse(a[2],2,Gt);if(!f||!m)return null;if(!df(f.type,[Wt,Zt,mt,Qs,Gt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pr(f.type)} instead`);if(a.length===4){const x=l.parse(a[3],3,mt);return x?new la(f,m,x):null}return new la(f,m)}evaluate(a){const l=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!jo(l,["boolean","string","number","null"]))throw new Tr(`Expected first argument to be of type boolean, string, number or null, but found ${Pr(jt(l))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(a)),jo(f,["string"])){const x=f.indexOf(l,m);return x===-1?-1:[...f.slice(0,x)].length}if(jo(f,["array"]))return f.indexOf(l,m);throw new Tr(`Expected second argument to be of type array or string, but found ${Pr(jt(f))} instead.`)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class kn{constructor(a,l,f,m,x,b){this.inputType=a,this.type=l,this.input=f,this.cases=m,this.outputs=x,this.otherwise=b}static parse(a,l){if(a.length<5)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return l.error("Expected an even number of arguments.");let f,m;l.expectedType&&l.expectedType.kind!=="value"&&(m=l.expectedType);const x={},b=[];for(let O=2;O<a.length-1;O+=2){let D=a[O];const B=a[O+1];Array.isArray(D)||(D=[D]);const K=l.concat(O);if(D.length===0)return K.error("Expected at least one branch label.");for(const J of D){if(typeof J!="number"&&typeof J!="string")return K.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return K.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return K.error("Numeric branch labels must be integer values.");if(f){if(K.checkSubtype(f,jt(J)))return null}else f=jt(J);if(x[String(J)]!==void 0)return K.error("Branch labels must be unique.");x[String(J)]=b.length}const Y=l.parse(B,O,m);if(!Y)return null;m=m||Y.type,b.push(Y)}const T=l.parse(a[1],1,Gt);if(!T)return null;const A=l.parse(a[a.length-1],a.length-1,m);return A?T.type.kind!=="value"&&l.concat(1).checkSubtype(f,T.type)?null:new kn(f,m,T,x,b,A):null}evaluate(a){const l=this.input.evaluate(a);return(jt(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}}class ol{constructor(a,l,f){this.type=a,this.branches=l,this.otherwise=f}static parse(a,l){if(a.length<4)return l.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return l.error("Expected an odd number of arguments.");let f;l.expectedType&&l.expectedType.kind!=="value"&&(f=l.expectedType);const m=[];for(let b=1;b<a.length-1;b+=2){const T=l.parse(a[b],b,Wt);if(!T)return null;const A=l.parse(a[b+1],b+1,f);if(!A)return null;m.push([T,A]),f=f||A.type}const x=l.parse(a[a.length-1],a.length-1,f);if(!x)return null;if(!f)throw new Error("Can't infer output type");return new ol(f,m,x)}evaluate(a){for(const[l,f]of this.branches)if(l.evaluate(a))return f.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[l,f]of this.branches)a(l),a(f);a(this.otherwise)}outputDefined(){return this.branches.every(([a,l])=>l.outputDefined())&&this.otherwise.outputDefined()}}class fc{constructor(a,l,f,m){this.type=a,this.input=l,this.beginIndex=f,this.endIndex=m}static parse(a,l){if(a.length<=2||a.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=l.parse(a[1],1,Gt),m=l.parse(a[2],2,mt);if(!f||!m)return null;if(!df(f.type,[bi(Gt),Zt,Gt]))return l.error(`Expected first argument to be of type array or string, but found ${Pr(f.type)} instead`);if(a.length===4){const x=l.parse(a[3],3,mt);return x?new fc(f.type,f,m,x):null}return new fc(f.type,f,m)}evaluate(a){const l=this.input.evaluate(a),f=this.beginIndex.evaluate(a);let m;if(this.endIndex&&(m=this.endIndex.evaluate(a)),jo(l,["string"]))return[...l].slice(f,m).join("");if(jo(l,["array"]))return l.slice(f,m);throw new Tr(`Expected first argument to be of type array or string, but found ${Pr(jt(l))} instead.`)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function ss(c,a){const l=c.length-1;let f,m,x=0,b=l,T=0;for(;x<=b;)if(T=Math.floor((x+b)/2),f=c[T],m=c[T+1],f<=a){if(T===l||a<m)return T;x=T+1}else{if(!(f>a))throw new Tr("Input is not a number.");b=T-1}return 0}class Qr{constructor(a,l,f){this.type=a,this.input=l,this.labels=[],this.outputs=[];for(const[m,x]of f)this.labels.push(m),this.outputs.push(x)}static parse(a,l){if(a.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return l.error("Expected an even number of arguments.");const f=l.parse(a[1],1,mt);if(!f)return null;const m=[];let x=null;l.expectedType&&l.expectedType.kind!=="value"&&(x=l.expectedType);for(let b=1;b<a.length;b+=2){const T=b===1?-1/0:a[b],A=a[b+1],O=b,D=b+1;if(typeof T!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(m.length&&m[m.length-1][0]>=T)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const B=l.parse(A,D,x);if(!B)return null;x=x||B.type,m.push([T,B])}return new Qr(x,f,m)}evaluate(a){const l=this.labels,f=this.outputs;if(l.length===1)return f[0].evaluate(a);const m=this.input.evaluate(a);if(m<=l[0])return f[0].evaluate(a);const x=l.length;return m>=l[x-1]?f[x-1].evaluate(a):f[ss(l,m)].evaluate(a)}eachChild(a){a(this.input);for(const l of this.outputs)a(l)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function Lg(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var pc,xf,Sx=function(){if(xf)return pc;function c(a,l,f,m){this.cx=3*a,this.bx=3*(f-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(m-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=l,this.p2x=f,this.p2y=m}return xf=1,pc=c,c.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,l){if(l===void 0&&(l=1e-6),a<0)return 0;if(a>1)return 1;for(var f=a,m=0;m<8;m++){var x=this.sampleCurveX(f)-a;if(Math.abs(x)<l)return f;var b=this.sampleCurveDerivativeX(f);if(Math.abs(b)<1e-6)break;f-=x/b}var T=0,A=1;for(f=a,m=0;m<20&&(x=this.sampleCurveX(f),!(Math.abs(x-a)<l));m++)a>x?T=f:A=f,f=.5*(A-T)+T;return f},solve:function(a,l){return this.sampleCurveY(this.solveCurveX(a,l))}},pc}(),sl=Lg(Sx);class zn{constructor(a,l,f,m,x){this.type=a,this.operator=l,this.interpolation=f,this.input=m,this.labels=[],this.outputs=[];for(const[b,T]of x)this.labels.push(b),this.outputs.push(T)}static interpolationFactor(a,l,f,m){let x=0;if(a.name==="exponential")x=mc(l,a.base,f,m);else if(a.name==="linear")x=mc(l,1,f,m);else if(a.name==="cubic-bezier"){const b=a.controlPoints;x=new sl(b[0],b[1],b[2],b[3]).solve(mc(l,1,f,m))}return x}static parse(a,l){let[f,m,x,...b]=a;if(!Array.isArray(m)||m.length===0)return l.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const O=m[1];if(typeof O!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:O}}else{if(m[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const O=m.slice(1);if(O.length!==4||O.some(D=>typeof D!="number"||D<0||D>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:O}}}if(a.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(x=l.parse(x,2,mt),!x)return null;const T=[];let A=null;f!=="interpolate-hcl"&&f!=="interpolate-lab"||l.expectedType==ja?l.expectedType&&l.expectedType.kind!=="value"&&(A=l.expectedType):A=$n;for(let O=0;O<b.length;O+=2){const D=b[O],B=b[O+1],K=O+3,Y=O+4;if(typeof D!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',K);if(T.length&&T[T.length-1][0]>=D)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',K);const J=l.parse(B,Y,A);if(!J)return null;A=A||J.type,T.push([D,J])}return Oo(A,mt)||Oo(A,rs)||Oo(A,$n)||Oo(A,Mu)||Oo(A,el)||Oo(A,ja)||Oo(A,Iu)||Oo(A,bi(mt))?new zn(A,f,m,x,T):l.error(`Type ${Pr(A)} is not interpolatable.`)}evaluate(a){const l=this.labels,f=this.outputs;if(l.length===1)return f[0].evaluate(a);const m=this.input.evaluate(a);if(m<=l[0])return f[0].evaluate(a);const x=l.length;if(m>=l[x-1])return f[x-1].evaluate(a);const b=ss(l,m),T=zn.interpolationFactor(this.interpolation,m,l[b],l[b+1]),A=f[b].evaluate(a),O=f[b+1].evaluate(a);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return eo(A,O,T);case"color":return Xt.interpolate(A,O,T);case"padding":return Tn.interpolate(A,O,T);case"colorArray":return un.interpolate(A,O,T);case"numberArray":return ci.interpolate(A,O,T);case"variableAnchorOffsetCollection":return ui.interpolate(A,O,T);case"array":return is(A,O,T);case"projectionDefinition":return Qn.interpolate(A,O,T)}case"interpolate-hcl":switch(this.type.kind){case"color":return Xt.interpolate(A,O,T,"hcl");case"colorArray":return un.interpolate(A,O,T,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Xt.interpolate(A,O,T,"lab");case"colorArray":return un.interpolate(A,O,T,"lab")}}}eachChild(a){a(this.input);for(const l of this.outputs)a(l)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function mc(c,a,l,f){const m=f-l,x=c-l;return m===0?0:a===1?x/m:(Math.pow(a,x)-1)/(Math.pow(a,m)-1)}const Ra={color:Xt.interpolate,number:eo,padding:Tn.interpolate,numberArray:ci.interpolate,colorArray:un.interpolate,variableAnchorOffsetCollection:ui.interpolate,array:is};class gc{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");let f=null;const m=l.expectedType;m&&m.kind!=="value"&&(f=m);const x=[];for(const T of a.slice(1)){const A=l.parse(T,1+x.length,f,void 0,{typeAnnotation:"omit"});if(!A)return null;f=f||A.type,x.push(A)}if(!f)throw new Error("No output type");const b=m&&x.some(T=>uc(m,T.type));return new gc(b?Gt:f,x)}evaluate(a){let l,f=null,m=0;for(const x of this.args)if(m++,f=x.evaluate(a),f&&f instanceof Di&&!f.available&&(l||(l=f.name),f=null,m===this.args.length&&(f=l)),f!==null)break;return f}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}function yc(c,a){return c==="=="||c==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function vc(c,a,l,f){return f.compare(a,l)===0}function ei(c,a,l){const f=c!=="=="&&c!=="!=";return class lR{constructor(x,b,T){this.type=Wt,this.lhs=x,this.rhs=b,this.collator=T,this.hasUntypedArgument=x.type.kind==="value"||b.type.kind==="value"}static parse(x,b){if(x.length!==3&&x.length!==4)return b.error("Expected two or three arguments.");const T=x[0];let A=b.parse(x[1],1,Gt);if(!A)return null;if(!yc(T,A.type))return b.concat(1).error(`"${T}" comparisons are not supported for type '${Pr(A.type)}'.`);let O=b.parse(x[2],2,Gt);if(!O)return null;if(!yc(T,O.type))return b.concat(2).error(`"${T}" comparisons are not supported for type '${Pr(O.type)}'.`);if(A.type.kind!==O.type.kind&&A.type.kind!=="value"&&O.type.kind!=="value")return b.error(`Cannot compare types '${Pr(A.type)}' and '${Pr(O.type)}'.`);f&&(A.type.kind==="value"&&O.type.kind!=="value"?A=new Ri(O.type,[A]):A.type.kind!=="value"&&O.type.kind==="value"&&(O=new Ri(A.type,[O])));let D=null;if(x.length===4){if(A.type.kind!=="string"&&O.type.kind!=="string"&&A.type.kind!=="value"&&O.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(D=b.parse(x[3],3,Cu),!D)return null}return new lR(A,O,D)}evaluate(x){const b=this.lhs.evaluate(x),T=this.rhs.evaluate(x);if(f&&this.hasUntypedArgument){const A=jt(b),O=jt(T);if(A.kind!==O.kind||A.kind!=="string"&&A.kind!=="number")throw new Tr(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${A.kind}, ${O.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const A=jt(b),O=jt(T);if(A.kind!=="string"||O.kind!=="string")return a(x,b,T)}return this.collator?l(x,b,T,this.collator.evaluate(x)):a(x,b,T)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const Bg=ei("==",function(c,a,l){return a===l},vc),zu=ei("!=",function(c,a,l){return a!==l},function(c,a,l,f){return!vc(0,a,l,f)}),Px=ei("<",function(c,a,l){return a<l},function(c,a,l,f){return f.compare(a,l)<0}),bf=ei(">",function(c,a,l){return a>l},function(c,a,l,f){return f.compare(a,l)>0}),Tx=ei("<=",function(c,a,l){return a<=l},function(c,a,l,f){return f.compare(a,l)<=0}),kx=ei(">=",function(c,a,l){return a>=l},function(c,a,l,f){return f.compare(a,l)>=0});class Lu{constructor(a,l,f){this.type=Cu,this.locale=f,this.caseSensitive=a,this.diacriticSensitive=l}static parse(a,l){if(a.length!==2)return l.error("Expected one argument.");const f=a[1];if(typeof f!="object"||Array.isArray(f))return l.error("Collator options argument must be an object.");const m=l.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,Wt);if(!m)return null;const x=l.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,Wt);if(!x)return null;let b=null;return f.locale&&(b=l.parse(f.locale,1,Zt),!b)?null:new Lu(m,x,b)}evaluate(a){return new as(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}class wf{constructor(a,l,f,m,x){this.type=Zt,this.number=a,this.locale=l,this.currency=f,this.minFractionDigits=m,this.maxFractionDigits=x}static parse(a,l){if(a.length!==3)return l.error("Expected two arguments.");const f=l.parse(a[1],1,mt);if(!f)return null;const m=a[2];if(typeof m!="object"||Array.isArray(m))return l.error("NumberFormat options argument must be an object.");let x=null;if(m.locale&&(x=l.parse(m.locale,1,Zt),!x))return null;let b=null;if(m.currency&&(b=l.parse(m.currency,1,Zt),!b))return null;let T=null;if(m["min-fraction-digits"]&&(T=l.parse(m["min-fraction-digits"],1,mt),!T))return null;let A=null;return m["max-fraction-digits"]&&(A=l.parse(m["max-fraction-digits"],1,mt),!A)?null:new wf(f,x,b,T,A)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class ls{constructor(a){this.type=Io,this.sections=a}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");const f=a[1];if(!Array.isArray(f)&&typeof f=="object")return l.error("First argument must be an image or text section.");const m=[];let x=!1;for(let b=1;b<=a.length-1;++b){const T=a[b];if(x&&typeof T=="object"&&!Array.isArray(T)){x=!1;let A=null;if(T["font-scale"]&&(A=l.parse(T["font-scale"],1,mt),!A))return null;let O=null;if(T["text-font"]&&(O=l.parse(T["text-font"],1,bi(Zt)),!O))return null;let D=null;if(T["text-color"]&&(D=l.parse(T["text-color"],1,$n),!D))return null;let B=null;if(T["vertical-align"]){if(typeof T["vertical-align"]=="string"&&!ju.includes(T["vertical-align"]))return l.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${T["vertical-align"]}' instead.`);if(B=l.parse(T["vertical-align"],1,Zt),!B)return null}const K=m[m.length-1];K.scale=A,K.font=O,K.textColor=D,K.verticalAlign=B}else{const A=l.parse(a[b],1,Gt);if(!A)return null;const O=A.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,m.push({content:A,scale:null,font:null,textColor:null,verticalAlign:null})}}return new ls(m)}evaluate(a){return new li(this.sections.map(l=>{const f=l.content.evaluate(a);return jt(f)===Jr?new Ou("",f,null,null,null,l.verticalAlign?l.verticalAlign.evaluate(a):null):new Ou(Bt(f),null,l.scale?l.scale.evaluate(a):null,l.font?l.font.evaluate(a).join(","):null,l.textColor?l.textColor.evaluate(a):null,l.verticalAlign?l.verticalAlign.evaluate(a):null)}))}eachChild(a){for(const l of this.sections)a(l.content),l.scale&&a(l.scale),l.font&&a(l.font),l.textColor&&a(l.textColor),l.verticalAlign&&a(l.verticalAlign)}outputDefined(){return!1}}class Sf{constructor(a){this.type=Jr,this.input=a}static parse(a,l){if(a.length!==2)return l.error("Expected two arguments.");const f=l.parse(a[1],1,Zt);return f?new Sf(f):l.error("No image name provided.")}evaluate(a){const l=this.input.evaluate(a),f=Di.fromString(l);return f&&a.availableImages&&(f.available=a.availableImages.indexOf(l)>-1),f}eachChild(a){a(this.input)}outputDefined(){return!1}}class Bu{constructor(a){this.type=mt,this.input=a}static parse(a,l){if(a.length!==2)return l.error(`Expected 1 argument, but found ${a.length-1} instead.`);const f=l.parse(a[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${Pr(f.type)} instead.`):new Bu(f):null}evaluate(a){const l=this.input.evaluate(a);if(typeof l=="string")return[...l].length;if(Array.isArray(l))return l.length;throw new Tr(`Expected value to be of type string or array, but found ${Pr(jt(l))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}const ca=8192;function Ex(c,a){const l=(180+c[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,m=Math.pow(2,a.z);return[Math.round(l*m*ca),Math.round(f*m*ca)]}function Fu(c,a){const l=Math.pow(2,a.z);return[(m=(c[0]/ca+a.x)/l,360*m-180),(f=(c[1]/ca+a.y)/l,360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90)];var f,m}function _c(c,a){c[0]=Math.min(c[0],a[0]),c[1]=Math.min(c[1],a[1]),c[2]=Math.max(c[2],a[0]),c[3]=Math.max(c[3],a[1])}function xc(c,a){return!(c[0]<=a[0]||c[2]>=a[2]||c[1]<=a[1]||c[3]>=a[3])}function Ax(c,a,l){const f=c[0]-a[0],m=c[1]-a[1],x=c[0]-l[0],b=c[1]-l[1];return f*b-x*m==0&&f*x<=0&&m*b<=0}function Uu(c,a,l,f){return(m=[f[0]-l[0],f[1]-l[1]])[0]*(x=[a[0]-c[0],a[1]-c[1]])[1]-m[1]*x[0]!=0&&!(!Ug(c,a,l,f)||!Ug(l,f,c,a));var m,x}function Cx(c,a,l){for(const f of l)for(let m=0;m<f.length-1;++m)if(Uu(c,a,f[m],f[m+1]))return!0;return!1}function cs(c,a,l=!1){let f=!1;for(const T of a)for(let A=0;A<T.length-1;A++){if(Ax(c,T[A],T[A+1]))return l;(x=T[A])[1]>(m=c)[1]!=(b=T[A+1])[1]>m[1]&&m[0]<(b[0]-x[0])*(m[1]-x[1])/(b[1]-x[1])+x[0]&&(f=!f)}var m,x,b;return f}function Fg(c,a){for(const l of a)if(cs(c,l))return!0;return!1}function Pf(c,a){for(const l of c)if(!cs(l,a))return!1;for(let l=0;l<c.length-1;++l)if(Cx(c[l],c[l+1],a))return!1;return!0}function Mx(c,a){for(const l of a)if(Pf(c,l))return!0;return!1}function Ug(c,a,l,f){const m=f[0]-l[0],x=f[1]-l[1],b=(c[0]-l[0])*x-m*(c[1]-l[1]),T=(a[0]-l[0])*x-m*(a[1]-l[1]);return b>0&&T<0||b<0&&T>0}function Tf(c,a,l){const f=[];for(let m=0;m<c.length;m++){const x=[];for(let b=0;b<c[m].length;b++){const T=Ex(c[m][b],l);_c(a,T),x.push(T)}f.push(x)}return f}function Vg(c,a,l){const f=[];for(let m=0;m<c.length;m++){const x=Tf(c[m],a,l);f.push(x)}return f}function Vu(c,a,l,f){if(c[0]<l[0]||c[0]>l[2]){const m=.5*f;let x=c[0]-l[0]>m?-f:l[0]-c[0]>m?f:0;x===0&&(x=c[0]-l[2]>m?-f:l[2]-c[0]>m?f:0),c[0]+=x}_c(a,c)}function Gg(c,a,l,f){const m=Math.pow(2,f.z)*ca,x=[f.x*ca,f.y*ca],b=[];for(const T of c)for(const A of T){const O=[A.x+x[0],A.y+x[1]];Vu(O,a,l,m),b.push(O)}return b}function qg(c,a,l,f){const m=Math.pow(2,f.z)*ca,x=[f.x*ca,f.y*ca],b=[];for(const A of c){const O=[];for(const D of A){const B=[D.x+x[0],D.y+x[1]];_c(a,B),O.push(B)}b.push(O)}if(a[2]-a[0]<=m/2){(T=a)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const A of b)for(const O of A)Vu(O,a,l,m)}var T;return b}class us{constructor(a,l){this.type=Wt,this.geojson=a,this.geometries=l}static parse(a,l){if(a.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(os(a[1])){const f=a[1];if(f.type==="FeatureCollection"){const m=[];for(const x of f.features){const{type:b,coordinates:T}=x.geometry;b==="Polygon"&&m.push(T),b==="MultiPolygon"&&m.push(...T)}if(m.length)return new us(f,{type:"MultiPolygon",coordinates:m})}else if(f.type==="Feature"){const m=f.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new us(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new us(f,f)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(l,f){const m=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if(f.type==="Polygon"){const T=Tf(f.coordinates,x,b),A=Gg(l.geometry(),m,x,b);if(!xc(m,x))return!1;for(const O of A)if(!cs(O,T))return!1}if(f.type==="MultiPolygon"){const T=Vg(f.coordinates,x,b),A=Gg(l.geometry(),m,x,b);if(!xc(m,x))return!1;for(const O of A)if(!Fg(O,T))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(l,f){const m=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if(f.type==="Polygon"){const T=Tf(f.coordinates,x,b),A=qg(l.geometry(),m,x,b);if(!xc(m,x))return!1;for(const O of A)if(!Pf(O,T))return!1}if(f.type==="MultiPolygon"){const T=Vg(f.coordinates,x,b),A=qg(l.geometry(),m,x,b);if(!xc(m,x))return!1;for(const O of A)if(!Mx(O,T))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let kf=class{constructor(c=[],a=(l,f)=>l<f?-1:l>f?1:0){if(this.data=c,this.length=this.data.length,this.compare=a,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:a,compare:l}=this,f=a[c];for(;c>0;){const m=c-1>>1,x=a[m];if(l(f,x)>=0)break;a[c]=x,c=m}a[c]=f}_down(c){const{data:a,compare:l}=this,f=this.length>>1,m=a[c];for(;c<f;){let x=1+(c<<1);const b=x+1;if(b<this.length&&l(a[b],a[x])<0&&(x=b),l(a[x],m)>=0)break;a[c]=a[x],c=x}a[c]=m}};function Ef(c,a,l=0,f=c.length-1,m=Ix){for(;f>l;){if(f-l>600){const A=f-l+1,O=a-l+1,D=Math.log(A),B=.5*Math.exp(2*D/3),K=.5*Math.sqrt(D*B*(A-B)/A)*(O-A/2<0?-1:1);Ef(c,a,Math.max(l,Math.floor(a-O*B/A+K)),Math.min(f,Math.floor(a+(A-O)*B/A+K)),m)}const x=c[a];let b=l,T=f;for(bc(c,l,a),m(c[f],x)>0&&bc(c,l,f);b<T;){for(bc(c,b,T),b++,T--;m(c[b],x)<0;)b++;for(;m(c[T],x)>0;)T--}m(c[l],x)===0?bc(c,l,T):(T++,bc(c,T,f)),T<=a&&(l=T+1),a<=T&&(f=T-1)}}function bc(c,a,l){const f=c[a];c[a]=c[l],c[l]=f}function Ix(c,a){return c<a?-1:c>a?1:0}function wc(c,a){if(c.length<=1)return[c];const l=[];let f,m;for(const x of c){const b=jx(x);b!==0&&(x.area=Math.abs(b),m===void 0&&(m=b<0),m===b<0?(f&&l.push(f),f=[x]):f.push(x))}if(f&&l.push(f),a>1)for(let x=0;x<l.length;x++)l[x].length<=a||(Ef(l[x],a,1,l[x].length-1,Wg),l[x]=l[x].slice(0,a));return l}function Wg(c,a){return a.area-c.area}function jx(c){let a=0;for(let l,f,m=0,x=c.length,b=x-1;m<x;b=m++)l=c[m],f=c[b],a+=(f.x-l.x)*(l.y+f.y);return a}const Hg=1/298.257223563,Zg=Hg*(2-Hg),Af=Math.PI/180;class Cf{constructor(a){const l=6378.137*Af*1e3,f=Math.cos(a*Af),m=1/(1-Zg*(1-f*f)),x=Math.sqrt(m);this.kx=l*x*f,this.ky=l*x*m*(1-Zg)}distance(a,l){const f=this.wrap(a[0]-l[0])*this.kx,m=(a[1]-l[1])*this.ky;return Math.sqrt(f*f+m*m)}pointOnLine(a,l){let f,m,x,b,T=1/0;for(let A=0;A<a.length-1;A++){let O=a[A][0],D=a[A][1],B=this.wrap(a[A+1][0]-O)*this.kx,K=(a[A+1][1]-D)*this.ky,Y=0;B===0&&K===0||(Y=(this.wrap(l[0]-O)*this.kx*B+(l[1]-D)*this.ky*K)/(B*B+K*K),Y>1?(O=a[A+1][0],D=a[A+1][1]):Y>0&&(O+=B/this.kx*Y,D+=K/this.ky*Y)),B=this.wrap(l[0]-O)*this.kx,K=(l[1]-D)*this.ky;const J=B*B+K*K;J<T&&(T=J,f=O,m=D,x=A,b=Y)}return{point:[f,m],index:x,t:Math.max(0,Math.min(1,b))}}wrap(a){for(;a<-180;)a+=360;for(;a>180;)a-=360;return a}}function Kg(c,a){return a[0]-c[0]}function Gu(c){return c[1]-c[0]+1}function ro(c,a){return c[1]>=c[0]&&c[1]<a}function ur(c,a){if(c[0]>c[1])return[null,null];const l=Gu(c);if(a){if(l===2)return[c,null];const m=Math.floor(l/2);return[[c[0],c[0]+m],[c[0]+m,c[1]]]}if(l===1)return[c,null];const f=Math.floor(l/2)-1;return[[c[0],c[0]+f],[c[0]+f+1,c[1]]]}function Mf(c,a){if(!ro(a,c.length))return[1/0,1/0,-1/0,-1/0];const l=[1/0,1/0,-1/0,-1/0];for(let f=a[0];f<=a[1];++f)_c(l,c[f]);return l}function If(c){const a=[1/0,1/0,-1/0,-1/0];for(const l of c)for(const f of l)_c(a,f);return a}function Xg(c){return c[0]!==-1/0&&c[1]!==-1/0&&c[2]!==1/0&&c[3]!==1/0}function jf(c,a,l){if(!Xg(c)||!Xg(a))return NaN;let f=0,m=0;return c[2]<a[0]&&(f=a[0]-c[2]),c[0]>a[2]&&(f=c[0]-a[2]),c[1]>a[3]&&(m=c[1]-a[3]),c[3]<a[1]&&(m=a[1]-c[3]),l.distance([0,0],[f,m])}function hs(c,a,l){const f=l.pointOnLine(a,c);return l.distance(c,f.point)}function Of(c,a,l,f,m){const x=Math.min(hs(c,[l,f],m),hs(a,[l,f],m)),b=Math.min(hs(l,[c,a],m),hs(f,[c,a],m));return Math.min(x,b)}function Ox(c,a,l,f,m){if(!ro(a,c.length)||!ro(f,l.length))return 1/0;let x=1/0;for(let b=a[0];b<a[1];++b){const T=c[b],A=c[b+1];for(let O=f[0];O<f[1];++O){const D=l[O],B=l[O+1];if(Uu(T,A,D,B))return 0;x=Math.min(x,Of(T,A,D,B,m))}}return x}function Dx(c,a,l,f,m){if(!ro(a,c.length)||!ro(f,l.length))return NaN;let x=1/0;for(let b=a[0];b<=a[1];++b)for(let T=f[0];T<=f[1];++T)if(x=Math.min(x,m.distance(c[b],l[T])),x===0)return x;return x}function Rx(c,a,l){if(cs(c,a,!0))return 0;let f=1/0;for(const m of a){const x=m[0],b=m[m.length-1];if(x!==b&&(f=Math.min(f,hs(c,[b,x],l)),f===0))return f;const T=l.pointOnLine(m,c);if(f=Math.min(f,l.distance(c,T.point)),f===0)return f}return f}function Nx(c,a,l,f){if(!ro(a,c.length))return NaN;for(let x=a[0];x<=a[1];++x)if(cs(c[x],l,!0))return 0;let m=1/0;for(let x=a[0];x<a[1];++x){const b=c[x],T=c[x+1];for(const A of l)for(let O=0,D=A.length,B=D-1;O<D;B=O++){const K=A[B],Y=A[O];if(Uu(b,T,K,Y))return 0;m=Math.min(m,Of(b,T,K,Y,f))}}return m}function Yg(c,a){for(const l of c)for(const f of l)if(cs(f,a,!0))return!0;return!1}function $x(c,a,l,f=1/0){const m=If(c),x=If(a);if(f!==1/0&&jf(m,x,l)>=f)return f;if(xc(m,x)){if(Yg(c,a))return 0}else if(Yg(a,c))return 0;let b=1/0;for(const T of c)for(let A=0,O=T.length,D=O-1;A<O;D=A++){const B=T[D],K=T[A];for(const Y of a)for(let J=0,te=Y.length,ae=te-1;J<te;ae=J++){const ce=Y[ae],Pe=Y[J];if(Uu(B,K,ce,Pe))return 0;b=Math.min(b,Of(B,K,ce,Pe,l))}}return b}function Jg(c,a,l,f,m,x){if(!x)return;const b=jf(Mf(f,x),m,l);b<a&&c.push([b,x,[0,0]])}function qu(c,a,l,f,m,x,b){if(!x||!b)return;const T=jf(Mf(f,x),Mf(m,b),l);T<a&&c.push([T,x,b])}function Wu(c,a,l,f,m=1/0){let x=Math.min(f.distance(c[0],l[0][0]),m);if(x===0)return x;const b=new kf([[0,[0,c.length-1],[0,0]]],Kg),T=If(l);for(;b.length>0;){const A=b.pop();if(A[0]>=x)continue;const O=A[1],D=a?50:100;if(Gu(O)<=D){if(!ro(O,c.length))return NaN;if(a){const B=Nx(c,O,l,f);if(isNaN(B)||B===0)return B;x=Math.min(x,B)}else for(let B=O[0];B<=O[1];++B){const K=Rx(c[B],l,f);if(x=Math.min(x,K),x===0)return 0}}else{const B=ur(O,a);Jg(b,x,f,c,T,B[0]),Jg(b,x,f,c,T,B[1])}}return x}function Hu(c,a,l,f,m,x=1/0){let b=Math.min(x,m.distance(c[0],l[0]));if(b===0)return b;const T=new kf([[0,[0,c.length-1],[0,l.length-1]]],Kg);for(;T.length>0;){const A=T.pop();if(A[0]>=b)continue;const O=A[1],D=A[2],B=a?50:100,K=f?50:100;if(Gu(O)<=B&&Gu(D)<=K){if(!ro(O,c.length)&&ro(D,l.length))return NaN;let Y;if(a&&f)Y=Ox(c,O,l,D,m),b=Math.min(b,Y);else if(a&&!f){const J=c.slice(O[0],O[1]+1);for(let te=D[0];te<=D[1];++te)if(Y=hs(l[te],J,m),b=Math.min(b,Y),b===0)return b}else if(!a&&f){const J=l.slice(D[0],D[1]+1);for(let te=O[0];te<=O[1];++te)if(Y=hs(c[te],J,m),b=Math.min(b,Y),b===0)return b}else Y=Dx(c,O,l,D,m),b=Math.min(b,Y)}else{const Y=ur(O,a),J=ur(D,f);qu(T,b,m,c,l,Y[0],J[0]),qu(T,b,m,c,l,Y[0],J[1]),qu(T,b,m,c,l,Y[1],J[0]),qu(T,b,m,c,l,Y[1],J[1])}}return b}function Df(c){return c.type==="MultiPolygon"?c.coordinates.map(a=>({type:"Polygon",coordinates:a})):c.type==="MultiLineString"?c.coordinates.map(a=>({type:"LineString",coordinates:a})):c.type==="MultiPoint"?c.coordinates.map(a=>({type:"Point",coordinates:a})):[c]}class ds{constructor(a,l){this.type=mt,this.geojson=a,this.geometries=l}static parse(a,l){if(a.length!==2)return l.error(`'distance' expression requires exactly one argument, but found ${a.length-1} instead.`);if(os(a[1])){const f=a[1];if(f.type==="FeatureCollection")return new ds(f,f.features.map(m=>Df(m.geometry)).flat());if(f.type==="Feature")return new ds(f,Df(f.geometry));if("type"in f&&"coordinates"in f)return new ds(f,Df(f))}return l.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(l,f){const m=l.geometry(),x=m.flat().map(A=>Fu([A.x,A.y],l.canonical));if(m.length===0)return NaN;const b=new Cf(x[0][1]);let T=1/0;for(const A of f){switch(A.type){case"Point":T=Math.min(T,Hu(x,!1,[A.coordinates],!1,b,T));break;case"LineString":T=Math.min(T,Hu(x,!1,A.coordinates,!0,b,T));break;case"Polygon":T=Math.min(T,Wu(x,!1,A.coordinates,b,T))}if(T===0)return T}return T}(a,this.geometries);if(a.geometryType()==="LineString")return function(l,f){const m=l.geometry(),x=m.flat().map(A=>Fu([A.x,A.y],l.canonical));if(m.length===0)return NaN;const b=new Cf(x[0][1]);let T=1/0;for(const A of f){switch(A.type){case"Point":T=Math.min(T,Hu(x,!0,[A.coordinates],!1,b,T));break;case"LineString":T=Math.min(T,Hu(x,!0,A.coordinates,!0,b,T));break;case"Polygon":T=Math.min(T,Wu(x,!0,A.coordinates,b,T))}if(T===0)return T}return T}(a,this.geometries);if(a.geometryType()==="Polygon")return function(l,f){const m=l.geometry();if(m.length===0||m[0].length===0)return NaN;const x=wc(m,0).map(A=>A.map(O=>O.map(D=>Fu([D.x,D.y],l.canonical)))),b=new Cf(x[0][0][0][1]);let T=1/0;for(const A of f)for(const O of x){switch(A.type){case"Point":T=Math.min(T,Wu([A.coordinates],!1,O,b,T));break;case"LineString":T=Math.min(T,Wu(A.coordinates,!0,O,b,T));break;case"Polygon":T=Math.min(T,$x(O,A.coordinates,b,T))}if(T===0)return T}return T}(a,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Sc{constructor(a){this.type=Gt,this.key=a}static parse(a,l){if(a.length!==2)return l.error(`Expected 1 argument, but found ${a.length-1} instead.`);const f=a[1];return f==null?l.error("Global state property must be defined."):typeof f!="string"?l.error(`Global state property must be string, but found ${typeof a[1]} instead.`):new Sc(f)}evaluate(a){var l;const f=(l=a.globals)===null||l===void 0?void 0:l.globalState;return f&&Object.keys(f).length!==0?il(f,this.key):null}eachChild(){}outputDefined(){return!1}}const ll={"==":Bg,"!=":zu,">":bf,"<":Px,">=":kx,"<=":Tx,array:Ri,at:Nu,boolean:Ri,case:ol,coalesce:gc,collator:Lu,format:ls,image:Sf,in:$u,"index-of":la,interpolate:zn,"interpolate-hcl":zn,"interpolate-lab":zn,length:Bu,let:dc,literal:to,match:kn,number:Ri,"number-format":wf,object:Ri,slice:fc,step:Qr,string:Ri,"to-boolean":Da,"to-color":Da,"to-number":Da,"to-string":Da,var:Ru,within:us,distance:ds,"global-state":Sc};class Hi{constructor(a,l,f,m){this.name=a,this.type=l,this._evaluate=f,this.args=m}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,l){const f=a[0],m=Hi.definitions[f];if(!m)return l.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(m)?m[0]:m.type,b=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,T=b.filter(([O])=>!Array.isArray(O)||O.length===a.length-1);let A=null;for(const[O,D]of T){A=new al(l.registry,Zu,l.path,null,l.scope);const B=[];let K=!1;for(let Y=1;Y<a.length;Y++){const J=a[Y],te=Array.isArray(O)?O[Y-1]:O.type,ae=A.parse(J,1+B.length,te);if(!ae){K=!0;break}B.push(ae)}if(!K)if(Array.isArray(O)&&O.length!==B.length)A.error(`Expected ${O.length} arguments, but found ${B.length} instead.`);else{for(let Y=0;Y<B.length;Y++){const J=Array.isArray(O)?O[Y]:O.type,te=B[Y];A.concat(Y+1).checkSubtype(J,te.type)}if(A.errors.length===0)return new Hi(f,x,D,B)}}if(T.length===1)l.errors.push(...A.errors);else{const O=(T.length?T:b).map(([B])=>{return K=B,Array.isArray(K)?`(${K.map(Pr).join(", ")})`:`(${Pr(K.type)}...)`;var K}).join(" | "),D=[];for(let B=1;B<a.length;B++){const K=l.parse(a[B],1+D.length);if(!K)return null;D.push(Pr(K.type))}l.error(`Expected arguments of type ${O}, but found (${D.join(", ")}) instead.`)}return null}static register(a,l){Hi.definitions=l;for(const f in l)a[f]=Hi}}function Qg(c,[a,l,f,m]){a=a.evaluate(c),l=l.evaluate(c),f=f.evaluate(c);const x=m?m.evaluate(c):1,b=jr(a,l,f,x);if(b)throw new Tr(b);return new Xt(a/255,l/255,f/255,x,!1)}function ey(c,a){return c in a}function Rf(c,a){const l=a[c];return l===void 0?null:l}function fs(c){return{type:c}}function Zu(c){if(c instanceof Ru)return Zu(c.boundExpression);if(c instanceof Hi&&c.name==="error"||c instanceof Lu||c instanceof us||c instanceof ds||c instanceof Sc)return!1;const a=c instanceof Da||c instanceof Ri;let l=!0;return c.eachChild(f=>{l=a?l&&Zu(f):l&&f instanceof to}),!!l&&Ku(c)&&Xu(c,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Ku(c){if(c instanceof Hi&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof us||c instanceof ds)return!1;let a=!0;return c.eachChild(l=>{a&&!Ku(l)&&(a=!1)}),a}function Pc(c){if(c instanceof Hi&&c.name==="feature-state")return!1;let a=!0;return c.eachChild(l=>{a&&!Pc(l)&&(a=!1)}),a}function Xu(c,a){if(c instanceof Hi&&a.indexOf(c.name)>=0)return!1;let l=!0;return c.eachChild(f=>{l&&!Xu(f,a)&&(l=!1)}),l}function ty(c){return{result:"success",value:c}}function cl(c){return{result:"error",value:c}}function Ro(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function ry(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Nf(c){return!!c.expression&&c.expression.interpolated}function Jt(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function Tc(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)&&jt(c)===Mo}function zx(c){return c}function ny(c,a){const l=c.stops&&typeof c.stops[0][0]=="object",f=l||!(l||c.property!==void 0),m=c.type||(Nf(a)?"exponential":"interval"),x=function(D){switch(D.type){case"color":return Xt.parse;case"padding":return Tn.parse;case"numberArray":return ci.parse;case"colorArray":return un.parse;default:return null}}(a);if(x&&((c=Jn({},c)).stops&&(c.stops=c.stops.map(D=>[D[0],x(D[1])])),c.default=x(c.default?c.default:a.default)),c.colorSpace&&(b=c.colorSpace)!=="rgb"&&b!=="hcl"&&b!=="lab")throw new Error(`Unknown color space: "${c.colorSpace}"`);var b;const T=function(D){switch(D){case"exponential":return ay;case"interval":return Lx;case"categorical":return iy;case"identity":return Bx;default:throw new Error(`Unknown function type "${D}"`)}}(m);let A,O;if(m==="categorical"){A=Object.create(null);for(const D of c.stops)A[D[0]]=D[1];O=typeof c.stops[0][0]}if(l){const D={},B=[];for(let J=0;J<c.stops.length;J++){const te=c.stops[J],ae=te[0].zoom;D[ae]===void 0&&(D[ae]={zoom:ae,type:c.type,property:c.property,default:c.default,stops:[]},B.push(ae)),D[ae].stops.push([te[0].value,te[1]])}const K=[];for(const J of B)K.push([D[J].zoom,ny(D[J],a)]);const Y={name:"linear"};return{kind:"composite",interpolationType:Y,interpolationFactor:zn.interpolationFactor.bind(void 0,Y),zoomStops:K.map(J=>J[0]),evaluate:({zoom:J},te)=>ay({stops:K,base:c.base},a,J).evaluate(J,te)}}if(f){const D=m==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:zn.interpolationFactor.bind(void 0,D),zoomStops:c.stops.map(B=>B[0]),evaluate:({zoom:B})=>T(c,a,B,A,O)}}return{kind:"source",evaluate(D,B){const K=B&&B.properties?B.properties[c.property]:void 0;return K===void 0?No(c.default,a.default):T(c,a,K,A,O)}}}function No(c,a,l){return c!==void 0?c:a!==void 0?a:l!==void 0?l:void 0}function iy(c,a,l,f,m){return No(typeof l===m?f[l]:void 0,c.default,a.default)}function Lx(c,a,l){if(Jt(l)!=="number")return No(c.default,a.default);const f=c.stops.length;if(f===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[f-1][0])return c.stops[f-1][1];const m=ss(c.stops.map(x=>x[0]),l);return c.stops[m][1]}function ay(c,a,l){const f=c.base!==void 0?c.base:1;if(Jt(l)!=="number")return No(c.default,a.default);const m=c.stops.length;if(m===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[m-1][0])return c.stops[m-1][1];const x=ss(c.stops.map(D=>D[0]),l),b=function(D,B,K,Y){const J=Y-K,te=D-K;return J===0?0:B===1?te/J:(Math.pow(B,te)-1)/(Math.pow(B,J)-1)}(l,f,c.stops[x][0],c.stops[x+1][0]),T=c.stops[x][1],A=c.stops[x+1][1],O=Ra[a.type]||zx;return typeof T.evaluate=="function"?{evaluate(...D){const B=T.evaluate.apply(void 0,D),K=A.evaluate.apply(void 0,D);if(B!==void 0&&K!==void 0)return O(B,K,b,c.colorSpace)}}:O(T,A,b,c.colorSpace)}function Bx(c,a,l){switch(a.type){case"color":l=Xt.parse(l);break;case"formatted":l=li.fromString(l.toString());break;case"resolvedImage":l=Di.fromString(l.toString());break;case"padding":l=Tn.parse(l);break;case"colorArray":l=un.parse(l);break;case"numberArray":l=ci.parse(l);break;default:Jt(l)===a.type||a.type==="enum"&&a.values[l]||(l=void 0)}return No(l,c.default,a.default)}Hi.register(ll,{error:[{kind:"error"},[Zt],(c,[a])=>{throw new Tr(a.evaluate(c))}],typeof:[Zt,[Gt],(c,[a])=>Pr(jt(a.evaluate(c)))],"to-rgba":[bi(mt,4),[$n],(c,[a])=>{const[l,f,m,x]=a.evaluate(c).rgb;return[255*l,255*f,255*m,x]}],rgb:[$n,[mt,mt,mt],Qg],rgba:[$n,[mt,mt,mt,mt],Qg],has:{type:Wt,overloads:[[[Zt],(c,[a])=>ey(a.evaluate(c),c.properties())],[[Zt,Mo],(c,[a,l])=>ey(a.evaluate(c),l.evaluate(c))]]},get:{type:Gt,overloads:[[[Zt],(c,[a])=>Rf(a.evaluate(c),c.properties())],[[Zt,Mo],(c,[a,l])=>Rf(a.evaluate(c),l.evaluate(c))]]},"feature-state":[Gt,[Zt],(c,[a])=>Rf(a.evaluate(c),c.featureState||{})],properties:[Mo,[],c=>c.properties()],"geometry-type":[Zt,[],c=>c.geometryType()],id:[Gt,[],c=>c.id()],zoom:[mt,[],c=>c.globals.zoom],"heatmap-density":[mt,[],c=>c.globals.heatmapDensity||0],elevation:[mt,[],c=>c.globals.elevation||0],"line-progress":[mt,[],c=>c.globals.lineProgress||0],accumulated:[Gt,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[mt,fs(mt),(c,a)=>{let l=0;for(const f of a)l+=f.evaluate(c);return l}],"*":[mt,fs(mt),(c,a)=>{let l=1;for(const f of a)l*=f.evaluate(c);return l}],"-":{type:mt,overloads:[[[mt,mt],(c,[a,l])=>a.evaluate(c)-l.evaluate(c)],[[mt],(c,[a])=>-a.evaluate(c)]]},"/":[mt,[mt,mt],(c,[a,l])=>a.evaluate(c)/l.evaluate(c)],"%":[mt,[mt,mt],(c,[a,l])=>a.evaluate(c)%l.evaluate(c)],ln2:[mt,[],()=>Math.LN2],pi:[mt,[],()=>Math.PI],e:[mt,[],()=>Math.E],"^":[mt,[mt,mt],(c,[a,l])=>Math.pow(a.evaluate(c),l.evaluate(c))],sqrt:[mt,[mt],(c,[a])=>Math.sqrt(a.evaluate(c))],log10:[mt,[mt],(c,[a])=>Math.log(a.evaluate(c))/Math.LN10],ln:[mt,[mt],(c,[a])=>Math.log(a.evaluate(c))],log2:[mt,[mt],(c,[a])=>Math.log(a.evaluate(c))/Math.LN2],sin:[mt,[mt],(c,[a])=>Math.sin(a.evaluate(c))],cos:[mt,[mt],(c,[a])=>Math.cos(a.evaluate(c))],tan:[mt,[mt],(c,[a])=>Math.tan(a.evaluate(c))],asin:[mt,[mt],(c,[a])=>Math.asin(a.evaluate(c))],acos:[mt,[mt],(c,[a])=>Math.acos(a.evaluate(c))],atan:[mt,[mt],(c,[a])=>Math.atan(a.evaluate(c))],min:[mt,fs(mt),(c,a)=>Math.min(...a.map(l=>l.evaluate(c)))],max:[mt,fs(mt),(c,a)=>Math.max(...a.map(l=>l.evaluate(c)))],abs:[mt,[mt],(c,[a])=>Math.abs(a.evaluate(c))],round:[mt,[mt],(c,[a])=>{const l=a.evaluate(c);return l<0?-Math.round(-l):Math.round(l)}],floor:[mt,[mt],(c,[a])=>Math.floor(a.evaluate(c))],ceil:[mt,[mt],(c,[a])=>Math.ceil(a.evaluate(c))],"filter-==":[Wt,[Zt,Gt],(c,[a,l])=>c.properties()[a.value]===l.value],"filter-id-==":[Wt,[Gt],(c,[a])=>c.id()===a.value],"filter-type-==":[Wt,[Zt],(c,[a])=>c.geometryType()===a.value],"filter-<":[Wt,[Zt,Gt],(c,[a,l])=>{const f=c.properties()[a.value],m=l.value;return typeof f==typeof m&&f<m}],"filter-id-<":[Wt,[Gt],(c,[a])=>{const l=c.id(),f=a.value;return typeof l==typeof f&&l<f}],"filter->":[Wt,[Zt,Gt],(c,[a,l])=>{const f=c.properties()[a.value],m=l.value;return typeof f==typeof m&&f>m}],"filter-id->":[Wt,[Gt],(c,[a])=>{const l=c.id(),f=a.value;return typeof l==typeof f&&l>f}],"filter-<=":[Wt,[Zt,Gt],(c,[a,l])=>{const f=c.properties()[a.value],m=l.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[Wt,[Gt],(c,[a])=>{const l=c.id(),f=a.value;return typeof l==typeof f&&l<=f}],"filter->=":[Wt,[Zt,Gt],(c,[a,l])=>{const f=c.properties()[a.value],m=l.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[Wt,[Gt],(c,[a])=>{const l=c.id(),f=a.value;return typeof l==typeof f&&l>=f}],"filter-has":[Wt,[Gt],(c,[a])=>a.value in c.properties()],"filter-has-id":[Wt,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Wt,[bi(Zt)],(c,[a])=>a.value.indexOf(c.geometryType())>=0],"filter-id-in":[Wt,[bi(Gt)],(c,[a])=>a.value.indexOf(c.id())>=0],"filter-in-small":[Wt,[Zt,bi(Gt)],(c,[a,l])=>l.value.indexOf(c.properties()[a.value])>=0],"filter-in-large":[Wt,[Zt,bi(Gt)],(c,[a,l])=>function(f,m,x,b){for(;x<=b;){const T=x+b>>1;if(m[T]===f)return!0;m[T]>f?b=T-1:x=T+1}return!1}(c.properties()[a.value],l.value,0,l.value.length-1)],all:{type:Wt,overloads:[[[Wt,Wt],(c,[a,l])=>a.evaluate(c)&&l.evaluate(c)],[fs(Wt),(c,a)=>{for(const l of a)if(!l.evaluate(c))return!1;return!0}]]},any:{type:Wt,overloads:[[[Wt,Wt],(c,[a,l])=>a.evaluate(c)||l.evaluate(c)],[fs(Wt),(c,a)=>{for(const l of a)if(l.evaluate(c))return!0;return!1}]]},"!":[Wt,[Wt],(c,[a])=>!a.evaluate(c)],"is-supported-script":[Wt,[Zt],(c,[a])=>{const l=c.globals&&c.globals.isSupportedScript;return!l||l(a.evaluate(c))}],upcase:[Zt,[Zt],(c,[a])=>a.evaluate(c).toUpperCase()],downcase:[Zt,[Zt],(c,[a])=>a.evaluate(c).toLowerCase()],concat:[Zt,fs(Gt),(c,a)=>a.map(l=>Bt(l.evaluate(c))).join("")],"resolved-locale":[Zt,[Cu],(c,[a])=>a.evaluate(c).resolvedLocale()]});class $f{constructor(a,l){this.expression=a,this._warningHistory={},this._evaluator=new _f,this._defaultValue=l?function(f){if(f.type==="color"&&Tc(f.default))return new Xt(0,0,0,0);switch(f.type){case"color":return Xt.parse(f.default)||null;case"padding":return Tn.parse(f.default)||null;case"numberArray":return ci.parse(f.default)||null;case"colorArray":return un.parse(f.default)||null;case"variableAnchorOffsetCollection":return ui.parse(f.default)||null;case"projectionDefinition":return Qn.parse(f.default)||null;default:return f.default===void 0?null:f.default}}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(a,l,f,m,x,b){return this._evaluator.globals=a,this._evaluator.feature=l,this._evaluator.featureState=f,this._evaluator.canonical=m,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)}evaluate(a,l,f,m,x,b){this._evaluator.globals=a,this._evaluator.feature=l||null,this._evaluator.featureState=f||null,this._evaluator.canonical=m,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=b||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Tr(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Yu(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in ll}function kc(c,a){const l=new al(ll,Zu,[],a?function(m){const x={color:$n,string:Zt,number:mt,enum:Zt,boolean:Wt,formatted:Io,padding:Mu,numberArray:el,colorArray:ja,projectionDefinition:rs,resolvedImage:Jr,variableAnchorOffsetCollection:Iu};return m.type==="array"?bi(x[m.value]||Gt,m.length):x[m.type]}(a):void 0),f=l.parse(c,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?ty(new $f(f,a)):cl(l.errors)}class Ec{constructor(a,l){this.kind=a,this._styleExpression=l,this.isStateDependent=a!=="constant"&&!Pc(l.expression),this.globalStateRefs=Mc(l.expression)}evaluateWithoutErrorHandling(a,l,f,m,x,b){return this._styleExpression.evaluateWithoutErrorHandling(a,l,f,m,x,b)}evaluate(a,l,f,m,x,b){return this._styleExpression.evaluate(a,l,f,m,x,b)}}class zf{constructor(a,l,f,m){this.kind=a,this.zoomStops=f,this._styleExpression=l,this.isStateDependent=a!=="camera"&&!Pc(l.expression),this.globalStateRefs=Mc(l.expression),this.interpolationType=m}evaluateWithoutErrorHandling(a,l,f,m,x,b){return this._styleExpression.evaluateWithoutErrorHandling(a,l,f,m,x,b)}evaluate(a,l,f,m,x,b){return this._styleExpression.evaluate(a,l,f,m,x,b)}interpolationFactor(a,l,f){return this.interpolationType?zn.interpolationFactor(this.interpolationType,a,l,f):0}}function oy(c,a){const l=kc(c,a);if(l.result==="error")return l;const f=l.value.expression,m=Ku(f);if(!m&&!Ro(a))return cl([new Ur("","data expressions not supported")]);const x=Xu(f,["zoom"]);if(!x&&!ry(a))return cl([new Ur("","zoom expressions not supported")]);const b=Cc(f);return b||x?b instanceof Ur?cl([b]):b instanceof zn&&!Nf(a)?cl([new Ur("",'"interpolate" expressions cannot be used with this property')]):ty(b?new zf(m?"camera":"composite",l.value,b.labels,b instanceof zn?b.interpolation:void 0):new Ec(m?"constant":"source",l.value)):cl([new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ac{constructor(a,l){this._parameters=a,this._specification=l,Jn(this,ny(this._parameters,this._specification))}static deserialize(a){return new Ac(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Cc(c){let a=null;if(c instanceof dc)a=Cc(c.result);else if(c instanceof gc){for(const l of c.args)if(a=Cc(l),a)break}else(c instanceof Qr||c instanceof zn)&&c.input instanceof Hi&&c.input.name==="zoom"&&(a=c);return a instanceof Ur||c.eachChild(l=>{const f=Cc(l);f instanceof Ur?a=f:!a&&f?a=new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&f&&a!==f&&(a=new Ur("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function Mc(c,a=new Set){return c instanceof Sc&&a.add(c.key),c.eachChild(l=>{Mc(l,a)}),a}function Ju(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const a of c.slice(1))if(!Ju(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}const Lf={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ps(c){if(c==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Ju(c)||(c=ms(c));const a=kc(c,Lf);if(a.result==="error")throw new Error(a.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,f,m)=>a.value.evaluate(l,f,{},m),needGeometry:Qu(c),getGlobalStateRefs:()=>Mc(a.value.expression)}}function Bf(c,a){return c<a?-1:c>a?1:0}function Qu(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let a=1;a<c.length;a++)if(Qu(c[a]))return!0;return!1}function ms(c){if(!c)return!0;const a=c[0];return c.length<=1?a!=="any":a==="=="?Ff(c[1],c[2],"=="):a==="!="?eh(Ff(c[1],c[2],"==")):a==="<"||a===">"||a==="<="||a===">="?Ff(c[1],c[2],a):a==="any"?(l=c.slice(1),["any"].concat(l.map(ms))):a==="all"?["all"].concat(c.slice(1).map(ms)):a==="none"?["all"].concat(c.slice(1).map(ms).map(eh)):a==="in"?sy(c[1],c.slice(2)):a==="!in"?eh(sy(c[1],c.slice(2))):a==="has"?ly(c[1]):a!=="!has"||eh(ly(c[1]));var l}function Ff(c,a,l){switch(c){case"$type":return[`filter-type-${l}`,a];case"$id":return[`filter-id-${l}`,a];default:return[`filter-${l}`,c,a]}}function sy(c,a){if(a.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(l=>typeof l!=typeof a[0])?["filter-in-large",c,["literal",a.sort(Bf)]]:["filter-in-small",c,["literal",a]]}}function ly(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function eh(c){return["!",c]}function Uf(c){const a=typeof c;if(a==="number"||a==="boolean"||a==="string"||c==null)return JSON.stringify(c);if(Array.isArray(c)){let m="[";for(const x of c)m+=`${Uf(x)},`;return`${m}]`}const l=Object.keys(c).sort();let f="{";for(let m=0;m<l.length;m++)f+=`${JSON.stringify(l[m])}:${Uf(c[l[m]])},`;return`${f}}`}function Fx(c){let a="";for(const l of $t)a+=`/${Uf(c[l])}`;return a}function Vf(c){const a=c.value;return a?[new ot(c.key,a,"constants have been deprecated as of v8")]:[]}function Vr(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Na(c){if(Array.isArray(c))return c.map(Na);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const a={};for(const l in c)a[l]=Na(c[l]);return a}return Vr(c)}function Zi(c){const a=c.key,l=c.value,f=c.valueSpec||{},m=c.objectElementValidators||{},x=c.style,b=c.styleSpec,T=c.validateSpec;let A=[];const O=Jt(l);if(O!=="object")return[new ot(a,l,`object expected, ${O} found`)];for(const D in l){const B=D.split(".")[0],K=il(f,B)||f["*"];let Y;if(il(m,B))Y=m[B];else if(il(f,B))Y=T;else if(m["*"])Y=m["*"];else{if(!f["*"]){A.push(new ot(a,l[D],`unknown property "${D}"`));continue}Y=T}A=A.concat(Y({key:(a&&`${a}.`)+D,value:l[D],valueSpec:K,style:x,styleSpec:b,object:l,objectKey:D,validateSpec:T},l))}for(const D in f)m[D]||f[D].required&&f[D].default===void 0&&l[D]===void 0&&A.push(new ot(a,l,`missing required property "${D}"`));return A}function th(c){const a=c.value,l=c.valueSpec,f=c.style,m=c.styleSpec,x=c.key,b=c.arrayElementValidator||c.validateSpec;if(Jt(a)!=="array")return[new ot(x,a,`array expected, ${Jt(a)} found`)];if(l.length&&a.length!==l.length)return[new ot(x,a,`array length ${l.length} expected, length ${a.length} found`)];if(l["min-length"]&&a.length<l["min-length"])return[new ot(x,a,`array length at least ${l["min-length"]} expected, length ${a.length} found`)];let T={type:l.value,values:l.values};m.$version<7&&(T.function=l.function),Jt(l.value)==="object"&&(T=l.value);let A=[];for(let O=0;O<a.length;O++)A=A.concat(b({array:a,arrayIndex:O,value:a[O],valueSpec:T,validateSpec:c.validateSpec,style:f,styleSpec:m,key:`${x}[${O}]`}));return A}function Ic(c){const a=c.key,l=c.value,f=c.valueSpec;let m=Jt(l);return m==="number"&&l!=l&&(m="NaN"),m!=="number"?[new ot(a,l,`number expected, ${m} found`)]:"minimum"in f&&l<f.minimum?[new ot(a,l,`${l} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&l>f.maximum?[new ot(a,l,`${l} is greater than the maximum value ${f.maximum}`)]:[]}function cy(c){const a=c.valueSpec,l=Vr(c.value.type);let f,m,x,b={};const T=l!=="categorical"&&c.value.property===void 0,A=!T,O=Jt(c.value.stops)==="array"&&Jt(c.value.stops[0])==="array"&&Jt(c.value.stops[0][0])==="object",D=Zi({key:c.key,value:c.value,valueSpec:c.styleSpec.function,validateSpec:c.validateSpec,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(Y){if(l==="identity")return[new ot(Y.key,Y.value,'identity function may not have a "stops" property')];let J=[];const te=Y.value;return J=J.concat(th({key:Y.key,value:te,valueSpec:Y.valueSpec,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:B})),Jt(te)==="array"&&te.length===0&&J.push(new ot(Y.key,te,"array must have at least one stop")),J},default:function(Y){return Y.validateSpec({key:Y.key,value:Y.value,valueSpec:a,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec})}}});return l==="identity"&&T&&D.push(new ot(c.key,c.value,'missing required property "property"')),l==="identity"||c.value.stops||D.push(new ot(c.key,c.value,'missing required property "stops"')),l==="exponential"&&c.valueSpec.expression&&!Nf(c.valueSpec)&&D.push(new ot(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(A&&!Ro(c.valueSpec)?D.push(new ot(c.key,c.value,"property functions not supported")):T&&!ry(c.valueSpec)&&D.push(new ot(c.key,c.value,"zoom functions not supported"))),l!=="categorical"&&!O||c.value.property!==void 0||D.push(new ot(c.key,c.value,'"property" property is required')),D;function B(Y){let J=[];const te=Y.value,ae=Y.key;if(Jt(te)!=="array")return[new ot(ae,te,`array expected, ${Jt(te)} found`)];if(te.length!==2)return[new ot(ae,te,`array length 2 expected, length ${te.length} found`)];if(O){if(Jt(te[0])!=="object")return[new ot(ae,te,`object expected, ${Jt(te[0])} found`)];if(te[0].zoom===void 0)return[new ot(ae,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new ot(ae,te,"object stop key must have value")];if(x&&x>Vr(te[0].zoom))return[new ot(ae,te[0].zoom,"stop zoom values must appear in ascending order")];Vr(te[0].zoom)!==x&&(x=Vr(te[0].zoom),m=void 0,b={}),J=J.concat(Zi({key:`${ae}[0]`,value:te[0],valueSpec:{zoom:{}},validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:Ic,value:K}}))}else J=J.concat(K({key:`${ae}[0]`,value:te[0],validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec},te));return Yu(Na(te[1]))?J.concat([new ot(`${ae}[1]`,te[1],"expressions are not allowed in function stops.")]):J.concat(Y.validateSpec({key:`${ae}[1]`,value:te[1],valueSpec:a,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec}))}function K(Y,J){const te=Jt(Y.value),ae=Vr(Y.value),ce=Y.value!==null?Y.value:J;if(f){if(te!==f)return[new ot(Y.key,ce,`${te} stop domain type must match previous stop domain type ${f}`)]}else f=te;if(te!=="number"&&te!=="string"&&te!=="boolean")return[new ot(Y.key,ce,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&l!=="categorical"){let Pe=`number expected, ${te} found`;return Ro(a)&&l===void 0&&(Pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ot(Y.key,ce,Pe)]}return l!=="categorical"||te!=="number"||isFinite(ae)&&Math.floor(ae)===ae?l!=="categorical"&&te==="number"&&m!==void 0&&ae<m?[new ot(Y.key,ce,"stop domain values must appear in ascending order")]:(m=ae,l==="categorical"&&ae in b?[new ot(Y.key,ce,"stop domain values must be unique")]:(b[ae]=!0,[])):[new ot(Y.key,ce,`integer expected, found ${ae}`)]}}function gs(c){const a=(c.expressionContext==="property"?oy:kc)(Na(c.value),c.valueSpec);if(a.result==="error")return a.value.map(f=>new ot(`${c.key}${f.key}`,c.value,f.message));const l=a.value.expression||a.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!l.outputDefined())return[new ot(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!Pc(l))return[new ot(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!Pc(l))return[new ot(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Xu(l,["zoom","feature-state"]))return[new ot(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!Ku(l))return[new ot(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function rh(c){const a=c.key,l=c.value,f=Jt(l);return f!=="string"?[new ot(a,l,`color expected, ${f} found`)]:Xt.parse(String(l))?[]:[new ot(a,l,`color expected, "${l}" found`)]}function no(c){const a=c.key,l=c.value,f=c.valueSpec,m=[];return Array.isArray(f.values)?f.values.indexOf(Vr(l))===-1&&m.push(new ot(a,l,`expected one of [${f.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(f.values).indexOf(Vr(l))===-1&&m.push(new ot(a,l,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(l)} found`)),m}function Gf(c){return Ju(Na(c.value))?gs(Jn({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):uy(c)}function uy(c){const a=c.value,l=c.key;if(Jt(a)!=="array")return[new ot(l,a,`array expected, ${Jt(a)} found`)];const f=c.styleSpec;let m,x=[];if(a.length<1)return[new ot(l,a,"filter array must have at least 1 element")];switch(x=x.concat(no({key:`${l}[0]`,value:a[0],valueSpec:f.filter_operator,style:c.style,styleSpec:c.styleSpec})),Vr(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&Vr(a[1])==="$type"&&x.push(new ot(l,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&x.push(new ot(l,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(m=Jt(a[1]),m!=="string"&&x.push(new ot(`${l}[1]`,a[1],`string expected, ${m} found`)));for(let b=2;b<a.length;b++)m=Jt(a[b]),Vr(a[1])==="$type"?x=x.concat(no({key:`${l}[${b}]`,value:a[b],valueSpec:f.geometry_type,style:c.style,styleSpec:c.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&x.push(new ot(`${l}[${b}]`,a[b],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let b=1;b<a.length;b++)x=x.concat(uy({key:`${l}[${b}]`,value:a[b],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":m=Jt(a[1]),a.length!==2?x.push(new ot(l,a,`filter array for "${a[0]}" operator must have 2 elements`)):m!=="string"&&x.push(new ot(`${l}[1]`,a[1],`string expected, ${m} found`))}return x}function hy(c,a){const l=c.key,f=c.validateSpec,m=c.style,x=c.styleSpec,b=c.value,T=c.objectKey,A=x[`${a}_${c.layerType}`];if(!A)return[];const O=T.match(/^(.*)-transition$/);if(a==="paint"&&O&&A[O[1]]&&A[O[1]].transition)return f({key:l,value:b,valueSpec:x.transition,style:m,styleSpec:x});const D=c.valueSpec||A[T];if(!D)return[new ot(l,b,`unknown property "${T}"`)];let B;if(Jt(b)==="string"&&Ro(D)&&!D.tokens&&(B=/^{([^}]+)}$/.exec(b)))return[new ot(l,b,`"${T}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(B[1])} }\`.`)];const K=[];return c.layerType==="symbol"&&(T==="text-field"&&m&&!m.glyphs&&K.push(new ot(l,b,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&Tc(Na(b))&&Vr(b.type)==="identity"&&K.push(new ot(l,b,'"text-font" does not support identity functions'))),K.concat(f({key:c.key,value:b,valueSpec:D,style:m,styleSpec:x,expressionContext:"property",propertyType:a,propertyKey:T}))}function dy(c){return hy(c,"paint")}function fy(c){return hy(c,"layout")}function py(c){let a=[];const l=c.value,f=c.key,m=c.style,x=c.styleSpec;if(Jt(l)!=="object")return[new ot(f,l,`object expected, ${Jt(l)} found`)];l.type||l.ref||a.push(new ot(f,l,'either "type" or "ref" is required'));let b=Vr(l.type);const T=Vr(l.ref);if(l.id){const A=Vr(l.id);for(let O=0;O<c.arrayIndex;O++){const D=m.layers[O];Vr(D.id)===A&&a.push(new ot(f,l.id,`duplicate layer id "${l.id}", previously used at line ${D.id.__line__}`))}}if("ref"in l){let A;["type","source","source-layer","filter","layout"].forEach(O=>{O in l&&a.push(new ot(f,l[O],`"${O}" is prohibited for ref layers`))}),m.layers.forEach(O=>{Vr(O.id)===T&&(A=O)}),A?A.ref?a.push(new ot(f,l.ref,"ref cannot reference another ref layer")):b=Vr(A.type):a.push(new ot(f,l.ref,`ref layer "${T}" not found`))}else if(b!=="background")if(l.source){const A=m.sources&&m.sources[l.source],O=A&&Vr(A.type);A?O==="vector"&&b==="raster"?a.push(new ot(f,l.source,`layer "${l.id}" requires a raster source`)):O!=="raster-dem"&&b==="hillshade"||O!=="raster-dem"&&b==="color-relief"?a.push(new ot(f,l.source,`layer "${l.id}" requires a raster-dem source`)):O==="raster"&&b!=="raster"?a.push(new ot(f,l.source,`layer "${l.id}" requires a vector source`)):O!=="vector"||l["source-layer"]?O==="raster-dem"&&b!=="hillshade"&&b!=="color-relief"?a.push(new ot(f,l.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):b!=="line"||!l.paint||!l.paint["line-gradient"]||O==="geojson"&&A.lineMetrics||a.push(new ot(f,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new ot(f,l,`layer "${l.id}" must specify a "source-layer"`)):a.push(new ot(f,l.source,`source "${l.source}" not found`))}else a.push(new ot(f,l,'missing required property "source"'));return a=a.concat(Zi({key:f,value:l,valueSpec:x.layer,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,objectElementValidators:{"*":()=>[],type:()=>c.validateSpec({key:`${f}.type`,value:l.type,valueSpec:x.layer.type,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,object:l,objectKey:"type"}),filter:Gf,layout:A=>Zi({layer:l,key:A.key,value:A.value,style:A.style,styleSpec:A.styleSpec,validateSpec:A.validateSpec,objectElementValidators:{"*":O=>fy(Jn({layerType:b},O))}}),paint:A=>Zi({layer:l,key:A.key,value:A.value,style:A.style,styleSpec:A.styleSpec,validateSpec:A.validateSpec,objectElementValidators:{"*":O=>dy(Jn({layerType:b},O))}})}})),a}function ua(c){const a=c.value,l=c.key,f=Jt(a);return f!=="string"?[new ot(l,a,`string expected, ${f} found`)]:[]}const ul={promoteId:function({key:c,value:a}){if(Jt(a)==="string")return ua({key:c,value:a});{const l=[];for(const f in a)l.push(...ua({key:`${c}.${f}`,value:a[f]}));return l}}};function wi(c){const a=c.value,l=c.key,f=c.styleSpec,m=c.style,x=c.validateSpec;if(!a.type)return[new ot(l,a,'"type" is required')];const b=Vr(a.type);let T;switch(b){case"vector":case"raster":return T=Zi({key:l,value:a,valueSpec:f[`source_${b.replace("-","_")}`],style:c.style,styleSpec:f,objectElementValidators:ul,validateSpec:x}),T;case"raster-dem":return T=function(A){var O;const D=(O=A.sourceName)!==null&&O!==void 0?O:"",B=A.value,K=A.styleSpec,Y=K.source_raster_dem,J=A.style;let te=[];const ae=Jt(B);if(B===void 0)return te;if(ae!=="object")return te.push(new ot("source_raster_dem",B,`object expected, ${ae} found`)),te;const ce=Vr(B.encoding)==="custom",Pe=["redFactor","greenFactor","blueFactor","baseShift"],ge=A.value.encoding?`"${A.value.encoding}"`:"Default";for(const ve in B)!ce&&Pe.includes(ve)?te.push(new ot(ve,B[ve],`In "${D}": "${ve}" is only valid when "encoding" is set to "custom". ${ge} encoding found`)):Y[ve]?te=te.concat(A.validateSpec({key:ve,value:B[ve],valueSpec:Y[ve],validateSpec:A.validateSpec,style:J,styleSpec:K})):te.push(new ot(ve,B[ve],`unknown property "${ve}"`));return te}({sourceName:l,value:a,style:c.style,styleSpec:f,validateSpec:x}),T;case"geojson":if(T=Zi({key:l,value:a,valueSpec:f.source_geojson,style:m,styleSpec:f,validateSpec:x,objectElementValidators:ul}),a.cluster)for(const A in a.clusterProperties){const[O,D]=a.clusterProperties[A],B=typeof O=="string"?[O,["accumulated"],["get",A]]:O;T.push(...gs({key:`${l}.${A}.map`,value:D,expressionContext:"cluster-map"})),T.push(...gs({key:`${l}.${A}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return T;case"video":return Zi({key:l,value:a,valueSpec:f.source_video,style:m,validateSpec:x,styleSpec:f});case"image":return Zi({key:l,value:a,valueSpec:f.source_image,style:m,validateSpec:x,styleSpec:f});case"canvas":return[new ot(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return no({key:`${l}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function hl(c){const a=c.value,l=c.styleSpec,f=l.light,m=c.style;let x=[];const b=Jt(a);if(a===void 0)return x;if(b!=="object")return x=x.concat([new ot("light",a,`object expected, ${b} found`)]),x;for(const T in a){const A=T.match(/^(.*)-transition$/);x=x.concat(A&&f[A[1]]&&f[A[1]].transition?c.validateSpec({key:T,value:a[T],valueSpec:l.transition,validateSpec:c.validateSpec,style:m,styleSpec:l}):f[T]?c.validateSpec({key:T,value:a[T],valueSpec:f[T],validateSpec:c.validateSpec,style:m,styleSpec:l}):[new ot(T,a[T],`unknown property "${T}"`)])}return x}function qf(c){const a=c.value,l=c.styleSpec,f=l.sky,m=c.style,x=Jt(a);if(a===void 0)return[];if(x!=="object")return[new ot("sky",a,`object expected, ${x} found`)];let b=[];for(const T in a)b=b.concat(f[T]?c.validateSpec({key:T,value:a[T],valueSpec:f[T],style:m,styleSpec:l}):[new ot(T,a[T],`unknown property "${T}"`)]);return b}function my(c){const a=c.value,l=c.styleSpec,f=l.terrain,m=c.style;let x=[];const b=Jt(a);if(a===void 0)return x;if(b!=="object")return x=x.concat([new ot("terrain",a,`object expected, ${b} found`)]),x;for(const T in a)x=x.concat(f[T]?c.validateSpec({key:T,value:a[T],valueSpec:f[T],validateSpec:c.validateSpec,style:m,styleSpec:l}):[new ot(T,a[T],`unknown property "${T}"`)]);return x}function gy(c){let a=[];const l=c.value,f=c.key;if(Array.isArray(l)){const m=[],x=[];for(const b in l)l[b].id&&m.includes(l[b].id)&&a.push(new ot(f,l,`all the sprites' ids must be unique, but ${l[b].id} is duplicated`)),m.push(l[b].id),l[b].url&&x.includes(l[b].url)&&a.push(new ot(f,l,`all the sprites' URLs must be unique, but ${l[b].url} is duplicated`)),x.push(l[b].url),a=a.concat(Zi({key:`${f}[${b}]`,value:l[b],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:c.validateSpec}));return a}return ua({key:f,value:l})}function dl(c){return a=c.value,a&&a.constructor===Object?[]:[new ot(c.key,c.value,`object expected, ${Jt(c.value)} found`)];var a}const Wf={"*":()=>[],array:th,boolean:function(c){const a=c.value,l=c.key,f=Jt(a);return f!=="boolean"?[new ot(l,a,`boolean expected, ${f} found`)]:[]},number:Ic,color:rh,constants:Vf,enum:no,filter:Gf,function:cy,layer:py,object:Zi,source:wi,light:hl,sky:qf,terrain:my,projection:function(c){const a=c.value,l=c.styleSpec,f=l.projection,m=c.style,x=Jt(a);if(a===void 0)return[];if(x!=="object")return[new ot("projection",a,`object expected, ${x} found`)];let b=[];for(const T in a)b=b.concat(f[T]?c.validateSpec({key:T,value:a[T],valueSpec:f[T],style:m,styleSpec:l}):[new ot(T,a[T],`unknown property "${T}"`)]);return b},projectionDefinition:function(c){const a=c.key;let l=c.value;l=l instanceof String?l.valueOf():l;const f=Jt(l);return f!=="array"||function(m){return Array.isArray(m)&&m.length===3&&typeof m[0]=="string"&&typeof m[1]=="string"&&typeof m[2]=="number"}(l)||function(m){return!!["interpolate","step","literal"].includes(m[0])}(l)?["array","string"].includes(f)?[]:[new ot(a,l,`projection expected, invalid type "${f}" found`)]:[new ot(a,l,`projection expected, invalid array ${JSON.stringify(l)} found`)]},string:ua,formatted:function(c){return ua(c).length===0?[]:gs(c)},resolvedImage:function(c){return ua(c).length===0?[]:gs(c)},padding:function(c){const a=c.key,l=c.value;if(Jt(l)==="array"){if(l.length<1||l.length>4)return[new ot(a,l,`padding requires 1 to 4 values; ${l.length} values found`)];const f={type:"number"};let m=[];for(let x=0;x<l.length;x++)m=m.concat(c.validateSpec({key:`${a}[${x}]`,value:l[x],validateSpec:c.validateSpec,valueSpec:f}));return m}return Ic({key:a,value:l,valueSpec:{}})},numberArray:function(c){const a=c.key,l=c.value;if(Jt(l)==="array"){const f={type:"number"};if(l.length<1)return[new ot(a,l,"array length at least 1 expected, length 0 found")];let m=[];for(let x=0;x<l.length;x++)m=m.concat(c.validateSpec({key:`${a}[${x}]`,value:l[x],validateSpec:c.validateSpec,valueSpec:f}));return m}return Ic({key:a,value:l,valueSpec:{}})},colorArray:function(c){const a=c.key,l=c.value;if(Jt(l)==="array"){if(l.length<1)return[new ot(a,l,"array length at least 1 expected, length 0 found")];let f=[];for(let m=0;m<l.length;m++)f=f.concat(rh({key:`${a}[${m}]`,value:l[m]}));return f}return rh({key:a,value:l})},variableAnchorOffsetCollection:function(c){const a=c.key,l=c.value,f=Jt(l),m=c.styleSpec;if(f!=="array"||l.length<1||l.length%2!=0)return[new ot(a,l,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let b=0;b<l.length;b+=2)x=x.concat(no({key:`${a}[${b}]`,value:l[b],valueSpec:m.layout_symbol["text-anchor"]})),x=x.concat(th({key:`${a}[${b+1}]`,value:l[b+1],valueSpec:{length:2,value:"number"},validateSpec:c.validateSpec,style:c.style,styleSpec:m}));return x},sprite:gy,state:dl};function fl(c){const a=c.value,l=c.valueSpec,f=c.styleSpec;return c.validateSpec=fl,l.expression&&Tc(Vr(a))?cy(c):l.expression&&Yu(Na(a))?gs(c):l.type&&Wf[l.type]?Wf[l.type](c):Zi(Jn({},c,{valueSpec:l.type?f[l.type]:l}))}function yy(c){const a=c.value,l=c.key,f=ua(c);return f.length||(a.indexOf("{fontstack}")===-1&&f.push(new ot(l,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&f.push(new ot(l,a,'"glyphs" url must include a "{range}" token'))),f}function Si(c,a=Ce){let l=[];return l=l.concat(fl({key:"",value:c,valueSpec:a.$root,styleSpec:a,style:c,validateSpec:fl,objectElementValidators:{glyphs:yy,"*":()=>[]}})),c.constants&&(l=l.concat(Vf({key:"constants",value:c.constants}))),pl(l)}function ha(c){return function(a){return c({...a,validateSpec:fl})}}function pl(c){return[].concat(c).sort((a,l)=>a.line-l.line)}function da(c){return function(...a){return pl(c.apply(this,a))}}Si.source=da(ha(wi)),Si.sprite=da(ha(gy)),Si.glyphs=da(ha(yy)),Si.light=da(ha(hl)),Si.sky=da(ha(qf)),Si.terrain=da(ha(my)),Si.state=da(ha(dl)),Si.layer=da(ha(py)),Si.filter=da(ha(Gf)),Si.paintProperty=da(ha(dy)),Si.layoutProperty=da(ha(fy));const ml=Si,Ux=ml.light,jc=ml.sky,Vx=ml.paintProperty,Gx=ml.layoutProperty;function Oc(c,a){let l=!1;if(a&&a.length)for(const f of a)c.fire(new Ze(new Error(f.message))),l=!0;return l}class Dc{constructor(a,l,f){const m=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;const b=new Int32Array(this.arrayBuffer);a=b[0],this.d=(l=b[1])+2*(f=b[2]);for(let A=0;A<this.d*this.d;A++){const O=b[3+A],D=b[3+A+1];m.push(O===D?null:b.subarray(O,D))}const T=b[3+m.length+1];this.keys=b.subarray(b[3+m.length],T),this.bboxes=b.subarray(T),this.insert=this._insertReadonly}else{this.d=l+2*f;for(let b=0;b<this.d*this.d;b++)m.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=a,this.padding=f,this.scale=l/a,this.uid=0;const x=f/l*a;this.min=-x,this.max=a+x}insert(a,l,f,m,x){this._forEachCell(l,f,m,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(a),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(m),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(a,l,f,m,x,b){this.cells[x].push(b)}query(a,l,f,m,x){const b=this.min,T=this.max;if(a<=b&&l<=b&&T<=f&&T<=m&&!x)return Array.prototype.slice.call(this.keys);{const A=[];return this._forEachCell(a,l,f,m,this._queryCell,A,{},x),A}}_queryCell(a,l,f,m,x,b,T,A){const O=this.cells[x];if(O!==null){const D=this.keys,B=this.bboxes;for(let K=0;K<O.length;K++){const Y=O[K];if(T[Y]===void 0){const J=4*Y;(A?A(B[J+0],B[J+1],B[J+2],B[J+3]):a<=B[J+2]&&l<=B[J+3]&&f>=B[J+0]&&m>=B[J+1])?(T[Y]=!0,b.push(D[Y])):T[Y]=!1}}}}_forEachCell(a,l,f,m,x,b,T,A){const O=this._convertToCellCoord(a),D=this._convertToCellCoord(l),B=this._convertToCellCoord(f),K=this._convertToCellCoord(m);for(let Y=O;Y<=B;Y++)for(let J=D;J<=K;J++){const te=this.d*J+Y;if((!A||A(this._convertFromCellCoord(Y),this._convertFromCellCoord(J),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(J+1)))&&x.call(this,a,l,f,m,te,b,T,A))return}}_convertFromCellCoord(a){return(a-this.padding)/this.scale}_convertToCellCoord(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const a=this.cells,l=3+this.cells.length+1+1;let f=0;for(let b=0;b<this.cells.length;b++)f+=this.cells[b].length;const m=new Int32Array(l+f+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let x=l;for(let b=0;b<a.length;b++){const T=a[b];m[3+b]=x,m.set(T,x),x+=T.length}return m[3+a.length]=x,m.set(this.keys,x),x+=this.keys.length,m[3+a.length+1]=x,m.set(this.bboxes,x),x+=this.bboxes.length,m.buffer}static serialize(a,l){const f=a.toArrayBuffer();return l&&l.push(f),{buffer:f}}static deserialize(a){return new Dc(a.buffer)}}const fa={};function yt(c,a,l={}){if(fa[c])throw new Error(`${c} is already registered.`);Object.defineProperty(a,"_classRegistryKey",{value:c,writeable:!1}),fa[c]={klass:a,omit:l.omit||[],shallow:l.shallow||[]}}yt("Object",Object),yt("Set",Set),yt("TransferableGridIndex",Dc),yt("Color",Xt),yt("Error",Error),yt("AJAXError",fe),yt("ResolvedImage",Di),yt("StylePropertyFunction",Ac),yt("StyleExpression",$f,{omit:["_evaluator"]}),yt("ZoomDependentExpression",zf),yt("ZoomConstantExpression",Ec),yt("CompoundExpression",Hi,{omit:["_evaluate"]});for(const c in ll)ll[c]._classRegistryKey||yt(`Expression_${c}`,ll[c]);function Hf(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function nh(c){return c.$name||c.constructor._classRegistryKey}function Zf(c){return!function(a){if(a===null||typeof a!="object")return!1;const l=nh(a);return!(!l||l==="Object")}(c)&&(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||c instanceof Error||Hf(c)||yn(c)||ArrayBuffer.isView(c)||c instanceof ImageData)}function gl(c,a){if(Zf(c))return(Hf(c)||yn(c))&&a&&a.push(c),ArrayBuffer.isView(c)&&a&&a.push(c.buffer),c instanceof ImageData&&a&&a.push(c.data.buffer),c;if(Array.isArray(c)){const x=[];for(const b of c)x.push(gl(b,a));return x}if(typeof c!="object")throw new Error("can't serialize object of type "+typeof c);const l=nh(c);if(!l)throw new Error(`can't serialize object of unregistered class ${c.constructor.name}`);if(!fa[l])throw new Error(`${l} is not registered.`);const{klass:f}=fa[l],m=f.serialize?f.serialize(c,a):{};if(f.serialize){if(a&&m===a[a.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in c){if(!c.hasOwnProperty(x)||fa[l].omit.indexOf(x)>=0)continue;const b=c[x];m[x]=fa[l].shallow.indexOf(x)>=0?b:gl(b,a)}c instanceof Error&&(m.message=c.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(m.$name=l),m}function ys(c){if(Zf(c))return c;if(Array.isArray(c))return c.map(ys);if(typeof c!="object")throw new Error("can't deserialize object of type "+typeof c);const a=nh(c)||"Object";if(!fa[a])throw new Error(`can't deserialize unregistered class ${a}`);const{klass:l}=fa[a];if(!l)throw new Error(`can't deserialize unregistered class ${a}`);if(l.deserialize)return l.deserialize(c);const f=Object.create(l.prototype);for(const m of Object.keys(c)){if(m==="$name")continue;const x=c[m];f[m]=fa[a].shallow.indexOf(m)>=0?x:ys(x)}return f}class ih{constructor(){this.first=!0}update(a,l){const f=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=l),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=f,!0))}}const er={"Latin-1 Supplement":c=>c>=128&&c<=255,"Hangul Jamo":c=>c>=4352&&c<=4607,Khmer:c=>c>=6016&&c<=6143,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Kanbun:c=>c>=12688&&c<=12703,"CJK Strokes":c=>c>=12736&&c<=12783,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Hangul Syllables":c=>c>=44032&&c<=55215,"Private Use Area":c=>c>=57344&&c<=63743,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function ah(c){for(const a of c)if(Xf(a.charCodeAt(0)))return!0;return!1}function qx(c){for(const a of c)if(!vy(a.charCodeAt(0)))return!1;return!0}function oh(c){const a=c.map(l=>{try{return new RegExp(`\\p{sc=${l}}`,"u").source}catch{return null}}).filter(l=>l);return new RegExp(a.join("|"),"u")}const Wx=oh(["Arab","Dupl","Mong","Ougr","Syrc"]);function vy(c){return!Wx.test(String.fromCodePoint(c))}const Kf=oh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Xf(c){return!(c!==746&&c!==747&&(c<4352||!(er["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||er["CJK Compatibility"](c)||er["CJK Strokes"](c)||!(!er["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||er["Enclosed CJK Letters and Months"](c)||er["Ideographic Description Characters"](c)||er.Kanbun(c)||er.Katakana(c)&&c!==12540||!(!er["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!er["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||er["Vertical Forms"](c)||er["Yijing Hexagram Symbols"](c)||/\p{sc=Cans}/u.test(String.fromCodePoint(c))||/\p{sc=Hang}/u.test(String.fromCodePoint(c))||Kf.test(String.fromCodePoint(c)))))}function _y(c){return!(Xf(c)||function(a){return!!(er["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||er["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||er["Letterlike Symbols"](a)||er["Number Forms"](a)||er["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||er["Control Pictures"](a)&&a!==9251||er["Optical Character Recognition"](a)||er["Enclosed Alphanumerics"](a)||er["Geometric Shapes"](a)||er["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||er["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||er["CJK Symbols and Punctuation"](a)||er.Katakana(a)||er["Private Use Area"](a)||er["CJK Compatibility Forms"](a)||er["Small Form Variants"](a)||er["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(c))}const xy=oh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Yf(c){return xy.test(String.fromCodePoint(c))}function by(c,a){return!(!a&&Yf(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||er.Khmer(c))}function wy(c){for(const a of c)if(Yf(a.charCodeAt(0)))return!0;return!1}const pa=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(c){this.pluginStatus=c.pluginStatus,this.pluginURL=c.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(c){if(pa.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=c.applyArabicShaping,this.processBidirectionalText=c.processBidirectionalText,this.processStyledBidirectionalText=c.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(c,a){return s(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(c.pluginStatus!=="loading")return this.setState(c),c;const l=c.pluginURL,f=new Promise(x=>{this.loadScriptResolve=x});a(l);const m=new Promise(x=>setTimeout(()=>x(),this.TIMEOUT));if(yield Promise.race([f,m]),this.isParsed()){const x={pluginStatus:"loaded",pluginURL:l};return this.setState(x),x}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${l}`)})}};class kr{constructor(a,l){this.zoom=a,l?(this.now=l.now||0,this.fadeDuration=l.fadeDuration||0,this.zoomHistory=l.zoomHistory||new ih,this.transition=l.transition||{},this.globalState=l.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ih,this.transition={},this.globalState={})}isSupportedScript(a){return function(l,f){for(const m of l)if(!by(m.charCodeAt(0),f))return!1;return!0}(a,pa.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const a=this.zoom,l=a-Math.floor(a),f=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*l}}}class yl{constructor(a,l){this.property=a,this.value=l,this.expression=function(f,m){if(Tc(f))return new Ac(f,m);if(Yu(f)){const x=oy(f,m);if(x.result==="error")throw new Error(x.value.map(b=>`${b.key}: ${b.message}`).join(", "));return x.value}{let x=f;return m.type==="color"&&typeof f=="string"?x=Xt.parse(f):m.type!=="padding"||typeof f!="number"&&!Array.isArray(f)?m.type!=="numberArray"||typeof f!="number"&&!Array.isArray(f)?m.type!=="colorArray"||typeof f!="string"&&!Array.isArray(f)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(f)?x=ui.parse(f):m.type==="projectionDefinition"&&typeof f=="string"&&(x=Qn.parse(f)):x=un.parse(f):x=ci.parse(f):x=Tn.parse(f),{globalStateRefs:new Set,kind:"constant",evaluate:()=>x}}}(l===void 0?a.specification.default:l,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(a,l,f){return this.property.possiblyEvaluate(this,a,l,f)}}class Jf{constructor(a){this.property=a,this.value=new yl(a,void 0)}transitioned(a,l){return new Qf(this.property,this.value,l,rr({},a.transition,this.transition),a.now)}untransitioned(){return new Qf(this.property,this.value,null,{},0)}}class Sy{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return et(this._values[a].value.value)}setValue(a,l){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new Jf(this._values[a].property)),this._values[a].value=new yl(this._values[a].property,l===null?void 0:et(l))}getTransition(a){return et(this._values[a].transition)}setTransition(a,l){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new Jf(this._values[a].property)),this._values[a].transition=et(l)||void 0}serialize(){const a={};for(const l of Object.keys(this._values)){const f=this.getValue(l);f!==void 0&&(a[l]=f);const m=this.getTransition(l);m!==void 0&&(a[`${l}-transition`]=m)}return a}transitioned(a,l){const f=new ep(this._properties);for(const m of Object.keys(this._values))f._values[m]=this._values[m].transitioned(a,l._values[m]);return f}untransitioned(){const a=new ep(this._properties);for(const l of Object.keys(this._values))a._values[l]=this._values[l].untransitioned();return a}}class Qf{constructor(a,l,f,m,x){this.property=a,this.value=l,this.begin=x+m.delay||0,this.end=this.begin+m.duration||0,a.specification.transition&&(m.delay||m.duration)&&(this.prior=f)}possiblyEvaluate(a,l,f){const m=a.now||0,x=this.value.possiblyEvaluate(a,l,f),b=this.prior;if(b){if(m>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(m<this.begin)return b.possiblyEvaluate(a,l,f);{const T=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(a,l,f),x,it(T))}}return x}}class ep{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,l,f){const m=new sh(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].possiblyEvaluate(a,l,f);return m}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class Py{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}hasValue(a){return this._values[a].value!==void 0}getValue(a){return et(this._values[a].value)}setValue(a,l){this._values[a]=new yl(this._values[a].property,l===null?void 0:et(l))}serialize(){const a={};for(const l of Object.keys(this._values)){const f=this.getValue(l);f!==void 0&&(a[l]=f)}return a}possiblyEvaluate(a,l,f){const m=new sh(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].possiblyEvaluate(a,l,f);return m}}class $a{constructor(a,l,f){this.property=a,this.value=l,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,l,f,m){return this.property.evaluate(this.value,this.parameters,a,l,f,m)}}class sh{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class St{constructor(a){this.specification=a}possiblyEvaluate(a,l){if(a.isDataDriven())throw new Error("Value should not be data driven");return a.expression.evaluate(l)}interpolate(a,l,f){const m=Ra[this.specification.type];return m?m(a,l,f):a}}class Mt{constructor(a,l){this.specification=a,this.overrides=l}possiblyEvaluate(a,l,f,m){return new $a(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(l,null,{},f,m)}:a.expression,l)}interpolate(a,l,f){if(a.value.kind!=="constant"||l.value.kind!=="constant")return a;if(a.value.value===void 0||l.value.value===void 0)return new $a(this,{kind:"constant",value:void 0},a.parameters);const m=Ra[this.specification.type];if(m){const x=m(a.value.value,l.value.value,f);return new $a(this,{kind:"constant",value:x},a.parameters)}return a}evaluate(a,l,f,m,x,b){return a.kind==="constant"?a.value:a.evaluate(l,f,m,x,b)}}class lh extends Mt{possiblyEvaluate(a,l,f,m){if(a.value===void 0)return new $a(this,{kind:"constant",value:void 0},l);if(a.expression.kind==="constant"){const x=a.expression.evaluate(l,null,{},f,m),b=a.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,T=this._calculate(b,b,b,l);return new $a(this,{kind:"constant",value:T},l)}if(a.expression.kind==="camera"){const x=this._calculate(a.expression.evaluate({zoom:l.zoom-1}),a.expression.evaluate({zoom:l.zoom}),a.expression.evaluate({zoom:l.zoom+1}),l);return new $a(this,{kind:"constant",value:x},l)}return new $a(this,a.expression,l)}evaluate(a,l,f,m,x,b){if(a.kind==="source"){const T=a.evaluate(l,f,m,x,b);return this._calculate(T,T,T,l)}return a.kind==="composite"?this._calculate(a.evaluate({zoom:Math.floor(l.zoom)-1},f,m),a.evaluate({zoom:Math.floor(l.zoom)},f,m),a.evaluate({zoom:Math.floor(l.zoom)+1},f,m),l):a.value}_calculate(a,l,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:a,to:l}:{from:f,to:l}}interpolate(a){return a}}class $o{constructor(a){this.specification=a}possiblyEvaluate(a,l,f,m){if(a.value!==void 0){if(a.expression.kind==="constant"){const x=a.expression.evaluate(l,null,{},f,m);return this._calculate(x,x,x,l)}return this._calculate(a.expression.evaluate(new kr(Math.floor(l.zoom-1),l)),a.expression.evaluate(new kr(Math.floor(l.zoom),l)),a.expression.evaluate(new kr(Math.floor(l.zoom+1),l)),l)}}_calculate(a,l,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:a,to:l}:{from:f,to:l}}interpolate(a){return a}}class ch{constructor(a){this.specification=a}possiblyEvaluate(a,l,f,m){return!!a.expression.evaluate(l,null,{},f,m)}interpolate(){return!1}}class hi{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in a){const f=a[l];f.specification.overridable&&this.overridableProperties.push(l);const m=this.defaultPropertyValues[l]=new yl(f,void 0),x=this.defaultTransitionablePropertyValues[l]=new Jf(f);this.defaultTransitioningPropertyValues[l]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=m.possiblyEvaluate({})}}}yt("DataDrivenProperty",Mt),yt("DataConstantProperty",St),yt("CrossFadedDataDrivenProperty",lh),yt("CrossFadedProperty",$o),yt("ColorRampProperty",ch);const Ty="-transition";class Ki extends wt{constructor(a,l){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter,this._featureFilter=ps(a.filter)),l.layout&&(this._unevaluatedLayout=new Py(l.layout)),l.paint)){this._transitionablePaint=new Sy(l.paint);for(const f in a.paint)this.setPaintProperty(f,a.paint[f],{validate:!1});for(const f in a.layout)this.setLayoutProperty(f,a.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new sh(l.paint)}}setFilter(a){this.filter=a,this._featureFilter=ps(a)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}getLayoutAffectingGlobalStateRefs(){const a=new Set;if(this._unevaluatedLayout)for(const l in this._unevaluatedLayout._values){const f=this._unevaluatedLayout._values[l];for(const m of f.getGlobalStateRefs())a.add(m)}for(const l of this._featureFilter.getGlobalStateRefs())a.add(l);return a}getPaintAffectingGlobalStateRefs(){var a;const l=new globalThis.Map;if(this._transitionablePaint)for(const f in this._transitionablePaint._values){const m=this._transitionablePaint._values[f].value;for(const x of m.getGlobalStateRefs()){const b=(a=l.get(x))!==null&&a!==void 0?a:[];b.push({name:f,value:m.value}),l.set(x,b)}}return l}setLayoutProperty(a,l,f={}){l!=null&&this._validate(Gx,`layers.${this.id}.layout.${a}`,a,l,f)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,l):this.visibility=l)}getPaintProperty(a){return a.endsWith(Ty)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,l,f={}){if(l!=null&&this._validate(Vx,`layers.${this.id}.paint.${a}`,a,l,f))return!1;if(a.endsWith(Ty))return this._transitionablePaint.setTransition(a.slice(0,-11),l||void 0),!1;{const m=this._transitionablePaint._values[a],x=m.property.specification["property-type"]==="cross-faded-data-driven",b=m.value.isDataDriven(),T=m.value;this._transitionablePaint.setValue(a,l),this._handleSpecialPaintPropertyUpdate(a);const A=this._transitionablePaint._values[a].value;return A.isDataDriven()||b||x||this._handleOverridablePaintPropertyUpdate(a,T,A)}}_handleSpecialPaintPropertyUpdate(a){}_handleOverridablePaintPropertyUpdate(a,l,f){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,l){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,l)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),zt(a,(l,f)=>!(l===void 0||f==="layout"&&!Object.keys(l).length||f==="paint"&&!Object.keys(l).length))}_validate(a,l,f,m,x={}){return(!x||x.validate!==!1)&&Oc(this,a.call(ml,{key:l,layerType:this.type,objectKey:f,value:m,styleSpec:Ce,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const l=this.paint.get(a);if(l instanceof $a&&Ro(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}const Hx={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Rc{constructor(a,l){this._structArray=a,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class vr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,l){return a._trim(),l&&(a.isTransferred=!0,l.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const l=Object.create(this.prototype);return l.arrayBuffer=a.arrayBuffer,l.length=a.length,l.capacity=a.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function en(c,a=1){let l=0,f=0;return{members:c.map(m=>{const x=Hx[m.type].BYTES_PER_ELEMENT,b=l=uh(l,Math.max(a,x)),T=m.components||1;return f=Math.max(f,x),l+=x*T,{name:m.name,type:m.type,components:T,offset:b}}),size:uh(l,Math.max(f,a)),alignment:a}}function uh(c,a){return Math.ceil(c/a)*a}class vl extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l){const f=this.length;return this.resize(f+1),this.emplace(f,a,l)}emplace(a,l,f){const m=2*a;return this.int16[m+0]=l,this.int16[m+1]=f,a}}vl.prototype.bytesPerElement=4,yt("StructArrayLayout2i4",vl);class _l extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f){const m=this.length;return this.resize(m+1),this.emplace(m,a,l,f)}emplace(a,l,f,m){const x=3*a;return this.int16[x+0]=l,this.int16[x+1]=f,this.int16[x+2]=m,a}}_l.prototype.bytesPerElement=6,yt("StructArrayLayout3i6",_l);class tp extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f,m){const x=this.length;return this.resize(x+1),this.emplace(x,a,l,f,m)}emplace(a,l,f,m,x){const b=4*a;return this.int16[b+0]=l,this.int16[b+1]=f,this.int16[b+2]=m,this.int16[b+3]=x,a}}tp.prototype.bytesPerElement=8,yt("StructArrayLayout4i8",tp);class xl extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f,m,x,b){const T=this.length;return this.resize(T+1),this.emplace(T,a,l,f,m,x,b)}emplace(a,l,f,m,x,b,T){const A=6*a;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=b,this.int16[A+5]=T,a}}xl.prototype.bytesPerElement=12,yt("StructArrayLayout2i4i12",xl);class vs extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f,m,x,b){const T=this.length;return this.resize(T+1),this.emplace(T,a,l,f,m,x,b)}emplace(a,l,f,m,x,b,T){const A=4*a,O=8*a;return this.int16[A+0]=l,this.int16[A+1]=f,this.uint8[O+4]=m,this.uint8[O+5]=x,this.uint8[O+6]=b,this.uint8[O+7]=T,a}}vs.prototype.bytesPerElement=8,yt("StructArrayLayout2i4ub8",vs);class Nc extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l){const f=this.length;return this.resize(f+1),this.emplace(f,a,l)}emplace(a,l,f){const m=2*a;return this.float32[m+0]=l,this.float32[m+1]=f,a}}Nc.prototype.bytesPerElement=8,yt("StructArrayLayout2f8",Nc);class hh extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,f,m,x,b,T,A,O,D){const B=this.length;return this.resize(B+1),this.emplace(B,a,l,f,m,x,b,T,A,O,D)}emplace(a,l,f,m,x,b,T,A,O,D,B){const K=10*a;return this.uint16[K+0]=l,this.uint16[K+1]=f,this.uint16[K+2]=m,this.uint16[K+3]=x,this.uint16[K+4]=b,this.uint16[K+5]=T,this.uint16[K+6]=A,this.uint16[K+7]=O,this.uint16[K+8]=D,this.uint16[K+9]=B,a}}hh.prototype.bytesPerElement=20,yt("StructArrayLayout10ui20",hh);class _s extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,f,m,x,b,T,A,O,D,B,K){const Y=this.length;return this.resize(Y+1),this.emplace(Y,a,l,f,m,x,b,T,A,O,D,B,K)}emplace(a,l,f,m,x,b,T,A,O,D,B,K,Y){const J=12*a;return this.int16[J+0]=l,this.int16[J+1]=f,this.int16[J+2]=m,this.int16[J+3]=x,this.uint16[J+4]=b,this.uint16[J+5]=T,this.uint16[J+6]=A,this.uint16[J+7]=O,this.int16[J+8]=D,this.int16[J+9]=B,this.int16[J+10]=K,this.int16[J+11]=Y,a}}_s.prototype.bytesPerElement=24,yt("StructArrayLayout4i4ui4i24",_s);class rp extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f){const m=this.length;return this.resize(m+1),this.emplace(m,a,l,f)}emplace(a,l,f,m){const x=3*a;return this.float32[x+0]=l,this.float32[x+1]=f,this.float32[x+2]=m,a}}rp.prototype.bytesPerElement=12,yt("StructArrayLayout3f12",rp);class np extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.uint32[1*a+0]=l,a}}np.prototype.bytesPerElement=4,yt("StructArrayLayout1ul4",np);class dh extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,f,m,x,b,T,A,O){const D=this.length;return this.resize(D+1),this.emplace(D,a,l,f,m,x,b,T,A,O)}emplace(a,l,f,m,x,b,T,A,O,D){const B=10*a,K=5*a;return this.int16[B+0]=l,this.int16[B+1]=f,this.int16[B+2]=m,this.int16[B+3]=x,this.int16[B+4]=b,this.int16[B+5]=T,this.uint32[K+3]=A,this.uint16[B+8]=O,this.uint16[B+9]=D,a}}dh.prototype.bytesPerElement=20,yt("StructArrayLayout6i1ul2ui20",dh);class ip extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f,m,x,b){const T=this.length;return this.resize(T+1),this.emplace(T,a,l,f,m,x,b)}emplace(a,l,f,m,x,b,T){const A=6*a;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=m,this.int16[A+3]=x,this.int16[A+4]=b,this.int16[A+5]=T,a}}ip.prototype.bytesPerElement=12,yt("StructArrayLayout2i2i2i12",ip);class v extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f,m,x){const b=this.length;return this.resize(b+1),this.emplace(b,a,l,f,m,x)}emplace(a,l,f,m,x,b){const T=4*a,A=8*a;return this.float32[T+0]=l,this.float32[T+1]=f,this.float32[T+2]=m,this.int16[A+6]=x,this.int16[A+7]=b,a}}v.prototype.bytesPerElement=16,yt("StructArrayLayout2f1f2i16",v);class i extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,l,f,m,x,b){const T=this.length;return this.resize(T+1),this.emplace(T,a,l,f,m,x,b)}emplace(a,l,f,m,x,b,T){const A=16*a,O=4*a,D=8*a;return this.uint8[A+0]=l,this.uint8[A+1]=f,this.float32[O+1]=m,this.float32[O+2]=x,this.int16[D+6]=b,this.int16[D+7]=T,a}}i.prototype.bytesPerElement=16,yt("StructArrayLayout2ub2f2i16",i);class u extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,f){const m=this.length;return this.resize(m+1),this.emplace(m,a,l,f)}emplace(a,l,f,m){const x=3*a;return this.uint16[x+0]=l,this.uint16[x+1]=f,this.uint16[x+2]=m,a}}u.prototype.bytesPerElement=6,yt("StructArrayLayout3ui6",u);class p extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,m,x,b,T,A,O,D,B,K,Y,J,te,ae,ce){const Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,a,l,f,m,x,b,T,A,O,D,B,K,Y,J,te,ae,ce)}emplace(a,l,f,m,x,b,T,A,O,D,B,K,Y,J,te,ae,ce,Pe){const ge=24*a,ve=12*a,Ne=48*a;return this.int16[ge+0]=l,this.int16[ge+1]=f,this.uint16[ge+2]=m,this.uint16[ge+3]=x,this.uint32[ve+2]=b,this.uint32[ve+3]=T,this.uint32[ve+4]=A,this.uint16[ge+10]=O,this.uint16[ge+11]=D,this.uint16[ge+12]=B,this.float32[ve+7]=K,this.float32[ve+8]=Y,this.uint8[Ne+36]=J,this.uint8[Ne+37]=te,this.uint8[Ne+38]=ae,this.uint32[ve+10]=ce,this.int16[ge+22]=Pe,a}}p.prototype.bytesPerElement=48,yt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",p);class g extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,m,x,b,T,A,O,D,B,K,Y,J,te,ae,ce,Pe,ge,ve,Ne,Fe,Qe,ft,st,ut,Tt,ct){const ht=this.length;return this.resize(ht+1),this.emplace(ht,a,l,f,m,x,b,T,A,O,D,B,K,Y,J,te,ae,ce,Pe,ge,ve,Ne,Fe,Qe,ft,st,ut,Tt,ct)}emplace(a,l,f,m,x,b,T,A,O,D,B,K,Y,J,te,ae,ce,Pe,ge,ve,Ne,Fe,Qe,ft,st,ut,Tt,ct,ht){const He=32*a,Ot=16*a;return this.int16[He+0]=l,this.int16[He+1]=f,this.int16[He+2]=m,this.int16[He+3]=x,this.int16[He+4]=b,this.int16[He+5]=T,this.int16[He+6]=A,this.int16[He+7]=O,this.uint16[He+8]=D,this.uint16[He+9]=B,this.uint16[He+10]=K,this.uint16[He+11]=Y,this.uint16[He+12]=J,this.uint16[He+13]=te,this.uint16[He+14]=ae,this.uint16[He+15]=ce,this.uint16[He+16]=Pe,this.uint16[He+17]=ge,this.uint16[He+18]=ve,this.uint16[He+19]=Ne,this.uint16[He+20]=Fe,this.uint16[He+21]=Qe,this.uint16[He+22]=ft,this.uint32[Ot+12]=st,this.float32[Ot+13]=ut,this.float32[Ot+14]=Tt,this.uint16[He+30]=ct,this.uint16[He+31]=ht,a}}g.prototype.bytesPerElement=64,yt("StructArrayLayout8i15ui1ul2f2ui64",g);class _ extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.float32[1*a+0]=l,a}}_.prototype.bytesPerElement=4,yt("StructArrayLayout1f4",_);class S extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f){const m=this.length;return this.resize(m+1),this.emplace(m,a,l,f)}emplace(a,l,f,m){const x=3*a;return this.uint16[6*a+0]=l,this.float32[x+1]=f,this.float32[x+2]=m,a}}S.prototype.bytesPerElement=12,yt("StructArrayLayout1ui2f12",S);class C extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l,f){const m=this.length;return this.resize(m+1),this.emplace(m,a,l,f)}emplace(a,l,f,m){const x=4*a;return this.uint32[2*a+0]=l,this.uint16[x+2]=f,this.uint16[x+3]=m,a}}C.prototype.bytesPerElement=8,yt("StructArrayLayout1ul2ui8",C);class M extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,l){const f=this.length;return this.resize(f+1),this.emplace(f,a,l)}emplace(a,l,f){const m=2*a;return this.uint16[m+0]=l,this.uint16[m+1]=f,a}}M.prototype.bytesPerElement=4,yt("StructArrayLayout2ui4",M);class R extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const l=this.length;return this.resize(l+1),this.emplace(l,a)}emplace(a,l){return this.uint16[1*a+0]=l,a}}R.prototype.bytesPerElement=2,yt("StructArrayLayout1ui2",R);class $ extends vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,l,f,m){const x=this.length;return this.resize(x+1),this.emplace(x,a,l,f,m)}emplace(a,l,f,m,x){const b=4*a;return this.float32[b+0]=l,this.float32[b+1]=f,this.float32[b+2]=m,this.float32[b+3]=x,a}}$.prototype.bytesPerElement=16,yt("StructArrayLayout4f16",$);class G extends Rc{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new y(this.anchorPointX,this.anchorPointY)}}G.prototype.size=20;class V extends dh{get(a){return new G(this,a)}}yt("CollisionBoxArray",V);class X extends Rc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(a){this._structArray.uint8[this._pos1+37]=a}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(a){this._structArray.uint8[this._pos1+38]=a}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(a){this._structArray.uint32[this._pos4+10]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}X.prototype.size=48;class Q extends p{get(a){return new X(this,a)}}yt("PlacedSymbolArray",Q);class se extends Rc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(a){this._structArray.uint32[this._pos4+12]=a}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}se.prototype.size=64;class oe extends g{get(a){return new se(this,a)}}yt("SymbolInstanceArray",oe);class le extends _{getoffsetX(a){return this.float32[1*a+0]}}yt("GlyphOffsetArray",le);class ue extends _l{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}yt("SymbolLineVertexArray",ue);class me extends Rc{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}me.prototype.size=12;class de extends S{get(a){return new me(this,a)}}yt("TextAnchorOffsetArray",de);class ye extends Rc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ye.prototype.size=8;class xe extends C{get(a){return new ye(this,a)}}yt("FeatureIndexArray",xe);class pe extends vl{}class ke extends vl{}class ze extends vl{}class je extends xl{}class De extends vs{}class $e extends Nc{}class at extends hh{}class lt extends _s{}class Ye extends rp{}class xt extends np{}class qt extends ip{}class hr extends i{}class _r extends u{}class gr extends M{}const $r=en([{name:"a_pos",components:2,type:"Int16"}],4),{members:Gr}=$r;class Ut{constructor(a=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=a}prepareSegment(a,l,f,m){const x=this.segments[this.segments.length-1];return a>Ut.MAX_VERTEX_ARRAY_LENGTH&&It(`Max vertices per segment is ${Ut.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ut.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!x||x.vertexLength+a>Ut.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==m?this.createNewSegment(l,f,m):x}createNewSegment(a,l,f){const m={vertexOffset:a.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0,vaos:{}};return f!==void 0&&(m.sortKey=f),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(m),m}getOrCreateLatestSegment(a,l,f){return this.prepareSegment(0,a,l,f)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const a of this.segments)for(const l in a.vaos)a.vaos[l].destroy()}static simpleSegment(a,l,f,m){return new Ut([{vertexOffset:a,primitiveOffset:l,vertexLength:f,primitiveLength:m,vaos:{},sortKey:0}])}}function xr(c,a){return 256*(c=Nt(Math.floor(c),0,255))+Nt(Math.floor(a),0,255)}Ut.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,yt("SegmentVector",Ut);const hn=en([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var xn,En,di,ma={exports:{}},zo={exports:{}},Lo={exports:{}},bl=function(){if(di)return ma.exports;di=1;var c=(xn||(xn=1,zo.exports=function(l,f){var m,x,b,T,A,O,D,B;for(x=l.length-(m=3&l.length),b=f,A=3432918353,O=461845907,B=0;B<x;)D=255&l.charCodeAt(B)|(255&l.charCodeAt(++B))<<8|(255&l.charCodeAt(++B))<<16|(255&l.charCodeAt(++B))<<24,++B,b=27492+(65535&(T=5*(65535&(b=(b^=D=(65535&(D=(D=(65535&D)*A+(((D>>>16)*A&65535)<<16)&4294967295)<<15|D>>>17))*O+(((D>>>16)*O&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(D=0,m){case 3:D^=(255&l.charCodeAt(B+2))<<16;case 2:D^=(255&l.charCodeAt(B+1))<<8;case 1:b^=D=(65535&(D=(D=(65535&(D^=255&l.charCodeAt(B)))*A+(((D>>>16)*A&65535)<<16)&4294967295)<<15|D>>>17))*O+(((D>>>16)*O&65535)<<16)&4294967295}return b^=l.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}),zo.exports),a=(En||(En=1,Lo.exports=function(l,f){for(var m,x=l.length,b=f^x,T=0;x>=4;)m=1540483477*(65535&(m=255&l.charCodeAt(T)|(255&l.charCodeAt(++T))<<8|(255&l.charCodeAt(++T))<<16|(255&l.charCodeAt(++T))<<24))+((1540483477*(m>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),x-=4,++T;switch(x){case 3:b^=(255&l.charCodeAt(T+2))<<16;case 2:b^=(255&l.charCodeAt(T+1))<<8;case 1:b=1540483477*(65535&(b^=255&l.charCodeAt(T)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}),Lo.exports);return ma.exports=c,ma.exports.murmur3=c,ma.exports.murmur2=a,ma.exports}(),wl=w(bl);class xs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,l,f,m){this.ids.push(bs(a)),this.positions.push(l,f,m)}getPositions(a){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const l=bs(a);let f=0,m=this.ids.length-1;for(;f<m;){const b=f+m>>1;this.ids[b]>=l?m=b:f=b+1}const x=[];for(;this.ids[f]===l;)x.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return x}static serialize(a,l){const f=new Float64Array(a.ids),m=new Uint32Array(a.positions);return Pi(f,m,0,f.length-1),l&&l.push(f.buffer,m.buffer),{ids:f,positions:m}}static deserialize(a){const l=new xs;return l.ids=a.ids,l.positions=a.positions,l.indexed=!0,l}}function bs(c){const a=+c;return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER?a:wl(String(c))}function Pi(c,a,l,f){for(;l<f;){const m=c[l+f>>1];let x=l-1,b=f+1;for(;;){do x++;while(c[x]<m);do b--;while(c[b]>m);if(x>=b)break;ga(c,x,b),ga(a,3*x,3*b),ga(a,3*x+1,3*b+1),ga(a,3*x+2,3*b+2)}b-l<f-b?(Pi(c,a,l,b),l=b+1):(Pi(c,a,b+1,f),f=b)}}function ga(c,a,l){const f=c[a];c[a]=c[l],c[l]=f}yt("FeaturePositionMap",xs);class fi{constructor(a,l){this.gl=a.gl,this.location=l}}class Bo extends fi{constructor(a,l){super(a,l),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class dn extends fi{constructor(a,l){super(a,l),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class bn extends fi{constructor(a,l){super(a,l),this.current=Xt.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}const Xi=new Float32Array(16);function fn(c){return[xr(255*c.r,255*c.g),xr(255*c.b,255*c.a)]}class $c{constructor(a,l,f){this.value=a,this.uniformNames=l.map(m=>`u_${m}`),this.type=f}setUniform(a,l,f){a.set(f.constantOr(this.value))}getBinding(a,l,f){return this.type==="color"?new bn(a,l):new Bo(a,l)}}class Sl{constructor(a,l){this.uniformNames=l.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=a.tlbr}setUniform(a,l,f,m){const x=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&a.set(x)}getBinding(a,l,f){return f.substr(0,9)==="u_pattern"?new dn(a,l):new Bo(a,l)}}class io{constructor(a,l,f,m){this.expression=a,this.type=f,this.maxValue=0,this.paintVertexAttributes=l.map(x=>({name:`a_${x}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(a,l,f){const m=this.paintVertexArray.length,x=this.expression.evaluate(new kr(0,f),l,{},f.canonical,[],f.formattedSection);this.paintVertexArray.resize(a),this._setPaintValue(m,a,x)}updatePaintArray(a,l,f,m,x){const b=this.expression.evaluate(new kr(0,x),f,m);this._setPaintValue(a,l,b)}_setPaintValue(a,l,f){if(this.type==="color"){const m=fn(f);for(let x=a;x<l;x++)this.paintVertexArray.emplace(x,m[0],m[1])}else{for(let m=a;m<l;m++)this.paintVertexArray.emplace(m,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ya{constructor(a,l,f,m,x,b){this.expression=a,this.uniformNames=l.map(T=>`u_${T}_t`),this.type=f,this.useIntegerZoom=m,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=l.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(a,l,f){const m=this.expression.evaluate(new kr(this.zoom,f),l,{},f.canonical,[],f.formattedSection),x=this.expression.evaluate(new kr(this.zoom+1,f),l,{},f.canonical,[],f.formattedSection),b=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(b,a,m,x)}updatePaintArray(a,l,f,m,x){const b=this.expression.evaluate(new kr(this.zoom,x),f,m),T=this.expression.evaluate(new kr(this.zoom+1,x),f,m);this._setPaintValue(a,l,b,T)}_setPaintValue(a,l,f,m){if(this.type==="color"){const x=fn(f),b=fn(m);for(let T=a;T<l;T++)this.paintVertexArray.emplace(T,x[0],x[1],b[0],b[1])}else{for(let x=a;x<l;x++)this.paintVertexArray.emplace(x,f,m);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(m))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,l){const f=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,m=Nt(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);a.set(m)}getBinding(a,l,f){return new Bo(a,l)}}class Fo{constructor(a,l,f,m,x,b){this.expression=a,this.type=l,this.useIntegerZoom=f,this.zoom=m,this.layerId=b,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(a,l,f){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(m,a,l.patterns&&l.patterns[this.layerId],f.imagePositions)}updatePaintArray(a,l,f,m,x){this._setPaintValues(a,l,f.patterns&&f.patterns[this.layerId],x.imagePositions)}_setPaintValues(a,l,f,m){if(!m||!f)return;const{min:x,mid:b,max:T}=f,A=m[x],O=m[b],D=m[T];if(A&&O&&D)for(let B=a;B<l;B++)this.zoomInPaintVertexArray.emplace(B,O.tl[0],O.tl[1],O.br[0],O.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],O.pixelRatio,A.pixelRatio),this.zoomOutPaintVertexArray.emplace(B,O.tl[0],O.tl[1],O.br[0],O.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],O.pixelRatio,D.pixelRatio)}upload(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,hn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,hn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class ky{constructor(a,l,f){this.binders={},this._buffers=[];const m=[];for(const x in a.paint._values){if(!f(x))continue;const b=a.paint.get(x);if(!(b instanceof $a&&Ro(b.property.specification)))continue;const T=Ey(x,a.type),A=b.value,O=b.property.specification.type,D=b.property.useIntegerZoom,B=b.property.specification["property-type"],K=B==="cross-faded"||B==="cross-faded-data-driven";if(A.kind==="constant")this.binders[x]=K?new Sl(A.value,T):new $c(A.value,T,O),m.push(`/u_${x}`);else if(A.kind==="source"||K){const Y=ap(x,O,"source");this.binders[x]=K?new Fo(A,O,D,l,Y,a.id):new io(A,T,O,Y),m.push(`/a_${x}`)}else{const Y=ap(x,O,"composite");this.binders[x]=new ya(A,T,O,D,l,Y),m.push(`/z_${x}`)}}this.cacheKey=m.sort().join("")}getMaxValue(a){const l=this.binders[a];return l instanceof io||l instanceof ya?l.maxValue:0}populatePaintArrays(a,l,f){for(const m in this.binders){const x=this.binders[m];(x instanceof io||x instanceof ya||x instanceof Fo)&&x.populatePaintArray(a,l,f)}}setConstantPatternPositions(a,l){for(const f in this.binders){const m=this.binders[f];m instanceof Sl&&m.setConstantPatternPositions(a,l)}}updatePaintArrays(a,l,f,m,x){let b=!1;for(const T in a){const A=l.getPositions(T);for(const O of A){const D=f.feature(O.index);for(const B in this.binders){const K=this.binders[B];if((K instanceof io||K instanceof ya||K instanceof Fo)&&K.expression.isStateDependent===!0){const Y=m.paint.get(B);K.expression=Y.value,K.updatePaintArray(O.start,O.end,D,a[T],x),b=!0}}}}return b}defines(){const a=[];for(const l in this.binders){const f=this.binders[l];(f instanceof $c||f instanceof Sl)&&a.push(...f.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return a}getBinderAttributes(){const a=[];for(const l in this.binders){const f=this.binders[l];if(f instanceof io||f instanceof ya)for(let m=0;m<f.paintVertexAttributes.length;m++)a.push(f.paintVertexAttributes[m].name);else if(f instanceof Fo)for(let m=0;m<hn.members.length;m++)a.push(hn.members[m].name)}return a}getBinderUniforms(){const a=[];for(const l in this.binders){const f=this.binders[l];if(f instanceof $c||f instanceof Sl||f instanceof ya)for(const m of f.uniformNames)a.push(m)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,l){const f=[];for(const m in this.binders){const x=this.binders[m];if(x instanceof $c||x instanceof Sl||x instanceof ya){for(const b of x.uniformNames)if(l[b]){const T=x.getBinding(a,l[b],b);f.push({name:b,property:m,binding:T})}}}return f}setUniforms(a,l,f,m){for(const{name:x,property:b,binding:T}of l)this.binders[b].setUniform(T,m,f.get(b),x)}updatePaintBuffers(a){this._buffers=[];for(const l in this.binders){const f=this.binders[l];if(a&&f instanceof Fo){const m=a.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(f instanceof io||f instanceof ya)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(a){for(const l in this.binders){const f=this.binders[l];(f instanceof io||f instanceof ya||f instanceof Fo)&&f.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const l=this.binders[a];(l instanceof io||l instanceof ya||l instanceof Fo)&&l.destroy()}}}class Ni{constructor(a,l,f=()=>!0){this.programConfigurations={};for(const m of a)this.programConfigurations[m.id]=new ky(m,l,f);this.needsUpload=!1,this._featureMap=new xs,this._bufferOffset=0}populatePaintArrays(a,l,f,m){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(a,l,m);l.id!==void 0&&this._featureMap.add(l.id,f,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,l,f,m){for(const x of f)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(a,this._featureMap,l,x,m)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}function Ey(c,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${a}-`,"").replace(/-/g,"_")]}function ap(c,a,l){const f={color:{source:Nc,composite:$},number:{source:_,composite:Nc}},m=function(x){return{"line-pattern":{source:at,composite:at},"fill-pattern":{source:at,composite:at},"fill-extrusion-pattern":{source:at,composite:at}}[x]}(c);return m&&m[l]||f[a][l]}yt("ConstantBinder",$c),yt("CrossFadedConstantBinder",Sl),yt("SourceExpressionBinder",io),yt("CrossFadedCompositeBinder",Fo),yt("CompositeExpressionBinder",ya),yt("ProgramConfiguration",ky,{omit:["_buffers"]}),yt("ProgramConfigurationSet",Ni);const fh=Math.pow(2,14)-1,ph=-fh-1;function Uo(c){const a=Be/c.extent,l=c.loadGeometry();for(let f=0;f<l.length;f++){const m=l[f];for(let x=0;x<m.length;x++){const b=m[x],T=Math.round(b.x*a),A=Math.round(b.y*a);b.x=Nt(T,ph,fh),b.y=Nt(A,ph,fh),(T<b.x||T>b.x+1||A<b.y||A>b.y+1)&&It("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function ao(c,a){return{type:c.type,id:c.id,properties:c.properties,geometry:a?Uo(c):[]}}const MT=-32768;function uz(c,a,l,f,m){c.emplaceBack(MT+8*a+f,MT+8*l+m)}class Zx{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new ke,this.indexArray=new _r,this.segments=new Ut,this.programConfigurations=new Ni(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(a,l,f){const m=this.layers[0],x=[];let b=null,T=!1,A=m.type==="heatmap";if(m.type==="circle"){const D=m;b=D.layout.get("circle-sort-key"),T=!b.isConstant(),A=A||D.paint.get("circle-pitch-alignment")==="map"}const O=A?l.subdivisionGranularity.circle:1;for(const{feature:D,id:B,index:K,sourceLayerIndex:Y}of a){const J=this.layers[0]._featureFilter.needGeometry,te=ao(D,J);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom,{globalState:this.globalState}),te,f))continue;const ae=T?b.evaluate(te,{},f):void 0,ce={id:B,properties:D.properties,type:D.type,sourceLayerIndex:Y,index:K,geometry:J?te.geometry:Uo(D),patterns:{},sortKey:ae};x.push(ce)}T&&x.sort((D,B)=>D.sortKey-B.sortKey);for(const D of x){const{geometry:B,index:K,sourceLayerIndex:Y}=D,J=a[K].feature;this.addFeature(D,B,K,f,O),l.featureIndex.insert(J,B,K,Y,this.index)}}update(a,l,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,l,this.stateDependentLayers,{imagePositions:f,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Gr),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,l,f,m,x=1){let b;switch(x){case 1:b=[0,7];break;case 3:b=[0,2,5,7];break;case 5:b=[0,1,3,4,6,7];break;case 7:b=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${x}; valid values are 1, 3, 5, 7.`)}const T=b.length;for(const A of l)for(const O of A){const D=O.x,B=O.y;if(D<0||D>=Be||B<0||B>=Be)continue;const K=this.segments.prepareSegment(T*T,this.layoutVertexArray,this.indexArray,a.sortKey),Y=K.vertexLength;for(let J=0;J<T;J++)for(let te=0;te<T;te++)uz(this.layoutVertexArray,D,B,b[te],b[J]);for(let J=0;J<T-1;J++)for(let te=0;te<T-1;te++){const ae=Y+J*T+te,ce=Y+(J+1)*T+te;this.indexArray.emplaceBack(ae,ce+1,ae+1),this.indexArray.emplaceBack(ae,ce,ce+1)}K.vertexLength+=T*T,K.primitiveLength+=(T-1)*(T-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{imagePositions:{},canonical:m,globalState:this.globalState})}}function IT(c,a){for(let l=0;l<c.length;l++)if(mh(a,c[l]))return!0;for(let l=0;l<a.length;l++)if(mh(c,a[l]))return!0;return!!Kx(c,a)}function hz(c,a,l){return!!mh(c,a)||!!Xx(a,c,l)}function jT(c,a){if(c.length===1)return DT(a,c[0]);for(let l=0;l<a.length;l++){const f=a[l];for(let m=0;m<f.length;m++)if(mh(c,f[m]))return!0}for(let l=0;l<c.length;l++)if(DT(a,c[l]))return!0;for(let l=0;l<a.length;l++)if(Kx(c,a[l]))return!0;return!1}function dz(c,a,l){if(c.length>1){if(Kx(c,a))return!0;for(let f=0;f<a.length;f++)if(Xx(a[f],c,l))return!0}for(let f=0;f<c.length;f++)if(Xx(c[f],a,l))return!0;return!1}function Kx(c,a){if(c.length===0||a.length===0)return!1;for(let l=0;l<c.length-1;l++){const f=c[l],m=c[l+1];for(let x=0;x<a.length-1;x++)if(fz(f,m,a[x],a[x+1]))return!0}return!1}function fz(c,a,l,f){return fr(c,l,f)!==fr(a,l,f)&&fr(c,a,l)!==fr(c,a,f)}function Xx(c,a,l){const f=l*l;if(a.length===1)return c.distSqr(a[0])<f;for(let m=1;m<a.length;m++)if(OT(c,a[m-1],a[m])<f)return!0;return!1}function OT(c,a,l){const f=a.distSqr(l);if(f===0)return c.distSqr(a);const m=((c.x-a.x)*(l.x-a.x)+(c.y-a.y)*(l.y-a.y))/f;return c.distSqr(m<0?a:m>1?l:l.sub(a)._mult(m)._add(a))}function DT(c,a){let l,f,m,x=!1;for(let b=0;b<c.length;b++){l=c[b];for(let T=0,A=l.length-1;T<l.length;A=T++)f=l[T],m=l[A],f.y>a.y!=m.y>a.y&&a.x<(m.x-f.x)*(a.y-f.y)/(m.y-f.y)+f.x&&(x=!x)}return x}function mh(c,a){let l=!1;for(let f=0,m=c.length-1;f<c.length;m=f++){const x=c[f],b=c[m];x.y>a.y!=b.y>a.y&&a.x<(b.x-x.x)*(a.y-x.y)/(b.y-x.y)+x.x&&(l=!l)}return l}function pz(c,a,l){const f=l[0],m=l[2];if(c.x<f.x&&a.x<f.x||c.x>m.x&&a.x>m.x||c.y<f.y&&a.y<f.y||c.y>m.y&&a.y>m.y)return!1;const x=fr(c,a,l[0]);return x!==fr(c,a,l[1])||x!==fr(c,a,l[2])||x!==fr(c,a,l[3])}function op(c,a,l){const f=a.paint.get(c).value;return f.kind==="constant"?f.value:l.programConfigurations.get(a.id).getMaxValue(c)}function Ay(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Cy(c,a,l,f,m){if(!a[0]&&!a[1])return c;const x=y.convert(a)._mult(m);l==="viewport"&&x._rotate(-f);const b=[];for(let T=0;T<c.length;T++)b.push(c[T].sub(x));return b}let RT,NT;yt("CircleBucket",Zx,{omit:["layers"]});var mz={get paint(){return NT=NT||new hi({"circle-radius":new Mt(Ce.paint_circle["circle-radius"]),"circle-color":new Mt(Ce.paint_circle["circle-color"]),"circle-blur":new Mt(Ce.paint_circle["circle-blur"]),"circle-opacity":new Mt(Ce.paint_circle["circle-opacity"]),"circle-translate":new St(Ce.paint_circle["circle-translate"]),"circle-translate-anchor":new St(Ce.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new St(Ce.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new St(Ce.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Mt(Ce.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Mt(Ce.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Mt(Ce.paint_circle["circle-stroke-opacity"])})},get layout(){return RT=RT||new hi({"circle-sort-key":new Mt(Ce.layout_circle["circle-sort-key"])})}};class gz extends Ki{constructor(a){super(a,mz)}createBucket(a){return new Zx(a)}queryRadius(a){const l=a;return op("circle-radius",this,l)+op("circle-stroke-width",this,l)+Ay(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:a,feature:l,featureState:f,geometry:m,transform:x,pixelsToTileUnits:b,unwrappedTileID:T,getElevation:A}){const O=Cy(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-x.bearingInRadians,b),D=this.paint.get("circle-radius").evaluate(l,f)+this.paint.get("circle-stroke-width").evaluate(l,f),B=this.paint.get("circle-pitch-alignment")==="map",K=B?O:function(J,te,ae,ce){return J.map(Pe=>$T(Pe,te,ae,ce))}(O,x,T,A),Y=B?D*b:D;for(const J of m)for(const te of J){const ae=B?te:$T(te,x,T,A);let ce=Y;const Pe=x.projectTileCoordinates(te.x,te.y,T,A).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ce*=Pe/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ce*=x.cameraToCenterDistance/Pe),hz(K,ae,ce))return!0}return!1}}function $T(c,a,l,f){const m=a.projectTileCoordinates(c.x,c.y,l,f).point;return new y((.5*m.x+.5)*a.width,(.5*-m.y+.5)*a.height)}class zT extends Zx{}let LT;yt("HeatmapBucket",zT,{omit:["layers"]});var yz={get paint(){return LT=LT||new hi({"heatmap-radius":new Mt(Ce.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Mt(Ce.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new St(Ce.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ch(Ce.paint_heatmap["heatmap-color"]),"heatmap-opacity":new St(Ce.paint_heatmap["heatmap-opacity"])})}};function Yx(c,{width:a,height:l},f,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==a*l*f)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${a*l*f}`)}else m=new Uint8Array(a*l*f);return c.width=a,c.height=l,c.data=m,c}function BT(c,{width:a,height:l},f){if(a===c.width&&l===c.height)return;const m=Yx({},{width:a,height:l},f);Jx(c,m,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,a),height:Math.min(c.height,l)},f),c.width=a,c.height=l,c.data=m.data}function Jx(c,a,l,f,m,x){if(m.width===0||m.height===0)return a;if(m.width>c.width||m.height>c.height||l.x>c.width-m.width||l.y>c.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>a.width||m.height>a.height||f.x>a.width-m.width||f.y>a.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const b=c.data,T=a.data;if(b===T)throw new Error("srcData equals dstData, so image is already copied");for(let A=0;A<m.height;A++){const O=((l.y+A)*c.width+l.x)*x,D=((f.y+A)*a.width+f.x)*x;for(let B=0;B<m.width*x;B++)T[D+B]=b[O+B]}return a}class sp{constructor(a,l){Yx(this,a,1,l)}resize(a){BT(this,a,1)}clone(){return new sp({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,l,f,m,x){Jx(a,l,f,m,x,1)}}class $i{constructor(a,l){Yx(this,a,4,l)}resize(a){BT(this,a,4)}replace(a,l){l?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new $i({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,l,f,m,x){Jx(a,l,f,m,x,4)}setPixel(a,l,f){const m=4*(a*this.width+l);this.data[m+0]=Math.round(255*f.r/f.a),this.data[m+1]=Math.round(255*f.g/f.a),this.data[m+2]=Math.round(255*f.b/f.a),this.data[m+3]=Math.round(255*f.a)}}function FT(c){const a={},l=c.resolution||256,f=c.clips?c.clips.length:1,m=c.image||new $i({width:l,height:f});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);const x=(b,T,A)=>{a[c.evaluationKey]=A;const O=c.expression.evaluate(a);m.setPixel(b/4/l,T/4,O)};if(c.clips)for(let b=0,T=0;b<f;++b,T+=4*l)for(let A=0,O=0;A<l;A++,O+=4){const D=A/(l-1),{start:B,end:K}=c.clips[b];x(T,O,B*(1-D)+K*D)}else for(let b=0,T=0;b<l;b++,T+=4)x(0,T,b/(l-1));return m}yt("AlphaImage",sp),yt("RGBAImage",$i);const Qx="big-fb";class vz extends Ki{createBucket(a){return new zT(a)}constructor(a){super(a,yz),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=FT({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Qx)&&this.heatmapFbos.delete(Qx)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let UT;var _z={get paint(){return UT=UT||new hi({"hillshade-illumination-direction":new St(Ce.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new St(Ce.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new St(Ce.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new St(Ce.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new St(Ce.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new St(Ce.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new St(Ce.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new St(Ce.paint_hillshade["hillshade-method"])})}};class xz extends Ki{constructor(a){super(a,_z),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let a=this.paint.get("hillshade-illumination-direction").values,l=this.paint.get("hillshade-illumination-altitude").values,f=this.paint.get("hillshade-highlight-color").values,m=this.paint.get("hillshade-shadow-color").values;const x=Math.max(a.length,l.length,f.length,m.length);a=a.concat(Array(x-a.length).fill(a.at(-1))),l=l.concat(Array(x-l.length).fill(l.at(-1))),f=f.concat(Array(x-f.length).fill(f.at(-1))),m=m.concat(Array(x-m.length).fill(m.at(-1)));const b=l.map(Ia);return{directionRadians:a.map(Ia),altitudeRadians:b,shadowColor:m,highlightColor:f}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let VT;var bz={get paint(){return VT=VT||new hi({"color-relief-opacity":new St(Ce["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new ch(Ce["paint_color-relief"]["color-relief-color"])})}};class eb{constructor(a,l,f,m){this.context=a,this.format=f,this.texture=a.gl.createTexture(),this.update(l,m)}update(a,l,f){const{width:m,height:x}=a,b=!(this.size&&this.size[0]===m&&this.size[1]===x||f),{context:T}=this,{gl:A}=T;if(this.useMipmap=!!(l&&l.useMipmap),A.bindTexture(A.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!l||l.premultiply!==!1)),b)this.size=[m,x],a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||yn(a)?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,a):A.texImage2D(A.TEXTURE_2D,0,this.format,m,x,0,this.format,A.UNSIGNED_BYTE,a.data);else{const{x:O,y:D}=f||{x:0,y:0};a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||yn(a)?A.texSubImage2D(A.TEXTURE_2D,0,O,D,A.RGBA,A.UNSIGNED_BYTE,a):A.texSubImage2D(A.TEXTURE_2D,0,O,D,m,x,A.RGBA,A.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&A.generateMipmap(A.TEXTURE_2D),T.pixelStoreUnpackFlipY.setDefault(),T.pixelStoreUnpack.setDefault(),T.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(a,l,f){const{context:m}=this,{gl:x}=m;x.bindTexture(x.TEXTURE_2D,this.texture),f!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=x.LINEAR),a!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,a),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,f||a),this.filter=a),l!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,l),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class GT{constructor(a,l,f,m=1,x=1,b=1,T=0){if(this.uid=a,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void It(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=l.height;const A=this.dim=l.height-2;switch(this.data=new Uint32Array(l.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=x,this.blueFactor=b,this.baseShift=T;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let O=0;O<A;O++)this.data[this._idx(-1,O)]=this.data[this._idx(0,O)],this.data[this._idx(A,O)]=this.data[this._idx(A-1,O)],this.data[this._idx(O,-1)]=this.data[this._idx(O,0)],this.data[this._idx(O,A)]=this.data[this._idx(O,A-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(A,-1)]=this.data[this._idx(A-1,0)],this.data[this._idx(-1,A)]=this.data[this._idx(0,A-1)],this.data[this._idx(A,A)]=this.data[this._idx(A-1,A-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let O=0;O<A;O++)for(let D=0;D<A;D++){const B=this.get(O,D);B>this.max&&(this.max=B),B<this.min&&(this.min=B)}}get(a,l){const f=new Uint8Array(this.data.buffer),m=4*this._idx(a,l);return this.unpack(f[m],f[m+1],f[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(a,l){if(a<-1||a>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(a+1)}unpack(a,l,f){return a*this.redFactor+l*this.greenFactor+f*this.blueFactor-this.baseShift}pack(a){return qT(a,this.getUnpackVector())}getPixels(){return new $i({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,l,f){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let m=l*this.dim,x=l*this.dim+this.dim,b=f*this.dim,T=f*this.dim+this.dim;switch(l){case-1:m=x-1;break;case 1:x=m+1}switch(f){case-1:b=T-1;break;case 1:T=b+1}const A=-l*this.dim,O=-f*this.dim;for(let D=b;D<T;D++)for(let B=m;B<x;B++)this.data[this._idx(B,D)]=a.data[this._idx(B+A,D+O)]}}function qT(c,a){const l=a[0],f=a[1],m=a[2],x=a[3],b=Math.min(l,f,m),T=Math.round((c+x)/b);return{r:Math.floor(T*b/l)%256,g:Math.floor(T*b/f)%256,b:Math.floor(T*b/m)%256}}yt("DEMData",GT);class wz extends Ki{constructor(a){super(a,bz)}_createColorRamp(a){const l={elevationStops:[],colorStops:[]},f=this._transitionablePaint._values["color-relief-color"].value.expression;if(f instanceof Ec&&f._styleExpression.expression instanceof zn){this.colorRampExpression=f;const b=f._styleExpression.expression;l.elevationStops=b.labels,l.colorStops=[];for(const T of l.elevationStops)l.colorStops.push(b.evaluate({globals:{elevation:T}}))}if(l.elevationStops.length<1&&(l.elevationStops=[0],l.colorStops=[Xt.transparent]),l.elevationStops.length<2&&(l.elevationStops.push(l.elevationStops[0]+1),l.colorStops.push(l.colorStops[0])),l.elevationStops.length<=a)return l;const m={elevationStops:[],colorStops:[]},x=(l.elevationStops.length-1)/(a-1);for(let b=0;b<l.elevationStops.length-.5;b+=x)m.elevationStops.push(l.elevationStops[Math.round(b)]),m.colorStops.push(l.colorStops[Math.round(b)]);return It(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),m}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(a,l,f){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const m=this._createColorRamp(l),x=new $i({width:m.colorStops.length,height:1}),b=new $i({width:m.colorStops.length,height:1});for(let T=0;T<m.elevationStops.length;T++){const A=qT(m.elevationStops[T],f);b.setPixel(0,T,new Xt(A.r/255,A.g/255,A.b/255,1)),x.setPixel(0,T,m.colorStops[T])}return this.colorRampTextures={elevationTexture:new eb(a,b,a.gl.RGBA),colorTexture:new eb(a,x,a.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Sz=en([{name:"a_pos",components:2,type:"Int16"}],4),{members:Pz}=Sz;function tb(c,a,l){const f=l.patternDependencies;let m=!1;for(const x of a){const b=x.paint.get(`${c}-pattern`);b.isConstant()||(m=!0);const T=b.constantOr(null);T&&(m=!0,f[T.to]=!0,f[T.from]=!0)}return m}function rb(c,a,l,f,m){const x=m.patternDependencies;for(const b of a){const T=b.paint.get(`${c}-pattern`).value;if(T.kind!=="constant"){let A=T.evaluate({zoom:f-1},l,{},m.availableImages),O=T.evaluate({zoom:f},l,{},m.availableImages),D=T.evaluate({zoom:f+1},l,{},m.availableImages);A=A&&A.name?A.name:A,O=O&&O.name?O.name:O,D=D&&D.name?D.name:D,x[A]=!0,x[O]=!0,x[D]=!0,l.patterns[b.id]={min:A,mid:O,max:D}}}return l}function WT(c,a,l,f,m){let x;if(m===function(b,T,A,O){let D=0;for(let B=T,K=A-O;B<A;B+=O)D+=(b[K]-b[B])*(b[B+1]+b[K+1]),K=B;return D}(c,a,l,f)>0)for(let b=a;b<l;b+=f)x=XT(b/f|0,c[b],c[b+1],x);else for(let b=l-f;b>=a;b-=f)x=XT(b/f|0,c[b],c[b+1],x);return x&&gh(x,x.next)&&(hp(x),x=x.next),x}function zc(c,a){if(!c)return c;a||(a=c);let l,f=c;do if(l=!1,f.steiner||!gh(f,f.next)&&an(f.prev,f,f.next)!==0)f=f.next;else{if(hp(f),f=a=f.prev,f===f.next)break;l=!0}while(l||f!==a);return a}function lp(c,a,l,f,m,x,b){if(!c)return;!b&&x&&function(A,O,D,B){let K=A;do K.z===0&&(K.z=nb(K.x,K.y,O,D,B)),K.prevZ=K.prev,K.nextZ=K.next,K=K.next;while(K!==A);K.prevZ.nextZ=null,K.prevZ=null,function(Y){let J,te=1;do{let ae,ce=Y;Y=null;let Pe=null;for(J=0;ce;){J++;let ge=ce,ve=0;for(let Fe=0;Fe<te&&(ve++,ge=ge.nextZ,ge);Fe++);let Ne=te;for(;ve>0||Ne>0&&ge;)ve!==0&&(Ne===0||!ge||ce.z<=ge.z)?(ae=ce,ce=ce.nextZ,ve--):(ae=ge,ge=ge.nextZ,Ne--),Pe?Pe.nextZ=ae:Y=ae,ae.prevZ=Pe,Pe=ae;ce=ge}Pe.nextZ=null,te*=2}while(J>1)}(K)}(c,f,m,x);let T=c;for(;c.prev!==c.next;){const A=c.prev,O=c.next;if(x?kz(c,f,m,x):Tz(c))a.push(A.i,c.i,O.i),hp(c),c=O.next,T=O.next;else if((c=O)===T){b?b===1?lp(c=Ez(zc(c),a),a,l,f,m,x,2):b===2&&Az(c,a,l,f,m,x):lp(zc(c),a,l,f,m,x,1);break}}}function Tz(c){const a=c.prev,l=c,f=c.next;if(an(a,l,f)>=0)return!1;const m=a.x,x=l.x,b=f.x,T=a.y,A=l.y,O=f.y,D=Math.min(m,x,b),B=Math.min(T,A,O),K=Math.max(m,x,b),Y=Math.max(T,A,O);let J=f.next;for(;J!==a;){if(J.x>=D&&J.x<=K&&J.y>=B&&J.y<=Y&&cp(m,T,x,A,b,O,J.x,J.y)&&an(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function kz(c,a,l,f){const m=c.prev,x=c,b=c.next;if(an(m,x,b)>=0)return!1;const T=m.x,A=x.x,O=b.x,D=m.y,B=x.y,K=b.y,Y=Math.min(T,A,O),J=Math.min(D,B,K),te=Math.max(T,A,O),ae=Math.max(D,B,K),ce=nb(Y,J,a,l,f),Pe=nb(te,ae,a,l,f);let ge=c.prevZ,ve=c.nextZ;for(;ge&&ge.z>=ce&&ve&&ve.z<=Pe;){if(ge.x>=Y&&ge.x<=te&&ge.y>=J&&ge.y<=ae&&ge!==m&&ge!==b&&cp(T,D,A,B,O,K,ge.x,ge.y)&&an(ge.prev,ge,ge.next)>=0||(ge=ge.prevZ,ve.x>=Y&&ve.x<=te&&ve.y>=J&&ve.y<=ae&&ve!==m&&ve!==b&&cp(T,D,A,B,O,K,ve.x,ve.y)&&an(ve.prev,ve,ve.next)>=0))return!1;ve=ve.nextZ}for(;ge&&ge.z>=ce;){if(ge.x>=Y&&ge.x<=te&&ge.y>=J&&ge.y<=ae&&ge!==m&&ge!==b&&cp(T,D,A,B,O,K,ge.x,ge.y)&&an(ge.prev,ge,ge.next)>=0)return!1;ge=ge.prevZ}for(;ve&&ve.z<=Pe;){if(ve.x>=Y&&ve.x<=te&&ve.y>=J&&ve.y<=ae&&ve!==m&&ve!==b&&cp(T,D,A,B,O,K,ve.x,ve.y)&&an(ve.prev,ve,ve.next)>=0)return!1;ve=ve.nextZ}return!0}function Ez(c,a){let l=c;do{const f=l.prev,m=l.next.next;!gh(f,m)&&ZT(f,l,l.next,m)&&up(f,m)&&up(m,f)&&(a.push(f.i,l.i,m.i),hp(l),hp(l.next),l=c=m),l=l.next}while(l!==c);return zc(l)}function Az(c,a,l,f,m,x){let b=c;do{let T=b.next.next;for(;T!==b.prev;){if(b.i!==T.i&&Oz(b,T)){let A=KT(b,T);return b=zc(b,b.next),A=zc(A,A.next),lp(b,a,l,f,m,x,0),void lp(A,a,l,f,m,x,0)}T=T.next}b=b.next}while(b!==c)}function Cz(c,a){let l=c.x-a.x;return l===0&&(l=c.y-a.y,l===0)&&(l=(c.next.y-c.y)/(c.next.x-c.x)-(a.next.y-a.y)/(a.next.x-a.x)),l}function Mz(c,a){const l=function(m,x){let b=x;const T=m.x,A=m.y;let O,D=-1/0;if(gh(m,b))return b;do{if(gh(m,b.next))return b.next;if(A<=b.y&&A>=b.next.y&&b.next.y!==b.y){const te=b.x+(A-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(te<=T&&te>D&&(D=te,O=b.x<b.next.x?b:b.next,te===T))return O}b=b.next}while(b!==x);if(!O)return null;const B=O,K=O.x,Y=O.y;let J=1/0;b=O;do{if(T>=b.x&&b.x>=K&&T!==b.x&&HT(A<Y?T:D,A,K,Y,A<Y?D:T,A,b.x,b.y)){const te=Math.abs(A-b.y)/(T-b.x);up(b,m)&&(te<J||te===J&&(b.x>O.x||b.x===O.x&&Iz(O,b)))&&(O=b,J=te)}b=b.next}while(b!==B);return O}(c,a);if(!l)return a;const f=KT(l,c);return zc(f,f.next),zc(l,l.next)}function Iz(c,a){return an(c.prev,c,a.prev)<0&&an(a.next,c,c.next)<0}function nb(c,a,l,f,m){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-l)*m|0)|c<<8))|c<<4))|c<<2))|c<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-f)*m|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function jz(c){let a=c,l=c;do(a.x<l.x||a.x===l.x&&a.y<l.y)&&(l=a),a=a.next;while(a!==c);return l}function HT(c,a,l,f,m,x,b,T){return(m-b)*(a-T)>=(c-b)*(x-T)&&(c-b)*(f-T)>=(l-b)*(a-T)&&(l-b)*(x-T)>=(m-b)*(f-T)}function cp(c,a,l,f,m,x,b,T){return!(c===b&&a===T)&&HT(c,a,l,f,m,x,b,T)}function Oz(c,a){return c.next.i!==a.i&&c.prev.i!==a.i&&!function(l,f){let m=l;do{if(m.i!==l.i&&m.next.i!==l.i&&m.i!==f.i&&m.next.i!==f.i&&ZT(m,m.next,l,f))return!0;m=m.next}while(m!==l);return!1}(c,a)&&(up(c,a)&&up(a,c)&&function(l,f){let m=l,x=!1;const b=(l.x+f.x)/2,T=(l.y+f.y)/2;do m.y>T!=m.next.y>T&&m.next.y!==m.y&&b<(m.next.x-m.x)*(T-m.y)/(m.next.y-m.y)+m.x&&(x=!x),m=m.next;while(m!==l);return x}(c,a)&&(an(c.prev,c,a.prev)||an(c,a.prev,a))||gh(c,a)&&an(c.prev,c,c.next)>0&&an(a.prev,a,a.next)>0)}function an(c,a,l){return(a.y-c.y)*(l.x-a.x)-(a.x-c.x)*(l.y-a.y)}function gh(c,a){return c.x===a.x&&c.y===a.y}function ZT(c,a,l,f){const m=Iy(an(c,a,l)),x=Iy(an(c,a,f)),b=Iy(an(l,f,c)),T=Iy(an(l,f,a));return m!==x&&b!==T||!(m!==0||!My(c,l,a))||!(x!==0||!My(c,f,a))||!(b!==0||!My(l,c,f))||!(T!==0||!My(l,a,f))}function My(c,a,l){return a.x<=Math.max(c.x,l.x)&&a.x>=Math.min(c.x,l.x)&&a.y<=Math.max(c.y,l.y)&&a.y>=Math.min(c.y,l.y)}function Iy(c){return c>0?1:c<0?-1:0}function up(c,a){return an(c.prev,c,c.next)<0?an(c,a,c.next)>=0&&an(c,c.prev,a)>=0:an(c,a,c.prev)<0||an(c,c.next,a)<0}function KT(c,a){const l=ib(c.i,c.x,c.y),f=ib(a.i,a.x,a.y),m=c.next,x=a.prev;return c.next=a,a.prev=c,l.next=m,m.prev=l,f.next=l,l.prev=f,x.next=f,f.prev=x,f}function XT(c,a,l,f){const m=ib(c,a,l);return f?(m.next=f.next,m.prev=f,f.next.prev=m,f.next=m):(m.prev=m,m.next=m),m}function hp(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function ib(c,a,l){return{i:c,x:a,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class yh{constructor(a,l){if(l>a)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=a,this._minGranularity=l}getGranularityForZoomLevel(a){return Math.max(Math.floor(this._baseZoomGranularity/(1<<a)),this._minGranularity,1)}}class jy{constructor(a){this.fill=a.fill,this.line=a.line,this.tile=a.tile,this.stencil=a.stencil,this.circle=a.circle}}jy.noSubdivision=new jy({fill:new yh(0,0),line:new yh(0,0),tile:new yh(0,0),stencil:new yh(0,0),circle:1}),yt("SubdivisionGranularityExpression",yh),yt("SubdivisionGranularitySetting",jy);const vh=-32768,dp=32767;class Dz{constructor(a,l){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=a,this._granularityCellSize=Be/a,this._canonical=l}_getKey(a,l){return(a+=32768)<<16|l+32768}_vertexToIndex(a,l){if(a<-32768||l<-32768||a>32767||l>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const f=0|Math.round(a),m=0|Math.round(l),x=this._getKey(f,m);if(this._vertexDictionary.has(x))return this._vertexDictionary.get(x);const b=this._vertexBuffer.length/2;return this._vertexDictionary.set(x,b),this._vertexBuffer.push(f,m),b}_subdivideTrianglesScanline(a){if(this._granularity<2)return function(m,x){const b=[];for(let T=0;T<x.length;T+=3){const A=x[T],O=x[T+1],D=x[T+2],B=m[2*A],K=m[2*A+1];(m[2*O]-B)*(m[2*D+1]-K)-(m[2*O+1]-K)*(m[2*D]-B)>0?(b.push(A),b.push(D),b.push(O)):(b.push(A),b.push(O),b.push(D))}return b}(this._vertexBuffer,a);const l=[],f=a.length;for(let m=0;m<f;m+=3){const x=[a[m+0],a[m+1],a[m+2]],b=[this._vertexBuffer[2*a[m+0]+0],this._vertexBuffer[2*a[m+0]+1],this._vertexBuffer[2*a[m+1]+0],this._vertexBuffer[2*a[m+1]+1],this._vertexBuffer[2*a[m+2]+0],this._vertexBuffer[2*a[m+2]+1]];let T=1/0,A=1/0,O=-1/0,D=-1/0;for(let te=0;te<3;te++){const ae=b[2*te],ce=b[2*te+1];T=Math.min(T,ae),O=Math.max(O,ae),A=Math.min(A,ce),D=Math.max(D,ce)}if(T===O||A===D)continue;const B=Math.floor(T/this._granularityCellSize),K=Math.ceil(O/this._granularityCellSize),Y=Math.floor(A/this._granularityCellSize),J=Math.ceil(D/this._granularityCellSize);if(B!==K||Y!==J)for(let te=Y;te<J;te++){const ae=this._scanlineGenerateVertexRingForCellRow(te,b,x);Rz(this._vertexBuffer,ae,l)}else l.push(...x)}return l}_scanlineGenerateVertexRingForCellRow(a,l,f){const m=a*this._granularityCellSize,x=m+this._granularityCellSize,b=[];for(let T=0;T<3;T++){const A=l[2*T],O=l[2*T+1],D=l[2*(T+1)%6],B=l[(2*(T+1)+1)%6],K=l[2*(T+2)%6],Y=l[(2*(T+2)+1)%6],J=D-A,te=B-O,ae=J===0,ce=te===0,Pe=(m-O)/te,ge=(x-O)/te,ve=Math.min(Pe,ge),Ne=Math.max(Pe,ge);if(!ce&&(ve>=1||Ne<=0)||ce&&(O<m||O>x)){B>=m&&B<=x&&b.push(f[(T+1)%3]);continue}!ce&&ve>0&&b.push(this._vertexToIndex(A+J*ve,O+te*ve));const Fe=A+J*Math.max(ve,0),Qe=A+J*Math.min(Ne,1);ae||this._generateIntraEdgeVertices(b,A,O,D,B,Fe,Qe),!ce&&Ne<1&&b.push(this._vertexToIndex(A+J*Ne,O+te*Ne)),(ce||B>=m&&B<=x)&&b.push(f[(T+1)%3]),!ce&&(B<=m||B>=x)&&this._generateInterEdgeVertices(b,A,O,D,B,K,Y,Qe,m,x)}return b}_generateIntraEdgeVertices(a,l,f,m,x,b,T){const A=m-l,O=x-f,D=O===0,B=D?Math.min(l,m):Math.min(b,T),K=D?Math.max(l,m):Math.max(b,T),Y=Math.floor(B/this._granularityCellSize)+1,J=Math.ceil(K/this._granularityCellSize)-1;if(D?l<m:b<T)for(let te=Y;te<=J;te++){const ae=te*this._granularityCellSize;a.push(this._vertexToIndex(ae,f+O*(ae-l)/A))}else for(let te=J;te>=Y;te--){const ae=te*this._granularityCellSize;a.push(this._vertexToIndex(ae,f+O*(ae-l)/A))}}_generateInterEdgeVertices(a,l,f,m,x,b,T,A,O,D){const B=x-f,K=b-m,Y=T-x,J=(O-x)/Y,te=(D-x)/Y,ae=Math.min(J,te),ce=Math.max(J,te),Pe=m+K*ae;let ge=Math.floor(Math.min(Pe,A)/this._granularityCellSize)+1,ve=Math.ceil(Math.max(Pe,A)/this._granularityCellSize)-1,Ne=A<Pe;const Fe=Y===0;if(Fe&&(T===O||T===D))return;if(Fe||ae>=1||ce<=0){const ft=f-T,st=b+(l-b)*Math.min((O-T)/ft,(D-T)/ft);ge=Math.floor(Math.min(st,A)/this._granularityCellSize)+1,ve=Math.ceil(Math.max(st,A)/this._granularityCellSize)-1,Ne=A<st}const Qe=B>0?D:O;if(Ne)for(let ft=ge;ft<=ve;ft++)a.push(this._vertexToIndex(ft*this._granularityCellSize,Qe));else for(let ft=ve;ft>=ge;ft--)a.push(this._vertexToIndex(ft*this._granularityCellSize,Qe))}_generateOutline(a){const l=[];for(const f of a){const m=Lc(f,this._granularity,!0),x=this._pointArrayToIndices(m),b=[];for(let T=1;T<x.length;T++)b.push(x[T-1]),b.push(x[T]);l.push(b)}return l}_handlePoles(a){let l=!1,f=!1;this._canonical&&(this._canonical.y===0&&(l=!0),this._canonical.y===(1<<this._canonical.z)-1&&(f=!0)),(l||f)&&this._fillPoles(a,l,f)}_ensureNoPoleVertices(){const a=this._vertexBuffer;for(let l=0;l<a.length;l+=2){const f=a[l+1];f===vh&&(a[l+1]=-32767),f===dp&&(a[l+1]=32766)}}_generatePoleQuad(a,l,f,m,x,b){m>x!=(b===vh)?(a.push(l),a.push(f),a.push(this._vertexToIndex(m,b)),a.push(f),a.push(this._vertexToIndex(x,b)),a.push(this._vertexToIndex(m,b))):(a.push(f),a.push(l),a.push(this._vertexToIndex(m,b)),a.push(this._vertexToIndex(x,b)),a.push(f),a.push(this._vertexToIndex(m,b)))}_fillPoles(a,l,f){const m=this._vertexBuffer,x=Be,b=a.length;for(let T=2;T<b;T+=3){const A=a[T-2],O=a[T-1],D=a[T],B=m[2*A],K=m[2*A+1],Y=m[2*O],J=m[2*O+1],te=m[2*D],ae=m[2*D+1];l&&(K===0&&J===0&&this._generatePoleQuad(a,A,O,B,Y,vh),J===0&&ae===0&&this._generatePoleQuad(a,O,D,Y,te,vh),ae===0&&K===0&&this._generatePoleQuad(a,D,A,te,B,vh)),f&&(K===x&&J===x&&this._generatePoleQuad(a,A,O,B,Y,dp),J===x&&ae===x&&this._generatePoleQuad(a,O,D,Y,te,dp),ae===x&&K===x&&this._generatePoleQuad(a,D,A,te,B,dp))}}_initializeVertices(a){for(let l=0;l<a.length;l+=2)this._vertexToIndex(a[l],a[l+1])}subdividePolygonInternal(a,l){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:f,holeIndices:m}=function(T){const A=[],O=[];for(const D of T)if(D.length!==0){D!==T[0]&&A.push(O.length/2);for(let B=0;B<D.length;B++)O.push(D[B].x),O.push(D[B].y)}return{flattened:O,holeIndices:A}}(a);let x;this._initializeVertices(f);try{const T=function(O,D,B=2){const K=D&&D.length,Y=K?D[0]*B:O.length;let J=WT(O,0,Y,B,!0);const te=[];if(!J||J.next===J.prev)return te;let ae,ce,Pe;if(K&&(J=function(ge,ve,Ne,Fe){const Qe=[];for(let ft=0,st=ve.length;ft<st;ft++){const ut=WT(ge,ve[ft]*Fe,ft<st-1?ve[ft+1]*Fe:ge.length,Fe,!1);ut===ut.next&&(ut.steiner=!0),Qe.push(jz(ut))}Qe.sort(Cz);for(let ft=0;ft<Qe.length;ft++)Ne=Mz(Qe[ft],Ne);return Ne}(O,D,J,B)),O.length>80*B){ae=O[0],ce=O[1];let ge=ae,ve=ce;for(let Ne=B;Ne<Y;Ne+=B){const Fe=O[Ne],Qe=O[Ne+1];Fe<ae&&(ae=Fe),Qe<ce&&(ce=Qe),Fe>ge&&(ge=Fe),Qe>ve&&(ve=Qe)}Pe=Math.max(ge-ae,ve-ce),Pe=Pe!==0?32767/Pe:0}return lp(J,te,B,ae,ce,Pe,0),te}(f,m),A=this._convertIndices(f,T);x=this._subdivideTrianglesScanline(A)}catch(T){console.error(T)}let b=[];return l&&(b=this._generateOutline(a)),this._ensureNoPoleVertices(),this._handlePoles(x),{verticesFlattened:this._vertexBuffer,indicesTriangles:x,indicesLineList:b}}_convertIndices(a,l){const f=[];for(let m=0;m<l.length;m++)f.push(this._vertexToIndex(a[2*l[m]],a[2*l[m]+1]));return f}_pointArrayToIndices(a){const l=[];for(let f=0;f<a.length;f++){const m=a[f];l.push(this._vertexToIndex(m.x,m.y))}return l}}function YT(c,a,l,f=!0){return new Dz(l,a).subdividePolygonInternal(c,f)}function Lc(c,a,l=!1){if(!c||c.length<1)return[];if(c.length<2)return[];const f=c[0],m=c[c.length-1],x=l&&(f.x!==m.x||f.y!==m.y);if(a<2)return x?[...c,c[0]]:[...c];const b=Math.floor(Be/a),T=[];T.push(new y(c[0].x,c[0].y));const A=c.length,O=x?A:A-1;for(let D=0;D<O;D++){const B=c[D],K=D<A-1?c[D+1]:c[0],Y=B.x,J=B.y,te=K.x,ae=K.y,ce=Y!==te,Pe=J!==ae;if(!ce&&!Pe)continue;const ge=te-Y,ve=ae-J,Ne=Math.abs(ge),Fe=Math.abs(ve);let Qe=Y,ft=J;for(;;){const ut=ge>0?(Math.floor(Qe/b)+1)*b:(Math.ceil(Qe/b)-1)*b,Tt=ve>0?(Math.floor(ft/b)+1)*b:(Math.ceil(ft/b)-1)*b,ct=Math.abs(Qe-ut),ht=Math.abs(ft-Tt),He=Math.abs(Qe-te),Ot=Math.abs(ft-ae),Rt=ce?ct/Ne:Number.POSITIVE_INFINITY,Ct=Pe?ht/Fe:Number.POSITIVE_INFINITY;if((He<=ct||!ce)&&(Ot<=ht||!Pe))break;if(Rt<Ct&&ce||!Pe){Qe=ut,ft+=ve*Rt;const bt=new y(Qe,Math.round(ft));T[T.length-1].x===bt.x&&T[T.length-1].y===bt.y||T.push(bt)}else{Qe+=ge*Ct,ft=Tt;const bt=new y(Math.round(Qe),ft);T[T.length-1].x===bt.x&&T[T.length-1].y===bt.y||T.push(bt)}}const st=new y(te,ae);T[T.length-1].x===st.x&&T[T.length-1].y===st.y||T.push(st)}return T}function Rz(c,a,l){if(a.length===0)throw new Error("Subdivision vertex ring is empty.");let f=0,m=c[2*a[0]];for(let A=1;A<a.length;A++){const O=c[2*a[A]];O<m&&(m=O,f=A)}const x=a.length;let b=f,T=(b+1)%x;for(;;){const A=b-1>=0?b-1:x-1,O=(T+1)%x,D=c[2*a[A]],B=c[2*a[O]],K=c[2*a[b]],Y=c[2*a[b]+1],J=c[2*a[T]+1];let te=!1;if(D<B)te=!0;else if(D>B)te=!1;else{const ae=J-Y,ce=-(c[2*a[T]]-K),Pe=Y<J?1:-1;((D-K)*ae+(c[2*a[A]+1]-Y)*ce)*Pe>((B-K)*ae+(c[2*a[O]+1]-Y)*ce)*Pe&&(te=!0)}if(te){const ae=a[A],ce=a[b],Pe=a[T];ae!==ce&&ae!==Pe&&ce!==Pe&&l.push(Pe,ce,ae),b--,b<0&&(b=x-1)}else{const ae=a[O],ce=a[b],Pe=a[T];ae!==ce&&ae!==Pe&&ce!==Pe&&l.push(Pe,ce,ae),T++,T>=x&&(T=0)}if(A===O)break}}function JT(c,a,l,f,m,x,b,T,A){const O=m.length/2,D=b&&T&&A;if(O<Ut.MAX_VERTEX_ARRAY_LENGTH){const B=a.prepareSegment(O,l,f),K=B.vertexLength;for(let te=0;te<x.length;te+=3)f.emplaceBack(K+x[te],K+x[te+1],K+x[te+2]);let Y,J;B.vertexLength+=O,B.primitiveLength+=x.length/3,D&&(J=b.prepareSegment(O,l,T),Y=J.vertexLength,J.vertexLength+=O);for(let te=0;te<m.length;te+=2)c(m[te],m[te+1]);if(D)for(let te=0;te<A.length;te++){const ae=A[te];for(let ce=1;ce<ae.length;ce+=2)T.emplaceBack(Y+ae[ce-1],Y+ae[ce]);J.primitiveLength+=ae.length/2}}else(function(B,K,Y,J,te,ae){const ce=[];for(let Fe=0;Fe<J.length/2;Fe++)ce.push(-1);const Pe={count:0};let ge=0,ve=B.getOrCreateLatestSegment(K,Y),Ne=ve.vertexLength;for(let Fe=2;Fe<te.length;Fe+=3){const Qe=te[Fe-2],ft=te[Fe-1],st=te[Fe];let ut=ce[Qe]<ge,Tt=ce[ft]<ge,ct=ce[st]<ge;ve.vertexLength+((ut?1:0)+(Tt?1:0)+(ct?1:0))>Ut.MAX_VERTEX_ARRAY_LENGTH&&(ve=B.createNewSegment(K,Y),ge=Pe.count,ut=!0,Tt=!0,ct=!0,Ne=0);const ht=fp(ce,J,ae,Pe,Qe,ut,ve),He=fp(ce,J,ae,Pe,ft,Tt,ve),Ot=fp(ce,J,ae,Pe,st,ct,ve);Y.emplaceBack(Ne+ht-ge,Ne+He-ge,Ne+Ot-ge),ve.primitiveLength++}})(a,l,f,m,x,c),D&&function(B,K,Y,J,te,ae){const ce=[];for(let Fe=0;Fe<J.length/2;Fe++)ce.push(-1);const Pe={count:0};let ge=0,ve=B.getOrCreateLatestSegment(K,Y),Ne=ve.vertexLength;for(let Fe=0;Fe<te.length;Fe++){const Qe=te[Fe];for(let ft=1;ft<te[Fe].length;ft+=2){const st=Qe[ft-1],ut=Qe[ft];let Tt=ce[st]<ge,ct=ce[ut]<ge;ve.vertexLength+((Tt?1:0)+(ct?1:0))>Ut.MAX_VERTEX_ARRAY_LENGTH&&(ve=B.createNewSegment(K,Y),ge=Pe.count,Tt=!0,ct=!0,Ne=0);const ht=fp(ce,J,ae,Pe,st,Tt,ve),He=fp(ce,J,ae,Pe,ut,ct,ve);Y.emplaceBack(Ne+ht-ge,Ne+He-ge),ve.primitiveLength++}}}(b,l,T,m,A,c),a.forceNewSegmentOnNextPrepare(),b==null||b.forceNewSegmentOnNextPrepare()}function fp(c,a,l,f,m,x,b){if(x){const T=f.count;return l(a[2*m],a[2*m+1]),c[m]=f.count,f.count++,b.vertexLength++,T}return c[m]}class ab{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ze,this.indexArray=new _r,this.indexArray2=new gr,this.programConfigurations=new Ni(a.layers,a.zoom),this.segments=new Ut,this.segments2=new Ut,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(a,l,f){this.hasPattern=tb("fill",this.layers,l);const m=this.layers[0].layout.get("fill-sort-key"),x=!m.isConstant(),b=[];for(const{feature:T,id:A,index:O,sourceLayerIndex:D}of a){const B=this.layers[0]._featureFilter.needGeometry,K=ao(T,B);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom,{globalState:this.globalState}),K,f))continue;const Y=x?m.evaluate(K,{},f,l.availableImages):void 0,J={id:A,properties:T.properties,type:T.type,sourceLayerIndex:D,index:O,geometry:B?K.geometry:Uo(T),patterns:{},sortKey:Y};b.push(J)}x&&b.sort((T,A)=>T.sortKey-A.sortKey);for(const T of b){const{geometry:A,index:O,sourceLayerIndex:D}=T;if(this.hasPattern){const B=rb("fill",this.layers,T,this.zoom,l);this.patternFeatures.push(B)}else this.addFeature(T,A,O,f,{},l.subdivisionGranularity);l.featureIndex.insert(a[O].feature,A,O,D,this.index)}}update(a,l,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,l,this.stateDependentLayers,{imagePositions:f,globalState:this.globalState})}addFeatures(a,l,f){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,f,a.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Pz),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,l,f,m,x,b){for(const T of wc(l,500)){const A=YT(T,m,b.fill.getGranularityForZoomLevel(m.z)),O=this.layoutVertexArray;JT((D,B)=>{O.emplaceBack(D,B)},this.segments,this.layoutVertexArray,this.indexArray,A.verticesFlattened,A.indicesTriangles,this.segments2,this.indexArray2,A.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{imagePositions:x,canonical:m,globalState:this.globalState})}}let QT,ek;yt("FillBucket",ab,{omit:["layers","patternFeatures"]});var Nz={get paint(){return ek=ek||new hi({"fill-antialias":new St(Ce.paint_fill["fill-antialias"]),"fill-opacity":new Mt(Ce.paint_fill["fill-opacity"]),"fill-color":new Mt(Ce.paint_fill["fill-color"]),"fill-outline-color":new Mt(Ce.paint_fill["fill-outline-color"]),"fill-translate":new St(Ce.paint_fill["fill-translate"]),"fill-translate-anchor":new St(Ce.paint_fill["fill-translate-anchor"]),"fill-pattern":new lh(Ce.paint_fill["fill-pattern"])})},get layout(){return QT=QT||new hi({"fill-sort-key":new Mt(Ce.layout_fill["fill-sort-key"])})}};class $z extends Ki{constructor(a){super(a,Nz)}recalculate(a,l){super.recalculate(a,l);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new ab(a)}queryRadius(){return Ay(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:a,geometry:l,transform:f,pixelsToTileUnits:m}){return jT(Cy(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-f.bearingInRadians,m),l)}isTileClipped(){return!0}}const zz=en([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Lz=en([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Bz}=zz;class _h{constructor(a,l,f,m,x){this.properties={},this.extent=f,this.type=0,this.id=void 0,this._pbf=a,this._geometry=-1,this._keys=m,this._values=x,a.readFields(Fz,this,l)}loadGeometry(){const a=this._pbf;a.pos=this._geometry;const l=a.readVarint()+a.pos,f=[];let m,x=1,b=0,T=0,A=0;for(;a.pos<l;){if(b<=0){const O=a.readVarint();x=7&O,b=O>>3}if(b--,x===1||x===2)T+=a.readSVarint(),A+=a.readSVarint(),x===1&&(m&&f.push(m),m=[]),m&&m.push(new y(T,A));else{if(x!==7)throw new Error(`unknown command ${x}`);m&&m.push(m[0].clone())}}return m&&f.push(m),f}bbox(){const a=this._pbf;a.pos=this._geometry;const l=a.readVarint()+a.pos;let f=1,m=0,x=0,b=0,T=1/0,A=-1/0,O=1/0,D=-1/0;for(;a.pos<l;){if(m<=0){const B=a.readVarint();f=7&B,m=B>>3}if(m--,f===1||f===2)x+=a.readSVarint(),b+=a.readSVarint(),x<T&&(T=x),x>A&&(A=x),b<O&&(O=b),b>D&&(D=b);else if(f!==7)throw new Error(`unknown command ${f}`)}return[T,O,A,D]}toGeoJSON(a,l,f){const m=this.extent*Math.pow(2,f),x=this.extent*a,b=this.extent*l,T=this.loadGeometry();function A(K){return[360*(K.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((1-2*(K.y+b)/m)*Math.PI))-90]}function O(K){return K.map(A)}let D;if(this.type===1){const K=[];for(const J of T)K.push(J[0]);const Y=O(K);D=K.length===1?{type:"Point",coordinates:Y[0]}:{type:"MultiPoint",coordinates:Y}}else if(this.type===2){const K=T.map(O);D=K.length===1?{type:"LineString",coordinates:K[0]}:{type:"MultiLineString",coordinates:K}}else{if(this.type!==3)throw new Error("unknown feature type");{const K=function(J){const te=J.length;if(te<=1)return[J];const ae=[];let ce,Pe;for(let ge=0;ge<te;ge++){const ve=Uz(J[ge]);ve!==0&&(Pe===void 0&&(Pe=ve<0),Pe===ve<0?(ce&&ae.push(ce),ce=[J[ge]]):ce&&ce.push(J[ge]))}return ce&&ae.push(ce),ae}(T),Y=[];for(const J of K)Y.push(J.map(O));D=Y.length===1?{type:"Polygon",coordinates:Y[0]}:{type:"MultiPolygon",coordinates:Y}}}const B={type:"Feature",geometry:D,properties:this.properties};return this.id!=null&&(B.id=this.id),B}}function Fz(c,a,l){c===1?a.id=l.readVarint():c===2?function(f,m){const x=f.readVarint()+f.pos;for(;f.pos<x;){const b=m._keys[f.readVarint()],T=m._values[f.readVarint()];m.properties[b]=T}}(l,a):c===3?a.type=l.readVarint():c===4&&(a._geometry=l.pos)}function Uz(c){let a=0;for(let l,f,m=0,x=c.length,b=x-1;m<x;b=m++)l=c[m],f=c[b],a+=(f.x-l.x)*(l.y+f.y);return a}_h.types=["Unknown","Point","LineString","Polygon"];class tk{constructor(a,l){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Vz,this,l),this.length=this._features.length}feature(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];const l=this._pbf.readVarint()+this._pbf.pos;return new _h(this._pbf,l,this.extent,this._keys,this._values)}}function Vz(c,a,l){c===15?a.version=l.readVarint():c===1?a.name=l.readString():c===5?a.extent=l.readVarint():c===2?a._features.push(l.pos):c===3?a._keys.push(l.readString()):c===4&&a._values.push(function(f){let m=null;const x=f.readVarint()+f.pos;for(;f.pos<x;){const b=f.readVarint()>>3;m=b===1?f.readString():b===2?f.readFloat():b===3?f.readDouble():b===4?f.readVarint64():b===5?f.readVarint():b===6?f.readSVarint():b===7?f.readBoolean():null}if(m==null)throw new Error("unknown feature value");return m}(l))}class rk{constructor(a,l){this.layers=a.readFields(Gz,{},l)}}function Gz(c,a,l){if(c===3){const f=new tk(l,l.readVarint()+l.pos);f.length&&(a[f.name]=f)}}const ob=Math.pow(2,13);function pp(c,a,l,f,m,x,b,T){c.emplaceBack(a,l,2*Math.floor(f*ob)+b,m*ob*2,x*ob*2,Math.round(T))}class sb{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new je,this.centroidVertexArray=new pe,this.indexArray=new _r,this.programConfigurations=new Ni(a.layers,a.zoom),this.segments=new Ut,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(a,l,f){this.features=[],this.hasPattern=tb("fill-extrusion",this.layers,l);for(const{feature:m,id:x,index:b,sourceLayerIndex:T}of a){const A=this.layers[0]._featureFilter.needGeometry,O=ao(m,A);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom,{globalState:this.globalState}),O,f))continue;const D={id:x,sourceLayerIndex:T,index:b,geometry:A?O.geometry:Uo(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(rb("fill-extrusion",this.layers,D,this.zoom,l)):this.addFeature(D,D.geometry,b,f,{},l.subdivisionGranularity),l.featureIndex.insert(m,D.geometry,b,T,this.index,!0)}}addFeatures(a,l,f){for(const m of this.features){const{geometry:x}=m;this.addFeature(m,x,m.index,l,f,a.subdivisionGranularity)}}update(a,l,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,l,this.stateDependentLayers,{imagePositions:f,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Bz),this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,Lz.members,!0),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(a,l,f,m,x,b){for(const T of wc(l,500)){const A={x:0,y:0,sampleCount:0},O=this.layoutVertexArray.length;this.processPolygon(A,m,a,T,b);const D=this.layoutVertexArray.length-O,B=Math.floor(A.x/A.sampleCount),K=Math.floor(A.y/A.sampleCount);for(let Y=0;Y<D;Y++)this.centroidVertexArray.emplaceBack(B,K)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{imagePositions:x,canonical:m,globalState:this.globalState})}processPolygon(a,l,f,m,x){if(m.length<1||nk(m[0]))return;for(const B of m)B.length!==0&&qz(a,B);const b={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},T=x.fill.getGranularityForZoomLevel(l.z),A=_h.types[f.type]==="Polygon";for(const B of m){if(B.length===0||nk(B))continue;const K=Lc(B,T,A);this._generateSideFaces(K,b)}if(!A)return;const O=YT(m,l,T,!1),D=this.layoutVertexArray;JT((B,K)=>{pp(D,B,K,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,O.verticesFlattened,O.indicesTriangles)}_generateSideFaces(a,l){let f=0;for(let m=1;m<a.length;m++){const x=a[m],b=a[m-1];if(Wz(x,b))continue;l.segment.vertexLength+4>Ut.MAX_VERTEX_ARRAY_LENGTH&&(l.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const T=x.sub(b)._perp()._unit(),A=b.dist(x);f+A>32768&&(f=0),pp(this.layoutVertexArray,x.x,x.y,T.x,T.y,0,0,f),pp(this.layoutVertexArray,x.x,x.y,T.x,T.y,0,1,f),f+=A,pp(this.layoutVertexArray,b.x,b.y,T.x,T.y,0,0,f),pp(this.layoutVertexArray,b.x,b.y,T.x,T.y,0,1,f);const O=l.segment.vertexLength;this.indexArray.emplaceBack(O,O+2,O+1),this.indexArray.emplaceBack(O+1,O+2,O+3),l.segment.vertexLength+=4,l.segment.primitiveLength+=2}}}function qz(c,a){for(let l=0;l<a.length;l++){const f=a[l];l===a.length-1&&a[0].x===f.x&&a[0].y===f.y||(c.x+=f.x,c.y+=f.y,c.sampleCount++)}}function Wz(c,a){return c.x===a.x&&(c.x<0||c.x>Be)||c.y===a.y&&(c.y<0||c.y>Be)}function nk(c){return c.every(a=>a.x<0)||c.every(a=>a.x>Be)||c.every(a=>a.y<0)||c.every(a=>a.y>Be)}let ik;yt("FillExtrusionBucket",sb,{omit:["layers","features"]});var Hz={get paint(){return ik=ik||new hi({"fill-extrusion-opacity":new St(Ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Mt(Ce["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new St(Ce["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new St(Ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lh(Ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Mt(Ce["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Mt(Ce["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new St(Ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Zz extends Ki{constructor(a){super(a,Hz)}createBucket(a){return new sb(a)}queryRadius(){return Ay(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:a,feature:l,featureState:f,geometry:m,transform:x,pixelsToTileUnits:b,pixelPosMatrix:T}){const A=Cy(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-x.bearingInRadians,b),O=this.paint.get("fill-extrusion-height").evaluate(l,f),D=this.paint.get("fill-extrusion-base").evaluate(l,f),B=function(Y,J){const te=[];for(const ae of Y){const ce=[ae.x,ae.y,0,1];We(ce,ce,J),te.push(new y(ce[0]/ce[3],ce[1]/ce[3]))}return te}(A,T),K=function(Y,J,te,ae){const ce=[],Pe=[],ge=ae[8]*J,ve=ae[9]*J,Ne=ae[10]*J,Fe=ae[11]*J,Qe=ae[8]*te,ft=ae[9]*te,st=ae[10]*te,ut=ae[11]*te;for(const Tt of Y){const ct=[],ht=[];for(const He of Tt){const Ot=He.x,Rt=He.y,Ct=ae[0]*Ot+ae[4]*Rt+ae[12],bt=ae[1]*Ot+ae[5]*Rt+ae[13],tr=ae[2]*Ot+ae[6]*Rt+ae[14],qr=ae[3]*Ot+ae[7]*Rt+ae[15],wn=tr+Ne,ri=qr+Fe,_a=Ct+Qe,zi=bt+ft,Ln=tr+st,zr=qr+ut,Cn=new y((Ct+ge)/ri,(bt+ve)/ri);Cn.z=wn/ri,ct.push(Cn);const Bn=new y(_a/zr,zi/zr);Bn.z=Ln/zr,ht.push(Bn)}ce.push(ct),Pe.push(ht)}return[ce,Pe]}(m,D,O,T);return function(Y,J,te){let ae=1/0;jT(te,J)&&(ae=ak(te,J[0]));for(let ce=0;ce<J.length;ce++){const Pe=J[ce],ge=Y[ce];for(let ve=0;ve<Pe.length-1;ve++){const Ne=Pe[ve],Fe=[Ne,Pe[ve+1],ge[ve+1],ge[ve],Ne];IT(te,Fe)&&(ae=Math.min(ae,ak(te,Fe)))}}return ae!==1/0&&ae}(K[0],K[1],B)}}function mp(c,a){return c.x*a.x+c.y*a.y}function ak(c,a){if(c.length===1){let l=0;const f=a[l++];let m;for(;!m||f.equals(m);)if(m=a[l++],!m)return 1/0;for(;l<a.length;l++){const x=a[l],b=c[0],T=m.sub(f),A=x.sub(f),O=b.sub(f),D=mp(T,T),B=mp(T,A),K=mp(A,A),Y=mp(O,T),J=mp(O,A),te=D*K-B*B,ae=(K*Y-B*J)/te,ce=(D*J-B*Y)/te,Pe=f.z*(1-ae-ce)+m.z*ae+x.z*ce;if(isFinite(Pe))return Pe}return 1/0}{let l=1/0;for(const f of a)l=Math.min(l,f.z);return l}}const Kz=en([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Xz}=Kz,Yz=en([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Jz}=Yz,Qz=Math.cos(Math.PI/180*37.5),ok=Math.pow(2,14)/.5;class lb{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(l=>l.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new De,this.layoutVertexArray2=new $e,this.indexArray=new _r,this.programConfigurations=new Ni(a.layers,a.zoom),this.segments=new Ut,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(a,l,f){this.hasPattern=tb("line",this.layers,l);const m=this.layers[0].layout.get("line-sort-key"),x=!m.isConstant(),b=[];for(const{feature:T,id:A,index:O,sourceLayerIndex:D}of a){const B=this.layers[0]._featureFilter.needGeometry,K=ao(T,B);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom,{globalState:this.globalState}),K,f))continue;const Y=x?m.evaluate(K,{},f):void 0,J={id:A,properties:T.properties,type:T.type,sourceLayerIndex:D,index:O,geometry:B?K.geometry:Uo(T),patterns:{},sortKey:Y};b.push(J)}x&&b.sort((T,A)=>T.sortKey-A.sortKey);for(const T of b){const{geometry:A,index:O,sourceLayerIndex:D}=T;if(this.hasPattern){const B=rb("line",this.layers,T,this.zoom,l);this.patternFeatures.push(B)}else this.addFeature(T,A,O,f,{},l.subdivisionGranularity);l.featureIndex.insert(a[O].feature,A,O,D,this.index)}}update(a,l,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,l,this.stateDependentLayers,{imagePositions:f,globalState:this.globalState})}addFeatures(a,l,f){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,f,a.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,Jz)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Xz),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,l,f,m,x,b){const T=this.layers[0].layout,A=T.get("line-join").evaluate(a,{}),O=T.get("line-cap"),D=T.get("line-miter-limit"),B=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const K of l)this.addLine(K,a,A,O,D,B,m,b);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{imagePositions:x,canonical:m,globalState:this.globalState})}addLine(a,l,f,m,x,b,T,A){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,a=Lc(a,T?A.line.getGranularityForZoomLevel(T.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<a.length-1;ge++)this.totalDistance+=a[ge].dist(a[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const O=_h.types[l.type]==="Polygon";let D=a.length;for(;D>=2&&a[D-1].equals(a[D-2]);)D--;let B=0;for(;B<D-1&&a[B].equals(a[B+1]);)B++;if(D<(O?3:2))return;f==="bevel"&&(x=1.05);const K=this.overscaling<=16?122880/(512*this.overscaling):0,Y=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let J,te,ae,ce,Pe;this.e1=this.e2=-1,O&&(J=a[D-2],Pe=a[B].sub(J)._unit()._perp());for(let ge=B;ge<D;ge++){if(ae=ge===D-1?O?a[B+1]:void 0:a[ge+1],ae&&a[ge].equals(ae))continue;Pe&&(ce=Pe),J&&(te=J),J=a[ge],Pe=ae?ae.sub(J)._unit()._perp():ce,ce=ce||Pe;let ve=ce.add(Pe);ve.x===0&&ve.y===0||ve._unit();const Ne=ce.x*Pe.x+ce.y*Pe.y,Fe=ve.x*Pe.x+ve.y*Pe.y,Qe=Fe!==0?1/Fe:1/0,ft=2*Math.sqrt(2-2*Fe),st=Fe<Qz&&te&&ae,ut=ce.x*Pe.y-ce.y*Pe.x>0;if(st&&ge>B){const ht=J.dist(te);if(ht>2*K){const He=J.sub(J.sub(te)._mult(K/ht)._round());this.updateDistance(te,He),this.addCurrentVertex(He,ce,0,0,Y),te=He}}const Tt=te&&ae;let ct=Tt?f:O?"butt":m;if(Tt&&ct==="round"&&(Qe<b?ct="miter":Qe<=2&&(ct="fakeround")),ct==="miter"&&Qe>x&&(ct="bevel"),ct==="bevel"&&(Qe>2&&(ct="flipbevel"),Qe<x&&(ct="miter")),te&&this.updateDistance(te,J),ct==="miter")ve._mult(Qe),this.addCurrentVertex(J,ve,0,0,Y);else if(ct==="flipbevel"){if(Qe>100)ve=Pe.mult(-1);else{const ht=Qe*ce.add(Pe).mag()/ce.sub(Pe).mag();ve._perp()._mult(ht*(ut?-1:1))}this.addCurrentVertex(J,ve,0,0,Y),this.addCurrentVertex(J,ve.mult(-1),0,0,Y)}else if(ct==="bevel"||ct==="fakeround"){const ht=-Math.sqrt(Qe*Qe-1),He=ut?ht:0,Ot=ut?0:ht;if(te&&this.addCurrentVertex(J,ce,He,Ot,Y),ct==="fakeround"){const Rt=Math.round(180*ft/Math.PI/20);for(let Ct=1;Ct<Rt;Ct++){let bt=Ct/Rt;if(bt!==.5){const qr=bt-.5;bt+=bt*qr*(bt-1)*((1.0904+Ne*(Ne*(3.55645-1.43519*Ne)-3.2452))*qr*qr+(.848013+Ne*(.215638*Ne-1.06021)))}const tr=Pe.sub(ce)._mult(bt)._add(ce)._unit()._mult(ut?-1:1);this.addHalfVertex(J,tr.x,tr.y,!1,ut,0,Y)}}ae&&this.addCurrentVertex(J,Pe,-He,-Ot,Y)}else if(ct==="butt")this.addCurrentVertex(J,ve,0,0,Y);else if(ct==="square"){const ht=te?1:-1;this.addCurrentVertex(J,ve,ht,ht,Y)}else ct==="round"&&(te&&(this.addCurrentVertex(J,ce,0,0,Y),this.addCurrentVertex(J,ce,1,1,Y,!0)),ae&&(this.addCurrentVertex(J,Pe,-1,-1,Y,!0),this.addCurrentVertex(J,Pe,0,0,Y)));if(st&&ge<D-1){const ht=J.dist(ae);if(ht>2*K){const He=J.add(ae.sub(J)._mult(K/ht)._round());this.updateDistance(J,He),this.addCurrentVertex(He,Pe,0,0,Y),J=He}}}}addCurrentVertex(a,l,f,m,x,b=!1){const T=l.y*m-l.x,A=-l.y-l.x*m;this.addHalfVertex(a,l.x+l.y*f,l.y-l.x*f,b,!1,f,x),this.addHalfVertex(a,T,A,b,!0,-m,x),this.distance>ok/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(a,l,f,m,x,b))}addHalfVertex({x:a,y:l},f,m,x,b,T,A){const O=.5*(this.lineClips?this.scaledDistance*(ok-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a<<1)+(x?1:0),(l<<1)+(b?1:0),Math.round(63*f)+128,Math.round(63*m)+128,1+(T===0?0:T<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,D,this.e2),A.primitiveLength++),b?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(a,l){this.distance+=a.dist(l),this.updateScaledDistance()}}let sk,lk;yt("LineBucket",lb,{omit:["layers","patternFeatures"]});var ck={get paint(){return lk=lk||new hi({"line-opacity":new Mt(Ce.paint_line["line-opacity"]),"line-color":new Mt(Ce.paint_line["line-color"]),"line-translate":new St(Ce.paint_line["line-translate"]),"line-translate-anchor":new St(Ce.paint_line["line-translate-anchor"]),"line-width":new Mt(Ce.paint_line["line-width"]),"line-gap-width":new Mt(Ce.paint_line["line-gap-width"]),"line-offset":new Mt(Ce.paint_line["line-offset"]),"line-blur":new Mt(Ce.paint_line["line-blur"]),"line-dasharray":new $o(Ce.paint_line["line-dasharray"]),"line-pattern":new lh(Ce.paint_line["line-pattern"]),"line-gradient":new ch(Ce.paint_line["line-gradient"])})},get layout(){return sk=sk||new hi({"line-cap":new St(Ce.layout_line["line-cap"]),"line-join":new Mt(Ce.layout_line["line-join"]),"line-miter-limit":new St(Ce.layout_line["line-miter-limit"]),"line-round-limit":new St(Ce.layout_line["line-round-limit"]),"line-sort-key":new Mt(Ce.layout_line["line-sort-key"])})}};class e3 extends Mt{possiblyEvaluate(a,l){return l=new kr(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),super.possiblyEvaluate(a,l)}evaluate(a,l,f,m){return l=rr({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(a,l,f,m)}}let Oy;class t3 extends Ki{constructor(a){super(a,ck),this.gradientVersion=0,Oy||(Oy=new e3(ck.paint.properties["line-width"].specification),Oy.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const l=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(l)&&l._styleExpression.expression instanceof Qr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,l){super.recalculate(a,l),this.paint._values["line-floorwidth"]=Oy.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new lb(a)}queryRadius(a){const l=a,f=uk(op("line-width",this,l),op("line-gap-width",this,l)),m=op("line-offset",this,l);return f/2+Math.abs(m)+Ay(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:a,feature:l,featureState:f,geometry:m,transform:x,pixelsToTileUnits:b}){const T=Cy(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-x.bearingInRadians,b),A=b/2*uk(this.paint.get("line-width").evaluate(l,f),this.paint.get("line-gap-width").evaluate(l,f)),O=this.paint.get("line-offset").evaluate(l,f);return O&&(m=function(D,B){const K=[];for(let Y=0;Y<D.length;Y++){const J=D[Y],te=[];for(let ae=0;ae<J.length;ae++){const ce=J[ae-1],Pe=J[ae],ge=J[ae+1],ve=ae===0?new y(0,0):Pe.sub(ce)._unit()._perp(),Ne=ae===J.length-1?new y(0,0):ge.sub(Pe)._unit()._perp(),Fe=ve._add(Ne)._unit(),Qe=Fe.x*Ne.x+Fe.y*Ne.y;Qe!==0&&Fe._mult(1/Qe),te.push(Fe._mult(B)._add(Pe))}K.push(te)}return K}(m,O*b)),function(D,B,K){for(let Y=0;Y<B.length;Y++){const J=B[Y];if(D.length>=3){for(let te=0;te<J.length;te++)if(mh(D,J[te]))return!0}if(dz(D,J,K))return!0}return!1}(T,m,A)}isTileClipped(){return!0}}function uk(c,a){return a>0?a+2*c:c}const r3=en([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),n3=en([{name:"a_projected_pos",components:3,type:"Float32"}],4);en([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const i3=en([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);en([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const hk=en([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),a3=en([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function o3(c,a,l){return c.sections.forEach(f=>{f.text=function(m,x,b){const T=x.layout.get("text-transform").evaluate(b,{});return T==="uppercase"?m=m.toLocaleUpperCase():T==="lowercase"&&(m=m.toLocaleLowerCase()),pa.applyArabicShaping&&(m=pa.applyArabicShaping(m)),m}(f.text,a,l)}),c}en([{name:"triangle",components:3,type:"Uint16"}]),en([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),en([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),en([{type:"Float32",name:"offsetX"}]),en([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),en([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const gp={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var An=24;const cb=4294967296,dk=1/cb,fk=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class ub{constructor(a=new Uint8Array(16)){this.buf=ArrayBuffer.isView(a)?a:new Uint8Array(a),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(a,l,f=this.length){for(;this.pos<f;){const m=this.readVarint(),x=m>>3,b=this.pos;this.type=7&m,a(x,l,this),this.pos===b&&this.skip(m)}return l}readMessage(a,l){return this.readFields(a,l,this.readVarint()+this.pos)}readFixed32(){const a=this.dataView.getUint32(this.pos,!0);return this.pos+=4,a}readSFixed32(){const a=this.dataView.getInt32(this.pos,!0);return this.pos+=4,a}readFixed64(){const a=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*cb;return this.pos+=8,a}readSFixed64(){const a=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*cb;return this.pos+=8,a}readFloat(){const a=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,a}readDouble(){const a=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,a}readVarint(a){const l=this.buf;let f,m;return m=l[this.pos++],f=127&m,m<128?f:(m=l[this.pos++],f|=(127&m)<<7,m<128?f:(m=l[this.pos++],f|=(127&m)<<14,m<128?f:(m=l[this.pos++],f|=(127&m)<<21,m<128?f:(m=l[this.pos],f|=(15&m)<<28,function(x,b,T){const A=T.buf;let O,D;if(D=A[T.pos++],O=(112&D)>>4,D<128||(D=A[T.pos++],O|=(127&D)<<3,D<128)||(D=A[T.pos++],O|=(127&D)<<10,D<128)||(D=A[T.pos++],O|=(127&D)<<17,D<128)||(D=A[T.pos++],O|=(127&D)<<24,D<128)||(D=A[T.pos++],O|=(1&D)<<31,D<128))return xh(x,O,b);throw new Error("Expected varint not more than 10 bytes")}(f,a,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const a=this.readVarint();return a%2==1?(a+1)/-2:a/2}readBoolean(){return!!this.readVarint()}readString(){const a=this.readVarint()+this.pos,l=this.pos;return this.pos=a,a-l>=12&&fk?fk.decode(this.buf.subarray(l,a)):function(f,m,x){let b="",T=m;for(;T<x;){const A=f[T];let O,D,B,K=null,Y=A>239?4:A>223?3:A>191?2:1;if(T+Y>x)break;Y===1?A<128&&(K=A):Y===2?(O=f[T+1],(192&O)==128&&(K=(31&A)<<6|63&O,K<=127&&(K=null))):Y===3?(O=f[T+1],D=f[T+2],(192&O)==128&&(192&D)==128&&(K=(15&A)<<12|(63&O)<<6|63&D,(K<=2047||K>=55296&&K<=57343)&&(K=null))):Y===4&&(O=f[T+1],D=f[T+2],B=f[T+3],(192&O)==128&&(192&D)==128&&(192&B)==128&&(K=(15&A)<<18|(63&O)<<12|(63&D)<<6|63&B,(K<=65535||K>=1114112)&&(K=null))),K===null?(K=65533,Y=1):K>65535&&(K-=65536,b+=String.fromCharCode(K>>>10&1023|55296),K=56320|1023&K),b+=String.fromCharCode(K),T+=Y}return b}(this.buf,l,a)}readBytes(){const a=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,a);return this.pos=a,l}readPackedVarint(a=[],l){const f=this.readPackedEnd();for(;this.pos<f;)a.push(this.readVarint(l));return a}readPackedSVarint(a=[]){const l=this.readPackedEnd();for(;this.pos<l;)a.push(this.readSVarint());return a}readPackedBoolean(a=[]){const l=this.readPackedEnd();for(;this.pos<l;)a.push(this.readBoolean());return a}readPackedFloat(a=[]){const l=this.readPackedEnd();for(;this.pos<l;)a.push(this.readFloat());return a}readPackedDouble(a=[]){const l=this.readPackedEnd();for(;this.pos<l;)a.push(this.readDouble());return a}readPackedFixed32(a=[]){const l=this.readPackedEnd();for(;this.pos<l;)a.push(this.readFixed32());return a}readPackedSFixed32(a=[]){const l=this.readPackedEnd();for(;this.pos<l;)a.push(this.readSFixed32());return a}readPackedFixed64(a=[]){const l=this.readPackedEnd();for(;this.pos<l;)a.push(this.readFixed64());return a}readPackedSFixed64(a=[]){const l=this.readPackedEnd();for(;this.pos<l;)a.push(this.readSFixed64());return a}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(a){const l=7&a;if(l===0)for(;this.buf[this.pos++]>127;);else if(l===2)this.pos=this.readVarint()+this.pos;else if(l===5)this.pos+=4;else{if(l!==1)throw new Error(`Unimplemented type: ${l}`);this.pos+=8}}writeTag(a,l){this.writeVarint(a<<3|l)}realloc(a){let l=this.length||16;for(;l<this.pos+a;)l*=2;if(l!==this.length){const f=new Uint8Array(l);f.set(this.buf),this.buf=f,this.dataView=new DataView(f.buffer),this.length=l}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(a){this.realloc(4),this.dataView.setInt32(this.pos,a,!0),this.pos+=4}writeSFixed32(a){this.realloc(4),this.dataView.setInt32(this.pos,a,!0),this.pos+=4}writeFixed64(a){this.realloc(8),this.dataView.setInt32(this.pos,-1&a,!0),this.dataView.setInt32(this.pos+4,Math.floor(a*dk),!0),this.pos+=8}writeSFixed64(a){this.realloc(8),this.dataView.setInt32(this.pos,-1&a,!0),this.dataView.setInt32(this.pos+4,Math.floor(a*dk),!0),this.pos+=8}writeVarint(a){(a=+a||0)>268435455||a<0?function(l,f){let m,x;if(l>=0?(m=l%4294967296|0,x=l/4294967296|0):(m=~(-l%4294967296),x=~(-l/4294967296),4294967295^m?m=m+1|0:(m=0,x=x+1|0)),l>=18446744073709552e3||l<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),function(b,T,A){A.buf[A.pos++]=127&b|128,b>>>=7,A.buf[A.pos++]=127&b|128,b>>>=7,A.buf[A.pos++]=127&b|128,b>>>=7,A.buf[A.pos++]=127&b|128,A.buf[A.pos]=127&(b>>>=7)}(m,0,f),function(b,T){const A=(7&b)<<4;T.buf[T.pos++]|=A|((b>>>=3)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b|((b>>>=7)?128:0),b&&(T.buf[T.pos++]=127&b)))))}(x,f)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))}writeSVarint(a){this.writeVarint(a<0?2*-a-1:2*a)}writeBoolean(a){this.writeVarint(+a)}writeString(a){a=String(a),this.realloc(4*a.length),this.pos++;const l=this.pos;this.pos=function(m,x,b){for(let T,A,O=0;O<x.length;O++){if(T=x.charCodeAt(O),T>55295&&T<57344){if(!A){T>56319||O+1===x.length?(m[b++]=239,m[b++]=191,m[b++]=189):A=T;continue}if(T<56320){m[b++]=239,m[b++]=191,m[b++]=189,A=T;continue}T=A-55296<<10|T-56320|65536,A=null}else A&&(m[b++]=239,m[b++]=191,m[b++]=189,A=null);T<128?m[b++]=T:(T<2048?m[b++]=T>>6|192:(T<65536?m[b++]=T>>12|224:(m[b++]=T>>18|240,m[b++]=T>>12&63|128),m[b++]=T>>6&63|128),m[b++]=63&T|128)}return b}(this.buf,a,this.pos);const f=this.pos-l;f>=128&&pk(l,f,this),this.pos=l-1,this.writeVarint(f),this.pos+=f}writeFloat(a){this.realloc(4),this.dataView.setFloat32(this.pos,a,!0),this.pos+=4}writeDouble(a){this.realloc(8),this.dataView.setFloat64(this.pos,a,!0),this.pos+=8}writeBytes(a){const l=a.length;this.writeVarint(l),this.realloc(l);for(let f=0;f<l;f++)this.buf[this.pos++]=a[f]}writeRawMessage(a,l){this.pos++;const f=this.pos;a(l,this);const m=this.pos-f;m>=128&&pk(f,m,this),this.pos=f-1,this.writeVarint(m),this.pos+=m}writeMessage(a,l,f){this.writeTag(a,2),this.writeRawMessage(l,f)}writePackedVarint(a,l){l.length&&this.writeMessage(a,s3,l)}writePackedSVarint(a,l){l.length&&this.writeMessage(a,l3,l)}writePackedBoolean(a,l){l.length&&this.writeMessage(a,h3,l)}writePackedFloat(a,l){l.length&&this.writeMessage(a,c3,l)}writePackedDouble(a,l){l.length&&this.writeMessage(a,u3,l)}writePackedFixed32(a,l){l.length&&this.writeMessage(a,d3,l)}writePackedSFixed32(a,l){l.length&&this.writeMessage(a,f3,l)}writePackedFixed64(a,l){l.length&&this.writeMessage(a,p3,l)}writePackedSFixed64(a,l){l.length&&this.writeMessage(a,m3,l)}writeBytesField(a,l){this.writeTag(a,2),this.writeBytes(l)}writeFixed32Field(a,l){this.writeTag(a,5),this.writeFixed32(l)}writeSFixed32Field(a,l){this.writeTag(a,5),this.writeSFixed32(l)}writeFixed64Field(a,l){this.writeTag(a,1),this.writeFixed64(l)}writeSFixed64Field(a,l){this.writeTag(a,1),this.writeSFixed64(l)}writeVarintField(a,l){this.writeTag(a,0),this.writeVarint(l)}writeSVarintField(a,l){this.writeTag(a,0),this.writeSVarint(l)}writeStringField(a,l){this.writeTag(a,2),this.writeString(l)}writeFloatField(a,l){this.writeTag(a,5),this.writeFloat(l)}writeDoubleField(a,l){this.writeTag(a,1),this.writeDouble(l)}writeBooleanField(a,l){this.writeVarintField(a,+l)}}function xh(c,a,l){return l?4294967296*a+(c>>>0):4294967296*(a>>>0)+(c>>>0)}function pk(c,a,l){const f=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));l.realloc(f);for(let m=l.pos-1;m>=c;m--)l.buf[m+f]=l.buf[m]}function s3(c,a){for(let l=0;l<c.length;l++)a.writeVarint(c[l])}function l3(c,a){for(let l=0;l<c.length;l++)a.writeSVarint(c[l])}function c3(c,a){for(let l=0;l<c.length;l++)a.writeFloat(c[l])}function u3(c,a){for(let l=0;l<c.length;l++)a.writeDouble(c[l])}function h3(c,a){for(let l=0;l<c.length;l++)a.writeBoolean(c[l])}function d3(c,a){for(let l=0;l<c.length;l++)a.writeFixed32(c[l])}function f3(c,a){for(let l=0;l<c.length;l++)a.writeSFixed32(c[l])}function p3(c,a){for(let l=0;l<c.length;l++)a.writeFixed64(c[l])}function m3(c,a){for(let l=0;l<c.length;l++)a.writeSFixed64(c[l])}function g3(c,a,l){c===1&&l.readMessage(y3,a)}function y3(c,a,l){if(c===3){const{id:f,bitmap:m,width:x,height:b,left:T,top:A,advance:O}=l.readMessage(v3,{});a.push({id:f,bitmap:new sp({width:x+6,height:b+6},m),metrics:{width:x,height:b,left:T,top:A,advance:O}})}}function v3(c,a,l){c===1?a.id=l.readVarint():c===2?a.bitmap=l.readBytes():c===3?a.width=l.readVarint():c===4?a.height=l.readVarint():c===5?a.left=l.readSVarint():c===6?a.top=l.readSVarint():c===7&&(a.advance=l.readVarint())}function mk(c){let a=0,l=0;for(const b of c)a+=b.w*b.h,l=Math.max(l,b.w);c.sort((b,T)=>T.h-b.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),l),h:1/0}];let m=0,x=0;for(const b of c)for(let T=f.length-1;T>=0;T--){const A=f[T];if(!(b.w>A.w||b.h>A.h)){if(b.x=A.x,b.y=A.y,x=Math.max(x,b.y+b.h),m=Math.max(m,b.x+b.w),b.w===A.w&&b.h===A.h){const O=f.pop();O&&T<f.length&&(f[T]=O)}else b.h===A.h?(A.x+=b.w,A.w-=b.w):b.w===A.w?(A.y+=b.h,A.h-=b.h):(f.push({x:A.x+b.w,y:A.y,w:A.w-b.w,h:b.h}),A.y+=b.h,A.h-=b.h);break}}return{w:m,h:x,fill:a/(m*x)||0}}class hb{constructor(a,{pixelRatio:l,version:f,stretchX:m,stretchY:x,content:b,textFitWidth:T,textFitHeight:A}){this.paddedRect=a,this.pixelRatio=l,this.stretchX=m,this.stretchY=x,this.content=b,this.version=f,this.textFitWidth=T,this.textFitHeight=A}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class gk{constructor(a,l){const f={},m={};this.haveRenderCallbacks=[];const x=[];this.addImages(a,f,x),this.addImages(l,m,x);const{w:b,h:T}=mk(x),A=new $i({width:b||1,height:T||1});for(const O in a){const D=a[O],B=f[O].paddedRect;$i.copy(D.data,A,{x:0,y:0},{x:B.x+1,y:B.y+1},D.data)}for(const O in l){const D=l[O],B=m[O].paddedRect,K=B.x+1,Y=B.y+1,J=D.data.width,te=D.data.height;$i.copy(D.data,A,{x:0,y:0},{x:K,y:Y},D.data),$i.copy(D.data,A,{x:0,y:te-1},{x:K,y:Y-1},{width:J,height:1}),$i.copy(D.data,A,{x:0,y:0},{x:K,y:Y+te},{width:J,height:1}),$i.copy(D.data,A,{x:J-1,y:0},{x:K-1,y:Y},{width:1,height:te}),$i.copy(D.data,A,{x:0,y:0},{x:K+J,y:Y},{width:1,height:te})}this.image=A,this.iconPositions=f,this.patternPositions=m}addImages(a,l,f){for(const m in a){const x=a[m],b={x:0,y:0,w:x.data.width+2,h:x.data.height+2};f.push(b),l[m]=new hb(b,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(a,l){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in a.updatedImages)this.patchUpdatedImage(this.iconPositions[f],a.getImage(f),l),this.patchUpdatedImage(this.patternPositions[f],a.getImage(f),l)}patchUpdatedImage(a,l,f){if(!a||!l||a.version===l.version)return;a.version=l.version;const[m,x]=a.tl;f.update(l.data,void 0,{x:m,y:x})}}var Pl;yt("ImagePosition",hb),yt("ImageAtlas",gk),d.ao=void 0,(Pl=d.ao||(d.ao={}))[Pl.none=0]="none",Pl[Pl.horizontal=1]="horizontal",Pl[Pl.vertical=2]="vertical",Pl[Pl.horizontalOnly=3]="horizontalOnly";class yp{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(a,l,f){const m=new yp;return m.scale=a||1,m.fontStack=l,m.verticalAlign=f||"bottom",m}static forImage(a,l){const f=new yp;return f.imageName=a,f.verticalAlign=l||"bottom",f}}class bh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,l){const f=new bh;for(let m=0;m<a.sections.length;m++){const x=a.sections[m];x.image?f.addImageSection(x):f.addTextSection(x,l)}return f}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(){this.text=function(a){let l="";for(let f=0;f<a.length;f++){const m=a.charCodeAt(f+1)||null,x=a.charCodeAt(f-1)||null;l+=m&&_y(m)&&!gp[a[f+1]]||x&&_y(x)&&!gp[a[f-1]]||!gp[a[f]]?a[f]:gp[a[f]]}return l}(this.text)}trim(){let a=0;for(let f=0;f<this.text.length&&Ry[this.text.charCodeAt(f)];f++)a++;let l=this.text.length;for(let f=this.text.length-1;f>=0&&f>=a&&Ry[this.text.charCodeAt(f)];f--)l--;this.text=this.text.substring(a,l),this.sectionIndex=this.sectionIndex.slice(a,l)}substring(a,l){const f=new bh;return f.text=this.text.substring(a,l),f.sectionIndex=this.sectionIndex.slice(a,l),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,l)=>Math.max(a,this.sections[l].scale),0)}getMaxImageSize(a){let l=0,f=0;for(let m=0;m<this.length();m++){const x=this.getSection(m);if(x.imageName){const b=a[x.imageName];if(!b)continue;const T=b.displaySize;l=Math.max(l,T[0]),f=Math.max(f,T[1])}}return{maxImageWidth:l,maxImageHeight:f}}addTextSection(a,l){this.text+=a.text,this.sections.push(yp.forText(a.scale,a.fontStack||l,a.verticalAlign));const f=this.sections.length-1;for(let m=0;m<a.text.length;++m)this.sectionIndex.push(f)}addImageSection(a){const l=a.image?a.image.name:"";if(l.length===0)return void It("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(yp.forImage(l,a.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):It("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Dy(c,a,l,f,m,x,b,T,A,O,D,B,K,Y,J){const te=bh.fromFeature(c,m);let ae;B===d.ao.vertical&&te.verticalizePunctuation();const{processBidirectionalText:ce,processStyledBidirectionalText:Pe}=pa;if(ce&&te.sections.length===1){ae=[];const Ne=ce(te.toString(),db(te,O,x,a,f,Y));for(const Fe of Ne){const Qe=new bh;Qe.text=Fe,Qe.sections=te.sections;for(let ft=0;ft<Fe.length;ft++)Qe.sectionIndex.push(0);ae.push(Qe)}}else if(Pe){ae=[];const Ne=Pe(te.text,te.sectionIndex,db(te,O,x,a,f,Y));for(const Fe of Ne){const Qe=new bh;Qe.text=Fe[0],Qe.sectionIndex=Fe[1],Qe.sections=te.sections,ae.push(Qe)}}else ae=function(Ne,Fe){const Qe=[],ft=Ne.text;let st=0;for(const ut of Fe)Qe.push(Ne.substring(st,ut)),st=ut;return st<ft.length&&Qe.push(Ne.substring(st,ft.length)),Qe}(te,db(te,O,x,a,f,Y));const ge=[],ve={positionedLines:ge,text:te.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(Ne,Fe,Qe,ft,st,ut,Tt,ct,ht,He,Ot,Rt){let Ct=0,bt=0,tr=0,qr=0;const wn=ct==="right"?1:ct==="left"?0:.5,ri=An/Rt;let _a=0;for(const zr of st){zr.trim();const Cn=zr.getMaxScale(),Bn={positionedGlyphs:[],lineOffset:0};Ne.positionedLines[_a]=Bn;const Fn=Bn.positionedGlyphs;let Ti=0;if(!zr.length()){bt+=ut,++_a;continue}const xa=w3(ft,zr,ri);for(let Li=0;Li<zr.length();Li++){const Sn=zr.getSection(Li),In=zr.getSectionIndex(Li),jn=zr.getCharCode(Li),pn=S3(ht,Ot,jn);let Or;if(Sn.imageName){if(Ne.iconsInText=!0,Sn.scale=Sn.scale*ri,Or=T3(Sn,pn,Cn,xa,ft),!Or)continue;Ti=Math.max(Ti,Or.imageOffset)}else if(Or=P3(Sn,jn,pn,xa,Fe,Qe),!Or)continue;const{rect:oo,metrics:Th,baselineOffset:so}=Or;Fn.push({glyph:jn,imageName:Sn.imageName,x:Ct,y:bt+so+-17,vertical:pn,scale:Sn.scale,fontStack:Sn.fontStack,sectionIndex:In,metrics:Th,rect:oo}),pn?(Ne.verticalizable=!0,Ct+=(Sn.imageName?Th.advance:An)*Sn.scale+He):Ct+=Th.advance*Sn.scale+He}Fn.length!==0&&(tr=Math.max(Ct-He,tr),k3(Fn,0,Fn.length-1,wn)),Ct=0,Bn.lineOffset=Math.max(Ti,(Cn-1)*An);const Mn=ut*Cn+Ti;bt+=Mn,qr=Math.max(Mn,qr),++_a}const{horizontalAlign:zi,verticalAlign:Ln}=fb(Tt);(function(zr,Cn,Bn,Fn,Ti,xa,Mn,Li,Sn){const In=(Cn-Bn)*Ti;let jn=0;jn=xa!==Mn?-Li*Fn- -17:-Fn*Sn*Mn+.5*Mn;for(const pn of zr)for(const Or of pn.positionedGlyphs)Or.x+=In,Or.y+=jn})(Ne.positionedLines,wn,zi,Ln,tr,qr,ut,bt,st.length),Ne.top+=-Ln*bt,Ne.bottom=Ne.top+bt,Ne.left+=-zi*tr,Ne.right=Ne.left+tr}(ve,a,l,f,ae,b,T,A,B,O,K,J),!function(Ne){for(const Fe of Ne)if(Fe.positionedGlyphs.length!==0)return!1;return!0}(ge)&&ve}const Ry={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_3={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},x3={40:!0};function yk(c,a,l,f,m,x){if(a.imageName){const b=f[a.imageName];return b?b.displaySize[0]*a.scale*An/x+m:0}{const b=l[a.fontStack],T=b&&b[c];return T?T.metrics.advance*a.scale+m:0}}function vk(c,a,l,f){const m=Math.pow(c-a,2);return f?c<a?m/2:2*m:m+Math.abs(l)*l}function b3(c,a,l){let f=0;return c===10&&(f-=1e4),l&&(f+=150),c!==40&&c!==65288||(f+=50),a!==41&&a!==65289||(f+=50),f}function _k(c,a,l,f,m,x){let b=null,T=vk(a,l,m,x);for(const A of f){const O=vk(a-A.x,l,m,x)+A.badness;O<=T&&(b=A,T=O)}return{index:c,x:a,priorBreak:b,badness:T}}function xk(c){return c?xk(c.priorBreak).concat(c.index):[]}function db(c,a,l,f,m,x){if(!c)return[];const b=[],T=function(B,K,Y,J,te,ae){let ce=0;for(let Pe=0;Pe<B.length();Pe++){const ge=B.getSection(Pe);ce+=yk(B.getCharCode(Pe),ge,J,te,K,ae)}return ce/Math.max(1,Math.ceil(ce/Y))}(c,a,l,f,m,x),A=c.text.indexOf("​")>=0;let O=0;for(let B=0;B<c.length();B++){const K=c.getSection(B),Y=c.getCharCode(B);if(Ry[Y]||(O+=yk(Y,K,f,m,a,x)),B<c.length()-1){const J=!((D=Y)<11904)&&(!!er["CJK Compatibility Forms"](D)||!!er["CJK Compatibility"](D)||!!er["CJK Strokes"](D)||!!er["CJK Symbols and Punctuation"](D)||!!er["Enclosed CJK Letters and Months"](D)||!!er["Halfwidth and Fullwidth Forms"](D)||!!er["Ideographic Description Characters"](D)||!!er["Vertical Forms"](D)||Kf.test(String.fromCodePoint(D)));(_3[Y]||J||K.imageName||B!==c.length()-2&&x3[c.getCharCode(B+1)])&&b.push(_k(B+1,O,T,b,b3(Y,c.getCharCode(B+1),J&&A),!1))}}var D;return xk(_k(c.length(),O,T,b,0,!0))}function fb(c){let a=.5,l=.5;switch(c){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:a,verticalAlign:l}}function w3(c,a,l){const f=a.getMaxScale()*An,{maxImageWidth:m,maxImageHeight:x}=a.getMaxImageSize(c),b=Math.max(f,x*l);return{verticalLineContentWidth:Math.max(f,m*l),horizontalLineContentHeight:b}}function bk(c){switch(c){case"top":return 0;case"center":return .5;default:return 1}}function S3(c,a,l){return!(c===d.ao.horizontal||!a&&!Xf(l)||a&&(Ry[l]||(f=l,/\p{sc=Arab}/u.test(String.fromCodePoint(f)))));var f}function P3(c,a,l,f,m,x){const b=x[c.fontStack],T=function(O,D,B,K){if(O&&O.rect)return O;const Y=D[B.fontStack],J=Y&&Y[K];return J?{rect:null,metrics:J.metrics}:null}(b&&b[a],m,c,a);if(T===null)return null;let A;if(l)A=f.verticalLineContentWidth-c.scale*An;else{const O=bk(c.verticalAlign);A=(f.horizontalLineContentHeight-c.scale*An)*O}return{rect:T.rect,metrics:T.metrics,baselineOffset:A}}function T3(c,a,l,f,m){const x=m[c.imageName];if(!x)return null;const b=x.paddedRect,T=x.displaySize,A={width:T[0],height:T[1],left:1,top:-3,advance:a?T[1]:T[0]};let O;if(a)O=f.verticalLineContentWidth-T[1]*c.scale;else{const D=bk(c.verticalAlign);O=(f.horizontalLineContentHeight-T[1]*c.scale)*D}return{rect:b,metrics:A,baselineOffset:O,imageOffset:(a?T[0]:T[1])*c.scale-An*l}}function k3(c,a,l,f){if(f===0)return;const m=c[l],x=(c[l].x+m.metrics.advance*m.scale)*f;for(let b=a;b<=l;b++)c[b].x-=x}function E3(c,a,l){const{horizontalAlign:f,verticalAlign:m}=fb(l),x=a[0]-c.displaySize[0]*f,b=a[1]-c.displaySize[1]*m;return{image:c,top:b,bottom:b+c.displaySize[1],left:x,right:x+c.displaySize[0]}}function wk(c){var a,l;let f=c.left,m=c.top,x=c.right-f,b=c.bottom-m;const T=(a=c.image.textFitWidth)!==null&&a!==void 0?a:"stretchOrShrink",A=(l=c.image.textFitHeight)!==null&&l!==void 0?l:"stretchOrShrink",O=(c.image.content[2]-c.image.content[0])/(c.image.content[3]-c.image.content[1]);if(A==="proportional"){if(T==="stretchOnly"&&x/b<O||T==="proportional"){const D=Math.ceil(b*O);f*=D/x,x=D}}else if(T==="proportional"&&A==="stretchOnly"&&O!==0&&x/b>O){const D=Math.ceil(x/O);m*=D/b,b=D}return{x1:f,y1:m,x2:f+x,y2:m+b}}function Sk(c,a,l,f,m,x){const b=c.image;let T;if(b.content){const ae=b.content,ce=b.pixelRatio||1;T=[ae[0]/ce,ae[1]/ce,b.displaySize[0]-ae[2]/ce,b.displaySize[1]-ae[3]/ce]}const A=a.left*x,O=a.right*x;let D,B,K,Y;l==="width"||l==="both"?(Y=m[0]+A-f[3],B=m[0]+O+f[1]):(Y=m[0]+(A+O-b.displaySize[0])/2,B=Y+b.displaySize[0]);const J=a.top*x,te=a.bottom*x;return l==="height"||l==="both"?(D=m[1]+J-f[0],K=m[1]+te+f[2]):(D=m[1]+(J+te-b.displaySize[1])/2,K=D+b.displaySize[1]),{image:b,top:D,right:B,bottom:K,left:Y,collisionPadding:T}}const ws=128,Tl=32640;function Pk(c,a){const{expression:l}=a;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new kr(c+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:m}=l;let x=0;for(;x<f.length&&f[x]<=c;)x++;x=Math.max(0,x-1);let b=x;for(;b<f.length&&f[b]<c+1;)b++;b=Math.min(f.length-1,b);const T=f[x],A=f[b];return l.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:A,interpolationType:m}:{kind:"camera",minZoom:T,maxZoom:A,minSize:l.evaluate(new kr(T)),maxSize:l.evaluate(new kr(A)),interpolationType:m}}}function pb(c,a,l){let f="never";const m=c.get(a);return m?f=m:c.get(l)&&(f="always"),f}const A3=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ny(c,a,l,f,m,x,b,T,A,O,D,B,K){const Y=T?Math.min(Tl,Math.round(T[0])):0,J=T?Math.min(Tl,Math.round(T[1])):0;c.emplaceBack(a,l,Math.round(32*f),Math.round(32*m),x,b,(Y<<1)+(A?1:0),J,16*O,16*D,256*B,256*K)}function mb(c,a,l){c.emplaceBack(a.x,a.y,l),c.emplaceBack(a.x,a.y,l),c.emplaceBack(a.x,a.y,l),c.emplaceBack(a.x,a.y,l)}function C3(c){for(const a of c.sections)if(wy(a.text))return!0;return!1}class gb{constructor(a){this.layoutVertexArray=new lt,this.indexArray=new _r,this.programConfigurations=a,this.segments=new Ut,this.dynamicLayoutVertexArray=new Ye,this.opacityVertexArray=new xt,this.hasVisibleVertices=!1,this.placedSymbolArray=new Q}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,l,f,m){this.isEmpty()||(f&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,r3.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,n3.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,A3,!0),this.opacityVertexBuffer.itemSize=1),(f||m)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}yt("SymbolBuffers",gb);class yb{constructor(a,l,f){this.layoutVertexArray=new a,this.layoutAttributes=l,this.indexArray=new f,this.segments=new Ut,this.collisionVertexArray=new hr}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,i3.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}yt("CollisionBuffers",yb);class wh{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(b=>b.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Pk(this.zoom,l["text-size"]),this.iconSizeData=Pk(this.zoom,l["icon-size"]);const f=this.layers[0].layout,m=f.get("symbol-sort-key"),x=f.get("symbol-z-order");this.canOverlap=pb(f,"text-overlap","text-allow-overlap")!=="never"||pb(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(b=>d.ao[b])),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=a.sourceID}createArrays(){this.text=new gb(new Ni(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new gb(new Ni(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new le,this.lineVertexArray=new ue,this.symbolInstances=new oe,this.textAnchorOffsets=new de}calculateGlyphDependencies(a,l,f,m,x){for(let b=0;b<a.length;b++)if(l[a.charCodeAt(b)]=!0,(f||m)&&x){const T=gp[a.charAt(b)];T&&(l[T.charCodeAt(0)]=!0)}}populate(a,l,f){const m=this.layers[0],x=m.layout,b=x.get("text-font"),T=x.get("text-field"),A=x.get("icon-image"),O=(T.value.kind!=="constant"||T.value.value instanceof li&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),D=A.value.kind!=="constant"||!!A.value.value||Object.keys(A.parameters).length>0,B=x.get("symbol-sort-key");if(this.features=[],!O&&!D)return;const K=l.iconDependencies,Y=l.glyphDependencies,J=l.availableImages,te=new kr(this.zoom,{globalState:this.globalState});for(const{feature:ae,id:ce,index:Pe,sourceLayerIndex:ge}of a){const ve=m._featureFilter.needGeometry,Ne=ao(ae,ve);if(!m._featureFilter.filter(te,Ne,f))continue;let Fe,Qe;if(ve||(Ne.geometry=Uo(ae)),O){const st=m.getValueAndResolveTokens("text-field",Ne,f,J),ut=li.factory(st),Tt=this.hasRTLText=this.hasRTLText||C3(ut);(!Tt||pa.getRTLTextPluginStatus()==="unavailable"||Tt&&pa.isParsed())&&(Fe=o3(ut,m,Ne))}if(D){const st=m.getValueAndResolveTokens("icon-image",Ne,f,J);Qe=st instanceof Di?st:Di.fromString(st)}if(!Fe&&!Qe)continue;const ft=this.sortFeaturesByKey?B.evaluate(Ne,{},f):void 0;if(this.features.push({id:ce,text:Fe,icon:Qe,index:Pe,sourceLayerIndex:ge,geometry:Ne.geometry,properties:ae.properties,type:_h.types[ae.type],sortKey:ft}),Qe&&(K[Qe.name]=!0),Fe){const st=b.evaluate(Ne,{},f).join(","),ut=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(d.ao.vertical)>=0;for(const Tt of Fe.sections)if(Tt.image)K[Tt.image.name]=!0;else{const ct=ah(Fe.toString()),ht=Tt.fontStack||st,He=Y[ht]=Y[ht]||{};this.calculateGlyphDependencies(Tt.text,He,ut,this.allowVerticalPlacement,ct)}}}x.get("symbol-placement")==="line"&&(this.features=function(ae){const ce={},Pe={},ge=[];let ve=0;function Ne(st){ge.push(ae[st]),ve++}function Fe(st,ut,Tt){const ct=Pe[st];return delete Pe[st],Pe[ut]=ct,ge[ct].geometry[0].pop(),ge[ct].geometry[0]=ge[ct].geometry[0].concat(Tt[0]),ct}function Qe(st,ut,Tt){const ct=ce[ut];return delete ce[ut],ce[st]=ct,ge[ct].geometry[0].shift(),ge[ct].geometry[0]=Tt[0].concat(ge[ct].geometry[0]),ct}function ft(st,ut,Tt){const ct=Tt?ut[0][ut[0].length-1]:ut[0][0];return`${st}:${ct.x}:${ct.y}`}for(let st=0;st<ae.length;st++){const ut=ae[st],Tt=ut.geometry,ct=ut.text?ut.text.toString():null;if(!ct){Ne(st);continue}const ht=ft(ct,Tt),He=ft(ct,Tt,!0);if(ht in Pe&&He in ce&&Pe[ht]!==ce[He]){const Ot=Qe(ht,He,Tt),Rt=Fe(ht,He,ge[Ot].geometry);delete ce[ht],delete Pe[He],Pe[ft(ct,ge[Rt].geometry,!0)]=Rt,ge[Ot].geometry=null}else ht in Pe?Fe(ht,He,Tt):He in ce?Qe(ht,He,Tt):(Ne(st),ce[ht]=ve-1,Pe[He]=ve-1)}return ge.filter(st=>st.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ae,ce)=>ae.sortKey-ce.sortKey)}update(a,l,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,l,this.layers,{imagePositions:f,globalState:this.globalState}),this.icon.programConfigurations.updatePaintArrays(a,l,this.layers,{imagePositions:f,globalState:this.globalState}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,l){const f=this.lineVertexArray.length;if(a.segment!==void 0){let m=a.dist(l[a.segment+1]),x=a.dist(l[a.segment]);const b={};for(let T=a.segment+1;T<l.length;T++)b[T]={x:l[T].x,y:l[T].y,tileUnitDistanceFromAnchor:m},T<l.length-1&&(m+=l[T+1].dist(l[T]));for(let T=a.segment||0;T>=0;T--)b[T]={x:l[T].x,y:l[T].y,tileUnitDistanceFromAnchor:x},T>0&&(x+=l[T-1].dist(l[T]));for(let T=0;T<l.length;T++){const A=b[T];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(a,l,f,m,x,b,T,A,O,D,B,K){const Y=a.indexArray,J=a.layoutVertexArray,te=a.segments.prepareSegment(4*l.length,J,Y,this.canOverlap?b.sortKey:void 0),ae=this.glyphOffsetArray.length,ce=te.vertexLength,Pe=this.allowVerticalPlacement&&T===d.ao.vertical?Math.PI/2:0,ge=b.text&&b.text.sections;for(let ve=0;ve<l.length;ve++){const{tl:Ne,tr:Fe,bl:Qe,br:ft,tex:st,pixelOffsetTL:ut,pixelOffsetBR:Tt,minFontScaleX:ct,minFontScaleY:ht,glyphOffset:He,isSDF:Ot,sectionIndex:Rt}=l[ve],Ct=te.vertexLength,bt=He[1];Ny(J,A.x,A.y,Ne.x,bt+Ne.y,st.x,st.y,f,Ot,ut.x,ut.y,ct,ht),Ny(J,A.x,A.y,Fe.x,bt+Fe.y,st.x+st.w,st.y,f,Ot,Tt.x,ut.y,ct,ht),Ny(J,A.x,A.y,Qe.x,bt+Qe.y,st.x,st.y+st.h,f,Ot,ut.x,Tt.y,ct,ht),Ny(J,A.x,A.y,ft.x,bt+ft.y,st.x+st.w,st.y+st.h,f,Ot,Tt.x,Tt.y,ct,ht),mb(a.dynamicLayoutVertexArray,A,Pe),Y.emplaceBack(Ct,Ct+2,Ct+1),Y.emplaceBack(Ct+1,Ct+2,Ct+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(He[0]),ve!==l.length-1&&Rt===l[ve+1].sectionIndex||a.programConfigurations.populatePaintArrays(J.length,b,b.index,{imagePositions:{},canonical:K,formattedSection:ge&&ge[Rt],globalState:this.globalState})}a.placedSymbolArray.emplaceBack(A.x,A.y,ae,this.glyphOffsetArray.length-ae,ce,O,D,A.segment,f?f[0]:0,f?f[1]:0,m[0],m[1],T,0,!1,0,B)}_addCollisionDebugVertex(a,l,f,m,x,b){return l.emplaceBack(0,0),a.emplaceBack(f.x,f.y,m,x,Math.round(b.x),Math.round(b.y))}addCollisionDebugVertices(a,l,f,m,x,b,T){const A=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),O=A.vertexLength,D=x.layoutVertexArray,B=x.collisionVertexArray,K=T.anchorX,Y=T.anchorY;this._addCollisionDebugVertex(D,B,b,K,Y,new y(a,l)),this._addCollisionDebugVertex(D,B,b,K,Y,new y(f,l)),this._addCollisionDebugVertex(D,B,b,K,Y,new y(f,m)),this._addCollisionDebugVertex(D,B,b,K,Y,new y(a,m)),A.vertexLength+=4;const J=x.indexArray;J.emplaceBack(O,O+1),J.emplaceBack(O+1,O+2),J.emplaceBack(O+2,O+3),J.emplaceBack(O+3,O),A.primitiveLength+=4}addDebugCollisionBoxes(a,l,f,m){for(let x=a;x<l;x++){const b=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,m?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new yb(qt,hk.members,gr),this.iconCollisionBox=new yb(qt,hk.members,gr);for(let a=0;a<this.symbolInstances.length;a++){const l=this.symbolInstances.get(a);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(a,l,f,m,x,b,T,A,O){const D={};for(let B=l;B<f;B++){const K=a.get(B);D.textBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},D.textFeatureIndex=K.featureIndex;break}for(let B=m;B<x;B++){const K=a.get(B);D.verticalTextBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},D.verticalTextFeatureIndex=K.featureIndex;break}for(let B=b;B<T;B++){const K=a.get(B);D.iconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},D.iconFeatureIndex=K.featureIndex;break}for(let B=A;B<O;B++){const K=a.get(B);D.verticalIconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},D.verticalIconFeatureIndex=K.featureIndex;break}return D}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const f=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,l){const f=a.placedSymbolArray.get(l),m=f.vertexStartIndex+4*f.numGlyphs;for(let x=f.vertexStartIndex;x<m;x+=4)a.indexArray.emplaceBack(x,x+2,x+1),a.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(a),f=Math.cos(a),m=[],x=[],b=[];for(let T=0;T<this.symbolInstances.length;++T){b.push(T);const A=this.symbolInstances.get(T);m.push(0|Math.round(l*A.anchorX+f*A.anchorY)),x.push(A.featureIndex)}return b.sort((T,A)=>m[T]-m[A]||x[A]-x[T]),b}addToSortKeyRanges(a,l){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===l?f.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const f=this.symbolInstances.get(l);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((m,x,b)=>{m>=0&&b.indexOf(m)===x&&this.addIndicesForPlacedSymbol(this.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Tk,kk;yt("SymbolBucket",wh,{omit:["layers","collisionBoxArray","features","compareText"]}),wh.MAX_GLYPHS=65535,wh.addDynamicAttributes=mb;var vb={get paint(){return kk=kk||new hi({"icon-opacity":new Mt(Ce.paint_symbol["icon-opacity"]),"icon-color":new Mt(Ce.paint_symbol["icon-color"]),"icon-halo-color":new Mt(Ce.paint_symbol["icon-halo-color"]),"icon-halo-width":new Mt(Ce.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Mt(Ce.paint_symbol["icon-halo-blur"]),"icon-translate":new St(Ce.paint_symbol["icon-translate"]),"icon-translate-anchor":new St(Ce.paint_symbol["icon-translate-anchor"]),"text-opacity":new Mt(Ce.paint_symbol["text-opacity"]),"text-color":new Mt(Ce.paint_symbol["text-color"],{runtimeType:$n,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Mt(Ce.paint_symbol["text-halo-color"]),"text-halo-width":new Mt(Ce.paint_symbol["text-halo-width"]),"text-halo-blur":new Mt(Ce.paint_symbol["text-halo-blur"]),"text-translate":new St(Ce.paint_symbol["text-translate"]),"text-translate-anchor":new St(Ce.paint_symbol["text-translate-anchor"])})},get layout(){return Tk=Tk||new hi({"symbol-placement":new St(Ce.layout_symbol["symbol-placement"]),"symbol-spacing":new St(Ce.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new St(Ce.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Mt(Ce.layout_symbol["symbol-sort-key"]),"symbol-z-order":new St(Ce.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new St(Ce.layout_symbol["icon-allow-overlap"]),"icon-overlap":new St(Ce.layout_symbol["icon-overlap"]),"icon-ignore-placement":new St(Ce.layout_symbol["icon-ignore-placement"]),"icon-optional":new St(Ce.layout_symbol["icon-optional"]),"icon-rotation-alignment":new St(Ce.layout_symbol["icon-rotation-alignment"]),"icon-size":new Mt(Ce.layout_symbol["icon-size"]),"icon-text-fit":new St(Ce.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new St(Ce.layout_symbol["icon-text-fit-padding"]),"icon-image":new Mt(Ce.layout_symbol["icon-image"]),"icon-rotate":new Mt(Ce.layout_symbol["icon-rotate"]),"icon-padding":new Mt(Ce.layout_symbol["icon-padding"]),"icon-keep-upright":new St(Ce.layout_symbol["icon-keep-upright"]),"icon-offset":new Mt(Ce.layout_symbol["icon-offset"]),"icon-anchor":new Mt(Ce.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new St(Ce.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new St(Ce.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new St(Ce.layout_symbol["text-rotation-alignment"]),"text-field":new Mt(Ce.layout_symbol["text-field"]),"text-font":new Mt(Ce.layout_symbol["text-font"]),"text-size":new Mt(Ce.layout_symbol["text-size"]),"text-max-width":new Mt(Ce.layout_symbol["text-max-width"]),"text-line-height":new St(Ce.layout_symbol["text-line-height"]),"text-letter-spacing":new Mt(Ce.layout_symbol["text-letter-spacing"]),"text-justify":new Mt(Ce.layout_symbol["text-justify"]),"text-radial-offset":new Mt(Ce.layout_symbol["text-radial-offset"]),"text-variable-anchor":new St(Ce.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Mt(Ce.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Mt(Ce.layout_symbol["text-anchor"]),"text-max-angle":new St(Ce.layout_symbol["text-max-angle"]),"text-writing-mode":new St(Ce.layout_symbol["text-writing-mode"]),"text-rotate":new Mt(Ce.layout_symbol["text-rotate"]),"text-padding":new St(Ce.layout_symbol["text-padding"]),"text-keep-upright":new St(Ce.layout_symbol["text-keep-upright"]),"text-transform":new Mt(Ce.layout_symbol["text-transform"]),"text-offset":new Mt(Ce.layout_symbol["text-offset"]),"text-allow-overlap":new St(Ce.layout_symbol["text-allow-overlap"]),"text-overlap":new St(Ce.layout_symbol["text-overlap"]),"text-ignore-placement":new St(Ce.layout_symbol["text-ignore-placement"]),"text-optional":new St(Ce.layout_symbol["text-optional"])})}};class Ek{constructor(a){if(a.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=a.property.overrides?a.property.overrides.runtimeType:Qs,this.defaultValue=a}evaluate(a){if(a.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(a.formattedSection))return l.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}yt("FormatSectionOverride",Ek,{omit:["defaultValue"]});class $y extends Ki{constructor(a){super(a,vb)}recalculate(a,l){if(super.recalculate(a,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const m=[];for(const x of f)m.indexOf(x)<0&&m.push(x);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(a,l,f,m){const x=this.layout.get(a).evaluate(l,{},f,m),b=this._unevaluatedLayout._values[a];return b.isDataDriven()||Yu(b.value)||!x?x:function(T,A){return A.replace(/{([^{}]+)}/g,(O,D)=>T&&D in T?String(T[D]):"")}(l.properties,x)}createBucket(a){return new wh(a)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const a of vb.paint.overridableProperties){if(!$y.hasPaintOverride(this.layout,a))continue;const l=this.paint.get(a),f=new Ek(l),m=new $f(f,l.property.specification);let x=null;x=l.value.kind==="constant"||l.value.kind==="source"?new Ec("source",m):new zf("composite",m,l.value.zoomStops),this.paint._values[a]=new $a(l.property,x,l.parameters)}}_handleOverridablePaintPropertyUpdate(a,l,f){return!(!this.layout||l.isDataDriven()||f.isDataDriven())&&$y.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,l){const f=a.get("text-field"),m=vb.paint.properties[l];let x=!1;const b=T=>{for(const A of T)if(m.overrides&&m.overrides.hasOverride(A))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof li)b(f.value.value.sections);else if(f.value.kind==="source"){const T=O=>{x||(O instanceof to&&jt(O.value)===Io?b(O.value.sections):O instanceof ls?b(O.sections):O.eachChild(T))},A=f.value;A._styleExpression&&T(A._styleExpression.expression)}return x}}let Ak;var M3={get paint(){return Ak=Ak||new hi({"background-color":new St(Ce.paint_background["background-color"]),"background-pattern":new $o(Ce.paint_background["background-pattern"]),"background-opacity":new St(Ce.paint_background["background-opacity"])})}};class I3 extends Ki{constructor(a){super(a,M3)}}let Ck;var j3={get paint(){return Ck=Ck||new hi({"raster-opacity":new St(Ce.paint_raster["raster-opacity"]),"raster-hue-rotate":new St(Ce.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new St(Ce.paint_raster["raster-brightness-min"]),"raster-brightness-max":new St(Ce.paint_raster["raster-brightness-max"]),"raster-saturation":new St(Ce.paint_raster["raster-saturation"]),"raster-contrast":new St(Ce.paint_raster["raster-contrast"]),"raster-resampling":new St(Ce.paint_raster["raster-resampling"]),"raster-fade-duration":new St(Ce.paint_raster["raster-fade-duration"])})}};class O3 extends Ki{constructor(a){super(a,j3)}}class D3 extends Ki{constructor(a){super(a,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class R3{constructor(a){this._methodToThrottle=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const N3={once:!0},_b=63710088e-1;class kl{constructor(a,l){if(isNaN(a)||isNaN(l))throw new Error(`Invalid LngLat object: (${a}, ${l})`);if(this.lng=+a,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new kl(or(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const l=Math.PI/180,f=this.lat*l,m=a.lat*l,x=Math.sin(f)*Math.sin(m)+Math.cos(f)*Math.cos(m)*Math.cos((a.lng-this.lng)*l);return _b*Math.acos(Math.min(x,1))}static convert(a){if(a instanceof kl)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new kl(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new kl(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Mk=2*Math.PI*_b;function Ik(c){return Mk*Math.cos(c*Math.PI/180)}function jk(c){return(180+c)/360}function Ok(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Dk(c,a){return c/Ik(a)}function xb(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Rk(c,a){return c*Ik(xb(a))}class vp{constructor(a,l,f=0){this.x=+a,this.y=+l,this.z=+f}static fromLngLat(a,l=0){const f=kl.convert(a);return new vp(jk(f.lng),Ok(f.lat),Dk(l,f.lat))}toLngLat(){return new kl(360*this.x-180,xb(this.y))}toAltitude(){return Rk(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Mk*(a=xb(this.y),1/Math.cos(a*Math.PI/180));var a}}function Nk(c,a,l){var f=2*Math.PI*6378137/256/Math.pow(2,l);return[c*f-2*Math.PI*6378137/2,a*f-2*Math.PI*6378137/2]}class bb{constructor(a,l,f){if(!function(m,x,b){return!(m<0||m>25||b<0||b>=Math.pow(2,m)||x<0||x>=Math.pow(2,m))}(a,l,f))throw new Error(`x=${l}, y=${f}, z=${a} outside of bounds. 0<=x<${Math.pow(2,a)}, 0<=y<${Math.pow(2,a)} 0<=z<=25 `);this.z=a,this.x=l,this.y=f,this.key=Sh(0,a,a,l,f)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,l,f){const m=(b=this.y,T=this.z,A=Nk(256*(x=this.x),256*(b=Math.pow(2,T)-b-1),T),O=Nk(256*(x+1),256*(b+1),T),A[0]+","+A[1]+","+O[0]+","+O[1]);var x,b,T,A,O;const D=function(B,K,Y){let J,te="";for(let ae=B;ae>0;ae--)J=1<<ae-1,te+=(K&J?1:0)+(Y&J?2:0);return te}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,m)}isChildOf(a){const l=this.z-a.z;return l>0&&a.x===this.x>>l&&a.y===this.y>>l}getTilePoint(a){const l=Math.pow(2,this.z);return new y((a.x*l-this.x)*Be,(a.y*l-this.y)*Be)}toString(){return`${this.z}/${this.x}/${this.y}`}}class $k{constructor(a,l){this.wrap=a,this.canonical=l,this.key=Sh(a,l.z,l.z,l.x,l.y)}}class va{constructor(a,l,f,m,x){if(this.terrainRttPosMatrix32f=null,a<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${a}; z = ${f}`);this.overscaledZ=a,this.wrap=l,this.canonical=new bb(f,+m,+x),this.key=Sh(l,a,f,m,x)}clone(){return new va(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-a;return a>this.canonical.z?new va(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new va(a,this.wrap,a,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(a,l){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-a;return a>this.canonical.z?Sh(this.wrap*+l,a,this.canonical.z,this.canonical.x,this.canonical.y):Sh(this.wrap*+l,a,a,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(a){if(a.wrap!==this.wrap)return!1;const l=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>l&&a.canonical.y===this.canonical.y>>l}children(a){if(this.overscaledZ>=a)return[new va(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,f=2*this.canonical.x,m=2*this.canonical.y;return[new va(l,this.wrap,l,f,m),new va(l,this.wrap,l,f+1,m),new va(l,this.wrap,l,f,m+1),new va(l,this.wrap,l,f+1,m+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new va(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new va(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new $k(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new vp(a.x-this.wrap,a.y))}}function Sh(c,a,l,f,m){(c*=2)<0&&(c=-1*c-1);const x=1<<l;return(x*x*c+x*m+f).toString(36)+l.toString(36)+a.toString(36)}function _p(c,a){return a?c.properties[a]:c.id}yt("CanonicalTileID",bb),yt("OverscaledTileID",va,{omit:["terrainRttPosMatrix32f"]});class Bc{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(a){return this.minX=Math.min(this.minX,a.x),this.minY=Math.min(this.minY,a.y),this.maxX=Math.max(this.maxX,a.x),this.maxY=Math.max(this.maxY,a.y),this}expandBy(a){return this.minX-=a,this.minY-=a,this.maxX+=a,this.maxY+=a,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(a){return this.expandBy(-a)}map(a){const l=new Bc;return l.extend(a(new y(this.minX,this.minY))),l.extend(a(new y(this.maxX,this.minY))),l.extend(a(new y(this.minX,this.maxY))),l.extend(a(new y(this.maxX,this.maxY))),l}static fromPoints(a){const l=new Bc;for(const f of a)l.extend(f);return l}contains(a){return a.x>=this.minX&&a.x<=this.maxX&&a.y>=this.minY&&a.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(a){return!this.empty()&&!a.empty()&&a.minX>=this.minX&&a.maxX<=this.maxX&&a.minY>=this.minY&&a.maxY<=this.maxY}intersects(a){return!this.empty()&&!a.empty()&&a.minX<=this.maxX&&a.maxX>=this.minX&&a.minY<=this.maxY&&a.maxY>=this.minY}}class zk{constructor(a){this._stringToNumber={},this._numberToString=[];for(let l=0;l<a.length;l++){const f=a[l];this._stringToNumber[f]=l,this._numberToString[l]=f}}encode(a){return this._stringToNumber[a]}decode(a){if(a>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${a} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[a]}}class Lk{constructor(a,l,f,m,x){this.type="Feature",this._vectorTileFeature=a,a._z=l,a._x=f,a._y=m,this.properties=a.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={geometry:this.geometry};for(const l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(a[l]=this[l]);return a}}class Bk{constructor(a,l){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Dc(Be,16,0),this.grid3D=new Dc(Be,16,0),this.featureIndexArray=new xe,this.promoteId=l}insert(a,l,f,m,x,b){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,m,x);const A=b?this.grid3D:this.grid;for(let O=0;O<l.length;O++){const D=l[O],B=[1/0,1/0,-1/0,-1/0];for(let K=0;K<D.length;K++){const Y=D[K];B[0]=Math.min(B[0],Y.x),B[1]=Math.min(B[1],Y.y),B[2]=Math.max(B[2],Y.x),B[3]=Math.max(B[3],Y.y)}B[0]<Be&&B[1]<Be&&B[2]>=0&&B[3]>=0&&A.insert(T,B[0],B[1],B[2],B[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new rk(new ub(this.rawTileData)).layers,this.sourceLayerCoder=new zk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(a,l,f,m){this.loadVTLayers();const x=a.params,b=Be/a.tileSize/a.scale,T=ps(x.filter),A=a.queryGeometry,O=a.queryPadding*b,D=Bc.fromPoints(A),B=this.grid.query(D.minX-O,D.minY-O,D.maxX+O,D.maxY+O),K=Bc.fromPoints(a.cameraQueryGeometry).expandBy(O),Y=this.grid3D.query(K.minX,K.minY,K.maxX,K.maxY,(ae,ce,Pe,ge)=>function(ve,Ne,Fe,Qe,ft){for(const ut of ve)if(Ne<=ut.x&&Fe<=ut.y&&Qe>=ut.x&&ft>=ut.y)return!0;const st=[new y(Ne,Fe),new y(Ne,ft),new y(Qe,ft),new y(Qe,Fe)];if(ve.length>2){for(const ut of st)if(mh(ve,ut))return!0}for(let ut=0;ut<ve.length-1;ut++)if(pz(ve[ut],ve[ut+1],st))return!0;return!1}(a.cameraQueryGeometry,ae-O,ce-O,Pe+O,ge+O));for(const ae of Y)B.push(ae);B.sort($3);const J={};let te;for(let ae=0;ae<B.length;ae++){const ce=B[ae];if(ce===te)continue;te=ce;const Pe=this.featureIndexArray.get(ce);let ge=null;this.loadMatchingFeature(J,Pe.bucketIndex,Pe.sourceLayerIndex,Pe.featureIndex,T,x.layers,x.availableImages,l,f,m,(ve,Ne,Fe)=>(ge||(ge=Uo(ve)),Ne.queryIntersectsFeature({queryGeometry:A,feature:ve,featureState:Fe,geometry:ge,zoom:this.z,transform:a.transform,pixelsToTileUnits:b,pixelPosMatrix:a.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:a.getElevation})))}return J}loadMatchingFeature(a,l,f,m,x,b,T,A,O,D,B){const K=this.bucketLayerIDs[l];if(b&&!K.some(ae=>b.has(ae)))return;const Y=this.sourceLayerCoder.decode(f),J=this.vtLayers[Y].feature(m);if(x.needGeometry){const ae=ao(J,!0);if(!x.filter(new kr(this.tileID.overscaledZ),ae,this.tileID.canonical))return}else if(!x.filter(new kr(this.tileID.overscaledZ),J))return;const te=this.getId(J,Y);for(let ae=0;ae<K.length;ae++){const ce=K[ae];if(b&&!b.has(ce))continue;const Pe=A[ce];if(!Pe)continue;let ge={};te&&D&&(ge=D.getState(Pe.sourceLayer||"_geojsonTileLayer",te));const ve=rr({},O[ce]);ve.paint=Fk(ve.paint,Pe.paint,J,ge,T),ve.layout=Fk(ve.layout,Pe.layout,J,ge,T);const Ne=!B||B(J,Pe,ge);if(!Ne)continue;const Fe=new Lk(J,this.z,this.x,this.y,te);Fe.layer=ve;let Qe=a[ce];Qe===void 0&&(Qe=a[ce]=[]),Qe.push({featureIndex:m,feature:Fe,intersectionZ:Ne})}}lookupSymbolFeatures(a,l,f,m,x,b,T,A){const O={};this.loadVTLayers();const D=ps(x);for(const B of a)this.loadMatchingFeature(O,f,m,B,D,b,T,A,l);return O}hasLayer(a){for(const l of this.bucketLayerIDs)for(const f of l)if(a===f)return!0;return!1}getId(a,l){var f;let m=a.id;return this.promoteId&&(m=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof m=="boolean"&&(m=Number(m)),m===void 0&&(!((f=a.properties)===null||f===void 0)&&f.cluster)&&this.promoteId&&(m=Number(a.properties.cluster_id))),m}}function Fk(c,a,l,f,m){return Dt(c,(x,b)=>{const T=a instanceof sh?a.get(b):null;return T&&T.evaluate?T.evaluate(l,f,m):T})}function $3(c,a){return a-c}function Uk(c,a,l,f,m){const x=[];for(let b=0;b<c.length;b++){const T=c[b];let A;for(let O=0;O<T.length-1;O++){let D=T[O],B=T[O+1];D.x<a&&B.x<a||(D.x<a?D=new y(a,D.y+(a-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x<a&&(B=new y(a,D.y+(a-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y<l&&B.y<l||(D.y<l?D=new y(D.x+(l-D.y)/(B.y-D.y)*(B.x-D.x),l)._round():B.y<l&&(B=new y(D.x+(l-D.y)/(B.y-D.y)*(B.x-D.x),l)._round()),D.x>=f&&B.x>=f||(D.x>=f?D=new y(f,D.y+(f-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x>=f&&(B=new y(f,D.y+(f-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y>=m&&B.y>=m||(D.y>=m?D=new y(D.x+(m-D.y)/(B.y-D.y)*(B.x-D.x),m)._round():B.y>=m&&(B=new y(D.x+(m-D.y)/(B.y-D.y)*(B.x-D.x),m)._round()),A&&D.equals(A[A.length-1])||(A=[D],x.push(A)),A.push(B)))))}}return x}yt("FeatureIndex",Bk,{omit:["rawTileData","sourceLayerCoder"]});class El extends y{constructor(a,l,f,m){super(a,l),this.angle=f,m!==void 0&&(this.segment=m)}clone(){return new El(this.x,this.y,this.angle,this.segment)}}function Vk(c,a,l,f,m){if(a.segment===void 0||l===0)return!0;let x=a,b=a.segment+1,T=0;for(;T>-l/2;){if(b--,b<0)return!1;T-=c[b].dist(x),x=c[b]}T+=c[b].dist(c[b+1]),b++;const A=[];let O=0;for(;T<l/2;){const D=c[b],B=c[b+1];if(!B)return!1;let K=c[b-1].angleTo(D)-D.angleTo(B);for(K=Math.abs((K+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:T,angleDelta:K}),O+=K;T-A[0].distance>f;)O-=A.shift().angleDelta;if(O>m)return!1;b++,T+=D.dist(B)}return!0}function Gk(c){let a=0;for(let l=0;l<c.length-1;l++)a+=c[l].dist(c[l+1]);return a}function qk(c,a,l){return c?.6*a*l:0}function Wk(c,a){return Math.max(c?c.right-c.left:0,a?a.right-a.left:0)}function z3(c,a,l,f,m,x){const b=qk(l,m,x),T=Wk(l,f)*x;let A=0;const O=Gk(c)/2;for(let D=0;D<c.length-1;D++){const B=c[D],K=c[D+1],Y=B.dist(K);if(A+Y>O){const J=(O-A)/Y,te=Ra.number(B.x,K.x,J),ae=Ra.number(B.y,K.y,J),ce=new El(te,ae,K.angleTo(B),D);return ce._round(),!b||Vk(c,ce,T,b,a)?ce:void 0}A+=Y}}function L3(c,a,l,f,m,x,b,T,A){const O=qk(f,x,b),D=Wk(f,m),B=D*b,K=c[0].x===0||c[0].x===A||c[0].y===0||c[0].y===A;return a-B<a/4&&(a=B+a/4),Hk(c,K?a/2*T%a:(D/2+2*x)*b*T%a,a,O,l,B,K,!1,A)}function Hk(c,a,l,f,m,x,b,T,A){const O=x/2,D=Gk(c);let B=0,K=a-l,Y=[];for(let J=0;J<c.length-1;J++){const te=c[J],ae=c[J+1],ce=te.dist(ae),Pe=ae.angleTo(te);for(;K+l<B+ce;){K+=l;const ge=(K-B)/ce,ve=Ra.number(te.x,ae.x,ge),Ne=Ra.number(te.y,ae.y,ge);if(ve>=0&&ve<A&&Ne>=0&&Ne<A&&K-O>=0&&K+O<=D){const Fe=new El(ve,Ne,Pe,J);Fe._round(),f&&!Vk(c,Fe,x,f,m)||Y.push(Fe)}}B+=ce}return T||Y.length||b||(Y=Hk(c,B/2,l,f,m,x,b,!0,A)),Y}function Zk(c,a,l,f){const m=[],x=c.image,b=x.pixelRatio,T=x.paddedRect.w-2,A=x.paddedRect.h-2;let O={x1:c.left,y1:c.top,x2:c.right,y2:c.bottom};const D=x.stretchX||[[0,T]],B=x.stretchY||[[0,A]],K=(He,Ot)=>He+Ot[1]-Ot[0],Y=D.reduce(K,0),J=B.reduce(K,0),te=T-Y,ae=A-J;let ce=0,Pe=Y,ge=0,ve=J,Ne=0,Fe=te,Qe=0,ft=ae;if(x.content&&f){const He=x.content,Ot=He[2]-He[0],Rt=He[3]-He[1];(x.textFitWidth||x.textFitHeight)&&(O=wk(c)),ce=zy(D,0,He[0]),ge=zy(B,0,He[1]),Pe=zy(D,He[0],He[2]),ve=zy(B,He[1],He[3]),Ne=He[0]-ce,Qe=He[1]-ge,Fe=Ot-Pe,ft=Rt-ve}const st=O.x1,ut=O.y1,Tt=O.x2-st,ct=O.y2-ut,ht=(He,Ot,Rt,Ct)=>{const bt=Ly(He.stretch-ce,Pe,Tt,st),tr=By(He.fixed-Ne,Fe,He.stretch,Y),qr=Ly(Ot.stretch-ge,ve,ct,ut),wn=By(Ot.fixed-Qe,ft,Ot.stretch,J),ri=Ly(Rt.stretch-ce,Pe,Tt,st),_a=By(Rt.fixed-Ne,Fe,Rt.stretch,Y),zi=Ly(Ct.stretch-ge,ve,ct,ut),Ln=By(Ct.fixed-Qe,ft,Ct.stretch,J),zr=new y(bt,qr),Cn=new y(ri,qr),Bn=new y(ri,zi),Fn=new y(bt,zi),Ti=new y(tr/b,wn/b),xa=new y(_a/b,Ln/b),Mn=a*Math.PI/180;if(Mn){const In=Math.sin(Mn),jn=Math.cos(Mn),pn=[jn,-In,In,jn];zr._matMult(pn),Cn._matMult(pn),Fn._matMult(pn),Bn._matMult(pn)}const Li=He.stretch+He.fixed,Sn=Ot.stretch+Ot.fixed;return{tl:zr,tr:Cn,bl:Fn,br:Bn,tex:{x:x.paddedRect.x+1+Li,y:x.paddedRect.y+1+Sn,w:Rt.stretch+Rt.fixed-Li,h:Ct.stretch+Ct.fixed-Sn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ti,pixelOffsetBR:xa,minFontScaleX:Fe/b/Tt,minFontScaleY:ft/b/ct,isSDF:l}};if(f&&(x.stretchX||x.stretchY)){const He=Kk(D,te,Y),Ot=Kk(B,ae,J);for(let Rt=0;Rt<He.length-1;Rt++){const Ct=He[Rt],bt=He[Rt+1];for(let tr=0;tr<Ot.length-1;tr++)m.push(ht(Ct,Ot[tr],bt,Ot[tr+1]))}}else m.push(ht({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:A+1}));return m}function zy(c,a,l){let f=0;for(const m of c)f+=Math.max(a,Math.min(l,m[1]))-Math.max(a,Math.min(l,m[0]));return f}function Kk(c,a,l){const f=[{fixed:-1,stretch:0}];for(const[m,x]of c){const b=f[f.length-1];f.push({fixed:m-b.stretch,stretch:b.stretch}),f.push({fixed:m-b.stretch,stretch:b.stretch+(x-m)})}return f.push({fixed:a+1,stretch:l}),f}function Ly(c,a,l,f){return c/a*l+f}function By(c,a,l,f){return c-a*l/f}yt("Anchor",El);class Fy{constructor(a,l,f,m,x,b,T,A,O,D){var B;if(this.boxStartIndex=a.length,O){let K=b.top,Y=b.bottom;const J=b.collisionPadding;J&&(K-=J[1],Y+=J[3]);let te=Y-K;te>0&&(te=Math.max(10,te),this.circleDiameter=te)}else{const K=!((B=b.image)===null||B===void 0)&&B.content&&(b.image.textFitWidth||b.image.textFitHeight)?wk(b):{x1:b.left,y1:b.top,x2:b.right,y2:b.bottom};K.y1=K.y1*T-A[0],K.y2=K.y2*T+A[2],K.x1=K.x1*T-A[3],K.x2=K.x2*T+A[1];const Y=b.collisionPadding;if(Y&&(K.x1-=Y[0]*T,K.y1-=Y[1]*T,K.x2+=Y[2]*T,K.y2+=Y[3]*T),D){const J=new y(K.x1,K.y1),te=new y(K.x2,K.y1),ae=new y(K.x1,K.y2),ce=new y(K.x2,K.y2),Pe=D*Math.PI/180;J._rotate(Pe),te._rotate(Pe),ae._rotate(Pe),ce._rotate(Pe),K.x1=Math.min(J.x,te.x,ae.x,ce.x),K.x2=Math.max(J.x,te.x,ae.x,ce.x),K.y1=Math.min(J.y,te.y,ae.y,ce.y),K.y2=Math.max(J.y,te.y,ae.y,ce.y)}a.emplaceBack(l.x,l.y,K.x1,K.y1,K.x2,K.y2,f,m,x)}this.boxEndIndex=a.length}}class B3{constructor(a=[],l=(f,m)=>f<m?-1:f>m?1:0){if(this.data=a,this.length=this.data.length,this.compare=l,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:l,compare:f}=this,m=l[a];for(;a>0;){const x=a-1>>1,b=l[x];if(f(m,b)>=0)break;l[a]=b,a=x}l[a]=m}_down(a){const{data:l,compare:f}=this,m=this.length>>1,x=l[a];for(;a<m;){let b=1+(a<<1);const T=b+1;if(T<this.length&&f(l[T],l[b])<0&&(b=T),f(l[b],x)>=0)break;l[a]=l[b],a=b}l[a]=x}}function F3(c,a=1,l=!1){const f=Bc.fromPoints(c[0]),m=Math.min(f.width(),f.height());let x=m/2;const b=new B3([],U3),{minX:T,minY:A,maxX:O,maxY:D}=f;if(m===0)return new y(T,A);for(let Y=T;Y<O;Y+=m)for(let J=A;J<D;J+=m)b.push(new Ph(Y+x,J+x,x,c));let B=function(Y){let J=0,te=0,ae=0;const ce=Y[0];for(let Pe=0,ge=ce.length,ve=ge-1;Pe<ge;ve=Pe++){const Ne=ce[Pe],Fe=ce[ve],Qe=Ne.x*Fe.y-Fe.x*Ne.y;te+=(Ne.x+Fe.x)*Qe,ae+=(Ne.y+Fe.y)*Qe,J+=3*Qe}return new Ph(te/J,ae/J,0,Y)}(c),K=b.length;for(;b.length;){const Y=b.pop();(Y.d>B.d||!B.d)&&(B=Y,l&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,K)),Y.max-B.d<=a||(x=Y.h/2,b.push(new Ph(Y.p.x-x,Y.p.y-x,x,c)),b.push(new Ph(Y.p.x+x,Y.p.y-x,x,c)),b.push(new Ph(Y.p.x-x,Y.p.y+x,x,c)),b.push(new Ph(Y.p.x+x,Y.p.y+x,x,c)),K+=4)}return l&&(console.log(`num probes: ${K}`),console.log(`best distance: ${B.d}`)),B.p}function U3(c,a){return a.max-c.max}function Ph(c,a,l,f){this.p=new y(c,a),this.h=l,this.d=function(m,x){let b=!1,T=1/0;for(let A=0;A<x.length;A++){const O=x[A];for(let D=0,B=O.length,K=B-1;D<B;K=D++){const Y=O[D],J=O[K];Y.y>m.y!=J.y>m.y&&m.x<(J.x-Y.x)*(m.y-Y.y)/(J.y-Y.y)+Y.x&&(b=!b),T=Math.min(T,OT(m,Y,J))}}return(b?1:-1)*Math.sqrt(T)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var ti;d.aE=void 0,(ti=d.aE||(d.aE={}))[ti.center=1]="center",ti[ti.left=2]="left",ti[ti.right=3]="right",ti[ti.top=4]="top",ti[ti.bottom=5]="bottom",ti[ti["top-left"]=6]="top-left",ti[ti["top-right"]=7]="top-right",ti[ti["bottom-left"]=8]="bottom-left",ti[ti["bottom-right"]=9]="bottom-right";const wb=Number.POSITIVE_INFINITY;function Xk(c,a){return a[1]!==wb?function(l,f,m){let x=0,b=0;switch(f=Math.abs(f),m=Math.abs(m),l){case"top-right":case"top-left":case"top":b=m-7;break;case"bottom-right":case"bottom-left":case"bottom":b=7-m}switch(l){case"top-right":case"bottom-right":case"right":x=-f;break;case"top-left":case"bottom-left":case"left":x=f}return[x,b]}(c,a[0],a[1]):function(l,f){let m=0,x=0;f<0&&(f=0);const b=f/Math.SQRT2;switch(l){case"top-right":case"top-left":x=b-7;break;case"bottom-right":case"bottom-left":x=7-b;break;case"bottom":x=7-f;break;case"top":x=f-7}switch(l){case"top-right":case"bottom-right":m=-b;break;case"top-left":case"bottom-left":m=b;break;case"left":m=f;break;case"right":m=-f}return[m,x]}(c,a[0])}function Yk(c,a,l){var f;const m=c.layout,x=(f=m.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(a,{},l);if(x){const T=x.values,A=[];for(let O=0;O<T.length;O+=2){const D=A[O]=T[O],B=T[O+1].map(K=>K*An);D.startsWith("top")?B[1]-=7:D.startsWith("bottom")&&(B[1]+=7),A[O+1]=B}return new ui(A)}const b=m.get("text-variable-anchor");if(b){let T;T=c._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(a,{},l)*An,wb]:m.get("text-offset").evaluate(a,{},l).map(O=>O*An);const A=[];for(const O of b)A.push(O,Xk(O,T));return new ui(A)}return null}function Sb(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function V3(c,a,l,f,m,x,b,T,A,O,D,B){let K=x.textMaxSize.evaluate(a,{});K===void 0&&(K=b);const Y=c.layers[0].layout,J=Y.get("icon-offset").evaluate(a,{},D),te=Qk(l.horizontal),ae=b/24,ce=c.tilePixelRatio*ae,Pe=c.tilePixelRatio*K/24,ge=c.tilePixelRatio*T,ve=c.tilePixelRatio*Y.get("symbol-spacing"),Ne=Y.get("text-padding")*c.tilePixelRatio,Fe=function(Rt,Ct,bt,tr=1){const qr=Rt.get("icon-padding").evaluate(Ct,{},bt),wn=qr&&qr.values;return[wn[0]*tr,wn[1]*tr,wn[2]*tr,wn[3]*tr]}(Y,a,D,c.tilePixelRatio),Qe=Y.get("text-max-angle")/180*Math.PI,ft=Y.get("text-rotation-alignment")!=="viewport"&&Y.get("symbol-placement")!=="point",st=Y.get("icon-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",ut=Y.get("symbol-placement"),Tt=ve/2,ct=Y.get("icon-text-fit");let ht;f&&ct!=="none"&&(c.allowVerticalPlacement&&l.vertical&&(ht=Sk(f,l.vertical,ct,Y.get("icon-text-fit-padding"),J,ae)),te&&(f=Sk(f,te,ct,Y.get("icon-text-fit-padding"),J,ae)));const He=D?B.line.getGranularityForZoomLevel(D.z):1,Ot=(Rt,Ct)=>{Ct.x<0||Ct.x>=Be||Ct.y<0||Ct.y>=Be||function(bt,tr,qr,wn,ri,_a,zi,Ln,zr,Cn,Bn,Fn,Ti,xa,Mn,Li,Sn,In,jn,pn,Or,oo,Th,so,W3){const kh=bt.addToLineVertexArray(tr,qr);let Fc,Eh,Ah,Ch,nE=0,iE=0,aE=0,oE=0,Ib=-1,jb=-1;const Ss={};let sE=wl("");if(bt.allowVerticalPlacement&&wn.vertical){const pi=Ln.layout.get("text-rotate").evaluate(Or,{},so)+90;Ah=new Fy(zr,tr,Cn,Bn,Fn,wn.vertical,Ti,xa,Mn,pi),zi&&(Ch=new Fy(zr,tr,Cn,Bn,Fn,zi,Sn,In,Mn,pi))}if(ri){const pi=Ln.layout.get("icon-rotate").evaluate(Or,{}),ba=Ln.layout.get("icon-text-fit")!=="none",Uc=Zk(ri,pi,Th,ba),co=zi?Zk(zi,pi,Th,ba):void 0;Eh=new Fy(zr,tr,Cn,Bn,Fn,ri,Sn,In,!1,pi),nE=4*Uc.length;const Vc=bt.iconSizeData;let Vo=null;Vc.kind==="source"?(Vo=[ws*Ln.layout.get("icon-size").evaluate(Or,{})],Vo[0]>Tl&&It(`${bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Vc.kind==="composite"&&(Vo=[ws*oo.compositeIconSizes[0].evaluate(Or,{},so),ws*oo.compositeIconSizes[1].evaluate(Or,{},so)],(Vo[0]>Tl||Vo[1]>Tl)&&It(`${bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),bt.addSymbols(bt.icon,Uc,Vo,pn,jn,Or,d.ao.none,tr,kh.lineStartIndex,kh.lineLength,-1,so),Ib=bt.icon.placedSymbolArray.length-1,co&&(iE=4*co.length,bt.addSymbols(bt.icon,co,Vo,pn,jn,Or,d.ao.vertical,tr,kh.lineStartIndex,kh.lineLength,-1,so),jb=bt.icon.placedSymbolArray.length-1)}const lE=Object.keys(wn.horizontal);for(const pi of lE){const ba=wn.horizontal[pi];if(!Fc){sE=wl(ba.text);const co=Ln.layout.get("text-rotate").evaluate(Or,{},so);Fc=new Fy(zr,tr,Cn,Bn,Fn,ba,Ti,xa,Mn,co)}const Uc=ba.positionedLines.length===1;if(aE+=Jk(bt,tr,ba,_a,Ln,Mn,Or,Li,kh,wn.vertical?d.ao.horizontal:d.ao.horizontalOnly,Uc?lE:[pi],Ss,Ib,oo,so),Uc)break}wn.vertical&&(oE+=Jk(bt,tr,wn.vertical,_a,Ln,Mn,Or,Li,kh,d.ao.vertical,["vertical"],Ss,jb,oo,so));const H3=Fc?Fc.boxStartIndex:bt.collisionBoxArray.length,Z3=Fc?Fc.boxEndIndex:bt.collisionBoxArray.length,K3=Ah?Ah.boxStartIndex:bt.collisionBoxArray.length,X3=Ah?Ah.boxEndIndex:bt.collisionBoxArray.length,Y3=Eh?Eh.boxStartIndex:bt.collisionBoxArray.length,J3=Eh?Eh.boxEndIndex:bt.collisionBoxArray.length,Q3=Ch?Ch.boxStartIndex:bt.collisionBoxArray.length,eL=Ch?Ch.boxEndIndex:bt.collisionBoxArray.length;let lo=-1;const Vy=(pi,ba)=>pi&&pi.circleDiameter?Math.max(pi.circleDiameter,ba):ba;lo=Vy(Fc,lo),lo=Vy(Ah,lo),lo=Vy(Eh,lo),lo=Vy(Ch,lo);const cE=lo>-1?1:0;cE&&(lo*=W3/An),bt.glyphOffsetArray.length>=wh.MAX_GLYPHS&&It("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Or.sortKey!==void 0&&bt.addToSortKeyRanges(bt.symbolInstances.length,Or.sortKey);const tL=Yk(Ln,Or,so),[rL,nL]=function(pi,ba){const Uc=pi.length,co=ba==null?void 0:ba.values;if((co==null?void 0:co.length)>0)for(let Vc=0;Vc<co.length;Vc+=2){const Vo=co[Vc+1];pi.emplaceBack(d.aE[co[Vc]],Vo[0],Vo[1])}return[Uc,pi.length]}(bt.textAnchorOffsets,tL);bt.symbolInstances.emplaceBack(tr.x,tr.y,Ss.right>=0?Ss.right:-1,Ss.center>=0?Ss.center:-1,Ss.left>=0?Ss.left:-1,Ss.vertical||-1,Ib,jb,sE,H3,Z3,K3,X3,Y3,J3,Q3,eL,Cn,aE,oE,nE,iE,cE,0,Ti,lo,rL,nL)}(c,Ct,Rt,l,f,m,ht,c.layers[0],c.collisionBoxArray,a.index,a.sourceLayerIndex,c.index,ce,[Ne,Ne,Ne,Ne],ft,A,ge,Fe,st,J,a,x,O,D,b)};if(ut==="line")for(const Rt of Uk(a.geometry,0,0,Be,Be)){const Ct=Lc(Rt,He),bt=L3(Ct,ve,Qe,l.vertical||te,f,24,Pe,c.overscaling,Be);for(const tr of bt)te&&G3(c,te.text,Tt,tr)||Ot(Ct,tr)}else if(ut==="line-center"){for(const Rt of a.geometry)if(Rt.length>1){const Ct=Lc(Rt,He),bt=z3(Ct,Qe,l.vertical||te,f,24,Pe);bt&&Ot(Ct,bt)}}else if(a.type==="Polygon")for(const Rt of wc(a.geometry,0)){const Ct=F3(Rt,16);Ot(Lc(Rt[0],He,!0),new El(Ct.x,Ct.y,0))}else if(a.type==="LineString")for(const Rt of a.geometry){const Ct=Lc(Rt,He);Ot(Ct,new El(Ct[0].x,Ct[0].y,0))}else if(a.type==="Point")for(const Rt of a.geometry)for(const Ct of Rt)Ot([Ct],new El(Ct.x,Ct.y,0))}function Jk(c,a,l,f,m,x,b,T,A,O,D,B,K,Y,J){const te=function(Pe,ge,ve,Ne,Fe,Qe,ft,st){const ut=Ne.layout.get("text-rotate").evaluate(Qe,{})*Math.PI/180,Tt=[];for(const ct of ge.positionedLines)for(const ht of ct.positionedGlyphs){if(!ht.rect)continue;const He=ht.rect||{};let Ot=4,Rt=!0,Ct=1,bt=0;const tr=(Fe||st)&&ht.vertical,qr=ht.metrics.advance*ht.scale/2;if(st&&ge.verticalizable&&(bt=ct.lineOffset/2-(ht.imageName?-(An-ht.metrics.width*ht.scale)/2:(ht.scale-1)*An)),ht.imageName){const In=ft[ht.imageName];Rt=In.sdf,Ct=In.pixelRatio,Ot=1/Ct}const wn=Fe?[ht.x+qr,ht.y]:[0,0];let ri=Fe?[0,0]:[ht.x+qr+ve[0],ht.y+ve[1]-bt],_a=[0,0];tr&&(_a=ri,ri=[0,0]);const zi=ht.metrics.isDoubleResolution?2:1,Ln=(ht.metrics.left-Ot)*ht.scale-qr+ri[0],zr=(-ht.metrics.top-Ot)*ht.scale+ri[1],Cn=Ln+He.w/zi*ht.scale/Ct,Bn=zr+He.h/zi*ht.scale/Ct,Fn=new y(Ln,zr),Ti=new y(Cn,zr),xa=new y(Ln,Bn),Mn=new y(Cn,Bn);if(tr){const In=new y(-qr,qr- -17),jn=-Math.PI/2,pn=12-qr,Or=new y(22-pn,-(ht.imageName?pn:0)),oo=new y(..._a);Fn._rotateAround(jn,In)._add(Or)._add(oo),Ti._rotateAround(jn,In)._add(Or)._add(oo),xa._rotateAround(jn,In)._add(Or)._add(oo),Mn._rotateAround(jn,In)._add(Or)._add(oo)}if(ut){const In=Math.sin(ut),jn=Math.cos(ut),pn=[jn,-In,In,jn];Fn._matMult(pn),Ti._matMult(pn),xa._matMult(pn),Mn._matMult(pn)}const Li=new y(0,0),Sn=new y(0,0);Tt.push({tl:Fn,tr:Ti,bl:xa,br:Mn,tex:He,writingMode:ge.writingMode,glyphOffset:wn,sectionIndex:ht.sectionIndex,isSDF:Rt,pixelOffsetTL:Li,pixelOffsetBR:Sn,minFontScaleX:0,minFontScaleY:0})}return Tt}(0,l,T,m,x,b,f,c.allowVerticalPlacement),ae=c.textSizeData;let ce=null;ae.kind==="source"?(ce=[ws*m.layout.get("text-size").evaluate(b,{})],ce[0]>Tl&&It(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ae.kind==="composite"&&(ce=[ws*Y.compositeTextSizes[0].evaluate(b,{},J),ws*Y.compositeTextSizes[1].evaluate(b,{},J)],(ce[0]>Tl||ce[1]>Tl)&&It(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,te,ce,T,x,b,O,a,A.lineStartIndex,A.lineLength,K,J);for(const Pe of D)B[Pe]=c.text.placedSymbolArray.length-1;return 4*te.length}function Qk(c){for(const a in c)return c[a];return null}function G3(c,a,l,f){const m=c.compareText;if(a in m){const x=m[a];for(let b=x.length-1;b>=0;b--)if(f.dist(x[b])<l)return!0}else m[a]=[];return m[a].push(f),!1}const eE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Pb{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,f]=new Uint8Array(a,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=f>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const x=eE[15&f];if(!x)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(a,2,1),[T]=new Uint32Array(a,4,1);return new Pb(T,b,x,a)}constructor(a,l=64,f=Float64Array,m){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=f,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;const x=eE.indexOf(this.ArrayType),b=2*a*this.ArrayType.BYTES_PER_ELEMENT,T=a*this.IndexArrayType.BYTES_PER_ELEMENT,A=(8-T%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${f}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+T+A,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+b+T+A),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+T+A,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=a)}add(a,l){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=a,this.coords[this._pos++]=l,f}finish(){const a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return Tb(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,l,f,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:b,nodeSize:T}=this,A=[0,x.length-1,0],O=[];for(;A.length;){const D=A.pop()||0,B=A.pop()||0,K=A.pop()||0;if(B-K<=T){for(let ae=K;ae<=B;ae++){const ce=b[2*ae],Pe=b[2*ae+1];ce>=a&&ce<=f&&Pe>=l&&Pe<=m&&O.push(x[ae])}continue}const Y=K+B>>1,J=b[2*Y],te=b[2*Y+1];J>=a&&J<=f&&te>=l&&te<=m&&O.push(x[Y]),(D===0?a<=J:l<=te)&&(A.push(K),A.push(Y-1),A.push(1-D)),(D===0?f>=J:m>=te)&&(A.push(Y+1),A.push(B),A.push(1-D))}return O}within(a,l,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:x,nodeSize:b}=this,T=[0,m.length-1,0],A=[],O=f*f;for(;T.length;){const D=T.pop()||0,B=T.pop()||0,K=T.pop()||0;if(B-K<=b){for(let ae=K;ae<=B;ae++)rE(x[2*ae],x[2*ae+1],a,l)<=O&&A.push(m[ae]);continue}const Y=K+B>>1,J=x[2*Y],te=x[2*Y+1];rE(J,te,a,l)<=O&&A.push(m[Y]),(D===0?a-f<=J:l-f<=te)&&(T.push(K),T.push(Y-1),T.push(1-D)),(D===0?a+f>=J:l+f>=te)&&(T.push(Y+1),T.push(B),T.push(1-D))}return A}}function Tb(c,a,l,f,m,x){if(m-f<=l)return;const b=f+m>>1;tE(c,a,b,f,m,x),Tb(c,a,l,f,b-1,1-x),Tb(c,a,l,b+1,m,1-x)}function tE(c,a,l,f,m,x){for(;m>f;){if(m-f>600){const O=m-f+1,D=l-f+1,B=Math.log(O),K=.5*Math.exp(2*B/3),Y=.5*Math.sqrt(B*K*(O-K)/O)*(D-O/2<0?-1:1);tE(c,a,l,Math.max(f,Math.floor(l-D*K/O+Y)),Math.min(m,Math.floor(l+(O-D)*K/O+Y)),x)}const b=a[2*l+x];let T=f,A=m;for(xp(c,a,f,l),a[2*m+x]>b&&xp(c,a,f,m);T<A;){for(xp(c,a,T,A),T++,A--;a[2*T+x]<b;)T++;for(;a[2*A+x]>b;)A--}a[2*f+x]===b?xp(c,a,f,A):(A++,xp(c,a,A,m)),A<=l&&(f=A+1),l<=A&&(m=A-1)}}function xp(c,a,l,f){kb(c,l,f),kb(a,2*l,2*f),kb(a,2*l+1,2*f+1)}function kb(c,a,l){const f=c[a];c[a]=c[l],c[l]=f}function rE(c,a,l,f){const m=c-l,x=a-f;return m*m+x*x}var Eb;d.cx=void 0,(Eb=d.cx||(d.cx={})).create="create",Eb.load="load",Eb.fullLoad="fullLoad";let Uy=null,bp=[];const Ab=1e3/60,Cb="loadTime",Mb="fullLoadTime",q3={mark(c){performance.mark(c)},frame(c){const a=c;Uy!=null&&bp.push(a-Uy),Uy=a},clearMetrics(){Uy=null,bp=[],performance.clearMeasures(Cb),performance.clearMeasures(Mb);for(const c in d.cx)performance.clearMarks(d.cx[c])},getPerformanceMetrics(){performance.measure(Cb,d.cx.create,d.cx.load),performance.measure(Mb,d.cx.create,d.cx.fullLoad);const c=performance.getEntriesByName(Cb)[0].duration,a=performance.getEntriesByName(Mb)[0].duration,l=bp.length,f=1/(bp.reduce((x,b)=>x+b,0)/l/1e3),m=bp.filter(x=>x>Ab).reduce((x,b)=>x+(b-Ab)/Ab,0);return{loadTime:c,fullLoadTime:a,fps:f,percentDroppedFrames:m/(l+m)*100,totalFrames:l}}};d.$=Be,d.A=N,d.B=function([c,a,l]){return a+=90,a*=Math.PI/180,l*=Math.PI/180,{x:c*Math.cos(a)*Math.sin(l),y:c*Math.sin(a)*Math.sin(l),z:c*Math.cos(l)}},d.C=Ra,d.D=St,d.E=wt,d.F=kr,d.G=jc,d.H=function(c){if(Yr==null){const a=c.navigator?c.navigator.userAgent:null;Yr=!!c.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return Yr},d.I=hb,d.J=class{constructor(c,a){this.target=c,this.mapId=a,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new R3(()=>this.process()),this.subscription=Wi(this.target,"message",l=>this.receive(l),!1),this.globalScope=mr(self)?c:window}registerMessageHandler(c,a){this.messageHandlers[c]=a}sendAsync(c,a){return new Promise((l,f)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10),x=a?Wi(a.signal,"abort",()=>{x==null||x.unsubscribe(),delete this.resolveRejects[m];const A={id:m,type:"<cancel>",origin:location.origin,targetMapId:c.targetMapId,sourceMapId:this.mapId};this.target.postMessage(A)},N3):null;this.resolveRejects[m]={resolve:A=>{x==null||x.unsubscribe(),l(A)},reject:A=>{x==null||x.unsubscribe(),f(A)}};const b=[],T=Object.assign(Object.assign({},c),{id:m,sourceMapId:this.mapId,origin:location.origin,data:gl(c.data,b)});this.target.postMessage(T,{transfer:b})})}receive(c){const a=c.data,l=a.id;if(!(a.origin!=="file://"&&location.origin!=="file://"&&a.origin!=="resource://android"&&location.origin!=="resource://android"&&a.origin!==location.origin||a.targetMapId&&this.mapId!==a.targetMapId)){if(a.type==="<cancel>"){delete this.tasks[l];const f=this.abortControllers[l];return delete this.abortControllers[l],void(f&&f.abort())}if(mr(self)||a.mustQueue)return this.tasks[l]=a,this.taskQueue.push(l),void this.invoker.trigger();this.processTask(l,a)}}process(){if(this.taskQueue.length===0)return;const c=this.taskQueue.shift(),a=this.tasks[c];delete this.tasks[c],this.taskQueue.length>0&&this.invoker.trigger(),a&&this.processTask(c,a)}processTask(c,a){return s(this,void 0,void 0,function*(){if(a.type==="<response>"){const m=this.resolveRejects[c];return delete this.resolveRejects[c],m?void(a.error?m.reject(ys(a.error)):m.resolve(ys(a.data))):void 0}if(!this.messageHandlers[a.type])return void this.completeTask(c,new Error(`Could not find a registered handler for ${a.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const l=ys(a.data),f=new AbortController;this.abortControllers[c]=f;try{const m=yield this.messageHandlers[a.type](a.sourceMapId,l,f);this.completeTask(c,null,m)}catch(m){this.completeTask(c,m)}})}completeTask(c,a,l){const f=[];delete this.abortControllers[c];const m={id:c,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:a?gl(a):null,data:gl(l,f)};this.target.postMessage(m,{transfer:f})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},d.K=ie,d.L=function(){var c=new N(16);return N!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},d.M=function(c,a,l){var f,m,x,b,T,A,O,D,B,K,Y,J,te=l[0],ae=l[1],ce=l[2];return a===c?(c[12]=a[0]*te+a[4]*ae+a[8]*ce+a[12],c[13]=a[1]*te+a[5]*ae+a[9]*ce+a[13],c[14]=a[2]*te+a[6]*ae+a[10]*ce+a[14],c[15]=a[3]*te+a[7]*ae+a[11]*ce+a[15]):(m=a[1],x=a[2],b=a[3],T=a[4],A=a[5],O=a[6],D=a[7],B=a[8],K=a[9],Y=a[10],J=a[11],c[0]=f=a[0],c[1]=m,c[2]=x,c[3]=b,c[4]=T,c[5]=A,c[6]=O,c[7]=D,c[8]=B,c[9]=K,c[10]=Y,c[11]=J,c[12]=f*te+T*ae+B*ce+a[12],c[13]=m*te+A*ae+K*ce+a[13],c[14]=x*te+O*ae+Y*ce+a[14],c[15]=b*te+D*ae+J*ce+a[15]),c},d.N=function(c,a,l){var f=l[0],m=l[1],x=l[2];return c[0]=a[0]*f,c[1]=a[1]*f,c[2]=a[2]*f,c[3]=a[3]*f,c[4]=a[4]*m,c[5]=a[5]*m,c[6]=a[6]*m,c[7]=a[7]*m,c[8]=a[8]*x,c[9]=a[9]*x,c[10]=a[10]*x,c[11]=a[11]*x,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c},d.O=function(c,a,l){var f=a[0],m=a[1],x=a[2],b=a[3],T=a[4],A=a[5],O=a[6],D=a[7],B=a[8],K=a[9],Y=a[10],J=a[11],te=a[12],ae=a[13],ce=a[14],Pe=a[15],ge=l[0],ve=l[1],Ne=l[2],Fe=l[3];return c[0]=ge*f+ve*T+Ne*B+Fe*te,c[1]=ge*m+ve*A+Ne*K+Fe*ae,c[2]=ge*x+ve*O+Ne*Y+Fe*ce,c[3]=ge*b+ve*D+Ne*J+Fe*Pe,c[4]=(ge=l[4])*f+(ve=l[5])*T+(Ne=l[6])*B+(Fe=l[7])*te,c[5]=ge*m+ve*A+Ne*K+Fe*ae,c[6]=ge*x+ve*O+Ne*Y+Fe*ce,c[7]=ge*b+ve*D+Ne*J+Fe*Pe,c[8]=(ge=l[8])*f+(ve=l[9])*T+(Ne=l[10])*B+(Fe=l[11])*te,c[9]=ge*m+ve*A+Ne*K+Fe*ae,c[10]=ge*x+ve*O+Ne*Y+Fe*ce,c[11]=ge*b+ve*D+Ne*J+Fe*Pe,c[12]=(ge=l[12])*f+(ve=l[13])*T+(Ne=l[14])*B+(Fe=l[15])*te,c[13]=ge*m+ve*A+Ne*K+Fe*ae,c[14]=ge*x+ve*O+Ne*Y+Fe*ce,c[15]=ge*b+ve*D+Ne*J+Fe*Pe,c},d.P=y,d.Q=function(c,a){const l={};for(let f=0;f<a.length;f++){const m=a[f];m in c&&(l[m]=c[m])}return l},d.R=$i,d.S=kl,d.T=eb,d.U=Ok,d.V=jk,d.W=q,d.X=F,d.Y=aa,d.Z=va,d._=s,d.a=ee,d.a$=Ue,d.a0=function(c,a){var l,f,m,x;if(!c)return a??{};if(!a)return c;const b=Object.assign({},c);if(a.removeAll&&(b.removeAll=!0),a.remove){const T=new Set(b.remove?b.remove.concat(a.remove):a.remove);b.remove=Array.from(T.values())}if(a.add){const T=b.add?b.add.concat(a.add):a.add,A=new Map(T.map(O=>[O.id,O]));b.add=Array.from(A.values())}if(a.update){const T=new Map((l=b.update)===null||l===void 0?void 0:l.map(A=>[A.id,A]));for(const A of a.update){const O=(f=T.get(A.id))!==null&&f!==void 0?f:{id:A.id};A.newGeometry&&(O.newGeometry=A.newGeometry),A.addOrUpdateProperties&&(O.addOrUpdateProperties=((m=O.addOrUpdateProperties)!==null&&m!==void 0?m:[]).concat(A.addOrUpdateProperties)),A.removeProperties&&(O.removeProperties=((x=O.removeProperties)!==null&&x!==void 0?x:[]).concat(A.removeProperties)),A.removeAllProperties&&(O.removeAllProperties=!0),T.set(A.id,O)}b.update=Array.from(T.values())}return b},d.a1=vp,d.a2=Bc,d.a3=25,d.a4=bb,d.a5=c=>{const a=window.document.createElement("video");return a.muted=!0,new Promise(l=>{a.onloadstart=()=>{l(a)};for(const f of c){const m=window.document.createElement("source");Re(f)||(a.crossOrigin="Anonymous"),m.src=f,a.appendChild(m)}})},d.a6=ot,d.a7=function(){return pt++},d.a8=V,d.a9=wh,d.aA=function(c){let a=1/0,l=1/0,f=-1/0,m=-1/0;for(const x of c)a=Math.min(a,x.x),l=Math.min(l,x.y),f=Math.max(f,x.x),m=Math.max(m,x.y);return[a,l,f,m]},d.aB=An,d.aC=nt,d.aD=function(c,a,l,f,m=!1){if(!l[0]&&!l[1])return[0,0];const x=m?f==="map"?-c.bearingInRadians:0:f==="viewport"?c.bearingInRadians:0;if(x){const b=Math.sin(x),T=Math.cos(x);l=[l[0]*T-l[1]*b,l[0]*b+l[1]*T]}return[m?l[0]:nt(a,l[0],c.zoom),m?l[1]:nt(a,l[1],c.zoom)]},d.aF=pb,d.aG=Sb,d.aH=fb,d.aI=Pb,d.aJ=en,d.aK=jy,d.aL=pe,d.aM=Ut,d.aN=_r,d.aO=or,d.aP=oa,d.aQ=Rk,d.aR=Oe,d.aS=we,d.aT=function(c){var a=new N(3);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a},d.aU=function(c,a,l){return c[0]=a[0]-l[0],c[1]=a[1]-l[1],c[2]=a[2]-l[2],c},d.aV=function(c,a){var l=a[0],f=a[1],m=a[2],x=l*l+f*f+m*m;return x>0&&(x=1/Math.sqrt(x)),c[0]=a[0]*x,c[1]=a[1]*x,c[2]=a[2]*x,c},d.aW=Me,d.aX=function(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]},d.aY=function(c,a,l){return c[0]=a[0]*l[0],c[1]=a[1]*l[1],c[2]=a[2]*l[2],c[3]=a[3]*l[3],c},d.aZ=re,d.a_=function(c,a,l){const f=a[0]*l[0]+a[1]*l[1]+a[2]*l[2];return f===0?null:(-(c[0]*l[0]+c[1]*l[1]+c[2]*l[2])-l[3])/f},d.aa=ps,d.ab=ao,d.ac=Lk,d.ad=function(c){const a={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,f,m,x)=>{const b=m||x;return a[f]=!b||b.toLowerCase(),""}),a["max-age"]){const l=parseInt(a["max-age"],10);isNaN(l)?delete a["max-age"]:a["max-age"]=l}return a},d.ae=Ia,d.af=function(c){return Math.pow(2,c)},d.ag=H,d.ah=Nt,d.ai=85.051129,d.aj=Dk,d.ak=function(c){return Math.log(c)/Math.LN2},d.al=function(c){var a=c[0],l=c[1];return a*a+l*l},d.am=function(c,a){const l=[];for(const f in c)f in a||l.push(f);return l},d.an=function(c,a){let l=0,f=0;if(c.kind==="constant")f=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:m,minZoom:x,maxZoom:b}=c,T=m?Nt(zn.interpolationFactor(m,a,x,b),0,1):0;c.kind==="camera"?f=Ra.number(c.minSize,c.maxSize,T):l=T}return{uSizeT:l,uSize:f}},d.ap=function(c,{uSize:a,uSizeT:l},{lowerSize:f,upperSize:m}){return c.kind==="source"?f/ws:c.kind==="composite"?Ra.number(f/ws,m/ws,l):a},d.aq=function(c,a){var l=a[0],f=a[1],m=a[2],x=a[3],b=a[4],T=a[5],A=a[6],O=a[7],D=a[8],B=a[9],K=a[10],Y=a[11],J=a[12],te=a[13],ae=a[14],ce=a[15],Pe=l*T-f*b,ge=l*A-m*b,ve=l*O-x*b,Ne=f*A-m*T,Fe=f*O-x*T,Qe=m*O-x*A,ft=D*te-B*J,st=D*ae-K*J,ut=D*ce-Y*J,Tt=B*ae-K*te,ct=B*ce-Y*te,ht=K*ce-Y*ae,He=Pe*ht-ge*ct+ve*Tt+Ne*ut-Fe*st+Qe*ft;return He?(c[0]=(T*ht-A*ct+O*Tt)*(He=1/He),c[1]=(m*ct-f*ht-x*Tt)*He,c[2]=(te*Qe-ae*Fe+ce*Ne)*He,c[3]=(K*Fe-B*Qe-Y*Ne)*He,c[4]=(A*ut-b*ht-O*st)*He,c[5]=(l*ht-m*ut+x*st)*He,c[6]=(ae*ve-J*Qe-ce*ge)*He,c[7]=(D*Qe-K*ve+Y*ge)*He,c[8]=(b*ct-T*ut+O*ft)*He,c[9]=(f*ut-l*ct-x*ft)*He,c[10]=(J*Fe-te*ve+ce*Pe)*He,c[11]=(B*ve-D*Fe-Y*Pe)*He,c[12]=(T*st-b*Tt-A*ft)*He,c[13]=(l*Tt-f*st+m*ft)*He,c[14]=(te*ge-J*Ne-ae*Pe)*He,c[15]=(D*Ne-B*ge+K*Pe)*He,c):null},d.ar=rt,d.as=function(c){var a=c[0],l=c[1];return Math.sqrt(a*a+l*l)},d.at=function(c){return c[0]=0,c[1]=0,c},d.au=function(c,a,l){return c[0]=a[0]*l,c[1]=a[1]*l,c},d.av=mb,d.aw=We,d.ax=function(c,a,l,f){const m=a.y-c.y,x=a.x-c.x,b=f.y-l.y,T=f.x-l.x,A=b*x-T*m;if(A===0)return null;const O=(T*(c.y-l.y)-b*(c.x-l.x))/A;return new y(c.x+O*x,c.y+O*m)},d.ay=Uk,d.az=IT,d.b=yn,d.b$=class extends v{},d.b0=function(c,a,l){return c[0]=a[0]*l,c[1]=a[1]*l,c[2]=a[2]*l,c[3]=a[3]*l,c},d.b1=function(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]+c[3]},d.b2=$k,d.b3=Sh,d.b4=function(c,a,l,f,m){var x=1/Math.tan(a/2);if(c[0]=x/l,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=x,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,m!=null&&m!==1/0){var b=1/(f-m);c[10]=(m+f)*b,c[14]=2*m*f*b}else c[10]=-1,c[14]=-2*f;return c},d.b5=function(c){var a=new N(16);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15],a},d.b6=function(c,a,l){var f=Math.sin(l),m=Math.cos(l),x=a[0],b=a[1],T=a[2],A=a[3],O=a[4],D=a[5],B=a[6],K=a[7];return a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=x*m+O*f,c[1]=b*m+D*f,c[2]=T*m+B*f,c[3]=A*m+K*f,c[4]=O*m-x*f,c[5]=D*m-b*f,c[6]=B*m-T*f,c[7]=K*m-A*f,c},d.b7=function(c,a,l){var f=Math.sin(l),m=Math.cos(l),x=a[4],b=a[5],T=a[6],A=a[7],O=a[8],D=a[9],B=a[10],K=a[11];return a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[4]=x*m+O*f,c[5]=b*m+D*f,c[6]=T*m+B*f,c[7]=A*m+K*f,c[8]=O*m-x*f,c[9]=D*m-b*f,c[10]=B*m-T*f,c[11]=K*m-A*f,c},d.b8=function(){const c=new Float32Array(16);return H(c),c},d.b9=function(){const c=new Float64Array(16);return H(c),c},d.bA=function(c,a){const l=Xe(c,360),f=Xe(a,360),m=f-l,x=f>l?m-360:m+360;return Math.abs(m)<Math.abs(x)?m:x},d.bB=function(c){return c[0]=0,c[1]=0,c[2]=0,c},d.bC=function(c,a,l,f){const m=Math.sqrt(c*c+a*a),x=Math.sqrt(l*l+f*f);c/=m,a/=m,l/=x,f/=x;const b=Math.acos(c*l+a*f);return-a*l+c*f>0?b:-b},d.bD=function(c,a){const l=Xe(c,2*Math.PI),f=Xe(a,2*Math.PI);return Math.min(Math.abs(l-f),Math.abs(l-f+2*Math.PI),Math.abs(l-f-2*Math.PI))},d.bE=function(){const c={},a=Ce.$version;for(const l in Ce.$root){const f=Ce.$root[l];if(f.required){let m=null;m=l==="version"?a:f.type==="array"?[]:{},m!=null&&(c[l]=m)}}return c},d.bF=ih,d.bG=_e,d.bH=function c(a,l){if(Array.isArray(a)){if(!Array.isArray(l)||a.length!==l.length)return!1;for(let f=0;f<a.length;f++)if(!c(a[f],l[f]))return!1;return!0}if(typeof a=="object"&&a!==null&&l!==null){if(typeof l!="object"||Object.keys(a).length!==Object.keys(l).length)return!1;for(const f in a)if(!c(a[f],l[f]))return!1;return!0}return a===l},d.bI=function(c){c=c.slice();const a=Object.create(null);for(let l=0;l<c.length;l++)a[c[l].id]=c[l];for(let l=0;l<c.length;l++)"ref"in c[l]&&(c[l]=Ht(c[l],a[c[l].ref]));return c},d.bJ=function(c){if(c.type==="custom")return new D3(c);switch(c.type){case"background":return new I3(c);case"circle":return new gz(c);case"color-relief":return new wz(c);case"fill":return new $z(c);case"fill-extrusion":return new Zz(c);case"heatmap":return new vz(c);case"hillshade":return new xz(c);case"line":return new t3(c);case"raster":return new O3(c);case"symbol":return new $y(c)}},d.bK=et,d.bL=function(c,a){if(!c)return[{command:"setStyle",args:[a]}];let l=[];try{if(!At(c.version,a.version))return[{command:"setStyle",args:[a]}];At(c.center,a.center)||l.push({command:"setCenter",args:[a.center]}),At(c.state,a.state)||l.push({command:"setGlobalState",args:[a.state]}),At(c.centerAltitude,a.centerAltitude)||l.push({command:"setCenterAltitude",args:[a.centerAltitude]}),At(c.zoom,a.zoom)||l.push({command:"setZoom",args:[a.zoom]}),At(c.bearing,a.bearing)||l.push({command:"setBearing",args:[a.bearing]}),At(c.pitch,a.pitch)||l.push({command:"setPitch",args:[a.pitch]}),At(c.roll,a.roll)||l.push({command:"setRoll",args:[a.roll]}),At(c.sprite,a.sprite)||l.push({command:"setSprite",args:[a.sprite]}),At(c.glyphs,a.glyphs)||l.push({command:"setGlyphs",args:[a.glyphs]}),At(c.transition,a.transition)||l.push({command:"setTransition",args:[a.transition]}),At(c.light,a.light)||l.push({command:"setLight",args:[a.light]}),At(c.terrain,a.terrain)||l.push({command:"setTerrain",args:[a.terrain]}),At(c.sky,a.sky)||l.push({command:"setSky",args:[a.sky]}),At(c.projection,a.projection)||l.push({command:"setProjection",args:[a.projection]});const f={},m=[];(function(b,T,A,O){let D;for(D in T=T||{},b=b||{})Object.prototype.hasOwnProperty.call(b,D)&&(Object.prototype.hasOwnProperty.call(T,D)||vn(D,A,O));for(D in T)Object.prototype.hasOwnProperty.call(T,D)&&(Object.prototype.hasOwnProperty.call(b,D)?At(b[D],T[D])||(b[D].type==="geojson"&&T[D].type==="geojson"&&nn(b,T,D)?Ft(A,{command:"setGeoJSONSourceData",args:[D,T[D].data]}):_n(D,T,A,O)):Ar(D,T,A))})(c.sources,a.sources,m,f);const x=[];c.layers&&c.layers.forEach(b=>{"source"in b&&f[b.source]?l.push({command:"removeLayer",args:[b.id]}):x.push(b)}),l=l.concat(m),function(b,T,A){T=T||[];const O=(b=b||[]).map(nr),D=T.map(nr),B=b.reduce(cn,{}),K=T.reduce(cn,{}),Y=O.slice(),J=Object.create(null);let te,ae,ce,Pe,ge;for(let ve=0,Ne=0;ve<O.length;ve++)te=O[ve],Object.prototype.hasOwnProperty.call(K,te)?Ne++:(Ft(A,{command:"removeLayer",args:[te]}),Y.splice(Y.indexOf(te,Ne),1));for(let ve=0,Ne=0;ve<D.length;ve++)te=D[D.length-1-ve],Y[Y.length-1-ve]!==te&&(Object.prototype.hasOwnProperty.call(B,te)?(Ft(A,{command:"removeLayer",args:[te]}),Y.splice(Y.lastIndexOf(te,Y.length-Ne),1)):Ne++,Pe=Y[Y.length-ve],Ft(A,{command:"addLayer",args:[K[te],Pe]}),Y.splice(Y.length-ve,0,te),J[te]=!0);for(let ve=0;ve<D.length;ve++)if(te=D[ve],ae=B[te],ce=K[te],!J[te]&&!At(ae,ce))if(At(ae.source,ce.source)&&At(ae["source-layer"],ce["source-layer"])&&At(ae.type,ce.type)){for(ge in Yt(ae.layout,ce.layout,A,te,null,"setLayoutProperty"),Yt(ae.paint,ce.paint,A,te,null,"setPaintProperty"),At(ae.filter,ce.filter)||Ft(A,{command:"setFilter",args:[te,ce.filter]}),At(ae.minzoom,ce.minzoom)&&At(ae.maxzoom,ce.maxzoom)||Ft(A,{command:"setLayerZoomRange",args:[te,ce.minzoom,ce.maxzoom]}),ae)Object.prototype.hasOwnProperty.call(ae,ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?Yt(ae[ge],ce[ge],A,te,ge.slice(6),"setPaintProperty"):At(ae[ge],ce[ge])||Ft(A,{command:"setLayerProperty",args:[te,ge,ce[ge]]}));for(ge in ce)Object.prototype.hasOwnProperty.call(ce,ge)&&!Object.prototype.hasOwnProperty.call(ae,ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?Yt(ae[ge],ce[ge],A,te,ge.slice(6),"setPaintProperty"):At(ae[ge],ce[ge])||Ft(A,{command:"setLayerProperty",args:[te,ge,ce[ge]]}))}else Ft(A,{command:"removeLayer",args:[te]}),Pe=Y[Y.lastIndexOf(te)+1],Ft(A,{command:"addLayer",args:[ce,Pe]})}(x,a.layers,l)}catch(f){console.warn("Unable to compute style diff:",f),l=[{command:"setStyle",args:[a]}]}return l},d.bM=function(c){const a=[],l=c.id;return l===void 0&&a.push({message:`layers.${l}: missing required property "id"`}),c.render===void 0&&a.push({message:`layers.${l}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&a.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),a},d.bN=Dt,d.bO=zt,d.bP=class extends fi{constructor(c,a){super(c,a),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},d.bQ=bn,d.bR=class extends fi{constructor(c,a){super(c,a),this.current=Xi}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let a=1;a<16;a++)if(c[a]!==this.current[a]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},d.bS=dn,d.bT=class extends fi{constructor(c,a){super(c,a),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},d.bU=class extends fi{constructor(c,a){super(c,a),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},d.bV=W,d.bW=function(c,a){var l=Math.sin(a),f=Math.cos(a);return c[0]=f,c[1]=l,c[2]=0,c[3]=-l,c[4]=f,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},d.bX=function(c,a,l){var f=a[0],m=a[1],x=a[2];return c[0]=f*l[0]+m*l[3]+x*l[6],c[1]=f*l[1]+m*l[4]+x*l[7],c[2]=f*l[2]+m*l[5]+x*l[8],c},d.bY=function(c,a,l,f,m,x,b){var T=1/(a-l),A=1/(f-m),O=1/(x-b);return c[0]=-2*T,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*A,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*O,c[11]=0,c[12]=(a+l)*T,c[13]=(m+f)*A,c[14]=(b+x)*O,c[15]=1,c},d.bZ=class extends fi{constructor(c,a){super(c,a),this.current=new Array}set(c){if(c!=this.current){this.current=c;const a=new Float32Array(4*c.length);for(let l=0;l<c.length;l++)a[4*l]=c[l].r,a[4*l+1]=c[l].g,a[4*l+2]=c[l].b,a[4*l+3]=c[l].a;this.gl.uniform4fv(this.location,a)}}},d.b_=class extends fi{constructor(c,a){super(c,a),this.current=new Array}set(c){if(c!=this.current){this.current=c;const a=new Float32Array(c);this.gl.uniform1fv(this.location,a)}}},d.ba=function(){return new Float64Array(16)},d.bb=function(c,a,l){const f=new Float64Array(4);return Je(f,c,a-90,l),f},d.bc=function(c,a,l,f){var m,x,b,T,A,O=a[0],D=a[1],B=a[2],K=a[3],Y=l[0],J=l[1],te=l[2],ae=l[3];return(x=O*Y+D*J+B*te+K*ae)<0&&(x=-x,Y=-Y,J=-J,te=-te,ae=-ae),1-x>U?(m=Math.acos(x),b=Math.sin(m),T=Math.sin((1-f)*m)/b,A=Math.sin(f*m)/b):(T=1-f,A=f),c[0]=T*O+A*Y,c[1]=T*D+A*J,c[2]=T*B+A*te,c[3]=T*K+A*ae,c},d.bd=function(c){const a=new Float64Array(9);var l,f,m,x,b,T,A,O,D,B,K,Y,J,te,ae,ce,Pe,ge;B=(m=(f=c)[0])*(A=m+m),K=(x=f[1])*A,J=(b=f[2])*A,te=b*(O=x+x),ce=(T=f[3])*A,Pe=T*O,ge=T*(D=b+b),(l=a)[0]=1-(Y=x*O)-(ae=b*D),l[3]=K-ge,l[6]=J+Pe,l[1]=K+ge,l[4]=1-B-ae,l[7]=te-ce,l[2]=J-Pe,l[5]=te+ce,l[8]=1-B-Y;const ve=oa(-Math.asin(Nt(a[2],-1,1)));let Ne,Fe;return Math.hypot(a[5],a[8])<.001?(Ne=0,Fe=-oa(Math.atan2(a[3],a[4]))):(Ne=oa(a[5]===0&&a[8]===0?0:Math.atan2(a[5],a[8])),Fe=oa(a[1]===0&&a[0]===0?0:Math.atan2(a[1],a[0]))),{roll:Ne,pitch:ve+90,bearing:Fe}},d.be=function(c,a){return c.roll==a.roll&&c.pitch==a.pitch&&c.bearing==a.bearing},d.bf=Xt,d.bg=Bo,d.bh=vh,d.bi=dp,d.bj=yh,d.bk=Ge,d.bl=it,d.bm=Qn,d.bn=function(c,a,l,f,m){return Ge(f,m,Nt((c-a)/(l-a),0,1))},d.bo=Xe,d.bp=function(){return new Float64Array(3)},d.bq=function(c,a,l,f){return c[0]=a[0]+l[0]*f,c[1]=a[1]+l[1]*f,c[2]=a[2]+l[2]*f,c},d.br=Je,d.bs=function(c,a,l){var f=l[0],m=l[1],x=l[2],b=l[3],T=a[0],A=a[1],O=a[2],D=m*O-x*A,B=x*T-f*O,K=f*A-m*T;return c[0]=T+b*(D+=D)+m*(K+=K)-x*(B+=B),c[1]=A+b*B+x*D-f*K,c[2]=O+b*K+f*B-m*D,c},d.bt=function(c,a,l){const f=(m=[c[0],c[1],c[2],a[0],a[1],a[2],l[0],l[1],l[2]])[0]*((D=m[8])*(b=m[4])-(T=m[5])*(O=m[7]))+m[1]*(-D*(x=m[3])+T*(A=m[6]))+m[2]*(O*x-b*A);var m,x,b,T,A,O,D;if(f===0)return null;const B=Me([],[a[0],a[1],a[2]],[l[0],l[1],l[2]]),K=Me([],[l[0],l[1],l[2]],[c[0],c[1],c[2]]),Y=Me([],[c[0],c[1],c[2]],[a[0],a[1],a[2]]),J=Oe([],B,-c[3]);return we(J,J,Oe([],K,-a[3])),we(J,J,Oe([],Y,-l[3])),Oe(J,J,1/f),J},d.bu=_b,d.bv=function(){return new Float64Array(4)},d.bw=function(c,a,l,f){var m=[],x=[];return m[0]=a[0]-l[0],m[1]=a[1]-l[1],m[2]=a[2]-l[2],x[0]=m[0]*Math.cos(f)-m[1]*Math.sin(f),x[1]=m[0]*Math.sin(f)+m[1]*Math.cos(f),x[2]=m[2],c[0]=x[0]+l[0],c[1]=x[1]+l[1],c[2]=x[2]+l[2],c},d.bx=function(c,a,l,f){var m=[],x=[];return m[0]=a[0]-l[0],m[1]=a[1]-l[1],m[2]=a[2]-l[2],x[0]=m[0],x[1]=m[1]*Math.cos(f)-m[2]*Math.sin(f),x[2]=m[1]*Math.sin(f)+m[2]*Math.cos(f),c[0]=x[0]+l[0],c[1]=x[1]+l[1],c[2]=x[2]+l[2],c},d.by=function(c,a,l,f){var m=[],x=[];return m[0]=a[0]-l[0],m[1]=a[1]-l[1],m[2]=a[2]-l[2],x[0]=m[2]*Math.sin(f)+m[0]*Math.cos(f),x[1]=m[1],x[2]=m[2]*Math.cos(f)-m[0]*Math.sin(f),c[0]=x[0]+l[0],c[1]=x[1]+l[1],c[2]=x[2]+l[2],c},d.bz=function(c,a,l){var f=Math.sin(l),m=Math.cos(l),x=a[0],b=a[1],T=a[2],A=a[3],O=a[8],D=a[9],B=a[10],K=a[11];return a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=x*m-O*f,c[1]=b*m-D*f,c[2]=T*m-B*f,c[3]=A*m-K*f,c[8]=x*f+O*m,c[9]=b*f+D*m,c[10]=T*f+B*m,c[11]=A*f+K*m,c},d.c=Te,d.c0=a3,d.c1=class extends u{},d.c2=Qx,d.c3=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},d.c4=FT,d.c5=function(c,a,l){var f=a[0],m=a[1],x=a[2],b=l[3]*f+l[7]*m+l[11]*x+l[15];return c[0]=(l[0]*f+l[4]*m+l[8]*x+l[12])/(b=b||1),c[1]=(l[1]*f+l[5]*m+l[9]*x+l[13])/b,c[2]=(l[2]*f+l[6]*m+l[10]*x+l[14])/b,c},d.c6=class extends tp{},d.c7=class extends R{},d.c8=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]&&c[4]===a[4]&&c[5]===a[5]&&c[6]===a[6]&&c[7]===a[7]&&c[8]===a[8]&&c[9]===a[9]&&c[10]===a[10]&&c[11]===a[11]&&c[12]===a[12]&&c[13]===a[13]&&c[14]===a[14]&&c[15]===a[15]},d.c9=function(c,a){var l=c[0],f=c[1],m=c[2],x=c[3],b=c[4],T=c[5],A=c[6],O=c[7],D=c[8],B=c[9],K=c[10],Y=c[11],J=c[12],te=c[13],ae=c[14],ce=c[15],Pe=a[0],ge=a[1],ve=a[2],Ne=a[3],Fe=a[4],Qe=a[5],ft=a[6],st=a[7],ut=a[8],Tt=a[9],ct=a[10],ht=a[11],He=a[12],Ot=a[13],Rt=a[14],Ct=a[15];return Math.abs(l-Pe)<=U*Math.max(1,Math.abs(l),Math.abs(Pe))&&Math.abs(f-ge)<=U*Math.max(1,Math.abs(f),Math.abs(ge))&&Math.abs(m-ve)<=U*Math.max(1,Math.abs(m),Math.abs(ve))&&Math.abs(x-Ne)<=U*Math.max(1,Math.abs(x),Math.abs(Ne))&&Math.abs(b-Fe)<=U*Math.max(1,Math.abs(b),Math.abs(Fe))&&Math.abs(T-Qe)<=U*Math.max(1,Math.abs(T),Math.abs(Qe))&&Math.abs(A-ft)<=U*Math.max(1,Math.abs(A),Math.abs(ft))&&Math.abs(O-st)<=U*Math.max(1,Math.abs(O),Math.abs(st))&&Math.abs(D-ut)<=U*Math.max(1,Math.abs(D),Math.abs(ut))&&Math.abs(B-Tt)<=U*Math.max(1,Math.abs(B),Math.abs(Tt))&&Math.abs(K-ct)<=U*Math.max(1,Math.abs(K),Math.abs(ct))&&Math.abs(Y-ht)<=U*Math.max(1,Math.abs(Y),Math.abs(ht))&&Math.abs(J-He)<=U*Math.max(1,Math.abs(J),Math.abs(He))&&Math.abs(te-Ot)<=U*Math.max(1,Math.abs(te),Math.abs(Ot))&&Math.abs(ae-Rt)<=U*Math.max(1,Math.abs(ae),Math.abs(Rt))&&Math.abs(ce-Ct)<=U*Math.max(1,Math.abs(ce),Math.abs(Ct))},d.cA=function(c,a){ee.REGISTERED_PROTOCOLS[c]=a},d.cB=function(c){delete ee.REGISTERED_PROTOCOLS[c]},d.cC=function(c,a){const l={};for(let m=0;m<c.length;m++){const x=a&&a[c[m].id]||Fx(c[m]);a&&(a[c[m].id]=x);let b=l[x];b||(b=l[x]=[]),b.push(c[m])}const f=[];for(const m in l)f.push(l[m]);return f},d.cD=yt,d.cE=zk,d.cF=Bk,d.cG=gk,d.cH=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=Be/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const a=c.bucket.layers[0],l=a.layout,f=a._unevaluatedLayout._values,m={layoutIconSize:f["icon-size"].possiblyEvaluate(new kr(c.bucket.zoom+1),c.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new kr(c.bucket.zoom+1),c.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new kr(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:O,maxZoom:D}=c.bucket.textSizeData;m.compositeTextSizes=[f["text-size"].possiblyEvaluate(new kr(O),c.canonical),f["text-size"].possiblyEvaluate(new kr(D),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:O,maxZoom:D}=c.bucket.iconSizeData;m.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new kr(O),c.canonical),f["icon-size"].possiblyEvaluate(new kr(D),c.canonical)]}const x=l.get("text-line-height")*An,b=l.get("text-rotation-alignment")!=="viewport"&&l.get("symbol-placement")!=="point",T=l.get("text-keep-upright"),A=l.get("text-size");for(const O of c.bucket.features){const D=l.get("text-font").evaluate(O,{},c.canonical).join(","),B=A.evaluate(O,{},c.canonical),K=m.layoutTextSize.evaluate(O,{},c.canonical),Y=m.layoutIconSize.evaluate(O,{},c.canonical),J={horizontal:{},vertical:void 0},te=O.text;let ae,ce=[0,0];if(te){const ve=te.toString(),Ne=l.get("text-letter-spacing").evaluate(O,{},c.canonical)*An,Fe=qx(ve)?Ne:0,Qe=l.get("text-anchor").evaluate(O,{},c.canonical),ft=Yk(a,O,c.canonical);if(!ft){const ct=l.get("text-radial-offset").evaluate(O,{},c.canonical);ce=ct?Xk(Qe,[ct*An,wb]):l.get("text-offset").evaluate(O,{},c.canonical).map(ht=>ht*An)}let st=b?"center":l.get("text-justify").evaluate(O,{},c.canonical);const ut=l.get("symbol-placement")==="point"?l.get("text-max-width").evaluate(O,{},c.canonical)*An:1/0,Tt=()=>{c.bucket.allowVerticalPlacement&&ah(ve)&&(J.vertical=Dy(te,c.glyphMap,c.glyphPositions,c.imagePositions,D,ut,x,Qe,"left",Fe,ce,d.ao.vertical,!0,K,B))};if(!b&&ft){const ct=new Set;if(st==="auto")for(let He=0;He<ft.values.length;He+=2)ct.add(Sb(ft.values[He]));else ct.add(st);let ht=!1;for(const He of ct)if(!J.horizontal[He])if(ht)J.horizontal[He]=J.horizontal[0];else{const Ot=Dy(te,c.glyphMap,c.glyphPositions,c.imagePositions,D,ut,x,"center",He,Fe,ce,d.ao.horizontal,!1,K,B);Ot&&(J.horizontal[He]=Ot,ht=Ot.positionedLines.length===1)}Tt()}else{st==="auto"&&(st=Sb(Qe));const ct=Dy(te,c.glyphMap,c.glyphPositions,c.imagePositions,D,ut,x,Qe,st,Fe,ce,d.ao.horizontal,!1,K,B);ct&&(J.horizontal[st]=ct),Tt(),ah(ve)&&b&&T&&(J.vertical=Dy(te,c.glyphMap,c.glyphPositions,c.imagePositions,D,ut,x,Qe,st,Fe,ce,d.ao.vertical,!1,K,B))}}let Pe=!1;if(O.icon&&O.icon.name){const ve=c.imageMap[O.icon.name];ve&&(ae=E3(c.imagePositions[O.icon.name],l.get("icon-offset").evaluate(O,{},c.canonical),l.get("icon-anchor").evaluate(O,{},c.canonical)),Pe=!!ve.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=Pe:c.bucket.sdfIcons!==Pe&&It("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ve.pixelRatio!==c.bucket.pixelRatio||l.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const ge=Qk(J.horizontal)||J.vertical;c.bucket.iconsInText=!!ge&&ge.iconsInText,(ge||ae)&&V3(c.bucket,O,J,ae,c.imageMap,m,K,Y,ce,Pe,c.canonical,c.subdivisionGranularity)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},d.cI=lb,d.cJ=ab,d.cK=sb,d.cL=rk,d.cM=ub,d.cN=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},d.cO=function(c,a,l,f,m){return s(this,void 0,void 0,function*(){if(F())try{return yield aa(c,a,l,f,m)}catch{}return function(x,b,T,A,O){const D=x.width,B=x.height;Xn&&Yn||(Xn=new OffscreenCanvas(D,B),Yn=Xn.getContext("2d",{willReadFrequently:!0})),Xn.width=D,Xn.height=B,Yn.drawImage(x,0,0,D,B);const K=Yn.getImageData(b,T,A,O);return Yn.clearRect(0,0,D,B),K.data}(c,a,l,f,m)})},d.cP=GT,d.cQ=w,d.cR=tk,d.cS=_h,d.cT=kc,d.cU=function(c,a){const l=new Map;if(c!=null)if(c.type==="Feature")l.set(_p(c,a),c);else for(const f of c.features)l.set(_p(f,a),f);return l},d.cV=function(c,a){if(c==null)return!0;if(c.type==="Feature")return _p(c,a)!=null;if(c.type==="FeatureCollection"){const l=new Set;for(const f of c.features){const m=_p(f,a);if(m==null||l.has(m))return!1;l.add(m)}return!0}return!1},d.cW=function(c,a,l){var f,m,x,b;if(a.removeAll&&c.clear(),a.remove)for(const T of a.remove)c.delete(T);if(a.add)for(const T of a.add){const A=_p(T,l);A!=null&&c.set(A,T)}if(a.update)for(const T of a.update){let A=c.get(T.id);if(A==null)continue;const O=!T.removeAllProperties&&(((f=T.removeProperties)===null||f===void 0?void 0:f.length)>0||((m=T.addOrUpdateProperties)===null||m===void 0?void 0:m.length)>0);if((T.newGeometry||T.removeAllProperties||O)&&(A=Object.assign({},A),c.set(T.id,A),O&&(A.properties=Object.assign({},A.properties))),T.newGeometry&&(A.geometry=T.newGeometry),T.removeAllProperties)A.properties={};else if(((x=T.removeProperties)===null||x===void 0?void 0:x.length)>0)for(const D of T.removeProperties)Object.prototype.hasOwnProperty.call(A.properties,D)&&delete A.properties[D];if(((b=T.addOrUpdateProperties)===null||b===void 0?void 0:b.length)>0)for(const{key:D,value:B}of T.addOrUpdateProperties)A.properties[D]=B}},d.cX=pa,d.ca=function(c,a){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c},d.cb=c=>c.type==="symbol",d.cc=c=>c.type==="circle",d.cd=c=>c.type==="heatmap",d.ce=c=>c.type==="line",d.cf=c=>c.type==="fill",d.cg=c=>c.type==="fill-extrusion",d.ch=c=>c.type==="hillshade",d.ci=c=>c.type==="color-relief",d.cj=c=>c.type==="raster",d.ck=c=>c.type==="background",d.cl=c=>c.type==="custom",d.cm=gt,d.cn=function(c,a,l){const f=Le(a.x-l.x,a.y-l.y),m=Le(c.x-l.x,c.y-l.y);var x,b;return oa(Math.atan2(f[0]*m[1]-f[1]*m[0],(x=f)[0]*(b=m)[0]+x[1]*b[1]))},d.co=Pt,d.cp=function(c,a){return Ao[a]&&(c instanceof MouseEvent||c instanceof WheelEvent)},d.cq=function(c,a){return Eo[a]&&"touches"in c},d.cr=function(c){return Eo[c]||Ao[c]},d.cs=function(c,a,l){var f=a[0],m=a[1];return c[0]=l[0]*f+l[4]*m+l[12],c[1]=l[1]*f+l[5]*m+l[13],c},d.ct=function(c,a){const{x:l,y:f}=vp.fromLngLat(a);return!(c<0||c>25||f<0||f>=1||l<0||l>=1)},d.cu=function(c,a){return c[0]=a[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=a[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=a[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},d.cv=class extends _l{},d.cw=q3,d.cy=function(c){return c.message===Js},d.cz=fe,d.d=Re,d.e=rr,d.f=c=>s(void 0,void 0,void 0,function*(){if(c.byteLength===0)return createImageBitmap(new ImageData(1,1));const a=new Blob([new Uint8Array(c)],{type:"image/png"});try{return createImageBitmap(a)}catch(l){throw new Error(`Could not load image because of ${l.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),d.g=ne,d.h=c=>new Promise((a,l)=>{const f=new Image;f.onload=()=>{a(f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=Nn})},f.onerror=()=>l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(c)],{type:"image/png"});f.src=c.byteLength?URL.createObjectURL(m):Nn}),d.i=mr,d.j=(c,a)=>Ee(rr(c,{type:"json"}),a),d.k=Ze,d.l=tt,d.m=Ee,d.n=(c,a)=>Ee(rr(c,{type:"arrayBuffer"}),a),d.o=function(c){return new ub(c).readFields(g3,[])},d.p=mk,d.q=sp,d.r=hi,d.s=Wi,d.t=Sy,d.u=er,d.v=Ce,d.w=It,d.x=Ux,d.y=Oc,d.z=ml}),o("worker",["./shared"],function(d){class s{constructor(ee){this.keyCache={},ee&&this.replace(ee)}replace(ee){this._layerConfigs={},this._layers={},this.update(ee,[])}update(ee,ne){for(const fe of ee){this._layerConfigs[fe.id]=fe;const _e=this._layers[fe.id]=d.bJ(fe);_e._featureFilter=d.aa(_e.filter),this.keyCache[fe.id]&&delete this.keyCache[fe.id]}for(const fe of ne)delete this.keyCache[fe],delete this._layerConfigs[fe],delete this._layers[fe];this.familiesBySource={};const ie=d.cC(Object.values(this._layerConfigs),this.keyCache);for(const fe of ie){const _e=fe.map(Ze=>this._layers[Ze.id]),Ee=_e[0];if(Ee.visibility==="none")continue;const Re=Ee.source||"";let Ae=this.familiesBySource[Re];Ae||(Ae=this.familiesBySource[Re]={});const Ve=Ee.sourceLayer||"_geojsonTileLayer";let tt=Ae[Ve];tt||(tt=Ae[Ve]=[]),tt.push(_e)}}}class y{constructor(ee){const ne={},ie=[];for(const Re in ee){const Ae=ee[Re],Ve=ne[Re]={};for(const tt in Ae){const Ze=Ae[+tt];if(!Ze||Ze.bitmap.width===0||Ze.bitmap.height===0)continue;const wt={x:0,y:0,w:Ze.bitmap.width+2,h:Ze.bitmap.height+2};ie.push(wt),Ve[tt]={rect:wt,metrics:Ze.metrics}}}const{w:fe,h:_e}=d.p(ie),Ee=new d.q({width:fe||1,height:_e||1});for(const Re in ee){const Ae=ee[Re];for(const Ve in Ae){const tt=Ae[+Ve];if(!tt||tt.bitmap.width===0||tt.bitmap.height===0)continue;const Ze=ne[Re][Ve].rect;d.q.copy(tt.bitmap,Ee,{x:0,y:0},{x:Ze.x+1,y:Ze.y+1},tt.bitmap)}}this.image=Ee,this.positions=ne}}d.cD("GlyphAtlas",y);class w{constructor(ee){this.tileID=new d.Z(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[],this.globalState=ee.globalState}parse(ee,ne,ie,fe,_e){return d._(this,void 0,void 0,function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new d.a8;const Ee=new d.cE(Object.keys(ee.layers).sort()),Re=new d.cF(this.tileID,this.promoteId);Re.bucketLayerIDs=[];const Ae={},Ve={featureIndex:Re,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ie,subdivisionGranularity:_e},tt=ne.familiesBySource[this.source];for(const Yt in tt){const nr=ee.layers[Yt];if(!nr)continue;nr.version===1&&d.w(`Vector tile source "${this.source}" layer "${Yt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const cn=Ee.encode(Yt),ot=[];for(let Jn=0;Jn<nr.length;Jn++){const Ur=nr.feature(Jn),Co=Re.getId(Ur,Yt);ot.push({feature:Ur,id:Co,index:Jn,sourceLayerIndex:cn})}for(const Jn of tt[Yt]){const Ur=Jn[0];Ur.source!==this.source&&d.w(`layer.source = ${Ur.source} does not equal this.source = ${this.source}`),Ur.minzoom&&this.zoom<Math.floor(Ur.minzoom)||Ur.maxzoom&&this.zoom>=Ur.maxzoom||Ur.visibility!=="none"&&(k(Jn,this.zoom,ie,this.globalState),(Ae[Ur.id]=Ur.createBucket({index:Re.bucketLayerIDs.length,layers:Jn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:cn,sourceID:this.source,globalState:this.globalState})).populate(ot,Ve,this.tileID.canonical),Re.bucketLayerIDs.push(Jn.map(Co=>Co.id)))}}const Ze=d.bN(Ve.glyphDependencies,Yt=>Object.keys(Yt).map(Number));this.inFlightDependencies.forEach(Yt=>Yt==null?void 0:Yt.abort()),this.inFlightDependencies=[];let wt=Promise.resolve({});if(Object.keys(Ze).length){const Yt=new AbortController;this.inFlightDependencies.push(Yt),wt=fe.sendAsync({type:"GG",data:{stacks:Ze,source:this.source,tileID:this.tileID,type:"glyphs"}},Yt)}const Ce=Object.keys(Ve.iconDependencies);let $t=Promise.resolve({});if(Ce.length){const Yt=new AbortController;this.inFlightDependencies.push(Yt),$t=fe.sendAsync({type:"GI",data:{icons:Ce,source:this.source,tileID:this.tileID,type:"icons"}},Yt)}const Ht=Object.keys(Ve.patternDependencies);let At=Promise.resolve({});if(Ht.length){const Yt=new AbortController;this.inFlightDependencies.push(Yt),At=fe.sendAsync({type:"GI",data:{icons:Ht,source:this.source,tileID:this.tileID,type:"patterns"}},Yt)}const[Ft,Ar,vn]=yield Promise.all([wt,$t,At]),_n=new y(Ft),nn=new d.cG(Ar,vn);for(const Yt in Ae){const nr=Ae[Yt];nr instanceof d.a9?(k(nr.layers,this.zoom,ie,this.globalState),d.cH({bucket:nr,glyphMap:Ft,glyphPositions:_n.positions,imageMap:Ar,imagePositions:nn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ve.subdivisionGranularity})):nr.hasPattern&&(nr instanceof d.cI||nr instanceof d.cJ||nr instanceof d.cK)&&(k(nr.layers,this.zoom,ie,this.globalState),nr.addFeatures(Ve,this.tileID.canonical,nn.patternPositions))}return this.status="done",{buckets:Object.values(Ae).filter(Yt=>!Yt.isEmpty()),featureIndex:Re,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:_n.image,imageAtlas:nn,glyphMap:this.returnDependencies?Ft:null,iconMap:this.returnDependencies?Ar:null,glyphPositions:this.returnDependencies?_n.positions:null}})}}function k(Te,ee,ne,ie){const fe=new d.F(ee,{globalState:ie});for(const _e of Te)_e.recalculate(fe,ne)}class E{constructor(ee,ne,ie){this.actor=ee,this.layerIndex=ne,this.availableImages=ie,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ee,ne){return d._(this,void 0,void 0,function*(){const ie=yield d.n(ee.request,ne);try{return{vectorTile:new d.cL(new d.cM(ie.data)),rawData:ie.data,cacheControl:ie.cacheControl,expires:ie.expires}}catch(fe){const _e=new Uint8Array(ie.data);let Ee=`Unable to parse the tile at ${ee.request.url}, `;throw Ee+=_e[0]===31&&_e[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${fe.message}`,new Error(Ee)}})}loadTile(ee){return d._(this,void 0,void 0,function*(){const ne=ee.uid,ie=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new d.cN(ee.request),fe=new w(ee);this.loading[ne]=fe;const _e=new AbortController;fe.abort=_e;try{const Ee=yield this.loadVectorTile(ee,_e);if(delete this.loading[ne],!Ee)return null;const Re=Ee.rawData,Ae={};Ee.expires&&(Ae.expires=Ee.expires),Ee.cacheControl&&(Ae.cacheControl=Ee.cacheControl);const Ve={};if(ie){const Ze=ie.finish();Ze&&(Ve.resourceTiming=JSON.parse(JSON.stringify(Ze)))}fe.vectorTile=Ee.vectorTile;const tt=fe.parse(Ee.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);this.loaded[ne]=fe,this.fetching[ne]={rawTileData:Re,cacheControl:Ae,resourceTiming:Ve};try{const Ze=yield tt;return d.e({rawTileData:Re.slice(0)},Ze,Ae,Ve)}finally{delete this.fetching[ne]}}catch(Ee){throw delete this.loading[ne],fe.status="done",this.loaded[ne]=fe,Ee}})}reloadTile(ee){return d._(this,void 0,void 0,function*(){const ne=ee.uid;if(!this.loaded||!this.loaded[ne])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ie=this.loaded[ne];if(ie.showCollisionBoxes=ee.showCollisionBoxes,ie.globalState=ee.globalState,ie.status==="parsing"){const fe=yield ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);let _e;if(this.fetching[ne]){const{rawTileData:Ee,cacheControl:Re,resourceTiming:Ae}=this.fetching[ne];delete this.fetching[ne],_e=d.e({rawTileData:Ee.slice(0)},fe,Re,Ae)}else _e=fe;return _e}if(ie.status==="done"&&ie.vectorTile)return ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity)})}abortTile(ee){return d._(this,void 0,void 0,function*(){const ne=this.loading,ie=ee.uid;ne&&ne[ie]&&ne[ie].abort&&(ne[ie].abort.abort(),delete ne[ie])})}removeTile(ee){return d._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ee.uid]&&delete this.loaded[ee.uid]})}}class I{constructor(){this.loaded={}}loadTile(ee){return d._(this,void 0,void 0,function*(){const{uid:ne,encoding:ie,rawImageData:fe,redFactor:_e,greenFactor:Ee,blueFactor:Re,baseShift:Ae}=ee,Ve=fe.width+2,tt=fe.height+2,Ze=d.b(fe)?new d.R({width:Ve,height:tt},yield d.cO(fe,-1,-1,Ve,tt)):fe,wt=new d.cP(ne,Ze,ie,_e,Ee,Re,Ae);return this.loaded=this.loaded||{},this.loaded[ne]=wt,wt})}removeTile(ee){const ne=this.loaded,ie=ee.uid;ne&&ne[ie]&&delete ne[ie]}}var j,z,L=function(){if(z)return j;function Te(ne,ie){if(ne.length!==0){ee(ne[0],ie);for(var fe=1;fe<ne.length;fe++)ee(ne[fe],!ie)}}function ee(ne,ie){for(var fe=0,_e=0,Ee=0,Re=ne.length,Ae=Re-1;Ee<Re;Ae=Ee++){var Ve=(ne[Ee][0]-ne[Ae][0])*(ne[Ae][1]+ne[Ee][1]),tt=fe+Ve;_e+=Math.abs(fe)>=Math.abs(Ve)?fe-tt+Ve:Ve-tt+fe,fe=tt}fe+_e>=0!=!!ie&&ne.reverse()}return z=1,j=function ne(ie,fe){var _e,Ee=ie&&ie.type;if(Ee==="FeatureCollection")for(_e=0;_e<ie.features.length;_e++)ne(ie.features[_e],fe);else if(Ee==="GeometryCollection")for(_e=0;_e<ie.geometries.length;_e++)ne(ie.geometries[_e],fe);else if(Ee==="Feature")ne(ie.geometry,fe);else if(Ee==="Polygon")Te(ie.coordinates,fe);else if(Ee==="MultiPolygon")for(_e=0;_e<ie.coordinates.length;_e++)Te(ie.coordinates[_e],fe);return ie}}(),q=d.cQ(L);class F extends d.cS{constructor(ee,ne){super(new d.cM,0,ne,[],[]),this.feature=ee,this.type=ee.type,this.properties=ee.tags?ee.tags:{},"id"in ee&&(typeof ee.id=="string"?this.id=parseInt(ee.id,10):typeof ee.id!="number"||isNaN(ee.id)||(this.id=ee.id))}loadGeometry(){const ee=[],ne=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const ie of ne){const fe=[];for(const _e of ie)fe.push(new d.P(_e[0],_e[1]));ee.push(fe)}return ee}}class U extends d.cR{constructor(ee,ne){super(new d.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=ne?ne.version:1,this.extent=ne?ne.extent:4096,this.length=ee.length,this.features=ee}feature(ee){return new F(this.features[ee],this.extent)}}function N(Te,ee){ee.writeVarintField(15,Te.version||1),ee.writeStringField(1,Te.name||""),ee.writeVarintField(5,Te.extent||4096);const ne={keys:[],values:[],keycache:{},valuecache:{}};for(let _e=0;_e<Te.length;_e++)ne.feature=Te.feature(_e),ee.writeMessage(2,W,ne);const ie=ne.keys;for(const _e of ie)ee.writeStringField(3,_e);const fe=ne.values;for(const _e of fe)ee.writeMessage(4,we,_e)}function W(Te,ee){if(!Te.feature)return;const ne=Te.feature;ne.id!==void 0&&ee.writeVarintField(1,ne.id),ee.writeMessage(2,H,Te),ee.writeVarintField(3,ne.type),ee.writeMessage(4,he,ne)}function H(Te,ee){var ne;for(const ie in(ne=Te.feature)==null?void 0:ne.properties){let fe=Te.feature.properties[ie],_e=Te.keycache[ie];if(fe===null)continue;_e===void 0&&(Te.keys.push(ie),_e=Te.keys.length-1,Te.keycache[ie]=_e),ee.writeVarint(_e),typeof fe!="string"&&typeof fe!="boolean"&&typeof fe!="number"&&(fe=JSON.stringify(fe));const Ee=typeof fe+":"+fe;let Re=Te.valuecache[Ee];Re===void 0&&(Te.values.push(fe),Re=Te.values.length-1,Te.valuecache[Ee]=Re),ee.writeVarint(Re)}}function Z(Te,ee){return(ee<<3)+(7&Te)}function re(Te){return Te<<1^Te>>31}function he(Te,ee){const ne=Te.loadGeometry(),ie=Te.type;let fe=0,_e=0;for(const Ee of ne){let Re=1;ie===1&&(Re=Ee.length),ee.writeVarint(Z(1,Re));const Ae=ie===3?Ee.length-1:Ee.length;for(let Ve=0;Ve<Ae;Ve++){Ve===1&&ie!==1&&ee.writeVarint(Z(2,Ae-1));const tt=Ee[Ve].x-fe,Ze=Ee[Ve].y-_e;ee.writeVarint(re(tt)),ee.writeVarint(re(Ze)),fe+=tt,_e+=Ze}Te.type===3&&ee.writeVarint(Z(7,1))}}function we(Te,ee){const ne=typeof Te;ne==="string"?ee.writeStringField(1,Te):ne==="boolean"?ee.writeBooleanField(7,Te):ne==="number"&&(Te%1!=0?ee.writeDoubleField(3,Te):Te<0?ee.writeSVarintField(6,Te):ee.writeVarintField(5,Te))}const Oe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Te=>Te},Me=Math.fround||(Se=new Float32Array(1),Te=>(Se[0]=+Te,Se[0]));var Se;class Ue{constructor(ee){this.options=Object.assign(Object.create(Oe),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:ne,minZoom:ie,maxZoom:fe}=this.options;ne&&console.time("total time");const _e=`prepare ${ee.length} points`;ne&&console.time(_e),this.points=ee;const Ee=[];for(let Ae=0;Ae<ee.length;Ae++){const Ve=ee[Ae];if(!Ve.geometry)continue;const[tt,Ze]=Ve.geometry.coordinates,wt=Me(Je(tt)),Ce=Me(rt(Ze));Ee.push(wt,Ce,1/0,Ae,-1,1),this.options.reduce&&Ee.push(0)}let Re=this.trees[fe+1]=this._createTree(Ee);ne&&console.timeEnd(_e);for(let Ae=fe;Ae>=ie;Ae--){const Ve=+Date.now();Re=this.trees[Ae]=this._createTree(this._cluster(Re,Ae)),ne&&console.log("z%d: %d clusters in %dms",Ae,Re.numItems,+Date.now()-Ve)}return ne&&console.timeEnd("total time"),this}getClusters(ee,ne){let ie=((ee[0]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,ee[1]));let _e=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const Ee=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)ie=-180,_e=180;else if(ie>_e){const Ze=this.getClusters([ie,fe,180,Ee],ne),wt=this.getClusters([-180,fe,_e,Ee],ne);return Ze.concat(wt)}const Re=this.trees[this._limitZoom(ne)],Ae=Re.range(Je(ie),rt(Ee),Je(_e),rt(fe)),Ve=Re.data,tt=[];for(const Ze of Ae){const wt=this.stride*Ze;tt.push(Ve[wt+5]>1?We(Ve,wt,this.clusterProps):this.points[Ve[wt+3]])}return tt}getChildren(ee){const ne=this._getOriginId(ee),ie=this._getOriginZoom(ee),fe="No cluster with the specified id.",_e=this.trees[ie];if(!_e)throw new Error(fe);const Ee=_e.data;if(ne*this.stride>=Ee.length)throw new Error(fe);const Re=this.options.radius/(this.options.extent*Math.pow(2,ie-1)),Ae=_e.within(Ee[ne*this.stride],Ee[ne*this.stride+1],Re),Ve=[];for(const tt of Ae){const Ze=tt*this.stride;Ee[Ze+4]===ee&&Ve.push(Ee[Ze+5]>1?We(Ee,Ze,this.clusterProps):this.points[Ee[Ze+3]])}if(Ve.length===0)throw new Error(fe);return Ve}getLeaves(ee,ne,ie){const fe=[];return this._appendLeaves(fe,ee,ne=ne||10,ie=ie||0,0),fe}getTile(ee,ne,ie){const fe=this.trees[this._limitZoom(ee)],_e=Math.pow(2,ee),{extent:Ee,radius:Re}=this.options,Ae=Re/Ee,Ve=(ie-Ae)/_e,tt=(ie+1+Ae)/_e,Ze={features:[]};return this._addTileFeatures(fe.range((ne-Ae)/_e,Ve,(ne+1+Ae)/_e,tt),fe.data,ne,ie,_e,Ze),ne===0&&this._addTileFeatures(fe.range(1-Ae/_e,Ve,1,tt),fe.data,_e,ie,_e,Ze),ne===_e-1&&this._addTileFeatures(fe.range(0,Ve,Ae/_e,tt),fe.data,-1,ie,_e,Ze),Ze.features.length?Ze:null}getClusterExpansionZoom(ee){let ne=this._getOriginZoom(ee)-1;for(;ne<=this.options.maxZoom;){const ie=this.getChildren(ee);if(ne++,ie.length!==1)break;ee=ie[0].properties.cluster_id}return ne}_appendLeaves(ee,ne,ie,fe,_e){const Ee=this.getChildren(ne);for(const Re of Ee){const Ae=Re.properties;if(Ae&&Ae.cluster?_e+Ae.point_count<=fe?_e+=Ae.point_count:_e=this._appendLeaves(ee,Ae.cluster_id,ie,fe,_e):_e<fe?_e++:ee.push(Re),ee.length===ie)break}return _e}_createTree(ee){const ne=new d.aI(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ie=0;ie<ee.length;ie+=this.stride)ne.add(ee[ie],ee[ie+1]);return ne.finish(),ne.data=ee,ne}_addTileFeatures(ee,ne,ie,fe,_e,Ee){for(const Re of ee){const Ae=Re*this.stride,Ve=ne[Ae+5]>1;let tt,Ze,wt;if(Ve)tt=qe(ne,Ae,this.clusterProps),Ze=ne[Ae],wt=ne[Ae+1];else{const Ht=this.points[ne[Ae+3]];tt=Ht.properties;const[At,Ft]=Ht.geometry.coordinates;Ze=Je(At),wt=rt(Ft)}const Ce={type:1,geometry:[[Math.round(this.options.extent*(Ze*_e-ie)),Math.round(this.options.extent*(wt*_e-fe))]],tags:tt};let $t;$t=Ve||this.options.generateId?ne[Ae+3]:this.points[ne[Ae+3]].id,$t!==void 0&&(Ce.id=$t),Ee.features.push(Ce)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,ne){const{radius:ie,extent:fe,reduce:_e,minPoints:Ee}=this.options,Re=ie/(fe*Math.pow(2,ne)),Ae=ee.data,Ve=[],tt=this.stride;for(let Ze=0;Ze<Ae.length;Ze+=tt){if(Ae[Ze+2]<=ne)continue;Ae[Ze+2]=ne;const wt=Ae[Ze],Ce=Ae[Ze+1],$t=ee.within(Ae[Ze],Ae[Ze+1],Re),Ht=Ae[Ze+5];let At=Ht;for(const Ft of $t){const Ar=Ft*tt;Ae[Ar+2]>ne&&(At+=Ae[Ar+5])}if(At>Ht&&At>=Ee){let Ft,Ar=wt*Ht,vn=Ce*Ht,_n=-1;const nn=(Ze/tt<<5)+(ne+1)+this.points.length;for(const Yt of $t){const nr=Yt*tt;if(Ae[nr+2]<=ne)continue;Ae[nr+2]=ne;const cn=Ae[nr+5];Ar+=Ae[nr]*cn,vn+=Ae[nr+1]*cn,Ae[nr+4]=nn,_e&&(Ft||(Ft=this._map(Ae,Ze,!0),_n=this.clusterProps.length,this.clusterProps.push(Ft)),_e(Ft,this._map(Ae,nr)))}Ae[Ze+4]=nn,Ve.push(Ar/At,vn/At,1/0,nn,-1,At),_e&&Ve.push(_n)}else{for(let Ft=0;Ft<tt;Ft++)Ve.push(Ae[Ze+Ft]);if(At>1)for(const Ft of $t){const Ar=Ft*tt;if(!(Ae[Ar+2]<=ne)){Ae[Ar+2]=ne;for(let vn=0;vn<tt;vn++)Ve.push(Ae[Ar+vn])}}}}return Ve}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,ne,ie){if(ee[ne+5]>1){const Ee=this.clusterProps[ee[ne+6]];return ie?Object.assign({},Ee):Ee}const fe=this.points[ee[ne+3]].properties,_e=this.options.map(fe);return ie&&_e===fe?Object.assign({},_e):_e}}function We(Te,ee,ne){return{type:"Feature",id:Te[ee+3],properties:qe(Te,ee,ne),geometry:{type:"Point",coordinates:[(ie=Te[ee],360*(ie-.5)),Le(Te[ee+1])]}};var ie}function qe(Te,ee,ne){const ie=Te[ee+5],fe=ie>=1e4?`${Math.round(ie/1e3)}k`:ie>=1e3?Math.round(ie/100)/10+"k":ie,_e=Te[ee+6],Ee=_e===-1?{}:Object.assign({},ne[_e]);return Object.assign(Ee,{cluster:!0,cluster_id:Te[ee+3],point_count:ie,point_count_abbreviated:fe})}function Je(Te){return Te/360+.5}function rt(Te){const ee=Math.sin(Te*Math.PI/180),ne=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ne<0?0:ne>1?1:ne}function Le(Te){const ee=(180-360*Te)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function Be(Te,ee,ne,ie){let fe=ie;const _e=ee+(ne-ee>>1);let Ee,Re=ne-ee;const Ae=Te[ee],Ve=Te[ee+1],tt=Te[ne],Ze=Te[ne+1];for(let wt=ee+3;wt<ne;wt+=3){const Ce=nt(Te[wt],Te[wt+1],Ae,Ve,tt,Ze);if(Ce>fe)Ee=wt,fe=Ce;else if(Ce===fe){const $t=Math.abs(wt-_e);$t<Re&&(Ee=wt,Re=$t)}}fe>ie&&(Ee-ee>3&&Be(Te,ee,Ee,ie),Te[Ee+2]=fe,ne-Ee>3&&Be(Te,Ee,ne,ie))}function nt(Te,ee,ne,ie,fe,_e){let Ee=fe-ne,Re=_e-ie;if(Ee!==0||Re!==0){const Ae=((Te-ne)*Ee+(ee-ie)*Re)/(Ee*Ee+Re*Re);Ae>1?(ne=fe,ie=_e):Ae>0&&(ne+=Ee*Ae,ie+=Re*Ae)}return Ee=Te-ne,Re=ee-ie,Ee*Ee+Re*Re}function Xe(Te,ee,ne,ie){const fe={id:Te??null,type:ee,geometry:ne,tags:ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")Ge(fe,ne);else if(ee==="Polygon")Ge(fe,ne[0]);else if(ee==="MultiLineString")for(const _e of ne)Ge(fe,_e);else if(ee==="MultiPolygon")for(const _e of ne)Ge(fe,_e[0]);return fe}function Ge(Te,ee){for(let ne=0;ne<ee.length;ne+=3)Te.minX=Math.min(Te.minX,ee[ne]),Te.minY=Math.min(Te.minY,ee[ne+1]),Te.maxX=Math.max(Te.maxX,ee[ne]),Te.maxY=Math.max(Te.maxY,ee[ne+1])}function it(Te,ee,ne,ie){if(!ee.geometry)return;const fe=ee.geometry.coordinates;if(fe&&fe.length===0)return;const _e=ee.geometry.type,Ee=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2);let Re=[],Ae=ee.id;if(ne.promoteId?Ae=ee.properties[ne.promoteId]:ne.generateId&&(Ae=ie||0),_e==="Point")gt(fe,Re);else if(_e==="MultiPoint")for(const Ve of fe)gt(Ve,Re);else if(_e==="LineString")Pt(fe,Re,Ee,!1);else if(_e==="MultiLineString"){if(ne.lineMetrics){for(const Ve of fe)Re=[],Pt(Ve,Re,Ee,!1),Te.push(Xe(Ae,"LineString",Re,ee.properties));return}Nt(fe,Re,Ee,!1)}else if(_e==="Polygon")Nt(fe,Re,Ee,!0);else{if(_e!=="MultiPolygon"){if(_e==="GeometryCollection"){for(const Ve of ee.geometry.geometries)it(Te,{id:Ae,geometry:Ve,properties:ee.properties},ne,ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ve of fe){const tt=[];Nt(Ve,tt,Ee,!0),Re.push(tt)}}Te.push(Xe(Ae,_e,Re,ee.properties))}function gt(Te,ee){ee.push(or(Te[0]),rr(Te[1]),0)}function Pt(Te,ee,ne,ie){let fe,_e,Ee=0;for(let Ae=0;Ae<Te.length;Ae++){const Ve=or(Te[Ae][0]),tt=rr(Te[Ae][1]);ee.push(Ve,tt,0),Ae>0&&(Ee+=ie?(fe*tt-Ve*_e)/2:Math.sqrt(Math.pow(Ve-fe,2)+Math.pow(tt-_e,2))),fe=Ve,_e=tt}const Re=ee.length-3;ee[2]=1,Be(ee,0,Re,ne),ee[Re+2]=1,ee.size=Math.abs(Ee),ee.start=0,ee.end=ee.size}function Nt(Te,ee,ne,ie){for(let fe=0;fe<Te.length;fe++){const _e=[];Pt(Te[fe],_e,ne,ie),ee.push(_e)}}function or(Te){return Te/360+.5}function rr(Te){const ee=Math.sin(Te*Math.PI/180),ne=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ne<0?0:ne>1?1:ne}function pt(Te,ee,ne,ie,fe,_e,Ee,Re){if(ie/=ee,_e>=(ne/=ee)&&Ee<ie)return Te;if(Ee<ne||_e>=ie)return null;const Ae=[];for(const Ve of Te){const tt=Ve.geometry;let Ze=Ve.type;const wt=fe===0?Ve.minX:Ve.minY,Ce=fe===0?Ve.maxX:Ve.maxY;if(wt>=ne&&Ce<ie){Ae.push(Ve);continue}if(Ce<ne||wt>=ie)continue;let $t=[];if(Ze==="Point"||Ze==="MultiPoint")Dt(tt,$t,ne,ie,fe);else if(Ze==="LineString")zt(tt,$t,ne,ie,fe,!1,Re.lineMetrics);else if(Ze==="MultiLineString")Vt(tt,$t,ne,ie,fe,!1);else if(Ze==="Polygon")Vt(tt,$t,ne,ie,fe,!0);else if(Ze==="MultiPolygon")for(const Ht of tt){const At=[];Vt(Ht,At,ne,ie,fe,!0),At.length&&$t.push(At)}if($t.length){if(Re.lineMetrics&&Ze==="LineString"){for(const Ht of $t)Ae.push(Xe(Ve.id,Ze,Ht,Ve.tags));continue}Ze!=="LineString"&&Ze!=="MultiLineString"||($t.length===1?(Ze="LineString",$t=$t[0]):Ze="MultiLineString"),Ze!=="Point"&&Ze!=="MultiPoint"||(Ze=$t.length===3?"Point":"MultiPoint"),Ae.push(Xe(Ve.id,Ze,$t,Ve.tags))}}return Ae.length?Ae:null}function Dt(Te,ee,ne,ie,fe){for(let _e=0;_e<Te.length;_e+=3){const Ee=Te[_e+fe];Ee>=ne&&Ee<=ie&&It(ee,Te[_e],Te[_e+1],Te[_e+2])}}function zt(Te,ee,ne,ie,fe,_e,Ee){let Re=et(Te);const Ae=fe===0?fr:mr;let Ve,tt,Ze=Te.start;for(let At=0;At<Te.length-3;At+=3){const Ft=Te[At],Ar=Te[At+1],vn=Te[At+2],_n=Te[At+3],nn=Te[At+4],Yt=fe===0?Ft:Ar,nr=fe===0?_n:nn;let cn=!1;Ee&&(Ve=Math.sqrt(Math.pow(Ft-_n,2)+Math.pow(Ar-nn,2))),Yt<ne?nr>ne&&(tt=Ae(Re,Ft,Ar,_n,nn,ne),Ee&&(Re.start=Ze+Ve*tt)):Yt>ie?nr<ie&&(tt=Ae(Re,Ft,Ar,_n,nn,ie),Ee&&(Re.start=Ze+Ve*tt)):It(Re,Ft,Ar,vn),nr<ne&&Yt>=ne&&(tt=Ae(Re,Ft,Ar,_n,nn,ne),cn=!0),nr>ie&&Yt<=ie&&(tt=Ae(Re,Ft,Ar,_n,nn,ie),cn=!0),!_e&&cn&&(Ee&&(Re.end=Ze+Ve*tt),ee.push(Re),Re=et(Te)),Ee&&(Ze+=Ve)}let wt=Te.length-3;const Ce=Te[wt],$t=Te[wt+1],Ht=fe===0?Ce:$t;Ht>=ne&&Ht<=ie&&It(Re,Ce,$t,Te[wt+2]),wt=Re.length-3,_e&&wt>=3&&(Re[wt]!==Re[0]||Re[wt+1]!==Re[1])&&It(Re,Re[0],Re[1],Re[2]),Re.length&&ee.push(Re)}function et(Te){const ee=[];return ee.size=Te.size,ee.start=Te.start,ee.end=Te.end,ee}function Vt(Te,ee,ne,ie,fe,_e){for(const Ee of Te)zt(Ee,ee,ne,ie,fe,_e,!1)}function It(Te,ee,ne,ie){Te.push(ee,ne,ie)}function fr(Te,ee,ne,ie,fe,_e){const Ee=(_e-ee)/(ie-ee);return It(Te,_e,ne+(fe-ne)*Ee,1),Ee}function mr(Te,ee,ne,ie,fe,_e){const Ee=(_e-ne)/(fe-ne);return It(Te,ee+(ie-ee)*Ee,_e,1),Ee}function Yr(Te,ee){const ne=[];for(let ie=0;ie<Te.length;ie++){const fe=Te[ie],_e=fe.type;let Ee;if(_e==="Point"||_e==="MultiPoint"||_e==="LineString")Ee=yn(fe.geometry,ee);else if(_e==="MultiLineString"||_e==="Polygon"){Ee=[];for(const Re of fe.geometry)Ee.push(yn(Re,ee))}else if(_e==="MultiPolygon"){Ee=[];for(const Re of fe.geometry){const Ae=[];for(const Ve of Re)Ae.push(yn(Ve,ee));Ee.push(Ae)}}ne.push(Xe(fe.id,_e,Ee,fe.tags))}return ne}function yn(Te,ee){const ne=[];ne.size=Te.size,Te.start!==void 0&&(ne.start=Te.start,ne.end=Te.end);for(let ie=0;ie<Te.length;ie+=3)ne.push(Te[ie]+ee,Te[ie+1],Te[ie+2]);return ne}function Nn(Te,ee){if(Te.transformed)return Te;const ne=1<<Te.z,ie=Te.x,fe=Te.y;for(const _e of Te.features){const Ee=_e.geometry,Re=_e.type;if(_e.geometry=[],Re===1)for(let Ae=0;Ae<Ee.length;Ae+=2)_e.geometry.push(aa(Ee[Ae],Ee[Ae+1],ee,ne,ie,fe));else for(let Ae=0;Ae<Ee.length;Ae++){const Ve=[];for(let tt=0;tt<Ee[Ae].length;tt+=2)Ve.push(aa(Ee[Ae][tt],Ee[Ae][tt+1],ee,ne,ie,fe));_e.geometry.push(Ve)}}return Te.transformed=!0,Te}function aa(Te,ee,ne,ie,fe,_e){return[Math.round(ne*(Te*ie-fe)),Math.round(ne*(ee*ie-_e))]}function Xn(Te,ee,ne,ie,fe){const _e=ee===fe.maxZoom?0:fe.tolerance/((1<<ee)*fe.extent),Ee={features:[],numPoints:0,numSimplified:0,numFeatures:Te.length,source:null,x:ne,y:ie,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Re of Te)Yn(Ee,Re,_e,fe);return Ee}function Yn(Te,ee,ne,ie){const fe=ee.geometry,_e=ee.type,Ee=[];if(Te.minX=Math.min(Te.minX,ee.minX),Te.minY=Math.min(Te.minY,ee.minY),Te.maxX=Math.max(Te.maxX,ee.maxX),Te.maxY=Math.max(Te.maxY,ee.maxY),_e==="Point"||_e==="MultiPoint")for(let Re=0;Re<fe.length;Re+=3)Ee.push(fe[Re],fe[Re+1]),Te.numPoints++,Te.numSimplified++;else if(_e==="LineString")Wi(Ee,fe,Te,ne,!1,!1);else if(_e==="MultiLineString"||_e==="Polygon")for(let Re=0;Re<fe.length;Re++)Wi(Ee,fe[Re],Te,ne,_e==="Polygon",Re===0);else if(_e==="MultiPolygon")for(let Re=0;Re<fe.length;Re++){const Ae=fe[Re];for(let Ve=0;Ve<Ae.length;Ve++)Wi(Ee,Ae[Ve],Te,ne,!0,Ve===0)}if(Ee.length){let Re=ee.tags||null;if(_e==="LineString"&&ie.lineMetrics){Re={};for(const Ve in ee.tags)Re[Ve]=ee.tags[Ve];Re.mapbox_clip_start=fe.start/fe.size,Re.mapbox_clip_end=fe.end/fe.size}const Ae={geometry:Ee,type:_e==="Polygon"||_e==="MultiPolygon"?3:_e==="LineString"||_e==="MultiLineString"?2:1,tags:Re};ee.id!==null&&(Ae.id=ee.id),Te.features.push(Ae)}}function Wi(Te,ee,ne,ie,fe,_e){const Ee=ie*ie;if(ie>0&&ee.size<(fe?Ee:ie))return void(ne.numPoints+=ee.length/3);const Re=[];for(let Ae=0;Ae<ee.length;Ae+=3)(ie===0||ee[Ae+2]>Ee)&&(ne.numSimplified++,Re.push(ee[Ae],ee[Ae+1])),ne.numPoints++;fe&&function(Ae,Ve){let tt=0;for(let Ze=0,wt=Ae.length,Ce=wt-2;Ze<wt;Ce=Ze,Ze+=2)tt+=(Ae[Ze]-Ae[Ce])*(Ae[Ze+1]+Ae[Ce+1]);if(tt>0===Ve)for(let Ze=0,wt=Ae.length;Ze<wt/2;Ze+=2){const Ce=Ae[Ze],$t=Ae[Ze+1];Ae[Ze]=Ae[wt-2-Ze],Ae[Ze+1]=Ae[wt-1-Ze],Ae[wt-2-Ze]=Ce,Ae[wt-1-Ze]=$t}}(Re,_e),Te.push(Re)}const Ia={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class oa{constructor(ee,ne){const ie=(ne=this.options=function(_e,Ee){for(const Re in Ee)_e[Re]=Ee[Re];return _e}(Object.create(Ia),ne)).debug;if(ie&&console.time("preprocess data"),ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");let fe=function(_e,Ee){const Re=[];if(_e.type==="FeatureCollection")for(let Ae=0;Ae<_e.features.length;Ae++)it(Re,_e.features[Ae],Ee,Ae);else it(Re,_e.type==="Feature"?_e:{geometry:_e},Ee);return Re}(ee,ne);this.tiles={},this.tileCoords=[],ie&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ne.indexMaxZoom,ne.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=function(_e,Ee){const Re=Ee.buffer/Ee.extent;let Ae=_e;const Ve=pt(_e,1,-1-Re,Re,0,-1,2,Ee),tt=pt(_e,1,1-Re,2+Re,0,-1,2,Ee);return(Ve||tt)&&(Ae=pt(_e,1,-Re,1+Re,0,-1,2,Ee)||[],Ve&&(Ae=Yr(Ve,1).concat(Ae)),tt&&(Ae=Ae.concat(Yr(tt,-1)))),Ae}(fe,ne),fe.length&&this.splitTile(fe,0,0,0),ie&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,ne,ie,fe,_e,Ee,Re){const Ae=[ee,ne,ie,fe],Ve=this.options,tt=Ve.debug;for(;Ae.length;){fe=Ae.pop(),ie=Ae.pop(),ne=Ae.pop(),ee=Ae.pop();const Ze=1<<ne,wt=Eo(ne,ie,fe);let Ce=this.tiles[wt];if(!Ce&&(tt>1&&console.time("creation"),Ce=this.tiles[wt]=Xn(ee,ne,ie,fe,Ve),this.tileCoords.push({z:ne,x:ie,y:fe}),tt)){tt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ne,ie,fe,Ce.numFeatures,Ce.numPoints,Ce.numSimplified),console.timeEnd("creation"));const cn=`z${ne}`;this.stats[cn]=(this.stats[cn]||0)+1,this.total++}if(Ce.source=ee,_e==null){if(ne===Ve.indexMaxZoom||Ce.numPoints<=Ve.indexMaxPoints)continue}else{if(ne===Ve.maxZoom||ne===_e)continue;if(_e!=null){const cn=_e-ne;if(ie!==Ee>>cn||fe!==Re>>cn)continue}}if(Ce.source=null,ee.length===0)continue;tt>1&&console.time("clipping");const $t=.5*Ve.buffer/Ve.extent,Ht=.5-$t,At=.5+$t,Ft=1+$t;let Ar=null,vn=null,_n=null,nn=null,Yt=pt(ee,Ze,ie-$t,ie+At,0,Ce.minX,Ce.maxX,Ve),nr=pt(ee,Ze,ie+Ht,ie+Ft,0,Ce.minX,Ce.maxX,Ve);ee=null,Yt&&(Ar=pt(Yt,Ze,fe-$t,fe+At,1,Ce.minY,Ce.maxY,Ve),vn=pt(Yt,Ze,fe+Ht,fe+Ft,1,Ce.minY,Ce.maxY,Ve),Yt=null),nr&&(_n=pt(nr,Ze,fe-$t,fe+At,1,Ce.minY,Ce.maxY,Ve),nn=pt(nr,Ze,fe+Ht,fe+Ft,1,Ce.minY,Ce.maxY,Ve),nr=null),tt>1&&console.timeEnd("clipping"),Ae.push(Ar||[],ne+1,2*ie,2*fe),Ae.push(vn||[],ne+1,2*ie,2*fe+1),Ae.push(_n||[],ne+1,2*ie+1,2*fe),Ae.push(nn||[],ne+1,2*ie+1,2*fe+1)}}getTile(ee,ne,ie){ee=+ee,ne=+ne,ie=+ie;const fe=this.options,{extent:_e,debug:Ee}=fe;if(ee<0||ee>24)return null;const Re=1<<ee,Ae=Eo(ee,ne=ne+Re&Re-1,ie);if(this.tiles[Ae])return Nn(this.tiles[Ae],_e);Ee>1&&console.log("drilling down to z%d-%d-%d",ee,ne,ie);let Ve,tt=ee,Ze=ne,wt=ie;for(;!Ve&&tt>0;)tt--,Ze>>=1,wt>>=1,Ve=this.tiles[Eo(tt,Ze,wt)];return Ve&&Ve.source?(Ee>1&&(console.log("found parent tile z%d-%d-%d",tt,Ze,wt),console.time("drilling down")),this.splitTile(Ve.source,tt,Ze,wt,ee,ne,ie),Ee>1&&console.timeEnd("drilling down"),this.tiles[Ae]?Nn(this.tiles[Ae],_e):null):null}}function Eo(Te,ee,ne){return 32*((1<<Te)*ne+ee)+Te}class Ao extends E{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ee,ne){return d._(this,void 0,void 0,function*(){const ie=ee.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const fe=this._geoJSONIndex.getTile(ie.z,ie.x,ie.y);if(!fe)return null;const _e=new U(fe.features,{version:2,extent:d.$});let Ee=function(Re){const Ae=new d.cM;return function(Ve,tt){for(const Ze in Ve.layers)tt.writeMessage(3,N,Ve.layers[Ze])}(Re,Ae),Ae.finish()}(_e);return Ee.byteOffset===0&&Ee.byteLength===Ee.buffer.byteLength||(Ee=new Uint8Array(Ee)),{vectorTile:_e,rawData:Ee.buffer}})}loadData(ee){return d._(this,void 0,void 0,function*(){var ne;(ne=this._pendingRequest)===null||ne===void 0||ne.abort();const ie=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new d.cN(ee.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest);const fe=yield this._pendingData;this._geoJSONIndex=ee.cluster?new Ue(function({superclusterOptions:Ee,clusterProperties:Re}){if(!Re||!Ee)return Ee;const Ae={},Ve={},tt={accumulated:null,zoom:0},Ze={properties:null},wt=Object.keys(Re);for(const Ce of wt){const[$t,Ht]=Re[Ce],At=d.cT(Ht),Ft=d.cT(typeof $t=="string"?[$t,["accumulated"],["get",Ce]]:$t);Ae[Ce]=At.value,Ve[Ce]=Ft.value}return Ee.map=Ce=>{Ze.properties=Ce;const $t={};for(const Ht of wt)$t[Ht]=Ae[Ht].evaluate(tt,Ze);return $t},Ee.reduce=(Ce,$t)=>{Ze.properties=$t;for(const Ht of wt)tt.accumulated=Ce[Ht],Ce[Ht]=Ve[Ht].evaluate(tt,Ze)},Ee}(ee)).load(fe.features):function(Ee,Re){return new oa(Ee,Re)}(fe,ee.geojsonVtOptions),this.loaded={};const _e={data:fe};if(ie){const Ee=ie.finish();Ee&&(_e.resourceTiming={},_e.resourceTiming[ee.source]=JSON.parse(JSON.stringify(Ee)))}return _e}catch(fe){if(delete this._pendingRequest,d.cy(fe))return{abandoned:!0};throw fe}})}getData(){return d._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ee){const ne=this.loaded;return ne&&ne[ee.uid]?super.reloadTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,ne){return d._(this,void 0,void 0,function*(){let ie=yield this.loadGeoJSON(ee,ne);if(delete this._pendingRequest,typeof ie!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(q(ie,!0),ee.filter){const fe=d.cT(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(fe.result==="error")throw new Error(fe.value.map(Ee=>`${Ee.key}: ${Ee.message}`).join(", "));ie={type:"FeatureCollection",features:ie.features.filter(Ee=>fe.value.evaluate({zoom:0},Ee))}}return ie})}loadGeoJSON(ee,ne){return d._(this,void 0,void 0,function*(){const{promoteId:ie}=ee;if(ee.request){const fe=yield d.j(ee.request,ne);return this._dataUpdateable=d.cV(fe.data,ie)?d.cU(fe.data,ie):void 0,fe.data}if(typeof ee.data=="string")try{const fe=JSON.parse(ee.data);return this._dataUpdateable=d.cV(fe,ie)?d.cU(fe,ie):void 0,fe}catch{throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`)}if(!ee.dataDiff)throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ee.source}`);return d.cW(this._dataUpdateable,ee.dataDiff,ie),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ee){return d._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}class Js{constructor(ee){this.self=ee,this.actor=new d.J(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ne,ie)=>{if(this.externalWorkerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.externalWorkerSourceTypes[ne]=ie},this.self.addProtocol=d.cA,this.self.removeProtocol=d.cB,this.self.registerRTLTextPlugin=ne=>{d.cX.setMethods(ne)},this.actor.registerMessageHandler("LDT",(ne,ie)=>this._getDEMWorkerSource(ne,ie.source).loadTile(ie)),this.actor.registerMessageHandler("RDT",(ne,ie)=>d._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ne,ie.source).removeTile(ie)})),this.actor.registerMessageHandler("GCEZ",(ne,ie)=>d._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,ie.type,ie.source).getClusterExpansionZoom(ie)})),this.actor.registerMessageHandler("GCC",(ne,ie)=>d._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,ie.type,ie.source).getClusterChildren(ie)})),this.actor.registerMessageHandler("GCL",(ne,ie)=>d._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,ie.type,ie.source).getClusterLeaves(ie)})),this.actor.registerMessageHandler("LD",(ne,ie)=>this._getWorkerSource(ne,ie.type,ie.source).loadData(ie)),this.actor.registerMessageHandler("GD",(ne,ie)=>this._getWorkerSource(ne,ie.type,ie.source).getData()),this.actor.registerMessageHandler("LT",(ne,ie)=>this._getWorkerSource(ne,ie.type,ie.source).loadTile(ie)),this.actor.registerMessageHandler("RT",(ne,ie)=>this._getWorkerSource(ne,ie.type,ie.source).reloadTile(ie)),this.actor.registerMessageHandler("AT",(ne,ie)=>this._getWorkerSource(ne,ie.type,ie.source).abortTile(ie)),this.actor.registerMessageHandler("RMT",(ne,ie)=>this._getWorkerSource(ne,ie.type,ie.source).removeTile(ie)),this.actor.registerMessageHandler("RS",(ne,ie)=>d._(this,void 0,void 0,function*(){if(!this.workerSources[ne]||!this.workerSources[ne][ie.type]||!this.workerSources[ne][ie.type][ie.source])return;const fe=this.workerSources[ne][ie.type][ie.source];delete this.workerSources[ne][ie.type][ie.source],fe.removeSource!==void 0&&fe.removeSource(ie)})),this.actor.registerMessageHandler("RM",ne=>d._(this,void 0,void 0,function*(){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne]})),this.actor.registerMessageHandler("SR",(ne,ie)=>d._(this,void 0,void 0,function*(){this.referrer=ie})),this.actor.registerMessageHandler("SRPS",(ne,ie)=>this._syncRTLPluginState(ne,ie)),this.actor.registerMessageHandler("IS",(ne,ie)=>d._(this,void 0,void 0,function*(){this.self.importScripts(ie)})),this.actor.registerMessageHandler("SI",(ne,ie)=>this._setImages(ne,ie)),this.actor.registerMessageHandler("UL",(ne,ie)=>d._(this,void 0,void 0,function*(){this._getLayerIndex(ne).update(ie.layers,ie.removedIds)})),this.actor.registerMessageHandler("SL",(ne,ie)=>d._(this,void 0,void 0,function*(){this._getLayerIndex(ne).replace(ie)}))}_setImages(ee,ne){return d._(this,void 0,void 0,function*(){this.availableImages[ee]=ne;for(const ie in this.workerSources[ee]){const fe=this.workerSources[ee][ie];for(const _e in fe)fe[_e].availableImages=ne}})}_syncRTLPluginState(ee,ne){return d._(this,void 0,void 0,function*(){return yield d.cX.syncState(ne,this.self.importScripts)})}_getAvailableImages(ee){let ne=this.availableImages[ee];return ne||(ne=[]),ne}_getLayerIndex(ee){let ne=this.layerIndexes[ee];return ne||(ne=this.layerIndexes[ee]=new s),ne}_getWorkerSource(ee,ne,ie){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][ne]||(this.workerSources[ee][ne]={}),!this.workerSources[ee][ne][ie]){const fe={sendAsync:(_e,Ee)=>(_e.targetMapId=ee,this.actor.sendAsync(_e,Ee))};switch(ne){case"vector":this.workerSources[ee][ne][ie]=new E(fe,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][ne][ie]=new Ao(fe,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][ne][ie]=new this.externalWorkerSourceTypes[ne](fe,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][ne][ie]}_getDEMWorkerSource(ee,ne){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][ne]||(this.demWorkerSources[ee][ne]=new I),this.demWorkerSources[ee][ne]}}return d.i(self)&&(self.worker=new Js(self)),Js}),o("index",["exports","./shared"],function(d,s){var y="5.7.0";function w(){var v=new s.A(4);return s.A!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v}let k,E;const I={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(v,i,u){const p=requestAnimationFrame(_=>{g(),i(_)}),{unsubscribe:g}=s.s(v.signal,"abort",()=>{g(),cancelAnimationFrame(p),u(s.c())},!1)},frameAsync(v){return new Promise((i,u)=>{this.frame(v,i,u)})},getImageData(v,i=0){return this.getImageCanvasContext(v).getImageData(-i,-i,v.width+2*i,v.height+2*i)},getImageCanvasContext(v){const i=window.document.createElement("canvas"),u=i.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return i.width=v.width,i.height=v.height,u.drawImage(v,0,0,v.width,v.height),u},resolveURL:v=>(k||(k=document.createElement("a")),k.href=v,k.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(E==null&&(E=matchMedia("(prefers-reduced-motion: reduce)")),E.matches)}};class j{static testProp(i){if(!j.docStyle)return i[0];for(let u=0;u<i.length;u++)if(i[u]in j.docStyle)return i[u];return i[0]}static create(i,u,p){const g=window.document.createElement(i);return u!==void 0&&(g.className=u),p&&p.appendChild(g),g}static createNS(i,u){return window.document.createElementNS(i,u)}static disableDrag(){j.docStyle&&j.selectProp&&(j.userSelect=j.docStyle[j.selectProp],j.docStyle[j.selectProp]="none")}static enableDrag(){j.docStyle&&j.selectProp&&(j.docStyle[j.selectProp]=j.userSelect)}static setTransform(i,u){i.style[j.transformProp]=u}static addEventListener(i,u,p,g={}){i.addEventListener(u,p,"passive"in g?g:g.capture)}static removeEventListener(i,u,p,g={}){i.removeEventListener(u,p,"passive"in g?g:g.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",j.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",j.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",j.suppressClickInternal,!0)},0)}static getScale(i){const u=i.getBoundingClientRect();return{x:u.width/i.offsetWidth||1,y:u.height/i.offsetHeight||1,boundingClientRect:u}}static getPoint(i,u,p){const g=u.boundingClientRect;return new s.P((p.clientX-g.left)/u.x-i.clientLeft,(p.clientY-g.top)/u.y-i.clientTop)}static mousePos(i,u){const p=j.getScale(i);return j.getPoint(i,p,u)}static touchPos(i,u){const p=[],g=j.getScale(i);for(let _=0;_<u.length;_++)p.push(j.getPoint(i,g,u[_]));return p}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}static sanitize(i){const u=new DOMParser().parseFromString(i,"text/html").body||document.createElement("body"),p=u.querySelectorAll("script");for(const g of p)g.remove();return j.clean(u),u.innerHTML}static isPossiblyDangerous(i,u){const p=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(i)||!p.includes("javascript:")&&!p.includes("data:"))||!!i.startsWith("on")||void 0}static clean(i){const u=i.children;for(const p of u)j.removeAttributes(p),j.clean(p)}static removeAttributes(i){for(const{name:u,value:p}of i.attributes)j.isPossiblyDangerous(u,p)&&i.removeAttribute(u)}}j.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,j.selectProp=j.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),j.transformProp=j.testProp(["transform","WebkitTransform"]);const z={supported:!1,testSupport:function(v){!F&&q&&(U?N(v):L=v)}};let L,q,F=!1,U=!1;function N(v){const i=v.createTexture();v.bindTexture(v.TEXTURE_2D,i);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,q),v.isContextLost())return;z.supported=!0}catch{}v.deleteTexture(i),F=!0}var W;typeof document<"u"&&(q=document.createElement("img"),q.onload=()=>{L&&N(L),L=null,U=!0},q.onerror=()=>{F=!0,L=null},q.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(v){let i,u,p,g;v.resetRequestQueue=()=>{i=[],u=0,p=0,g={}},v.addThrottleControl=M=>{const R=p++;return g[R]=M,R},v.removeThrottleControl=M=>{delete g[M],S()},v.getImage=(M,R,$=!0)=>new Promise((G,V)=>{z.supported&&(M.headers||(M.headers={}),M.headers.accept="image/webp,*/*"),s.e(M,{type:"image"}),i.push({abortController:R,requestParameters:M,supportImageRefresh:$,state:"queued",onError:X=>{V(X)},onSuccess:X=>{G(X)}}),S()});const _=M=>s._(this,void 0,void 0,function*(){M.state="running";const{requestParameters:R,supportImageRefresh:$,onError:G,onSuccess:V,abortController:X}=M,Q=$===!1&&!s.i(self)&&!s.g(R.url)&&(!R.headers||Object.keys(R.headers).reduce((le,ue)=>le&&ue==="accept",!0));u++;const se=Q?C(R,X):s.m(R,X);try{const le=yield se;delete M.abortController,M.state="completed",le.data instanceof HTMLImageElement||s.b(le.data)?V(le):le.data&&V({data:yield(oe=le.data,typeof createImageBitmap=="function"?s.f(oe):s.h(oe)),cacheControl:le.cacheControl,expires:le.expires})}catch(le){delete M.abortController,G(le)}finally{u--,S()}var oe}),S=()=>{const M=(()=>{for(const R of Object.keys(g))if(g[R]())return!0;return!1})()?s.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let R=u;R<M&&i.length>0;R++){const $=i.shift();$.abortController.signal.aborted?R--:_($)}},C=(M,R)=>new Promise(($,G)=>{const V=new Image,X=M.url,Q=M.credentials;Q&&Q==="include"?V.crossOrigin="use-credentials":(Q&&Q==="same-origin"||!s.d(X))&&(V.crossOrigin="anonymous"),R.signal.addEventListener("abort",()=>{V.src="",G(s.c())}),V.fetchPriority="high",V.onload=()=>{V.onerror=V.onload=null,$({data:V})},V.onerror=()=>{V.onerror=V.onload=null,R.signal.aborted||G(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},V.src=X})}(W||(W={})),W.resetRequestQueue();class H{constructor(i){this._transformRequestFn=i??null}transformRequest(i,u){return this._transformRequestFn&&this._transformRequestFn(i,u)||{url:i}}setTransformRequest(i){this._transformRequestFn=i}}function Z(v){const i=[];if(typeof v=="string")i.push({id:"default",url:v});else if(v&&v.length>0){const u=[];for(const{id:p,url:g}of v){const _=`${p}${g}`;u.indexOf(_)===-1&&(u.push(_),i.push({id:p,url:g}))}}return i}function re(v,i,u){try{const p=new URL(v);return p.pathname+=`${i}${u}`,p.toString()}catch{throw new Error(`Invalid sprite URL "${v}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function he(v){const{userImage:i}=v;return!!(i&&i.render&&i.render())&&(v.data.replace(new Uint8Array(i.data.buffer)),!0)}class we extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:u,promiseResolve:p}of this.requestors)p(this._getImagesForIds(u));this.requestors=[]}}getImage(i){const u=this.images[i];if(u&&!u.data&&u.spriteData){const p=u.spriteData;u.data=new s.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),u.spriteData=null}return u}addImage(i,u){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,u)&&(this.images[i]=u)}_validate(i,u){let p=!0;const g=u.data||u.spriteData;return this._validateStretch(u.stretchX,g&&g.width)||(this.fire(new s.k(new Error(`Image "${i}" has invalid "stretchX" value`))),p=!1),this._validateStretch(u.stretchY,g&&g.height)||(this.fire(new s.k(new Error(`Image "${i}" has invalid "stretchY" value`))),p=!1),this._validateContent(u.content,u)||(this.fire(new s.k(new Error(`Image "${i}" has invalid "content" value`))),p=!1),p}_validateStretch(i,u){if(!i)return!0;let p=0;for(const g of i){if(g[0]<p||g[1]<g[0]||u<g[1])return!1;p=g[1]}return!0}_validateContent(i,u){if(!i)return!0;if(i.length!==4)return!1;const p=u.spriteData,g=p&&p.width||u.data.width,_=p&&p.height||u.data.height;return!(i[0]<0||g<i[0]||i[1]<0||_<i[1]||i[2]<0||g<i[2]||i[3]<0||_<i[3]||i[2]<i[0]||i[3]<i[1])}updateImage(i,u,p=!0){const g=this.getImage(i);if(p&&(g.data.width!==u.data.width||g.data.height!==u.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=g.version+1,this.images[i]=u,this.updatedImages[i]=!0}removeImage(i){const u=this.images[i];delete this.images[i],delete this.patterns[i],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i){return new Promise((u,p)=>{let g=!0;if(!this.isLoaded())for(const _ of i)this.images[_]||(g=!1);this.isLoaded()||g?u(this._getImagesForIds(i)):this.requestors.push({ids:i,promiseResolve:u})})}_getImagesForIds(i){const u={};for(const p of i){let g=this.getImage(p);g||(this.fire(new s.l("styleimagemissing",{id:p})),g=this.getImage(p)),g?u[p]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,textFitWidth:g.textFitWidth,textFitHeight:g.textFitHeight,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:s.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:i,height:u}=this.atlasImage;return{width:i,height:u}}getPattern(i){const u=this.patterns[i],p=this.getImage(i);if(!p)return null;if(u&&u.position.version===p.version)return u.position;if(u)u.position.version=p.version;else{const g={w:p.data.width+2,h:p.data.height+2,x:0,y:0},_=new s.I(g,p);this.patterns[i]={bin:g,position:_}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const u=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.T(i,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const _ in this.patterns)i.push(this.patterns[_].bin);const{w:u,h:p}=s.p(i),g=this.atlasImage;g.resize({width:u||1,height:p||1});for(const _ in this.patterns){const{bin:S}=this.patterns[_],C=S.x+1,M=S.y+1,R=this.getImage(_).data,$=R.width,G=R.height;s.R.copy(R,g,{x:0,y:0},{x:C,y:M},{width:$,height:G}),s.R.copy(R,g,{x:0,y:G-1},{x:C,y:M-1},{width:$,height:1}),s.R.copy(R,g,{x:0,y:0},{x:C,y:M+G},{width:$,height:1}),s.R.copy(R,g,{x:$-1,y:0},{x:C-1,y:M},{width:1,height:G}),s.R.copy(R,g,{x:0,y:0},{x:C+$,y:M},{width:1,height:G})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const u of i){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const p=this.getImage(u);p||s.w(`Image with ID: "${u}" was not found`),he(p)&&this.updateImage(u,p)}}}const Oe=1e20;function Me(v,i,u,p,g,_,S,C,M){for(let R=i;R<i+p;R++)Se(v,u*_+R,_,g,S,C,M);for(let R=u;R<u+g;R++)Se(v,R*_+i,1,p,S,C,M)}function Se(v,i,u,p,g,_,S){_[0]=0,S[0]=-Oe,S[1]=Oe,g[0]=v[i];for(let C=1,M=0,R=0;C<p;C++){g[C]=v[i+C*u];const $=C*C;do{const G=_[M];R=(g[C]-g[G]+$-G*G)/(C-G)/2}while(R<=S[M]&&--M>-1);M++,_[M]=C,S[M]=R,S[M+1]=Oe}for(let C=0,M=0;C<p;C++){for(;S[M+1]<C;)M++;const R=_[M],$=C-R;v[i+C*u]=g[R]+$*$}}class Ue{constructor(i,u,p){this.requestManager=i,this.localIdeographFontFamily=u,this.entries={},this.lang=p}setURL(i){this.url=i}getGlyphs(i){return s._(this,void 0,void 0,function*(){const u=[];for(const _ in i)for(const S of i[_])u.push(this._getAndCacheGlyphsPromise(_,S));const p=yield Promise.all(u),g={};for(const{stack:_,id:S,glyph:C}of p)g[_]||(g[_]={}),g[_][S]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};return g})}_getAndCacheGlyphsPromise(i,u){return s._(this,void 0,void 0,function*(){let p=this.entries[i];p||(p=this.entries[i]={glyphs:{},requests:{},ranges:{}});let g=p.glyphs[u];if(g!==void 0)return{stack:i,id:u,glyph:g};if(g=this._tinySDF(p,i,u),g)return p.glyphs[u]=g,{stack:i,id:u,glyph:g};const _=Math.floor(u/256);if(256*_>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[_])return{stack:i,id:u,glyph:g};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[_]){const C=Ue.loadGlyphRange(i,_,this.url,this.requestManager);p.requests[_]=C}const S=yield p.requests[_];for(const C in S)this._doesCharSupportLocalGlyph(+C)||(p.glyphs[+C]=S[+C]);return p.ranges[_]=!0,{stack:i,id:u,glyph:S[u]||null}})}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&(/\p{Ideo}|\p{sc=Hang}|\p{sc=Hira}|\p{sc=Kana}/u.test(String.fromCodePoint(i))||s.u["CJK Unified Ideographs"](i)||s.u["Hangul Syllables"](i)||s.u.Hiragana(i)||s.u.Katakana(i)||s.u["CJK Symbols and Punctuation"](i)||s.u["Halfwidth and Fullwidth Forms"](i))}_tinySDF(i,u,p){const g=this.localIdeographFontFamily;if(!g||!this._doesCharSupportLocalGlyph(p))return;let _=i.tinySDF;if(!_){let C="400";/bold/i.test(u)?C="900":/medium/i.test(u)?C="500":/light/i.test(u)&&(C="200"),_=i.tinySDF=new Ue.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:g,fontWeight:C})}const S=_.draw(String.fromCharCode(p));return{id:p,bitmap:new s.q({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ue.loadGlyphRange=function(v,i,u,p){return s._(this,void 0,void 0,function*(){const g=256*i,_=g+255,S=p.transformRequest(u.replace("{fontstack}",v).replace("{range}",`${g}-${_}`),"Glyphs"),C=yield s.n(S,new AbortController);if(!C||!C.data)throw new Error(`Could not load glyph range. range: ${i}, ${g}-${_}`);const M={};for(const R of s.o(C.data))M[R.id]=R;return M})},Ue.TinySDF=class{constructor({fontSize:v=24,buffer:i=3,radius:u=8,cutoff:p=.25,fontFamily:g="sans-serif",fontWeight:_="normal",fontStyle:S="normal",lang:C=null}={}){this.buffer=i,this.cutoff=p,this.radius=u,this.lang=C;const M=this.size=v+4*i,R=this._createCanvas(M),$=this.ctx=R.getContext("2d",{willReadFrequently:!0});$.font=`${S} ${_} ${v}px ${g}`,$.textBaseline="alphabetic",$.textAlign="left",$.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(v){const i=document.createElement("canvas");return i.width=i.height=v,i}draw(v){const{width:i,actualBoundingBoxAscent:u,actualBoundingBoxDescent:p,actualBoundingBoxLeft:g,actualBoundingBoxRight:_}=this.ctx.measureText(v),S=Math.ceil(u),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-g))),M=Math.min(this.size-this.buffer,S+Math.ceil(p)),R=C+2*this.buffer,$=M+2*this.buffer,G=Math.max(R*$,0),V=new Uint8ClampedArray(G),X={data:V,width:R,height:$,glyphWidth:C,glyphHeight:M,glyphTop:S,glyphLeft:0,glyphAdvance:i};if(C===0||M===0)return X;const{ctx:Q,buffer:se,gridInner:oe,gridOuter:le}=this;this.lang&&(Q.lang=this.lang),Q.clearRect(se,se,C,M),Q.fillText(v,se,se+S);const ue=Q.getImageData(se,se,C,M);le.fill(Oe,0,G),oe.fill(0,0,G);for(let me=0;me<M;me++)for(let de=0;de<C;de++){const ye=ue.data[4*(me*C+de)+3]/255;if(ye===0)continue;const xe=(me+se)*R+de+se;if(ye===1)le[xe]=0,oe[xe]=Oe;else{const pe=.5-ye;le[xe]=pe>0?pe*pe:0,oe[xe]=pe<0?pe*pe:0}}Me(le,0,0,R,$,R,this.f,this.v,this.z),Me(oe,se,se,C,M,R,this.f,this.v,this.z);for(let me=0;me<G;me++){const de=Math.sqrt(le[me])-Math.sqrt(oe[me]);V[me]=Math.round(255-255*(de/this.radius+this.cutoff))}return X}};class We{constructor(){this.specification=s.v.light.position}possiblyEvaluate(i,u){return s.B(i.expression.evaluate(u))}interpolate(i,u,p){return{x:s.C.number(i.x,u.x,p),y:s.C.number(i.y,u.y,p),z:s.C.number(i.z,u.z,p)}}}let qe;class Je extends s.E{constructor(i){super(),qe=qe||new s.r({anchor:new s.D(s.v.light.anchor),position:new We,color:new s.D(s.v.light.color),intensity:new s.D(s.v.light.intensity)}),this._transitionable=new s.t(qe),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,u={}){if(!this._validate(s.x,i,u))for(const p in i){const g=i[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),g):this._transitionable.setValue(p,g)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,u,p){return(!p||p.validate!==!1)&&s.y(this,i.call(s.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.v}))}}const rt=new s.r({"sky-color":new s.D(s.v.sky["sky-color"]),"horizon-color":new s.D(s.v.sky["horizon-color"]),"fog-color":new s.D(s.v.sky["fog-color"]),"fog-ground-blend":new s.D(s.v.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.v.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.v.sky["atmosphere-blend"])});class Le extends s.E{constructor(i){super(),this._transitionable=new s.t(rt),this.setSky(i),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0))}setSky(i,u={}){if(!this._validate(s.G,i,u)){i||(i={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const p in i){const g=i[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),g):this._transitionable.setValue(p,g)}}}getSky(){return this._transitionable.serialize()}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,u,p={}){return(p==null?void 0:p.validate)!==!1&&s.y(this,i.call(s.z,s.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.v})))}calculateFogBlendOpacity(i){return i<60?0:i<70?(i-60)/10:1}}class Be{constructor(i,u){this.width=i,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,u){const p=i.join(",")+String(u);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(i,u)),this.dashEntry[p]}getDashRanges(i,u,p){const g=[];let _=i.length%2==1?-i[i.length-1]*p:0,S=i[0]*p,C=!0;g.push({left:_,right:S,isDash:C,zeroLength:i[0]===0});let M=i[0];for(let R=1;R<i.length;R++){C=!C;const $=i[R];_=M*p,M+=$,S=M*p,g.push({left:_,right:S,isDash:C,zeroLength:$===0})}return g}addRoundDash(i,u,p){const g=u/2;for(let _=-p;_<=p;_++){const S=this.width*(this.nextRow+p+_);let C=0,M=i[C];for(let R=0;R<this.width;R++){R/M.right>1&&(M=i[++C]);const $=Math.abs(R-M.left),G=Math.abs(R-M.right),V=Math.min($,G);let X;const Q=_/p*(g+1);if(M.isDash){const se=g-Math.abs(Q);X=Math.sqrt(V*V+se*se)}else X=g-Math.sqrt(V*V+Q*Q);this.data[S+R]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(i){for(let C=i.length-1;C>=0;--C){const M=i[C],R=i[C+1];M.zeroLength?i.splice(C,1):R&&R.isDash===M.isDash&&(R.left=M.left,i.splice(C,1))}const u=i[0],p=i[i.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);const g=this.width*this.nextRow;let _=0,S=i[_];for(let C=0;C<this.width;C++){C/S.right>1&&(S=i[++_]);const M=Math.abs(C-S.left),R=Math.abs(C-S.right),$=Math.min(M,R);this.data[g+C]=Math.max(0,Math.min(255,(S.isDash?$:-$)+128))}}addDash(i,u){const p=u?7:0,g=2*p+1;if(this.nextRow+g>this.height)return s.w("LineAtlas out of space"),null;let _=0;for(let C=0;C<i.length;C++)_+=i[C];if(_!==0){const C=this.width/_,M=this.getDashRanges(i,this.width,C);u?this.addRoundDash(M,C,p):this.addRegularDash(M)}const S={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:_};return this.nextRow+=g,this.dirty=!0,S}bind(i){const u=i.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const nt="maplibre_preloaded_worker_pool";class Xe{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<Xe.workerCount;)this.workers.push(new Worker(s.a.WORKER_URL));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[nt]}numActive(){return Object.keys(this.active).length}}const Ge=Math.floor(I.hardwareConcurrency/2);let it,gt;function Pt(){return it||(it=new Xe),it}Xe.workerCount=s.H(globalThis)?Math.max(Math.min(Ge,3),1):1;class Nt{constructor(i,u){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=u;const p=this.workerPool.acquire(u);for(let g=0;g<p.length;g++){const _=new s.J(p[g],u);_.name=`Worker ${g}`,this.actors.push(_)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,u){const p=[];for(const g of this.actors)p.push(g.sendAsync({type:i,data:u}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(i=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],i&&this.workerPool.release(this.id)}registerMessageHandler(i,u){for(const p of this.actors)p.registerMessageHandler(i,u)}}function or(){return gt||(gt=new Nt(Pt(),s.K),gt.registerMessageHandler("GR",(v,i,u)=>s.m(i,u))),gt}function rr(v,i){const u=s.L();return s.M(u,u,[1,1,0]),s.N(u,u,[.5*v.width,.5*v.height,1]),v.calculatePosMatrix?s.O(u,u,v.calculatePosMatrix(i.toUnwrapped())):u}function pt(v,i,u,p,g,_,S){var C;const M=function(V,X,Q){if(V)for(const se of V){const oe=X[se];if(oe&&oe.source===Q&&oe.type==="fill-extrusion")return!0}else for(const se in X){const oe=X[se];if(oe.source===Q&&oe.type==="fill-extrusion")return!0}return!1}((C=g==null?void 0:g.layers)!==null&&C!==void 0?C:null,i,v.id),R=_.maxPitchScaleFactor(),$=v.tilesIn(p,R,M);$.sort(Dt);const G=[];for(const V of $)G.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(i,u,v._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,g,_,R,rr(v.transform,V.tileID),S?(X,Q)=>S(V.tileID,X,Q):void 0)});return function(V,X){for(const Q in V)for(const se of V[Q])zt(se,X);return V}(function(V){const X={},Q={};for(const se of V){const oe=se.queryResults,le=se.wrappedTileID,ue=Q[le]=Q[le]||{};for(const me in oe){const de=oe[me],ye=ue[me]=ue[me]||{},xe=X[me]=X[me]||[];for(const pe of de)ye[pe.featureIndex]||(ye[pe.featureIndex]=!0,xe.push(pe))}}return X}(G),v)}function Dt(v,i){const u=v.tileID,p=i.tileID;return u.overscaledZ-p.overscaledZ||u.canonical.y-p.canonical.y||u.wrap-p.wrap||u.canonical.x-p.canonical.x}function zt(v,i){const u=v.feature,p=i.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=p}function et(v,i,u){return s._(this,void 0,void 0,function*(){let p=v;if(v.url?p=(yield s.j(i.transformRequest(v.url,"Source"),u)).data:yield I.frameAsync(u),!p)return null;const g=s.Q(s.e(p,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(g.vectorLayerIds=p.vector_layers.map(_=>_.id)),g})}class Vt{constructor(i,u){i&&(u?this.setSouthWest(i).setNorthEast(u):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof s.S?new s.S(i.lng,i.lat):s.S.convert(i),this}setSouthWest(i){return this._sw=i instanceof s.S?new s.S(i.lng,i.lat):s.S.convert(i),this}extend(i){const u=this._sw,p=this._ne;let g,_;if(i instanceof s.S)g=i,_=i;else{if(!(i instanceof Vt))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(Vt.convert(i)):this.extend(s.S.convert(i)):i&&("lng"in i||"lon"in i)&&"lat"in i?this.extend(s.S.convert(i)):this;if(g=i._sw,_=i._ne,!g||!_)return this}return u||p?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),p.lng=Math.max(_.lng,p.lng),p.lat=Math.max(_.lat,p.lat)):(this._sw=new s.S(g.lng,g.lat),this._ne=new s.S(_.lng,_.lat)),this}getCenter(){return new s.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.S(this.getWest(),this.getNorth())}getSouthEast(){return new s.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:u,lat:p}=s.S.convert(i);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&g}static convert(i){return i instanceof Vt?i:i&&new Vt(i)}static fromLngLat(i,u=0){const p=360*u/40075017,g=p/Math.cos(Math.PI/180*i.lat);return new Vt(new s.S(i.lng-g,i.lat-p),new s.S(i.lng+g,i.lat+p))}adjustAntiMeridian(){const i=new s.S(this._sw.lng,this._sw.lat),u=new s.S(this._ne.lng,this._ne.lat);return new Vt(i,i.lng>u.lng?new s.S(u.lng+360,u.lat):u)}}class It{constructor(i,u,p){this.bounds=Vt.convert(this.validateBounds(i)),this.minzoom=u||0,this.maxzoom=p||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const u=Math.pow(2,i.z),p=Math.floor(s.V(this.bounds.getWest())*u),g=Math.floor(s.U(this.bounds.getNorth())*u),_=Math.ceil(s.V(this.bounds.getEast())*u),S=Math.ceil(s.U(this.bounds.getSouth())*u);return i.x>=p&&i.x<_&&i.y>=g&&i.y<S}}class fr extends s.E{constructor(i,u,p,g){if(super(),this.id=i,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.Q(u,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield et(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),i&&(s.e(this,i),i.bounds&&(this.tileBounds=new It(i.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new s.k(i))}})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.abort(),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(i){return s._(this,void 0,void 0,function*(){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(u,"Tile"),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};p.request.collectResourceTiming=this._collectResourceTiming;let g="RT";if(i.actor&&i.state!=="expired"){if(i.state==="loading")return new Promise((_,S)=>{i.reloadPromise={resolve:_,reject:S}})}else i.actor=this.dispatcher.getActor(),g="LT";i.abortController=new AbortController;try{const _=yield i.actor.sendAsync({type:g,data:p},i.abortController);if(delete i.abortController,i.aborted)return;this._afterTileLoadWorkerResponse(i,_)}catch(_){if(delete i.abortController,i.aborted)return;if(_&&_.status!==404)throw _;this._afterTileLoadWorkerResponse(i,null)}})}_afterTileLoadWorkerResponse(i,u){if(u&&u.resourceTiming&&(i.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&i.setExpiryData(u),i.loadVectorData(u,this.map.painter),i.reloadPromise){const p=i.reloadPromise;i.reloadPromise=null,this.loadTile(i).then(p.resolve).catch(p.reject)}}abortTile(i){return s._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.actor&&(yield i.actor.sendAsync({type:"AT",data:{uid:i.uid,type:this.type,source:this.id}}))})}unloadTile(i){return s._(this,void 0,void 0,function*(){i.unloadVectorData(),i.actor&&(yield i.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class mr extends s.E{constructor(i,u,p,g){super(),this.id=i,this.dispatcher=p,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},u),s.e(this,s.Q(u,["url","scheme","tileSize"]))}load(){return s._(this,arguments,void 0,function*(i=!1){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield et(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(s.e(this,u),u.bounds&&(this.tileBounds=new It(u.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:i})))}catch(u){this._tileJSONRequest=null,this.fire(new s.k(u))}})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(i){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),i(),this.load(!0)}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}serialize(){return s.e({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i){return s._(this,void 0,void 0,function*(){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.abortController=new AbortController;try{const p=yield W.getImage(this.map._requestManager.transformRequest(u,"Tile"),i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&(p.cacheControl||p.expires)&&i.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const g=this.map.painter.context,_=g.gl,S=p.data;i.texture=this.map.painter.getTileTexture(S.width),i.texture?i.texture.update(S,{useMipmap:!0}):(i.texture=new s.T(g,S,_.RGBA,{useMipmap:!0}),i.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST)),i.state="loaded"}}catch(p){if(delete i.abortController,i.aborted)i.state="unloaded";else if(p)throw i.state="errored",p}})}abortTile(i){return s._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController)})}unloadTile(i){return s._(this,void 0,void 0,function*(){i.texture&&this.map.painter.saveTileTexture(i.texture)})}hasTransition(){return!1}}class Yr extends mr{constructor(i,u,p,g){super(i,u,p,g),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(i){return s._(this,void 0,void 0,function*(){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(u,"Tile");i.neighboringTiles=this._getNeighboringTiles(i.tileID),i.abortController=new AbortController;try{const g=yield W.getImage(p,i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(g&&g.data){const _=g.data;this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&i.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const S=s.b(_)&&s.W()?_:yield this.readImageNow(_),C={type:this.type,uid:i.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!i.actor||i.state==="expired"){i.actor=this.dispatcher.getActor();const M=yield i.actor.sendAsync({type:"LDT",data:C});i.dem=M,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded"}}}catch(g){if(delete i.abortController,i.aborted)i.state="unloaded";else if(g)throw i.state="errored",g}})}readImageNow(i){return s._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&s.X()){const u=i.width+2,p=i.height+2;try{return new s.R({width:u,height:p},yield s.Y(i,-1,-1,u,p))}catch{}}return I.getImageData(i,1)})}_getNeighboringTiles(i){const u=i.canonical,p=Math.pow(2,u.z),g=(u.x-1+p)%p,_=u.x===0?i.wrap-1:i.wrap,S=(u.x+1+p)%p,C=u.x+1===p?i.wrap+1:i.wrap,M={};return M[new s.Z(i.overscaledZ,_,u.z,g,u.y).key]={backfilled:!1},M[new s.Z(i.overscaledZ,C,u.z,S,u.y).key]={backfilled:!1},u.y>0&&(M[new s.Z(i.overscaledZ,_,u.z,g,u.y-1).key]={backfilled:!1},M[new s.Z(i.overscaledZ,i.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},M[new s.Z(i.overscaledZ,C,u.z,S,u.y-1).key]={backfilled:!1}),u.y+1<p&&(M[new s.Z(i.overscaledZ,_,u.z,g,u.y+1).key]={backfilled:!1},M[new s.Z(i.overscaledZ,i.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},M[new s.Z(i.overscaledZ,C,u.z,S,u.y+1).key]={backfilled:!1}),M}unloadTile(i){return s._(this,void 0,void 0,function*(){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&(yield i.actor.sendAsync({type:"RDT",data:{type:this.type,uid:i.uid,source:this.id}}))})}}class yn extends s.E{constructor(i,u,p,g){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:u.data},this.actor=p.getActor(),this.setEventedParent(g),this._data=u.data,this._options=s.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:s.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:s.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(i){return i*(s.$/this.tileSize)}_getClusterMaxZoom(i){const u=i?Math.round(i):this.maxzoom-1;return Number.isInteger(i)||i===void 0||s.w(`Integer expected for option 'clusterMaxZoom': provided value "${i}" rounded to "${u}"`),u}load(){return s._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._pendingWorkerUpdate={data:i},this._updateWorkerData(),this}updateData(i){return this._pendingWorkerUpdate.diff=s.a0(this._pendingWorkerUpdate.diff,i),this._updateWorkerData(),this}getData(){return s._(this,void 0,void 0,function*(){const i=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:i})})}getCoordinatesFromGeometry(i){return i.type==="GeometryCollection"?i.geometries.map(u=>u.coordinates).flat(1/0):i.coordinates.flat(1/0)}getBounds(){return s._(this,void 0,void 0,function*(){const i=new Vt,u=yield this.getData();let p;switch(u.type){case"FeatureCollection":p=u.features.map(g=>this.getCoordinatesFromGeometry(g.geometry)).flat(1/0);break;case"Feature":p=this.getCoordinatesFromGeometry(u.geometry);break;default:p=this.getCoordinatesFromGeometry(u)}if(p.length==0)return i;for(let g=0;g<p.length-1;g+=2)i.extend([p[g],p[g+1]]);return i})}setClusterOptions(i){return this.workerOptions.cluster=i.cluster,i&&(i.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(i.clusterRadius)),i.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(i.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(i){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:i,source:this.id}})}getClusterChildren(i){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:i,source:this.id}})}getClusterLeaves(i,u,p){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:i,limit:u,offset:p}})}_updateWorkerData(){return s._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:i,diff:u}=this._pendingWorkerUpdate;if(!i&&!u)return void s.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const p=s.e({type:this.type},this.workerOptions);i?(typeof i=="string"?(p.request=this.map._requestManager.transformRequest(I.resolveURL(i),"Source"),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(i),this._pendingWorkerUpdate.data=void 0):u&&(p.dataDiff=u,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new s.l("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:p});if(this._isUpdatingWorker=!1,this._removed||g.abandoned)return void this.fire(new s.l("dataabort",{dataType:"source"}));this._data=g.data;let _=null;g.resourceTiming&&g.resourceTiming[this.id]&&(_=g.resourceTiming[this.id].slice(0));const S={dataType:"source"};this._collectResourceTiming&&_&&_.length>0&&s.e(S,{resourceTiming:_}),this.fire(new s.l("data",Object.assign(Object.assign({},S),{sourceDataType:"metadata"}))),this.fire(new s.l("data",Object.assign(Object.assign({},S),{sourceDataType:"content"})))}catch(g){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new s.l("dataabort",{dataType:"source"}));this.fire(new s.k(g))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(i){return s._(this,void 0,void 0,function*(){const u=i.actor?"RT":"LT";i.actor=this.actor;const p={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};i.abortController=new AbortController;const g=yield this.actor.sendAsync({type:u,data:p},i.abortController);delete i.abortController,i.unloadVectorData(),i.aborted||i.loadVectorData(g,this.map.painter,u==="RT")})}abortTile(i){return s._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.aborted=!0})}unloadTile(i){return s._(this,void 0,void 0,function*(){i.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Nn extends s.E{constructor(i,u,p,g){super(),this.flippedWindingOrder=!1,this.id=i,this.dispatcher=p,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=u}load(i){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield W.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,i&&(this.coordinates=i),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new s.k(u))}})}loaded(){return this._loaded}updateImage(i){return i.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=i.url,this.load(i.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(i){this.coordinates=i;const u=i.map(s.a1.fromLngLat);var p;return this.tileID=function(g){const _=s.a2.fromPoints(g),S=_.width(),C=_.height(),M=Math.max(S,C),R=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),$=Math.pow(2,R);return new s.a4(R,Math.floor((_.minX+_.maxX)/2*$),Math.floor((_.minY+_.maxY)/2*$))}(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map(g=>this.tileID.getTilePoint(g)._round()),this.flippedWindingOrder=((p=this.tileCoords)[1].x-p[0].x)*(p[2].y-p[0].y)-(p[1].y-p[0].y)*(p[2].x-p[0].x)<0,this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,u=i.gl;this.texture||(this.texture=new s.T(i,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let p=!1;for(const g in this.tiles){const _=this.tiles[g];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,p=!0)}p&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(i){return s._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={}):i.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(i){const{minX:u,minY:p,maxX:g,maxY:_}=s.a2.fromPoints(i),S={};for(let C=0;C<=s.a3;C++){const M=Math.pow(2,C),R=Math.floor(u*M),$=Math.floor(p*M),G=Math.floor(g*M),V=Math.floor(_*M);S[C]={minTileX:R,minTileY:$,maxTileX:G,maxTileY:V}}return S}}class aa extends Nn{constructor(i,u,p,g){super(i,u,p,g),this.roundZoom=!0,this.type="video",this.options=u}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1;const i=this.options;this.urls=[];for(const u of i.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield s.a5(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new s.k(u))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const u=this.video.seekable;i<u.start(0)||i>u.end(0)?this.fire(new s.k(new s.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,u=i.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(i,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let p=!1;for(const g in this.tiles){const _=this.tiles[g];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,p=!0)}p&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Xn extends Nn{constructor(i,u,p,g){super(i,u,p,g),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(S=>typeof S!="number"))||this.fire(new s.k(new s.a6(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.k(new s.a6(`sources.${i}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new s.k(new s.a6(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new s.k(new s.a6(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.k(new s.a6(`sources.${i}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return s._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,p=u.gl;this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(u,this.canvas,p.RGBA,{premultiply:!0});let g=!1;for(const _ in this.tiles){const S=this.tiles[_];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,g=!0)}g&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const Yn={},Wi=v=>{switch(v){case"geojson":return yn;case"image":return Nn;case"raster":return mr;case"raster-dem":return Yr;case"vector":return fr;case"video":return aa;case"canvas":return Xn}return Yn[v]},Ia="RTLPluginLoaded";class oa extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=or()}_syncState(i){return this.status=i,this.dispatcher.broadcast("SRPS",{pluginStatus:i,pluginURL:this.url}).catch(u=>{throw this.status="error",u})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(i){return s._(this,arguments,void 0,function*(u,p=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=I.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!p)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return s._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.l(Ia))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Eo=null;function Ao(){return Eo||(Eo=new oa),Eo}class Js{constructor(i,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=i,this.uid=s.a7(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const u=i+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(i,u,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(g,_){const S={};if(!_)return S;for(const C of g){const M=C.layerIds.map(R=>_.getLayer(R)).filter(Boolean);if(M.length!==0){C.layers=M,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(R=>M.filter($=>$.id===R)[0]));for(const R of M)S[R.id]=C}}return S}(i.buckets,u==null?void 0:u.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const _=this.buckets[g];if(_ instanceof s.a9){if(this.hasSymbolBuckets=!0,!p)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const _=this.buckets[g];if(_ instanceof s.a9&&_.hasRTLText){this.hasRTLText=!0,Ao().lazyLoad();break}}this.queryPadding=0;for(const g in this.buckets){const _=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(g).queryRadius(_))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new s.a8}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const p in this.buckets){const g=this.buckets[p];g.uploadPending()&&g.upload(i)}const u=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new s.T(i,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(i,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,u,p,g,_,S,C,M,R,$,G){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:_,scale:S,tileSize:this.tileSize,pixelPosMatrix:$,transform:M,params:C,queryPadding:this.queryPadding*R,getElevation:G},i,u,p):{}}querySourceFeatures(i,u){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const g=p.loadVTLayers(),_=u&&u.sourceLayer?u.sourceLayer:"",S=g._geojsonTileLayer||g[_];if(!S)return;const C=s.aa(u&&u.filter),{z:M,x:R,y:$}=this.tileID.canonical,G={z:M,x:R,y:$};for(let V=0;V<S.length;V++){const X=S.feature(V);if(C.needGeometry){const oe=s.ab(X,!0);if(!C.filter(new s.F(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!C.filter(new s.F(this.tileID.overscaledZ),X))continue;const Q=p.getId(X,_),se=new s.ac(X,M,R,$,Q);se.tile=G,i.push(se)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const u=this.expirationTime;if(i.cacheControl){const p=s.ad(i.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const p=Date.now();let g=!1;if(this.expirationTime>p)g=!1;else if(u)if(this.expirationTime<u)g=!0;else{const _=this.expirationTime-u;_?this.expirationTime=p+Math.max(_,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!u.style.hasLayer(g))continue;const _=this.buckets[g],S=_.layers[0].sourceLayer||"_geojsonTileLayer",C=p[S],M=i[S];if(!C||!M||Object.keys(M).length===0)continue;_.update(M,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const R=u&&u.style&&u.style.getLayer(g);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(_)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<I.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=I.now()+i}setDependencies(i,u){const p={};for(const g of u)p[g]=!0;this.dependencies[i]=p}hasDependency(i,u){for(const p of i){const g=this.dependencies[p];if(g){for(const _ of u)if(g[_])return!0}}return!1}}class Te{constructor(i,u){this.max=i,this.onRemove=u,this.reset()}reset(){for(const i in this.data)for(const u of this.data[i])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(i,u,p){const g=i.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const _={value:u,timeout:void 0};if(p!==void 0&&(_.timeout=setTimeout(()=>{this.remove(i,_)},p)),this.data[g].push(_),this.order.push(g),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const u=this.data[i].shift();return u.timeout&&clearTimeout(u.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),u.value}getByKey(i){const u=this.data[i];return u?u[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,u){if(!this.has(i))return this;const p=i.wrapped().key,g=u===void 0?0:this.data[p].indexOf(u),_=this.data[p][g];return this.data[p].splice(g,1),_.timeout&&clearTimeout(_.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(_.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(i){const u=[];for(const p in this.data)for(const g of this.data[p])i(g.value)||u.push(g);for(const p of u)this.remove(p.value.tileID,p)}}class ee{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,u,p){const g=String(u);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][g]=this.stateChanges[i][g]||{},s.e(this.stateChanges[i][g],p),this.deletedStates[i]===null){this.deletedStates[i]={};for(const _ in this.state[i])_!==g&&(this.deletedStates[i][_]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][g]===null){this.deletedStates[i][g]={};for(const _ in this.state[i][g])p[_]||(this.deletedStates[i][g][_]=null)}else for(const _ in p)this.deletedStates[i]&&this.deletedStates[i][g]&&this.deletedStates[i][g][_]===null&&delete this.deletedStates[i][g][_]}removeFeatureState(i,u,p){if(this.deletedStates[i]===null)return;const g=String(u);if(this.deletedStates[i]=this.deletedStates[i]||{},p&&u!==void 0)this.deletedStates[i][g]!==null&&(this.deletedStates[i][g]=this.deletedStates[i][g]||{},this.deletedStates[i][g][p]=null);else if(u!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][g])for(p in this.deletedStates[i][g]={},this.stateChanges[i][g])this.deletedStates[i][g][p]=null;else this.deletedStates[i][g]=null;else this.deletedStates[i]=null}getState(i,u){const p=String(u),g=s.e({},(this.state[i]||{})[p],(this.stateChanges[i]||{})[p]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const _=this.deletedStates[i][u];if(_===null)return{};for(const S in _)delete g[S]}return g}initializeTileState(i,u){i.setFeatureState(this.state,u)}coalesceChanges(i,u){const p={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const _={};for(const S in this.stateChanges[g])this.state[g][S]||(this.state[g][S]={}),s.e(this.state[g][S],this.stateChanges[g][S]),_[S]=this.state[g][S];p[g]=_}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const _={};if(this.deletedStates[g]===null)for(const S in this.state[g])_[S]={},this.state[g][S]={};else for(const S in this.deletedStates[g]){if(this.deletedStates[g][S]===null)this.state[g][S]={};else for(const C of Object.keys(this.deletedStates[g][S]))delete this.state[g][S][C];_[S]=this.state[g][S]}p[g]=p[g]||{},s.e(p[g],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const g in i)i[g].setFeatureState(p,u)}}const ne=89.25;function ie(v,i){const u=s.ah(i.lat,-s.ai,s.ai);return new s.P(s.V(i.lng)*v,s.U(u)*v)}function fe(v,i){return new s.a1(i.x/v,i.y/v).toLngLat()}function _e(v){return v.cameraToCenterDistance*Math.min(.85*Math.tan(s.ae(90-v.pitch)),Math.tan(s.ae(ne-v.pitch)))}function Ee(v,i){const u=v.canonical,p=i/s.af(u.z),g=u.x+Math.pow(2,u.z)*v.wrap,_=s.ag(new Float64Array(16));return s.M(_,_,[g*p,u.y*p,0]),s.N(_,_,[p/s.$,p/s.$,1]),_}function Re(v,i,u,p,g){const _=s.a1.fromLngLat(v,i),S=g*s.aj(1,v.lat),C=S*Math.cos(s.ae(u)),M=Math.sqrt(S*S-C*C),R=M*Math.sin(s.ae(-p)),$=M*Math.cos(s.ae(-p));return new s.a1(_.x+R,_.y+$,_.z+C)}function Ae(v,i,u){const p=i.intersectsFrustum(v);if(!u||p===0)return p;const g=i.intersectsPlane(u);return g===0?0:p===2&&g===2?2:1}function Ve(v,i,u){let p=0;const g=(u-i)/10;for(let _=0;_<10;_++)p+=g*Math.pow(Math.cos(i+(_+.5)/10*(u-i)),v);return p}function tt(v,i){return function(u,p,g,_,S){const C=2*((v-1)/s.ak(Math.cos(s.ae(ne-S))/Math.cos(s.ae(ne)))-1),M=Math.acos(g/_),R=2*Ve(C-1,0,s.ae(S/2)),$=Math.min(s.ae(ne),M+s.ae(S/2)),G=Ve(C-1,Math.min($,M-s.ae(S/2)),$),V=Math.atan(p/g),X=Math.hypot(p,g);let Q=u;return Q+=s.ak(_/X/Math.max(.5,Math.cos(s.ae(S/2)))),Q+=C*s.ak(Math.cos(V))/2,Q-=s.ak(Math.max(1,G/R/i))/2,Q}}const Ze=tt(9.314,3);function wt(v,i){const u=(i.roundZoom?Math.round:Math.floor)(v.zoom+s.ak(v.tileSize/i.tileSize));return Math.max(0,u)}function Ce(v,i){const u=v.getCameraFrustum(),p=v.getClippingPlane(),g=v.screenPointToMercatorCoordinate(v.getCameraPoint()),_=s.a1.fromLngLat(v.center,v.elevation);g.z=_.z+Math.cos(v.pitchInRadians)*v.cameraToCenterDistance/v.worldSize;const S=v.getCoveringTilesDetailsProvider(),C=S.allowVariableZoom(v,i),M=wt(v,i),R=i.minzoom||0,$=i.maxzoom!==void 0?i.maxzoom:v.maxZoom,G=Math.min(Math.max(0,M),$),V=Math.pow(2,G),X=[V*g.x,V*g.y,0],Q=[V*_.x,V*_.y,0],se=Math.hypot(_.x-g.x,_.y-g.y),oe=Math.abs(_.z-g.z),le=Math.hypot(se,oe),ue=ye=>({zoom:0,x:0,y:0,wrap:ye,fullyVisible:!1}),me=[],de=[];if(v.renderWorldCopies&&S.allowWorldCopies())for(let ye=1;ye<=3;ye++)me.push(ue(-ye)),me.push(ue(ye));for(me.push(ue(0));me.length>0;){const ye=me.pop(),xe=ye.x,pe=ye.y;let ke=ye.fullyVisible;const ze={x:xe,y:pe,z:ye.zoom},je=S.getTileBoundingVolume(ze,ye.wrap,v.elevation,i);if(!ke){const lt=Ae(u,je,p);if(lt===0)continue;ke=lt===2}const De=S.distanceToTile2d(g.x,g.y,ze,je);let $e=M;C&&($e=(i.calculateTileZoom||Ze)(v.zoom+s.ak(v.tileSize/i.tileSize),De,oe,le,v.fov)),$e=(i.roundZoom?Math.round:Math.floor)($e),$e=Math.max(0,$e);const at=Math.min($e,$);if(ye.wrap=S.getWrap(_,ze,ye.wrap),ye.zoom>=at){if(ye.zoom<R)continue;const lt=G-ye.zoom,Ye=X[0]-.5-(xe<<lt),xt=X[1]-.5-(pe<<lt),qt=i.reparseOverscaled?Math.max(ye.zoom,$e):ye.zoom;de.push({tileID:new s.Z(ye.zoom===$?qt:ye.zoom,ye.wrap,ye.zoom,xe,pe),distanceSq:s.al([Q[0]-.5-xe,Q[1]-.5-pe]),tileDistanceToCamera:Math.sqrt(Ye*Ye+xt*xt)})}else for(let lt=0;lt<4;lt++)me.push({zoom:ye.zoom+1,x:(xe<<1)+lt%2,y:(pe<<1)+(lt>>1),wrap:ye.wrap,fullyVisible:ke})}return de.sort((ye,xe)=>ye.distanceSq-xe.distanceSq).map(ye=>ye.tileID)}const $t=s.a2.fromPoints([new s.P(0,0),new s.P(s.$,s.$)]);class Ht extends s.E{constructor(i,u,p){super(),this.id=i,this.dispatcher=p,this.on("data",g=>this._dataHandler(g)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((g,_,S,C)=>{const M=new(Wi(_.type))(g,_,S,C);if(M.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${M.id}`);return M})(i,u,p,this),this._tiles={},this._cache=new Te(0,g=>this._unloadTile(g)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ee,this._didEmitContent=!1,this._updated=!1}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._maxTileCacheZoomLevels=i?i._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const i in this._tiles){const u=this._tiles[i];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,u,p){return s._(this,void 0,void 0,function*(){try{yield this._source.loadTile(i),this._tileLoaded(i,u,p)}catch(g){i.state="errored",g.status!==404?this._source.fire(new s.k(g,{tile:i})):this.update(this.transform,this.terrain)}})}_unloadTile(i){this._source.unloadTile&&this._source.unloadTile(i)}_abortTile(i){this._source.abortTile&&this._source.abortTile(i),this._source.fire(new s.l("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const p=this._tiles[u];p.upload(i),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(i=>i.tileID).sort(At).map(i=>i.key)}getRenderableIds(i){const u=[];for(const p in this._tiles)this._isIdRenderable(p,i)&&u.push(this._tiles[p]);return i?u.sort((p,g)=>{const _=p.tileID,S=g.tileID,C=new s.P(_.canonical.x,_.canonical.y)._rotate(-this.transform.bearingInRadians),M=new s.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return _.overscaledZ-S.overscaledZ||M.y-C.y||M.x-C.x}).map(p=>p.tileID.key):u.map(p=>p.tileID).sort(At).map(p=>p.key)}hasRenderableParent(i){const u=this.findLoadedParent(i,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(i,u){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(u||!this._tiles[i].holdingForFade())}reload(i){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)i?this._reloadTile(u,"expired"):this._tiles[u].state!=="errored"&&this._reloadTile(u,"reloading")}}_reloadTile(i,u){return s._(this,void 0,void 0,function*(){const p=this._tiles[i];p&&(p.state!=="loading"&&(p.state=u),yield this._loadTile(p,i,u))})}_tileLoaded(i,u,p){i.timeAdded=I.now(),p==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(u,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new s.l("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const u=this.getRenderableIds();for(let g=0;g<u.length;g++){const _=u[g];if(i.neighboringTiles&&i.neighboringTiles[_]){const S=this.getTileByID(_);p(i,S),p(S,i)}}function p(g,_){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let S=_.tileID.canonical.x-g.tileID.canonical.x;const C=_.tileID.canonical.y-g.tileID.canonical.y,M=Math.pow(2,g.tileID.canonical.z),R=_.tileID.key;S===0&&C===0||Math.abs(C)>1||(Math.abs(S)>1&&(Math.abs(S+M)===1?S+=M:Math.abs(S-M)===1&&(S-=M)),_.dem&&g.dem&&(g.dem.backfillBorder(_.dem,S,C),g.neighboringTiles&&g.neighboringTiles[R]&&(g.neighboringTiles[R].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,u,p,g){for(const _ in this._tiles){let S=this._tiles[_];if(g[_]||!S.hasData()||S.tileID.overscaledZ<=u||S.tileID.overscaledZ>p)continue;let C=S.tileID;for(;S&&S.tileID.overscaledZ>u+1;){const R=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[R.key],S&&S.hasData()&&(C=R)}let M=C;for(;M.overscaledZ>u;)if(M=M.scaledTo(M.overscaledZ-1),i[M.key]||i[M.canonical.key]){g[C.key]=C;break}}}findLoadedParent(i,u){if(i.key in this._loadedParentTiles){const p=this._loadedParentTiles[i.key];return p&&p.tileID.overscaledZ>=u?p:null}for(let p=i.overscaledZ-1;p>=u;p--){const g=i.scaledTo(p),_=this._getLoadedTile(g);if(_)return _}}findLoadedSibling(i){return this._getLoadedTile(i)}_getLoadedTile(i){const u=this._tiles[i.key];return u&&u.hasData()?u:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){const u=Math.ceil(i.width/this._source.tileSize)+1,p=Math.ceil(i.height/this._source.tileSize)+1,g=Math.floor(u*p*(this._maxTileCacheZoomLevels===null?s.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(_)}handleWrapJump(i){const u=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,u){const p={};for(const g in this._tiles){const _=this._tiles[g];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+u),p[_.tileID.key]=_}this._tiles=p;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}}_updateCoveredAndRetainedTiles(i,u,p,g,_,S){const C={},M={},R=Object.keys(i),$=I.now();for(const G of R){const V=i[G],X=this._tiles[G];if(!X||X.fadeEndTime!==0&&X.fadeEndTime<=$)continue;const Q=this.findLoadedParent(V,u),se=this.findLoadedSibling(V),oe=Q||se||null;oe&&(this._addTile(oe.tileID),C[oe.tileID.key]=oe.tileID),M[G]=V}this._retainLoadedChildren(M,g,p,i);for(const G in C)i[G]||(this._coveredTiles[G]=!0,i[G]=C[G]);if(S){const G={},V={};for(const X of _)this._tiles[X.key].hasData()?G[X.key]=X:V[X.key]=X;for(const X in V){const Q=V[X].children(this._source.maxzoom);this._tiles[Q[0].key]&&this._tiles[Q[1].key]&&this._tiles[Q[2].key]&&this._tiles[Q[3].key]&&(G[Q[0].key]=i[Q[0].key]=Q[0],G[Q[1].key]=i[Q[1].key]=Q[1],G[Q[2].key]=i[Q[2].key]=Q[2],G[Q[3].key]=i[Q[3].key]=Q[3],delete V[X])}for(const X in V){const Q=V[X],se=this.findLoadedParent(Q,this._source.minzoom),oe=this.findLoadedSibling(Q),le=se||oe||null;if(le){G[le.tileID.key]=i[le.tileID.key]=le.tileID;for(const ue in G)G[ue].isChildOf(le.tileID)&&delete G[ue]}}for(const X in this._tiles)G[X]||(this._coveredTiles[X]=!0)}}update(i,u){if(!this._sourceLoaded||this._paused)return;let p;this.transform=i,this.terrain=u,this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=i.getVisibleUnwrappedCoordinates(this._source.tileID).map($=>new s.Z($.canonical.z,$.wrap,$.canonical.z,$.canonical.x,$.canonical.y)):(p=Ce(i,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(p=p.filter($=>this._source.hasTile($)))):p=[];const g=wt(i,this._source),_=Math.max(g-Ht.maxOverzooming,this._source.minzoom),S=Math.max(g+Ht.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const $={};for(const G of p)if(G.canonical.z>this._source.minzoom){const V=G.scaledTo(G.canonical.z-1);$[V.key]=V;const X=G.scaledTo(Math.max(this._source.minzoom,Math.min(G.canonical.z,5)));$[X.key]=X}p=p.concat(Object.values($))}const C=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new s.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=this._updateRetainedTiles(p,g);Ft(this._source.type)&&this._updateCoveredAndRetainedTiles(M,_,S,g,p,u);for(const $ in M)this._tiles[$].clearFadeHold();const R=s.am(this._tiles,M);for(const $ of R){const G=this._tiles[$];G.hasSymbolBuckets&&!G.holdingForFade()?G.setHoldDuration(this.map._fadeDuration):G.hasSymbolBuckets&&!G.symbolFadeFinished()||this._removeTile($)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,u){var p;const g={},_={},S=Math.max(u-Ht.maxOverzooming,this._source.minzoom),C=Math.max(u+Ht.maxUnderzooming,this._source.minzoom),M={};for(const R of i){const $=this._addTile(R);g[R.key]=R,$.hasData()||u<this._source.maxzoom&&(M[R.key]=R)}this._retainLoadedChildren(M,u,C,g);for(const R of i){let $=this._tiles[R.key];if($.hasData())continue;if(u+1>this._source.maxzoom){const V=R.children(this._source.maxzoom)[0],X=this.getTile(V);if(X&&X.hasData()){g[V.key]=V;continue}}else{const V=R.children(this._source.maxzoom);if(g[V[0].key]&&g[V[1].key]&&g[V[2].key]&&g[V[3].key])continue}let G=$.wasRequested();for(let V=R.overscaledZ-1;V>=S;--V){const X=R.scaledTo(V);if(_[X.key])break;if(_[X.key]=!0,$=this.getTile(X),!$&&G&&($=this._addTile(X)),$){const Q=$.hasData();if((Q||!(!((p=this.map)===null||p===void 0)&&p.cancelPendingTileRequestsWhileZooming)||G)&&(g[X.key]=X),G=$.wasRequested(),Q)break}}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const u=[];let p,g=this._tiles[i].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){p=this._loadedParentTiles[g.key];break}u.push(g.key);const _=g.scaledTo(g.overscaledZ-1);if(p=this._getLoadedTile(_),p)break;g=_}for(const _ of u)this._loadedParentTiles[_]=p}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const i in this._tiles){const u=this._tiles[i].tileID,p=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=p}}_addTile(i){let u=this._tiles[i.key];if(u)return u;u=this._cache.getAndRemove(i),u&&(this._setTileReloadTimer(i.key,u),u.tileID=i,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,u)));const p=u;return u||(u=new Js(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(u,i.key,u.state)),u.uses++,this._tiles[i.key]=u,p||this._source.fire(new s.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(i,u){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const p=u.getExpiryTimeout();p&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},p))}refreshTiles(i){for(const u in this._tiles)(this._isIdRenderable(u)||this._tiles[u].state=="errored")&&i.some(p=>p.equals(this._tiles[u].tileID.canonical))&&this._reloadTile(u,"expired")}_removeTile(i){const u=this._tiles[i];u&&(u.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(i){const u=i.sourceDataType;i.dataType==="source"&&u==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&i.dataType==="source"&&u==="content"&&(this.reload(i.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,u,p){const g=[],_=this.transform;if(!_)return g;const S=_.getCoveringTilesDetailsProvider().allowWorldCopies(),C=p?_.getCameraQueryGeometry(i):i,M=X=>_.screenPointToMercatorCoordinate(X,this.terrain),R=this.transformBbox(i,M,!S),$=this.transformBbox(C,M,!S),G=this.getIds(),V=s.a2.fromPoints($);for(let X=0;X<G.length;X++){const Q=this._tiles[G[X]];if(Q.holdingForFade())continue;const se=S?[Q.tileID]:[Q.tileID.unwrapTo(-1),Q.tileID.unwrapTo(0)],oe=Math.pow(2,_.zoom-Q.tileID.overscaledZ),le=u*Q.queryPadding*s.$/Q.tileSize/oe;for(const ue of se){const me=V.map(de=>ue.getTilePoint(new s.a1(de.x,de.y)));if(me.expandBy(le),me.intersects($t)){const de=R.map(xe=>ue.getTilePoint(xe)),ye=$.map(xe=>ue.getTilePoint(xe));g.push({tile:Q,tileID:S?ue:ue.unwrapTo(0),queryGeometry:de,cameraQueryGeometry:ye,scale:oe})}}}return g}transformBbox(i,u,p){let g=i.map(u);if(p){const _=s.a2.fromPoints(i);_.shrinkBy(.001*Math.min(_.width(),_.height()));const S=_.map(u);s.a2.fromPoints(g).covers(S)||(g=g.map(C=>C.x>.5?new s.a1(C.x-1,C.y,C.z):C))}return g}getVisibleCoordinates(i){const u=this.getRenderableIds(i).map(p=>this._tiles[p].tileID);return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if(Ft(this._source.type)){const i=I.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=i)return!0}return!1}setFeatureState(i,u,p){this._state.updateState(i=i||"_geojsonTileLayer",u,p)}removeFeatureState(i,u,p){this._state.removeFeatureState(i=i||"_geojsonTileLayer",u,p)}getFeatureState(i,u){return this._state.getState(i=i||"_geojsonTileLayer",u)}setDependencies(i,u,p){const g=this._tiles[i];g&&g.setDependencies(u,p)}reloadTilesForDependencies(i,u){for(const p in this._tiles)this._tiles[p].hasDependency(i,u)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(i,u))}}function At(v,i){const u=Math.abs(2*v.wrap)-+(v.wrap<0),p=Math.abs(2*i.wrap)-+(i.wrap<0);return v.overscaledZ-i.overscaledZ||p-u||i.canonical.y-v.canonical.y||i.canonical.x-v.canonical.x}function Ft(v){return v==="raster"||v==="image"||v==="video"}Ht.maxOverzooming=10,Ht.maxUnderzooming=3;class Ar{constructor(i,u){this.reset(i,u)}reset(i,u){this.points=i||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=s.ah(i,0,1);let u=1,p=this._distances[u];const g=i*this.paddedLength+this.padding;for(;p<g&&u<this._distances.length;)p=this._distances[++u];const _=u-1,S=this._distances[_],C=p-S,M=C>0?(g-S)/C:0;return this.points[_].mult(1-M).add(this.points[u].mult(M))}}function vn(v,i){let u=!0;return v==="always"||v!=="never"&&i!=="never"||(u=!1),u}class _n{constructor(i,u,p){const g=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(i/p),this.yCellCount=Math.ceil(u/p);for(let S=0;S<this.xCellCount*this.yCellCount;S++)g.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=u,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,u,p,g,_){this._forEachCell(u,p,g,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(g),this.bboxes.push(_)}insertCircle(i,u,p,g){this._forEachCell(u-g,p-g,u+g,p+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(u),this.circles.push(p),this.circles.push(g)}_insertBoxCell(i,u,p,g,_,S){this.boxCells[_].push(S)}_insertCircleCell(i,u,p,g,_,S){this.circleCells[_].push(S)}_query(i,u,p,g,_,S,C){if(p<0||i>this.width||g<0||u>this.height)return[];const M=[];if(i<=0&&u<=0&&this.width<=p&&this.height<=g){if(_)return[{key:null,x1:i,y1:u,x2:p,y2:g}];for(let R=0;R<this.boxKeys.length;R++)M.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const $=this.circles[3*R],G=this.circles[3*R+1],V=this.circles[3*R+2];M.push({key:this.circleKeys[R],x1:$-V,y1:G-V,x2:$+V,y2:G+V})}}else this._forEachCell(i,u,p,g,this._queryCell,M,{hitTest:_,overlapMode:S,seenUids:{box:{},circle:{}}},C);return M}query(i,u,p,g){return this._query(i,u,p,g,!1,null)}hitTest(i,u,p,g,_,S){return this._query(i,u,p,g,!0,_,S).length>0}hitTestCircle(i,u,p,g,_){const S=i-p,C=i+p,M=u-p,R=u+p;if(C<0||S>this.width||R<0||M>this.height)return!1;const $=[];return this._forEachCell(S,M,C,R,this._queryCellCircle,$,{hitTest:!0,overlapMode:g,circle:{x:i,y:u,radius:p},seenUids:{box:{},circle:{}}},_),$.length>0}_queryCell(i,u,p,g,_,S,C,M){const{seenUids:R,hitTest:$,overlapMode:G}=C,V=this.boxCells[_];if(V!==null){const Q=this.bboxes;for(const se of V)if(!R.box[se]){R.box[se]=!0;const oe=4*se,le=this.boxKeys[se];if(i<=Q[oe+2]&&u<=Q[oe+3]&&p>=Q[oe+0]&&g>=Q[oe+1]&&(!M||M(le))&&(!$||!vn(G,le.overlapMode))&&(S.push({key:le,x1:Q[oe],y1:Q[oe+1],x2:Q[oe+2],y2:Q[oe+3]}),$))return!0}}const X=this.circleCells[_];if(X!==null){const Q=this.circles;for(const se of X)if(!R.circle[se]){R.circle[se]=!0;const oe=3*se,le=this.circleKeys[se];if(this._circleAndRectCollide(Q[oe],Q[oe+1],Q[oe+2],i,u,p,g)&&(!M||M(le))&&(!$||!vn(G,le.overlapMode))){const ue=Q[oe],me=Q[oe+1],de=Q[oe+2];if(S.push({key:le,x1:ue-de,y1:me-de,x2:ue+de,y2:me+de}),$)return!0}}}return!1}_queryCellCircle(i,u,p,g,_,S,C,M){const{circle:R,seenUids:$,overlapMode:G}=C,V=this.boxCells[_];if(V!==null){const Q=this.bboxes;for(const se of V)if(!$.box[se]){$.box[se]=!0;const oe=4*se,le=this.boxKeys[se];if(this._circleAndRectCollide(R.x,R.y,R.radius,Q[oe+0],Q[oe+1],Q[oe+2],Q[oe+3])&&(!M||M(le))&&!vn(G,le.overlapMode))return S.push(!0),!0}}const X=this.circleCells[_];if(X!==null){const Q=this.circles;for(const se of X)if(!$.circle[se]){$.circle[se]=!0;const oe=3*se,le=this.circleKeys[se];if(this._circlesCollide(Q[oe],Q[oe+1],Q[oe+2],R.x,R.y,R.radius)&&(!M||M(le))&&!vn(G,le.overlapMode))return S.push(!0),!0}}}_forEachCell(i,u,p,g,_,S,C,M){const R=this._convertToXCellCoord(i),$=this._convertToYCellCoord(u),G=this._convertToXCellCoord(p),V=this._convertToYCellCoord(g);for(let X=R;X<=G;X++)for(let Q=$;Q<=V;Q++)if(_.call(this,i,u,p,g,this.xCellCount*Q+X,S,C,M))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,u,p,g,_,S){const C=g-i,M=_-u,R=p+S;return R*R>C*C+M*M}_circleAndRectCollide(i,u,p,g,_,S,C){const M=(S-g)/2,R=Math.abs(i-(g+M));if(R>M+p)return!1;const $=(C-_)/2,G=Math.abs(u-(_+$));if(G>$+p)return!1;if(R<=M||G<=$)return!0;const V=R-M,X=G-$;return V*V+X*X<=p*p}}function nn(v,i,u){const p=s.L();if(!v){const{vecSouth:G,vecEast:V}=nr(i),X=w();X[0]=V[0],X[1]=V[1],X[2]=G[0],X[3]=G[1],g=X,($=(S=(_=X)[0])*(R=_[3])-(M=_[2])*(C=_[1]))&&(g[0]=R*($=1/$),g[1]=-C*$,g[2]=-M*$,g[3]=S*$),p[0]=X[0],p[1]=X[1],p[4]=X[2],p[5]=X[3]}var g,_,S,C,M,R,$;return s.N(p,p,[1/u,1/u,1]),p}function Yt(v,i,u,p){if(v){const g=s.L();if(!i){const{vecSouth:_,vecEast:S}=nr(u);g[0]=S[0],g[1]=S[1],g[4]=_[0],g[5]=_[1]}return s.N(g,g,[p,p,1]),g}return u.pixelsToClipSpaceMatrix}function nr(v){const i=Math.cos(v.rollInRadians),u=Math.sin(v.rollInRadians),p=Math.cos(v.pitchInRadians),g=Math.cos(v.bearingInRadians),_=Math.sin(v.bearingInRadians),S=s.ar();S[0]=-g*p*u-_*i,S[1]=-_*p*u+g*i;const C=s.as(S);C<1e-9?s.at(S):s.au(S,S,1/C);const M=s.ar();M[0]=g*p*i-_*u,M[1]=_*p*i+g*u;const R=s.as(M);return R<1e-9?s.at(M):s.au(M,M,1/R),{vecEast:M,vecSouth:S}}function cn(v,i,u,p){let g;p?(g=[v,i,p(v,i),1],s.aw(g,g,u)):(g=[v,i,0,1],el(g,g,u));const _=g[3];return{point:new s.P(g[0]/_,g[1]/_),signedDistanceFromCamera:_,isOccluded:!1}}function ot(v,i){return .5+v/i*.5}function Jn(v,i){return v.x>=-i[0]&&v.x<=i[0]&&v.y>=-i[1]&&v.y<=i[1]}function Ur(v,i,u,p,g,_,S,C,M,R,$,G,V){const X=u?v.textSizeData:v.iconSizeData,Q=s.an(X,i.transform.zoom),se=[256/i.width*2+1,256/i.height*2+1],oe=u?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;oe.clear();const le=v.lineVertexArray,ue=u?v.text.placedSymbolArray:v.icon.placedSymbolArray,me=i.transform.width/i.transform.height;let de=!1;for(let ye=0;ye<ue.length;ye++){const xe=ue.get(ye);if(xe.hidden||xe.writingMode===s.ao.vertical&&!de){ja(xe.numGlyphs,oe);continue}de=!1;const pe=new s.P(xe.anchorX,xe.anchorY),ke={getElevation:V,pitchedLabelPlaneMatrix:p,lineVertexArray:le,pitchWithMap:_,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:i.transform,tileAnchorPoint:pe,unwrappedTileID:M,width:R,height:$,translation:G},ze=Mo(xe.anchorX,xe.anchorY,ke);if(!Jn(ze.point,se)){ja(xe.numGlyphs,oe);continue}const je=ot(i.transform.cameraToCenterDistance,ze.signedDistanceFromCamera),De=s.ap(X,Q,xe),$e=_?De*i.transform.getPitchedTextCorrection(xe.anchorX,xe.anchorY,M)/je:De*je,at=mt({projectionContext:ke,pitchedLabelPlaneMatrixInverse:g,symbol:xe,fontSize:$e,flip:!1,keepUpright:S,glyphOffsetArray:v.glyphOffsetArray,dynamicLayoutVertexArray:oe,aspectRatio:me,rotateToLine:C});de=at.useVertical,(at.notEnoughRoom||de||at.needsFlipping&&mt({projectionContext:ke,pitchedLabelPlaneMatrixInverse:g,symbol:xe,fontSize:$e,flip:!0,keepUpright:S,glyphOffsetArray:v.glyphOffsetArray,dynamicLayoutVertexArray:oe,aspectRatio:me,rotateToLine:C}).notEnoughRoom)&&ja(xe.numGlyphs,oe)}u?v.text.dynamicLayoutVertexBuffer.updateData(oe):v.icon.dynamicLayoutVertexBuffer.updateData(oe)}function Co(v,i,u,p,g,_,S,C){const M=_.glyphStartIndex+_.numGlyphs,R=_.lineStartIndex,$=_.lineStartIndex+_.lineLength,G=i.getoffsetX(_.glyphStartIndex),V=i.getoffsetX(M-1),X=Io(v*G,u,p,g,_.segment,R,$,C,S);if(!X)return null;const Q=Io(v*V,u,p,g,_.segment,R,$,C,S);return Q?C.projectionCache.anyProjectionOccluded?null:{first:X,last:Q}:null}function Qs(v,i,u,p){return v===s.ao.horizontal&&Math.abs(u.y-i.y)>Math.abs(u.x-i.x)*p?{useVertical:!0}:(v===s.ao.vertical?i.y<u.y:i.x>u.x)?{needsFlipping:!0}:null}function mt(v){const{projectionContext:i,pitchedLabelPlaneMatrixInverse:u,symbol:p,fontSize:g,flip:_,keepUpright:S,glyphOffsetArray:C,dynamicLayoutVertexArray:M,aspectRatio:R,rotateToLine:$}=v,G=g/24,V=p.lineOffsetX*G,X=p.lineOffsetY*G;let Q;if(p.numGlyphs>1){const se=p.glyphStartIndex+p.numGlyphs,oe=p.lineStartIndex,le=p.lineStartIndex+p.lineLength,ue=Co(G,C,V,X,_,p,$,i);if(!ue)return{notEnoughRoom:!0};const me=rs(ue.first.point.x,ue.first.point.y,i,u),de=rs(ue.last.point.x,ue.last.point.y,i,u);if(S&&!_){const ye=Qs(p.writingMode,me,de,R);if(ye)return ye}Q=[ue.first];for(let ye=p.glyphStartIndex+1;ye<se-1;ye++){const xe=Io(G*C.getoffsetX(ye),V,X,_,p.segment,oe,le,i,$);if(!xe)return{notEnoughRoom:!0};Q.push(xe)}Q.push(ue.last)}else{if(S&&!_){const oe=$n(i.tileAnchorPoint.x,i.tileAnchorPoint.y,i).point,le=p.lineStartIndex+p.segment+1,ue=new s.P(i.lineVertexArray.getx(le),i.lineVertexArray.gety(le)),me=$n(ue.x,ue.y,i),de=me.signedDistanceFromCamera>0?me.point:Zt(i.tileAnchorPoint,ue,oe,1,i),ye=rs(oe.x,oe.y,i,u),xe=rs(de.x,de.y,i,u),pe=Qs(p.writingMode,ye,xe,R);if(pe)return pe}const se=Io(G*C.getoffsetX(p.glyphStartIndex),V,X,_,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,i,$);if(!se||i.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Q=[se]}for(const se of Q)s.av(M,se.point,se.angle);return{}}function Zt(v,i,u,p,g){const _=v.add(v.sub(i)._unit()),S=$n(_.x,_.y,g).point,C=u.sub(S);return u.add(C._mult(p/C.mag()))}function Wt(v,i,u){const p=i.projectionCache;if(p.projections[v])return p.projections[v];const g=new s.P(i.lineVertexArray.getx(v),i.lineVertexArray.gety(v)),_=$n(g.x,g.y,i);if(_.signedDistanceFromCamera>0)return p.projections[v]=_.point,p.anyProjectionOccluded=p.anyProjectionOccluded||_.isOccluded,_.point;const S=v-u.direction;return Zt(u.distanceFromAnchor===0?i.tileAnchorPoint:new s.P(i.lineVertexArray.getx(S),i.lineVertexArray.gety(S)),g,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,i)}function $n(v,i,u){const p=v+u.translation[0],g=i+u.translation[1];let _;return u.pitchWithMap?(_=cn(p,g,u.pitchedLabelPlaneMatrix,u.getElevation),_.isOccluded=!1):(_=u.transform.projectTileCoordinates(p,g,u.unwrappedTileID,u.getElevation),_.point.x=(.5*_.point.x+.5)*u.width,_.point.y=(.5*-_.point.y+.5)*u.height),_}function rs(v,i,u,p){if(u.pitchWithMap){const g=[v,i,0,1];return s.aw(g,g,p),u.transform.projectTileCoordinates(g[0]/g[3],g[1]/g[3],u.unwrappedTileID,u.getElevation).point}return{x:v/u.width*2-1,y:1-i/u.height*2}}function Mo(v,i,u){return u.transform.projectTileCoordinates(v,i,u.unwrappedTileID,u.getElevation)}function Gt(v,i,u){return v._unit()._perp()._mult(i*u)}function Cu(v,i,u,p,g,_,S,C,M){if(C.projectionCache.offsets[v])return C.projectionCache.offsets[v];const R=u.add(i);if(v+M.direction<p||v+M.direction>=g)return C.projectionCache.offsets[v]=R,R;const $=Wt(v+M.direction,C,M),G=Gt($.sub(u),S,M.direction),V=u.add(G),X=$.add(G);return C.projectionCache.offsets[v]=s.ax(_,R,V,X)||R,C.projectionCache.offsets[v]}function Io(v,i,u,p,g,_,S,C,M){const R=p?v-i:v+i;let $=R>0?1:-1,G=0;p&&($*=-1,G=Math.PI),$<0&&(G+=Math.PI);let V,X=$>0?_+g:_+g+1;C.projectionCache.cachedAnchorPoint?V=C.projectionCache.cachedAnchorPoint:(V=$n(C.tileAnchorPoint.x,C.tileAnchorPoint.y,C).point,C.projectionCache.cachedAnchorPoint=V);let Q,se,oe=V,le=V,ue=0,me=0;const de=Math.abs(R),ye=[];let xe;for(;ue+me<=de;){if(X+=$,X<_||X>=S)return null;ue+=me,le=oe,se=Q;const ze={absOffsetX:de,direction:$,distanceFromAnchor:ue,previousVertex:le};if(oe=Wt(X,C,ze),u===0)ye.push(le),xe=oe.sub(le);else{let je;const De=oe.sub(le);je=De.mag()===0?Gt(Wt(X+$,C,ze).sub(oe),u,$):Gt(De,u,$),se||(se=le.add(je)),Q=Cu(X,je,oe,_,S,se,u,C,ze),ye.push(se),xe=Q.sub(se)}me=xe.mag()}const pe=xe._mult((de-ue)/me)._add(se||le),ke=G+Math.atan2(oe.y-le.y,oe.x-le.x);return ye.push(pe),{point:pe,angle:M?ke:0,path:ye}}const Mu=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ja(v,i){for(let u=0;u<v;u++){const p=i.length;i.resize(p+4),i.float32.set(Mu,3*p)}}function el(v,i,u){const p=i[0],g=i[1];return v[0]=u[0]*p+u[4]*g+u[12],v[1]=u[1]*p+u[5]*g+u[13],v[3]=u[3]*p+u[7]*g+u[15],v}const Jr=100;class Iu{constructor(i,u=new _n(i.width+200,i.height+200,25),p=new _n(i.width+200,i.height+200,25)){this.transform=i,this.grid=u,this.ignoredGrid=p,this.pitchFactor=Math.cos(i.pitch*Math.PI/180)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+Jr,this.screenBottomBoundary=i.height+Jr,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,u,p,g,_,S,C,M,R,$,G,V){const X=this.projectAndGetPerspectiveRatio(i.anchorPointX+M[0],i.anchorPointY+M[1],_,$,V),Q=p*X.perspectiveRatio;let se;if(S||C)se=this._projectCollisionBox(i,Q,g,_,S,C,M,X,$,G,V);else{const xe=X.x+(G?G.x*Q:0),pe=X.y+(G?G.y*Q:0);se={allPointsOccluded:!1,box:[xe+i.x1*Q,pe+i.y1*Q,xe+i.x2*Q,pe+i.y2*Q]}}const[oe,le,ue,me]=se.box,de=S?se.allPointsOccluded:X.isOccluded;let ye=de;return ye||(ye=X.perspectiveRatio<this.perspectiveRatioCutoff),ye||(ye=!this.isInsideGrid(oe,le,ue,me)),ye||u!=="always"&&this.grid.hitTest(oe,le,ue,me,u,R)?{box:[oe,le,ue,me],placeable:!1,offscreen:!1,occluded:de}:{box:[oe,le,ue,me],placeable:!0,offscreen:this.isOffscreen(oe,le,ue,me),occluded:de}}placeCollisionCircles(i,u,p,g,_,S,C,M,R,$,G,V,X,Q){const se=[],oe=new s.P(u.anchorX,u.anchorY),le=this.getPerspectiveRatio(oe.x,oe.y,S,Q),ue=(R?_*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,S)/le:_*le)/s.aB,me={getElevation:Q,pitchedLabelPlaneMatrix:C,lineVertexArray:p,pitchWithMap:R,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:oe,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:X},de=Co(ue,g,u.lineOffsetX*ue,u.lineOffsetY*ue,!1,u,!1,me);let ye=!1,xe=!1,pe=!0;if(de){const ke=.5*G*le+V,ze=new s.P(-100,-100),je=new s.P(this.screenRightBoundary,this.screenBottomBoundary),De=new Ar,$e=de.first,at=de.last;let lt=[];for(let qt=$e.path.length-1;qt>=1;qt--)lt.push($e.path[qt]);for(let qt=1;qt<at.path.length;qt++)lt.push(at.path[qt]);const Ye=2.5*ke;if(R){const qt=this.projectPathToScreenSpace(lt,me);lt=qt.some(hr=>hr.signedDistanceFromCamera<=0)?[]:qt.map(hr=>hr.point)}let xt=[];if(lt.length>0){const qt=lt[0].clone(),hr=lt[0].clone();for(let _r=1;_r<lt.length;_r++)qt.x=Math.min(qt.x,lt[_r].x),qt.y=Math.min(qt.y,lt[_r].y),hr.x=Math.max(hr.x,lt[_r].x),hr.y=Math.max(hr.y,lt[_r].y);xt=qt.x>=ze.x&&hr.x<=je.x&&qt.y>=ze.y&&hr.y<=je.y?[lt]:hr.x<ze.x||qt.x>je.x||hr.y<ze.y||qt.y>je.y?[]:s.ay([lt],ze.x,ze.y,je.x,je.y)}for(const qt of xt){De.reset(qt,.25*ke);let hr=0;hr=De.length<=.5*ke?1:Math.ceil(De.paddedLength/Ye)+1;for(let _r=0;_r<hr;_r++){const gr=_r/Math.max(hr-1,1),$r=De.lerp(gr),Gr=$r.x+Jr,Ut=$r.y+Jr;se.push(Gr,Ut,ke,0);const xr=Gr-ke,hn=Ut-ke,xn=Gr+ke,En=Ut+ke;if(pe=pe&&this.isOffscreen(xr,hn,xn,En),xe=xe||this.isInsideGrid(xr,hn,xn,En),i!=="always"&&this.grid.hitTestCircle(Gr,Ut,ke,i,$)&&(ye=!0,!M))return{circles:[],offscreen:!1,collisionDetected:ye}}}}return{circles:!M&&ye||!xe||le<this.perspectiveRatioCutoff?[]:se,offscreen:pe,collisionDetected:ye}}projectPathToScreenSpace(i,u){const p=function(g,_){const S=s.L();return s.aq(S,_.pitchedLabelPlaneMatrix),g.map(C=>{const M=cn(C.x,C.y,S,_.getElevation),R=_.transform.projectTileCoordinates(M.point.x,M.point.y,_.unwrappedTileID,_.getElevation);return R.point.x=(.5*R.point.x+.5)*_.width,R.point.y=(.5*-R.point.y+.5)*_.height,R})}(i,u);return function(g){let _=0,S=0,C=0,M=0;for(let R=0;R<g.length;R++)g[R].isOccluded?(C=R+1,M=0):(M++,M>S&&(S=M,_=C));return g.slice(_,_+S)}(p)}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],p=new s.a2;for(const G of i){const V=new s.P(G.x+Jr,G.y+Jr);p.extend(V),u.push(V)}const{minX:g,minY:_,maxX:S,maxY:C}=p,M=this.grid.query(g,_,S,C).concat(this.ignoredGrid.query(g,_,S,C)),R={},$={};for(const G of M){const V=G.key;if(R[V.bucketInstanceId]===void 0&&(R[V.bucketInstanceId]={}),R[V.bucketInstanceId][V.featureIndex])continue;const X=[new s.P(G.x1,G.y1),new s.P(G.x2,G.y1),new s.P(G.x2,G.y2),new s.P(G.x1,G.y2)];s.az(u,X)&&(R[V.bucketInstanceId][V.featureIndex]=!0,$[V.bucketInstanceId]===void 0&&($[V.bucketInstanceId]=[]),$[V.bucketInstanceId].push(V.featureIndex))}return $}insertCollisionBox(i,u,p,g,_,S){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:_,collisionGroupID:S,overlapMode:u},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,u,p,g,_,S){const C=p?this.ignoredGrid:this.grid,M={bucketInstanceId:g,featureIndex:_,collisionGroupID:S,overlapMode:u};for(let R=0;R<i.length;R+=4)C.insertCircle(M,i[R],i[R+1],i[R+2])}projectAndGetPerspectiveRatio(i,u,p,g,_){if(_){let S;g?(S=[i,u,g(i,u),1],s.aw(S,S,_)):(S=[i,u,0,1],el(S,S,_));const C=S[3];return{x:(S[0]/C+1)/2*this.transform.width+Jr,y:(-S[1]/C+1)/2*this.transform.height+Jr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/C*.5,isOccluded:!1,signedDistanceFromCamera:C}}{const S=this.transform.projectTileCoordinates(i,u,p,g);return{x:(S.point.x+1)/2*this.transform.width+Jr,y:(1-S.point.y)/2*this.transform.height+Jr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(i,u,p,g){const _=this.transform.projectTileCoordinates(i,u,p,g);return .5+this.transform.cameraToCenterDistance/_.signedDistanceFromCamera*.5}isOffscreen(i,u,p,g){return p<Jr||i>=this.screenRightBoundary||g<Jr||u>this.screenBottomBoundary}isInsideGrid(i,u,p,g){return p>=0&&i<this.gridRightBoundary&&g>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const i=s.ag([]);return s.M(i,i,[-100,-100,0]),i}_projectCollisionBox(i,u,p,g,_,S,C,M,R,$,G){let V=1,X=0,Q=0,se=1;const oe=i.anchorPointX+C[0],le=i.anchorPointY+C[1];if(S&&!_){const lt=this.projectAndGetPerspectiveRatio(oe+1,le,g,R,G),Ye=lt.x-M.x,xt=Math.atan((lt.y-M.y)/Ye)+(Ye<0?Math.PI:0),qt=Math.sin(xt),hr=Math.cos(xt);V=hr,X=qt,Q=-qt,se=hr}else if(!S&&_){const lt=nr(this.transform);V=lt.vecEast[0],X=lt.vecEast[1],Q=lt.vecSouth[0],se=lt.vecSouth[1]}let ue=M.x,me=M.y,de=u;_&&(ue=oe,me=le,de=Math.pow(2,-(this.transform.zoom-p.overscaledZ)),de*=this.transform.getPitchedTextCorrection(oe,le,g),$||(de*=s.ah(.5+M.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),$&&(ue+=V*$.x*de+Q*$.y*de,me+=X*$.x*de+se*$.y*de);const ye=i.x1*de,xe=i.x2*de,pe=(ye+xe)/2,ke=i.y1*de,ze=i.y2*de,je=(ke+ze)/2,De=[{offsetX:ye,offsetY:ke},{offsetX:pe,offsetY:ke},{offsetX:xe,offsetY:ke},{offsetX:xe,offsetY:je},{offsetX:xe,offsetY:ze},{offsetX:pe,offsetY:ze},{offsetX:ye,offsetY:ze},{offsetX:ye,offsetY:je}];let $e=[];for(const{offsetX:lt,offsetY:Ye}of De)$e.push(new s.P(ue+V*lt+Q*Ye,me+X*lt+se*Ye));let at=!1;if(_){const lt=$e.map(Ye=>this.projectAndGetPerspectiveRatio(Ye.x,Ye.y,g,R,G));at=lt.some(Ye=>!Ye.isOccluded),$e=lt.map(Ye=>new s.P(Ye.x,Ye.y))}else at=!0;return{box:s.aA($e),allPointsOccluded:!at}}}class bi{constructor(i,u,p,g){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?u:-u))):g&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Pr{constructor(i,u,p,g,_){this.text=new bi(i?i.text:null,u,p,_),this.icon=new bi(i?i.icon:null,u,g,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Dg{constructor(i,u,p){this.text=i,this.icon=u,this.skipFade=p}}class uc{constructor(i,u,p,g,_){this.bucketInstanceId=i,this.featureIndex=u,this.sourceLayerIndex=p,this.bucketIndex=g,this.tileID=_}}class df{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const u=++this.maxGroupID;this.collisionGroups[i]={ID:u,predicate:p=>p.collisionGroupID===u}}return this.collisionGroups[i]}}function jo(v,i,u,p,g){const{horizontalAlign:_,verticalAlign:S}=s.aH(v);return new s.P(-(_-.5)*i+p[0]*g,-(S-.5)*u+p[1]*g)}class Oo{constructor(i,u,p,g,_){this.transform=i.clone(),this.terrain=u,this.collisionIndex=new Iu(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new df(g),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(i){const u=this.terrain;return u?(p,g)=>u.getElevation(i,p,g):null}getBucketParts(i,u,p,g){const _=p.getBucket(u),S=p.latestFeatureIndex;if(!_||!S||u.id!==_.layerIds[0])return;const C=p.collisionBoxArray,M=_.layers[0].layout,R=_.layers[0].paint,$=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),G=p.tileSize/s.$,V=p.tileID.toUnwrapped(),X=M.get("text-rotation-alignment")==="map",Q=s.aC(p,1,this.transform.zoom),se=s.aD(this.collisionIndex.transform,p,R.get("text-translate"),R.get("text-translate-anchor")),oe=s.aD(this.collisionIndex.transform,p,R.get("icon-translate"),R.get("icon-translate-anchor")),le=nn(X,this.transform,Q);this.retainedQueryData[_.bucketInstanceId]=new uc(_.bucketInstanceId,S,_.sourceLayerIndex,_.index,p.tileID);const ue={bucket:_,layout:M,translationText:se,translationIcon:oe,unwrappedTileID:V,pitchedLabelPlaneMatrix:le,scale:$,textPixelRatio:G,holdingForFade:p.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:s.an(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(g)for(const me of _.sortKeyRanges){const{sortKey:de,symbolInstanceStart:ye,symbolInstanceEnd:xe}=me;i.push({sortKey:de,symbolInstanceStart:ye,symbolInstanceEnd:xe,parameters:ue})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:ue})}attemptAnchorPlacement(i,u,p,g,_,S,C,M,R,$,G,V,X,Q,se,oe,le,ue,me,de){const ye=s.aE[i.textAnchor],xe=[i.textOffset0,i.textOffset1],pe=jo(ye,p,g,xe,_),ke=this.collisionIndex.placeCollisionBox(u,V,M,R,$,C,S,oe,G.predicate,me,pe,de);if((!ue||this.collisionIndex.placeCollisionBox(ue,V,M,R,$,C,S,le,G.predicate,me,pe,de).placeable)&&ke.placeable){let ze;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(ze=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:xe,width:p,height:g,anchor:ye,textBoxScale:_,prevAnchor:ze},this.markUsedJustification(Q,ye,X,se),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,se,X),this.placedOrientations[X.crossTileID]=se),{shift:pe,placedGlyphBoxes:ke}}}placeLayerBucketPart(i,u,p){const{bucket:g,layout:_,translationText:S,translationIcon:C,unwrappedTileID:M,pitchedLabelPlaneMatrix:R,textPixelRatio:$,holdingForFade:G,collisionBoxArray:V,partiallyEvaluatedTextSize:X,collisionGroup:Q}=i.parameters,se=_.get("text-optional"),oe=_.get("icon-optional"),le=s.aF(_,"text-overlap","text-allow-overlap"),ue=le==="always",me=s.aF(_,"icon-overlap","icon-allow-overlap"),de=me==="always",ye=_.get("text-rotation-alignment")==="map",xe=_.get("text-pitch-alignment")==="map",pe=_.get("icon-text-fit")!=="none",ke=_.get("symbol-z-order")==="viewport-y",ze=ue&&(de||!g.hasIconData()||oe),je=de&&(ue||!g.hasTextData()||se);!g.collisionArrays&&V&&g.deserializeCollisionBoxes(V);const De=this.retainedQueryData[g.bucketInstanceId].tileID,$e=this._getTerrainElevationFunc(De),at=this.transform.getFastPathSimpleProjectionMatrix(De),lt=(Ye,xt,qt)=>{var hr,_r;if(u[Ye.crossTileID])return;if(G)return void(this.placements[Ye.crossTileID]=new Dg(!1,!1,!1));let gr=!1,$r=!1,Gr=!0,Ut=null,xr={box:null,placeable:!1,offscreen:null,occluded:!1},hn={placeable:!1},xn=null,En=null,di=null,ma=0,zo=0,Lo=0;xt.textFeatureIndex?ma=xt.textFeatureIndex:Ye.useRuntimeCollisionCircles&&(ma=Ye.featureIndex),xt.verticalTextFeatureIndex&&(zo=xt.verticalTextFeatureIndex);const bl=xt.textBox;if(bl){const Pi=dn=>{let bn=s.ao.horizontal;if(g.allowVerticalPlacement&&!dn&&this.prevPlacement){const Xi=this.prevPlacement.placedOrientations[Ye.crossTileID];Xi&&(this.placedOrientations[Ye.crossTileID]=Xi,bn=Xi,this.markUsedOrientation(g,bn,Ye))}return bn},ga=(dn,bn)=>{if(g.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&xt.verticalTextBox){for(const Xi of g.writingModes)if(Xi===s.ao.vertical?(xr=bn(),hn=xr):xr=dn(),xr&&xr.placeable)break}else xr=dn()},fi=Ye.textAnchorOffsetStartIndex,Bo=Ye.textAnchorOffsetEndIndex;if(Bo===fi){const dn=(bn,Xi)=>{const fn=this.collisionIndex.placeCollisionBox(bn,le,$,De,M,xe,ye,S,Q.predicate,$e,void 0,at);return fn&&fn.placeable&&(this.markUsedOrientation(g,Xi,Ye),this.placedOrientations[Ye.crossTileID]=Xi),fn};ga(()=>dn(bl,s.ao.horizontal),()=>{const bn=xt.verticalTextBox;return g.allowVerticalPlacement&&Ye.numVerticalGlyphVertices>0&&bn?dn(bn,s.ao.vertical):{box:null,offscreen:null}}),Pi(xr&&xr.placeable)}else{let dn=s.aE[(_r=(hr=this.prevPlacement)===null||hr===void 0?void 0:hr.variableOffsets[Ye.crossTileID])===null||_r===void 0?void 0:_r.anchor];const bn=(fn,$c,Sl)=>{const io=fn.x2-fn.x1,ya=fn.y2-fn.y1,Fo=Ye.textBoxScale,ky=pe&&me==="never"?$c:null;let Ni=null,Ey=le==="never"?1:2,ap="never";dn&&Ey++;for(let fh=0;fh<Ey;fh++){for(let ph=fi;ph<Bo;ph++){const Uo=g.textAnchorOffsets.get(ph);if(dn&&Uo.textAnchor!==dn)continue;const ao=this.attemptAnchorPlacement(Uo,fn,io,ya,Fo,ye,xe,$,De,M,Q,ap,Ye,g,Sl,S,C,ky,$e);if(ao&&(Ni=ao.placedGlyphBoxes,Ni&&Ni.placeable))return gr=!0,Ut=ao.shift,Ni}dn?dn=null:ap=le}return p&&!Ni&&(Ni={box:this.collisionIndex.placeCollisionBox(bl,"always",$,De,M,xe,ye,S,Q.predicate,$e,void 0,at).box,offscreen:!1,placeable:!1,occluded:!1}),Ni};ga(()=>bn(bl,xt.iconBox,s.ao.horizontal),()=>{const fn=xt.verticalTextBox;return g.allowVerticalPlacement&&(!xr||!xr.placeable)&&Ye.numVerticalGlyphVertices>0&&fn?bn(fn,xt.verticalIconBox,s.ao.vertical):{box:null,occluded:!0,offscreen:null}}),xr&&(gr=xr.placeable,Gr=xr.offscreen);const Xi=Pi(xr&&xr.placeable);if(!gr&&this.prevPlacement){const fn=this.prevPlacement.variableOffsets[Ye.crossTileID];fn&&(this.variableOffsets[Ye.crossTileID]=fn,this.markUsedJustification(g,fn.anchor,Ye,Xi))}}}if(xn=xr,gr=xn&&xn.placeable,Gr=xn&&xn.offscreen,Ye.useRuntimeCollisionCircles){const Pi=g.text.placedSymbolArray.get(Ye.centerJustifiedTextSymbolIndex),ga=s.ap(g.textSizeData,X,Pi),fi=_.get("text-padding");En=this.collisionIndex.placeCollisionCircles(le,Pi,g.lineVertexArray,g.glyphOffsetArray,ga,M,R,p,xe,Q.predicate,Ye.collisionCircleDiameter,fi,S,$e),En.circles.length&&En.collisionDetected&&!p&&s.w("Collisions detected, but collision boxes are not shown"),gr=ue||En.circles.length>0&&!En.collisionDetected,Gr=Gr&&En.offscreen}if(xt.iconFeatureIndex&&(Lo=xt.iconFeatureIndex),xt.iconBox){const Pi=ga=>this.collisionIndex.placeCollisionBox(ga,me,$,De,M,xe,ye,C,Q.predicate,$e,pe&&Ut?Ut:void 0,at);hn&&hn.placeable&&xt.verticalIconBox?(di=Pi(xt.verticalIconBox),$r=di.placeable):(di=Pi(xt.iconBox),$r=di.placeable),Gr=Gr&&di.offscreen}const wl=se||Ye.numHorizontalGlyphVertices===0&&Ye.numVerticalGlyphVertices===0,xs=oe||Ye.numIconVertices===0;wl||xs?xs?wl||($r=$r&&gr):gr=$r&&gr:$r=gr=$r&&gr;const bs=$r&&di.placeable;if(gr&&xn.placeable&&this.collisionIndex.insertCollisionBox(xn.box,le,_.get("text-ignore-placement"),g.bucketInstanceId,hn&&hn.placeable&&zo?zo:ma,Q.ID),bs&&this.collisionIndex.insertCollisionBox(di.box,me,_.get("icon-ignore-placement"),g.bucketInstanceId,Lo,Q.ID),En&&gr&&this.collisionIndex.insertCollisionCircles(En.circles,le,_.get("text-ignore-placement"),g.bucketInstanceId,ma,Q.ID),p&&this.storeCollisionData(g.bucketInstanceId,qt,xt,xn,di,En),Ye.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ye.crossTileID]=new Dg((gr||ze)&&!(xn!=null&&xn.occluded),($r||je)&&!(di!=null&&di.occluded),Gr||g.justReloaded),u[Ye.crossTileID]=!0};if(ke){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ye=g.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let xt=Ye.length-1;xt>=0;--xt){const qt=Ye[xt];lt(g.symbolInstances.get(qt),g.collisionArrays[qt],qt)}}else for(let Ye=i.symbolInstanceStart;Ye<i.symbolInstanceEnd;Ye++)lt(g.symbolInstances.get(Ye),g.collisionArrays[Ye],Ye);g.justReloaded=!1}storeCollisionData(i,u,p,g,_,S){if(p.textBox||p.iconBox){let C,M;this.collisionBoxArrays.has(i)?C=this.collisionBoxArrays.get(i):(C=new Map,this.collisionBoxArrays.set(i,C)),C.has(u)?M=C.get(u):(M={text:null,icon:null},C.set(u,M)),p.textBox&&(M.text=g.box),p.iconBox&&(M.icon=_.box)}if(S){let C=this.collisionCircleArrays[i];C===void 0&&(C=this.collisionCircleArrays[i]=[]);for(let M=0;M<S.circles.length;M+=4)C.push(S.circles[M+0]-Jr),C.push(S.circles[M+1]-Jr),C.push(S.circles[M+2]),C.push(S.collisionDetected?1:0)}}markUsedJustification(i,u,p,g){let _;_=g===s.ao.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[s.aG(u)];const S=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const C of S)C>=0&&(i.text.placedSymbolArray.get(C).crossTileID=_>=0&&C!==_?0:p.crossTileID)}markUsedOrientation(i,u,p){const g=u===s.ao.horizontal||u===s.ao.horizontalOnly?u:0,_=u===s.ao.vertical?u:0,S=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const C of S)i.text.placedSymbolArray.get(C).placedOrientation=g;p.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let p=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const g=u?u.symbolFadeChange(i):1,_=u?u.opacities:{},S=u?u.variableOffsets:{},C=u?u.placedOrientations:{};for(const M in this.placements){const R=this.placements[M],$=_[M];$?(this.opacities[M]=new Pr($,g,R.text,R.icon),p=p||R.text!==$.text.placed||R.icon!==$.icon.placed):(this.opacities[M]=new Pr(null,g,R.text,R.icon,R.skipFade),p=p||R.text||R.icon)}for(const M in _){const R=_[M];if(!this.opacities[M]){const $=new Pr(R,g,!1,!1);$.isHidden()||(this.opacities[M]=$,p=p||R.text.placed||R.icon.placed)}}for(const M in S)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=S[M]);for(const M in C)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=C[M]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:i)}updateLayerOpacities(i,u){const p={};for(const g of u){const _=g.getBucket(i);_&&g.latestFeatureIndex&&i.id===_.layerIds[0]&&this.updateBucketOpacities(_,g.tileID,p,g.collisionBoxArray)}}updateBucketOpacities(i,u,p,g){i.hasTextData()&&(i.text.opacityVertexArray.clear(),i.text.hasVisibleVertices=!1),i.hasIconData()&&(i.icon.opacityVertexArray.clear(),i.icon.hasVisibleVertices=!1),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const _=i.layers[0],S=_.layout,C=new Pr(null,0,!1,!1,!0),M=S.get("text-allow-overlap"),R=S.get("icon-allow-overlap"),$=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),G=S.get("text-rotation-alignment")==="map",V=S.get("text-pitch-alignment")==="map",X=S.get("icon-text-fit")!=="none",Q=new Pr(null,0,M&&(R||!i.hasIconData()||S.get("icon-optional")),R&&(M||!i.hasTextData()||S.get("text-optional")),!0);!i.collisionArrays&&g&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(g);const se=(le,ue,me)=>{for(let de=0;de<ue/4;de++)le.opacityVertexArray.emplaceBack(me);le.hasVisibleVertices=le.hasVisibleVertices||me!==rl},oe=this.collisionBoxArrays.get(i.bucketInstanceId);for(let le=0;le<i.symbolInstances.length;le++){const ue=i.symbolInstances.get(le),{numHorizontalGlyphVertices:me,numVerticalGlyphVertices:de,crossTileID:ye}=ue;let xe=this.opacities[ye];p[ye]?xe=C:xe||(xe=Q,this.opacities[ye]=xe),p[ye]=!0;const pe=ue.numIconVertices>0,ke=this.placedOrientations[ue.crossTileID],ze=ke===s.ao.vertical,je=ke===s.ao.horizontal||ke===s.ao.horizontalOnly;if(me>0||de>0){const $e=pf(xe.text);se(i.text,me,ze?rl:$e),se(i.text,de,je?rl:$e);const at=xe.text.isHidden();[ue.rightJustifiedTextSymbolIndex,ue.centerJustifiedTextSymbolIndex,ue.leftJustifiedTextSymbolIndex].forEach(xt=>{xt>=0&&(i.text.placedSymbolArray.get(xt).hidden=at||ze?1:0)}),ue.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(ue.verticalPlacedTextSymbolIndex).hidden=at||je?1:0);const lt=this.variableOffsets[ue.crossTileID];lt&&this.markUsedJustification(i,lt.anchor,ue,ke);const Ye=this.placedOrientations[ue.crossTileID];Ye&&(this.markUsedJustification(i,"left",ue,Ye),this.markUsedOrientation(i,Ye,ue))}if(pe){const $e=pf(xe.icon),at=!(X&&ue.verticalPlacedIconSymbolIndex&&ze);ue.placedIconSymbolIndex>=0&&(se(i.icon,ue.numIconVertices,at?$e:rl),i.icon.placedSymbolArray.get(ue.placedIconSymbolIndex).hidden=xe.icon.isHidden()),ue.verticalPlacedIconSymbolIndex>=0&&(se(i.icon,ue.numVerticalIconVertices,at?rl:$e),i.icon.placedSymbolArray.get(ue.verticalPlacedIconSymbolIndex).hidden=xe.icon.isHidden())}const De=oe&&oe.has(le)?oe.get(le):{text:null,icon:null};if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const $e=i.collisionArrays[le];if($e){let at=new s.P(0,0);if($e.textBox||$e.verticalTextBox){let lt=!0;if($){const Ye=this.variableOffsets[ye];Ye?(at=jo(Ye.anchor,Ye.width,Ye.height,Ye.textOffset,Ye.textBoxScale),G&&at._rotate(V?-this.transform.bearingInRadians:this.transform.bearingInRadians)):lt=!1}if($e.textBox||$e.verticalTextBox){let Ye;$e.textBox&&(Ye=ze),$e.verticalTextBox&&(Ye=je),ff(i.textCollisionBox.collisionVertexArray,xe.text.placed,!lt||Ye,De.text,at.x,at.y)}}if($e.iconBox||$e.verticalIconBox){const lt=!!(!je&&$e.verticalIconBox);let Ye;$e.iconBox&&(Ye=lt),$e.verticalIconBox&&(Ye=!lt),ff(i.iconCollisionBox.collisionVertexArray,xe.icon.placed,Ye,De.icon,X?at.x:0,X?at.y:0)}}}}if(i.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);i.bucketInstanceId in this.collisionCircleArrays&&(i.collisionCircleArray=this.collisionCircleArrays[i.bucketInstanceId],delete this.collisionCircleArrays[i.bucketInstanceId])}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,u){const p=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*p>i}setStale(){this.stale=!0}}function ff(v,i,u,p,g,_){p&&p.length!==0||(p=[0,0,0,0]);const S=p[0]-Jr,C=p[1]-Jr,M=p[2]-Jr,R=p[3]-Jr;v.emplaceBack(i?1:0,u?1:0,g||0,_||0,S,C),v.emplaceBack(i?1:0,u?1:0,g||0,_||0,M,C),v.emplaceBack(i?1:0,u?1:0,g||0,_||0,M,R),v.emplaceBack(i?1:0,u?1:0,g||0,_||0,S,R)}const Rg=Math.pow(2,25),Ng=Math.pow(2,24),tl=Math.pow(2,17),$g=Math.pow(2,16),_x=Math.pow(2,9),xx=Math.pow(2,8),bx=Math.pow(2,1);function pf(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const i=v.placed?1:0,u=Math.floor(127*v.opacity);return u*Rg+i*Ng+u*tl+i*$g+u*_x+i*xx+u*bx+i}const rl=0;class mf{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,u,p,g,_){const S=this._bucketParts;for(;this._currentTileIndex<i.length;)if(u.getBucketParts(S,g,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((C,M)=>C.sortKey-M.sortKey));this._currentPartIndex<S.length;)if(u.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,_())return!0;return!1}}class gf{constructor(i,u,p,g,_,S,C,M){this.placement=new Oo(i,u,S,C,M),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(i,u,p){const g=I.now(),_=()=>!this._forceFullPlacement&&I.now()-g>2;for(;this._currentPlacementIndex>=0;){const S=u[i[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=C)&&(!S.maxzoom||S.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new mf(S)),this._inProgressLayer.continuePlacement(p[S.source],this.placement,this._showCollisionBoxes,S,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const nl=512/s.$/2;class yf{constructor(i,u,p){this.tileID=i,this.bucketInstanceId=p,this._symbolsByKey={};const g=new Map;for(let _=0;_<u.length;_++){const S=u.get(_),C=S.key,M=g.get(C);M?M.push(S):g.set(C,[S])}for(const[_,S]of g){const C={positions:S.map(M=>({x:Math.floor(M.anchorX*nl),y:Math.floor(M.anchorY*nl)})),crossTileIDs:S.map(M=>M.crossTileID)};if(C.positions.length>128){const M=new s.aI(C.positions.length,16,Uint16Array);for(const{x:R,y:$}of C.positions)M.add(R,$);M.finish(),delete C.positions,C.index=M}this._symbolsByKey[_]=C}}getScaledCoordinates(i,u){const{x:p,y:g,z:_}=this.tileID.canonical,{x:S,y:C,z:M}=u.canonical,R=nl/Math.pow(2,M-_),$=(C*s.$+i.anchorY)*R,G=g*s.$*nl;return{x:Math.floor((S*s.$+i.anchorX)*R-p*s.$*nl),y:Math.floor($-G)}}findMatches(i,u,p){const g=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let _=0;_<i.length;_++){const S=i.get(_);if(S.crossTileID)continue;const C=this._symbolsByKey[S.key];if(!C)continue;const M=this.getScaledCoordinates(S,u);if(C.index){const R=C.index.range(M.x-g,M.y-g,M.x+g,M.y+g).sort();for(const $ of R){const G=C.crossTileIDs[$];if(!p[G]){p[G]=!0,S.crossTileID=G;break}}}else if(C.positions)for(let R=0;R<C.positions.length;R++){const $=C.positions[R],G=C.crossTileIDs[R];if(Math.abs($.x-M.x)<=g&&Math.abs($.y-M.y)<=g&&!p[G]){p[G]=!0,S.crossTileID=G;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:i})=>i)}}class vf{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class wx{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const u=Math.round((i-this.lng)/360);if(u!==0)for(const p in this.indexes){const g=this.indexes[p],_={};for(const S in g){const C=g[S];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+u),_[C.tileID.key]=C}this.indexes[p]=_}this.lng=i}addBucket(i,u,p){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let _=0;_<u.symbolInstances.length;_++)u.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const g=this.usedCrossTileIDs[i.overscaledZ];for(const _ in this.indexes){const S=this.indexes[_];if(Number(_)>i.overscaledZ)for(const C in S){const M=S[C];M.tileID.isChildOf(i)&&M.findMatches(u.symbolInstances,i,g)}else{const C=S[i.scaledTo(Number(_)).key];C&&C.findMatches(u.symbolInstances,i,g)}}for(let _=0;_<u.symbolInstances.length;_++){const S=u.symbolInstances.get(_);S.crossTileID||(S.crossTileID=p.generate(),g[S.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new yf(i,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(i,u){for(const p of u.getCrossTileIDsLists())for(const g of p)delete this.usedCrossTileIDs[i][g]}removeStaleBuckets(i){let u=!1;for(const p in this.indexes){const g=this.indexes[p];for(const _ in g)i[g[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,g[_]),delete g[_],u=!0)}return u}}class il{constructor(){this.layerIndexes={},this.crossTileIDs=new vf,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,u,p){let g=this.layerIndexes[i.id];g===void 0&&(g=this.layerIndexes[i.id]=new wx);let _=!1;const S={};g.handleWrapJump(p);for(const C of u){const M=C.getBucket(i);M&&i.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(C.tileID,M,this.crossTileIDs)&&(_=!0),S[M.bucketInstanceId]=!0)}return g.removeStaleBuckets(S)&&(_=!0),_}pruneUnusedLayers(i){const u={};i.forEach(p=>{u[p]=!0});for(const p in this.layerIndexes)u[p]||delete this.layerIndexes[p]}}var hc="void main() {fragColor=vec4(1.0);}";const sa={prelude:Kt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Kt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Kt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Kt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Kt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Kt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Kt(hc,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Kt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Kt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Kt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Kt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Kt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Kt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Kt(hc,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Kt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Kt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Kt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Kt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Kt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Kt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Kt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Kt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Kt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Kt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Kt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Kt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Kt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Kt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Kt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Kt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Kt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Kt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Kt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Kt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Kt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Kt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Kt(v,i){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=i.match(/in ([\w]+) ([\w]+)/g),g=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=_?_.concat(g):g,C={};return{fragmentSource:v=v.replace(u,(M,R,$,G,V)=>(C[V]=!0,R==="define"?`
#ifndef HAS_UNIFORM_u_${V}
in ${$} ${G} ${V};
#else
uniform ${$} ${G} u_${V};
#endif
`:`
#ifdef HAS_UNIFORM_u_${V}
    ${$} ${G} ${V} = u_${V};
#endif
`)),vertexSource:i=i.replace(u,(M,R,$,G,V)=>{const X=G==="float"?"vec2":"vec4",Q=V.match(/color/)?"color":X;return C[V]?R==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
in ${$} ${X} a_${V};
out ${$} ${G} ${V};
#else
uniform ${$} ${G} u_${V};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = a_${V};
#else
    ${$} ${G} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = unpack_mix_${Q}(a_${V}, u_${V}_t);
#else
    ${$} ${G} ${V} = u_${V};
#endif
`:R==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
in ${$} ${X} a_${V};
#else
uniform ${$} ${G} u_${V};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${$} ${G} ${V} = a_${V};
#else
    ${$} ${G} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${$} ${G} ${V} = unpack_mix_${Q}(a_${V}, u_${V}_t);
#else
    ${$} ${G} ${V} = u_${V};
#endif
`}),staticAttributes:p,staticUniforms:S}}class ns{constructor(i,u,p){this.vertexBuffer=i,this.indexBuffer=u,this.segments=p}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Do=s.aJ([{name:"a_pos",type:"Int16",components:2}]);const eo="#define PROJECTION_MERCATOR",is="mercator";class Xt{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return is}get shaderDefine(){return eo}get shaderPreludeCode(){return sa.projectionMercator}get vertexShaderPreludeCode(){return sa.projectionMercator.vertexSource}get subdivisionGranularity(){return s.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(i){}getMeshFromTileID(i,u,p,g,_){if(this._cachedMesh)return this._cachedMesh;const S=new s.aL;S.emplaceBack(0,0),S.emplaceBack(s.$,0),S.emplaceBack(0,s.$),S.emplaceBack(s.$,s.$);const C=i.createVertexBuffer(S,Do.members),M=s.aM.simpleSegment(0,0,4,2),R=new s.aN;R.emplaceBack(1,0,2),R.emplaceBack(1,2,3);const $=i.createIndexBuffer(R);return this._cachedMesh=new ns(C,$,M),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(i){}}class as{constructor(i=0,u=0,p=0,g=0){if(isNaN(i)||i<0||isNaN(u)||u<0||isNaN(p)||p<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=u,this.left=p,this.right=g}interpolate(i,u,p){return u.top!=null&&i.top!=null&&(this.top=s.C.number(i.top,u.top,p)),u.bottom!=null&&i.bottom!=null&&(this.bottom=s.C.number(i.bottom,u.bottom,p)),u.left!=null&&i.left!=null&&(this.left=s.C.number(i.left,u.left,p)),u.right!=null&&i.right!=null&&(this.right=s.C.number(i.right,u.right,p)),this}getCenter(i,u){const p=s.ah((this.left+i-this.right)/2,0,i),g=s.ah((this.top+u-this.bottom)/2,0,u);return new s.P(p,g)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new as(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ju(v,i){if(!v.renderWorldCopies||v.lngRange)return;const u=i.lng-v.center.lng;i.lng+=u>180?-360:u<-180?360:0}function Ou(v){return Math.max(0,Math.floor(v))}class li{constructor(i,u,p,g,_,S){this._callbacks=i,this._tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=u||0,this._maxZoom=p||22,this._minPitch=g??0,this._maxPitch=_??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new s.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ou(this._zoom),this._scale=s.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new as,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(i,u,p){this._latRange=i.latRange,this._lngRange=i.lngRange,this._width=i.width,this._height=i.height,this._center=i.center,this._elevation=i.elevation,this._minElevationForCurrentTile=i.minElevationForCurrentTile,this._zoom=i.zoom,this._tileZoom=Ou(this._zoom),this._scale=s.af(this._zoom),this._bearingInRadians=i.bearingInRadians,this._fovInRadians=i.fovInRadians,this._pitchInRadians=i.pitchInRadians,this._rollInRadians=i.rollInRadians,this._unmodified=i.unmodified,this._edgeInsets=new as(i.padding.top,i.padding.bottom,i.padding.left,i.padding.right),this._minZoom=i.minZoom,this._maxZoom=i.maxZoom,this._minPitch=i.minPitch,this._maxPitch=i.maxPitch,this._renderWorldCopies=i.renderWorldCopies,this._cameraToCenterDistance=i.cameraToCenterDistance,this._nearZ=i.nearZ,this._farZ=i.farZ,this._autoCalculateNearFarZ=!p&&i.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(i){this._minElevationForCurrentTile=i}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(i){this._minZoom!==i&&(this._minZoom=i,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(i){this._minPitch!==i&&(this._minPitch=i,this.setPitch(Math.max(this.pitch,i)))}get maxPitch(){return this._maxPitch}setMaxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.setPitch(Math.min(this.pitch,i)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(i){const u=s.aO(i,-180,180)*Math.PI/180;var p,g,_,S,C,M,R,$,G;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=w(),p=this._rotationMatrix,_=-this._bearingInRadians,S=(g=this._rotationMatrix)[0],C=g[1],M=g[2],R=g[3],$=Math.sin(_),G=Math.cos(_),p[0]=S*G+M*$,p[1]=C*G+R*$,p[2]=S*-$+M*G,p[3]=C*-$+R*G)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(i){const u=s.ah(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(i){const u=i/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return s.aP(this._fovInRadians)}setFov(i){i=s.ah(i,.1,150),this.fov!==i&&(this._unmodified=!1,this._fovInRadians=s.ae(i),this._calcMatrices())}get zoom(){return this._zoom}setZoom(i){const u=this.getConstrained(this._center,i).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=s.af(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(i,u){this._autoCalculateNearFarZ=!1,this._nearZ=i,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,u,p){this._unmodified=!1,this._edgeInsets.interpolate(i,u,p),this._constrain(),this._calcMatrices()}resize(i,u,p=!0){this._width=i,this._height=u,p&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Vt([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(i){i?(this._lngRange=[i.getWest(),i.getEast()],this._latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-s.ai,s.ai])}getConstrained(i,u){return this._callbacks.getConstrained(i,u)}getCameraQueryGeometry(i,u){if(u.length===1)return[u[0],i];{const{minX:p,minY:g,maxX:_,maxY:S}=s.a2.fromPoints(u).extend(i);return[new s.P(p,g),new s.P(_,g),new s.P(_,S),new s.P(p,S),new s.P(p,g)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const i=this._unmodified,{center:u,zoom:p}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(p),this._unmodified=i,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let i=s.ag(new Float64Array(16));s.N(i,i,[this._width/2,-this._height/2,1]),s.M(i,i,[1,-1,0]),this._clipSpaceToPixelsMatrix=i,i=s.ag(new Float64Array(16)),s.N(i,i,[1,-1,1]),s.M(i,i,[-1,-1,0]),s.N(i,i,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=i,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(i,u,p,g){const _=p!==void 0?p:this.bearing,S=g=g!==void 0?g:this.pitch,C=s.a1.fromLngLat(i,u),M=-Math.cos(s.ae(S)),R=Math.sin(s.ae(S)),$=R*Math.sin(s.ae(_)),G=-R*Math.cos(s.ae(_));let V=this.elevation;const X=u-V;let Q;M*X>=0||Math.abs(M)<.1?(Q=1e4,V=u+Q*M):Q=-X/M;let se,oe,le=s.aQ(1,C.y),ue=0;do{if(ue+=1,ue>10)break;oe=Q/le,se=new s.a1(C.x+$*oe,C.y+G*oe),le=1/se.meterInMercatorCoordinateUnits()}while(Math.abs(Q-oe*le)>1e-12);return{center:se.toLngLat(),elevation:V,zoom:s.ak(this.height/2/Math.tan(this.fovInRadians/2)/oe/this.tileSize)}}recalculateZoomAndCenter(i){if(this.elevation-i==0)return;const u=s.aj(1,this.center.lat)*this.worldSize,p=this.cameraToCenterDistance/u,g=s.a1.fromLngLat(this.center,this.elevation),_=Re(this.center,this.elevation,this.pitch,this.bearing,p);this._elevation=i;const S=this.calculateCenterFromCameraLngLatAlt(_.toLngLat(),s.aQ(_.z,g.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const i=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(i*Math.sin(this.rollInRadians),i*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const i=s.aj(1,this.center.lat)*this.worldSize;return Re(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/i).toLngLat()}getMercatorTileCoordinates(i){if(!i)return[0,0,1,1];const u=i.canonical.z>=0?1<<i.canonical.z:Math.pow(2,i.canonical.z);return[i.canonical.x/u,i.canonical.y/u,1/u/s.$,1/u/s.$]}}class Tn{constructor(i,u){this.min=i,this.max=u,this.center=s.aR([],s.aS([],this.min,this.max),.5)}quadrant(i){const u=[i%2==0,i<2],p=s.aT(this.min),g=s.aT(this.max);for(let _=0;_<u.length;_++)p[_]=u[_]?this.min[_]:this.center[_],g[_]=u[_]?this.center[_]:this.max[_];return g[2]=this.max[2],new Tn(p,g)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersectsFrustum(i){let u=!0;for(let p=0;p<i.planes.length;p++){const g=this.intersectsPlane(i.planes[p]);if(g===0)return 0;g===1&&(u=!1)}return u?2:i.aabb.min[0]>this.max[0]||i.aabb.min[1]>this.max[1]||i.aabb.min[2]>this.max[2]||i.aabb.max[0]<this.min[0]||i.aabb.max[1]<this.min[1]||i.aabb.max[2]<this.min[2]?0:1}intersectsPlane(i){let u=i[3],p=i[3];for(let g=0;g<3;g++)i[g]>0?(u+=i[g]*this.min[g],p+=i[g]*this.max[g]):(p+=i[g]*this.min[g],u+=i[g]*this.max[g]);return u>=0?2:p<0?0:1}}class ci{distanceToTile2d(i,u,p,g){const _=g.distanceX([i,u]),S=g.distanceY([i,u]);return Math.hypot(_,S)}getWrap(i,u,p){return p}getTileBoundingVolume(i,u,p,g){var _,S;let C=0,M=0;if(g!=null&&g.terrain){const $=new s.Z(i.z,u,i.z,i.x,i.y),G=g.terrain.getMinMaxElevation($);C=(_=G.minElevation)!==null&&_!==void 0?_:Math.min(0,p),M=(S=G.maxElevation)!==null&&S!==void 0?S:Math.max(0,p)}const R=1<<i.z;return new Tn([u+i.x/R,i.y/R,C],[u+(i.x+1)/R,(i.y+1)/R,M])}allowVariableZoom(i,u){const p=i.fov*(Math.abs(Math.cos(i.rollInRadians))*i.height+Math.abs(Math.sin(i.rollInRadians))*i.width)/i.height,g=s.ah(78.5-p/2,0,60);return!!u.terrain||i.pitch>g}allowWorldCopies(){return!0}prepareNextFrame(){}}class un{constructor(i,u,p){this.points=i,this.planes=u,this.aabb=p}static fromInvProjectionMatrix(i,u=1,p=0,g,_){const S=_?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],C=Math.pow(2,p),M=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(V=>function(X,Q,se,oe){const le=s.aw([],X,Q),ue=1/le[3]/se*oe;return s.aY(le,le,[ue,ue,1/le[3],ue])}(V,i,u,C));g&&function(V,X,Q,se){const oe=se?4:0,le=se?0:4;let ue=0;const me=[],de=[];for(let pe=0;pe<4;pe++){const ke=s.aU([],V[pe+le],V[pe+oe]),ze=s.aZ(ke);s.aR(ke,ke,1/ze),me.push(ze),de.push(ke)}for(let pe=0;pe<4;pe++){const ke=s.a_(V[pe+oe],de[pe],Q);ue=ke!==null&&ke>=0?Math.max(ue,ke):Math.max(ue,me[pe])}const ye=function(pe,ke){const ze=s.aU([],pe[ke[0]],pe[ke[1]]),je=s.aU([],pe[ke[2]],pe[ke[1]]),De=[0,0,0,0];return s.aV(De,s.aW([],ze,je)),De[3]=-s.aX(De,pe[ke[0]]),De}(V,X),xe=function(pe,ke){const ze=s.a$(pe),je=s.b0([],pe,1/ze),De=s.aU([],ke,s.aR([],je,s.aX(ke,je))),$e=s.a$(De);if($e>0){const at=Math.sqrt(1-je[3]*je[3]),lt=s.aR([],je,-je[3]),Ye=s.aS([],lt,s.aR([],De,at/$e));return s.b1(ke,Ye)}return null}(Q,ye);if(xe!==null){const pe=xe/s.aX(de[0],ye);ue=Math.min(ue,pe)}for(let pe=0;pe<4;pe++){const ke=Math.min(ue,me[pe]);V[pe+le]=[V[pe+oe][0]+de[pe][0]*ke,V[pe+oe][1]+de[pe][1]*ke,V[pe+oe][2]+de[pe][2]*ke,1]}}(M,S[0],g,_);const R=S.map(V=>{const X=s.aU([],M[V[0]],M[V[1]]),Q=s.aU([],M[V[2]],M[V[1]]),se=s.aV([],s.aW([],X,Q)),oe=-s.aX(se,M[V[1]]);return se.concat(oe)}),$=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],G=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const V of M)for(let X=0;X<3;X++)$[X]=Math.min($[X],V[X]),G[X]=Math.max(G[X],V[X]);return new un(M,R,new Tn($,G))}}class Tr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(i){this._helper.setMinZoom(i)}setMaxZoom(i){this._helper.setMaxZoom(i)}setMinPitch(i){this._helper.setMinPitch(i)}setMaxPitch(i){this._helper.setMaxPitch(i)}setRenderWorldCopies(i){this._helper.setRenderWorldCopies(i)}setBearing(i){this._helper.setBearing(i)}setPitch(i){this._helper.setPitch(i)}setRoll(i){this._helper.setRoll(i)}setFov(i){this._helper.setFov(i)}setZoom(i){this._helper.setZoom(i)}setCenter(i){this._helper.setCenter(i)}setElevation(i){this._helper.setElevation(i)}setMinElevationForCurrentTile(i){this._helper.setMinElevationForCurrentTile(i)}setPadding(i){this._helper.setPadding(i)}interpolatePadding(i,u,p){return this._helper.interpolatePadding(i,u,p)}isPaddingEqual(i){return this._helper.isPaddingEqual(i)}resize(i,u,p=!0){this._helper.resize(i,u,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(i){this._helper.setMaxBounds(i)}overrideNearFarZ(i,u){this._helper.overrideNearFarZ(i,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(i){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),i)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(i,u){}constructor(i,u,p,g,_){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new li({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,C)=>this.getConstrained(S,C)},i,u,p,g,_),this._coveringTilesDetailsProvider=new ci}clone(){const i=new Tr;return i.apply(this),i}apply(i,u,p){this._helper.apply(i,u,p)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(i){const u=[new s.b2(0,i)];if(this._helper._renderWorldCopies){const p=this.screenPointToMercatorCoordinate(new s.P(0,0)),g=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,0)),_=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new s.P(0,this._helper._height)),C=Math.floor(Math.min(p.x,g.x,_.x,S.x)),M=Math.floor(Math.max(p.x,g.x,_.x,S.x)),R=1;for(let $=C-R;$<=M+R;$++)$!==0&&u.push(new s.b2($,i))}return u}getCameraFrustum(){return un.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(i){const u=this.screenPointToLocation(this.centerPoint,i),p=i?i.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(p)}setLocationAtPoint(i,u){const p=s.aj(this.elevation,this.center.lat),g=this.screenPointToMercatorCoordinateAtZ(u,p),_=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,p),S=s.a1.fromLngLat(i),C=new s.a1(S.x-(g.x-_.x),S.y-(g.y-_.y));this.setCenter(C==null?void 0:C.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(i,u){return u?this.coordinatePoint(s.a1.fromLngLat(i),u.getElevationForLngLatZoom(i,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(s.a1.fromLngLat(i))}screenPointToLocation(i,u){var p;return(p=this.screenPointToMercatorCoordinate(i,u))===null||p===void 0?void 0:p.toLngLat()}screenPointToMercatorCoordinate(i,u){if(u){const p=u.pointCoordinate(i);if(p!=null)return p}return this.screenPointToMercatorCoordinateAtZ(i)}screenPointToMercatorCoordinateAtZ(i,u){const p=u||0,g=[i.x,i.y,0,1],_=[i.x,i.y,1,1];s.aw(g,g,this._pixelMatrixInverse),s.aw(_,_,this._pixelMatrixInverse);const S=g[3],C=_[3],M=g[1]/S,R=_[1]/C,$=g[2]/S,G=_[2]/C,V=$===G?0:(p-$)/(G-$);return new s.a1(s.C.number(g[0]/S,_[0]/C,V)/this.worldSize,s.C.number(M,R,V)/this.worldSize,p)}coordinatePoint(i,u=0,p=this._pixelMatrix){const g=[i.x*this.worldSize,i.y*this.worldSize,u,1];return s.aw(g,g,p),new s.P(g[0]/g[3],g[1]/g[3])}getBounds(){const i=Math.max(0,this._helper._height/2-_e(this));return new Vt().extend(this.screenPointToLocation(new s.P(0,i))).extend(this.screenPointToLocation(new s.P(this._helper._width,i))).extend(this.screenPointToLocation(new s.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new s.P(0,this._helper._height)))}isPointOnMapSurface(i,u){return u?u.pointCoordinate(i)!=null:i.y>this.height/2-_e(this)}calculatePosMatrix(i,u=!1,p){var g;const _=(g=i.key)!==null&&g!==void 0?g:s.b3(i.wrap,i.canonical.z,i.canonical.z,i.canonical.x,i.canonical.y),S=u?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(_)){const R=S.get(_);return p?R.f32:R.f64}const C=Ee(i,this.worldSize);s.O(C,u?this._alignedProjMatrix:this._viewProjMatrix,C);const M={f64:C,f32:new Float32Array(C)};return S.set(_,M),p?M.f32:M.f64}calculateFogMatrix(i){const u=i.key,p=this._fogMatrixCacheF32;if(p.has(u))return p.get(u);const g=Ee(i,this.worldSize);return s.O(g,this._fogMatrix,g),p.set(u,new Float32Array(g)),p.get(u)}getConstrained(i,u){u=s.ah(+u,this.minZoom,this.maxZoom);const p={center:new s.S(i.lng,i.lat),zoom:u};let g=this._helper._lngRange;if(!this._helper._renderWorldCopies&&g===null){const me=179.9999999999;g=[-me,me]}const _=this.tileSize*s.af(p.zoom);let S=0,C=_,M=0,R=_,$=0,G=0;const{x:V,y:X}=this.size;if(this._helper._latRange){const me=this._helper._latRange;S=s.U(me[1])*_,C=s.U(me[0])*_,C-S<X&&($=X/(C-S))}g&&(M=s.aO(s.V(g[0])*_,0,_),R=s.aO(s.V(g[1])*_,0,_),R<M&&(R+=_),R-M<V&&(G=V/(R-M)));const{x:Q,y:se}=ie(_,i);let oe,le;const ue=Math.max(G||0,$||0);if(ue){const me=new s.P(G?(R+M)/2:Q,$?(C+S)/2:se);return p.center=fe(_,me).wrap(),p.zoom+=s.ak(ue),p}if(this._helper._latRange){const me=X/2;se-me<S&&(le=S+me),se+me>C&&(le=C-me)}if(g){const me=(M+R)/2;let de=Q;this._helper._renderWorldCopies&&(de=s.aO(Q,me-_/2,me+_/2));const ye=V/2;de-ye<M&&(oe=M+ye),de+ye>R&&(oe=R-ye)}if(oe!==void 0||le!==void 0){const me=new s.P(oe??Q,le??se);p.center=fe(_,me).wrap()}return p}calculateCenterFromCameraLngLatAlt(i,u,p,g){return this._helper.calculateCenterFromCameraLngLatAlt(i,u,p,g)}_calculateNearFarZIfNeeded(i,u,p){if(!this._helper.autoCalculateNearFarZ)return;const g=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),_=i-g*this._helper._pixelPerMeter/Math.cos(u),S=g<0?_:i,C=Math.PI/2+this.pitchInRadians,M=s.ae(this.fov)*(Math.abs(Math.cos(s.ae(this.roll)))*this.height+Math.abs(Math.sin(s.ae(this.roll)))*this.width)/this.height*(.5+p.y/this.height),R=Math.sin(M)*S/Math.sin(s.ah(Math.PI-C-M,.01,Math.PI-.01)),$=_e(this),G=Math.atan($/this._helper.cameraToCenterDistance),V=s.ae(.75),X=G>V?2*G*(.5+p.y/(2*$)):V,Q=Math.sin(X)*S/Math.sin(s.ah(Math.PI-C-X,.01,Math.PI-.01)),se=Math.min(R,Q);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*se+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const i=this.centerOffset,u=ie(this.worldSize,this.center),p=u.x,g=u.y;this._helper._pixelPerMeter=s.aj(1,this.center.lat)*this.worldSize;const _=s.ae(Math.min(this.pitch,ne)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(_));let C;this._calculateNearFarZIfNeeded(S,_,i),C=new Float64Array(16),s.b4(C,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),s.aq(this._invProjMatrix,C),C[8]=2*-i.x/this._helper._width,C[9]=2*i.y/this._helper._height,this._projectionMatrix=s.b5(C),s.N(C,C,[1,-1,1]),s.M(C,C,[0,0,-this._helper.cameraToCenterDistance]),s.b6(C,C,-this.rollInRadians),s.b7(C,C,this.pitchInRadians),s.b6(C,C,-this.bearingInRadians),s.M(C,C,[-p,-g,0]),this._mercatorMatrix=s.N([],C,[this.worldSize,this.worldSize,this.worldSize]),s.N(C,C,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,C),s.M(C,C,[0,0,-this.elevation]),this._viewProjMatrix=C,this._invViewProjMatrix=s.aq([],C);const M=[0,0,-1,1];s.aw(M,M,this._invViewProjMatrix),this._cameraPosition=[M[0]/M[3],M[1]/M[3],M[2]/M[3]],this._fogMatrix=new Float64Array(16),s.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-i.x/this.width,this._fogMatrix[9]=2*i.y/this.height,s.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),s.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),s.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),s.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),s.M(this._fogMatrix,this._fogMatrix,[-p,-g,0]),s.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,C);const R=this._helper._width%2/2,$=this._helper._height%2/2,G=Math.cos(this.bearingInRadians),V=Math.sin(-this.bearingInRadians),X=p-Math.round(p)+G*R+V*$,Q=g-Math.round(g)+G*$+V*R,se=new Float64Array(C);if(s.M(se,se,[X>.5?X-1:X,Q>.5?Q-1:Q,0]),this._alignedProjMatrix=se,C=s.aq(new Float64Array(16),this._pixelMatrix),!C)throw new Error("failed to invert matrix");this._pixelMatrixInverse=C,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const i=this.screenPointToMercatorCoordinate(new s.P(0,0)),u=[i.x*this.worldSize,i.y*this.worldSize,0,1];return s.aw(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const i=s.aj(1,this.center.lat)*this.worldSize;return Re(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/i).toLngLat()}lngLatToCameraDepth(i,u){const p=s.a1.fromLngLat(i),g=[p.x*this.worldSize,p.y*this.worldSize,u,1];return s.aw(g,g,this._viewProjMatrix),g[2]/g[3]}getProjectionData(i){const{overscaledTileID:u,aligned:p,applyTerrainMatrix:g}=i,_=this._helper.getMercatorTileCoordinates(u),S=u?this.calculatePosMatrix(u,p,!0):null;let C;return C=u&&u.terrainRttPosMatrix32f&&g?u.terrainRttPosMatrix32f:S||s.b8(),{mainMatrix:C,tileMercatorCoords:_,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:C}}isLocationOccluded(i){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(i,u,p){return 1}transformLightDirection(i){return s.aT(i)}getRayDirectionFromPixel(i){throw new Error("Not implemented.")}projectTileCoordinates(i,u,p,g){const _=this.calculatePosMatrix(p);let S;g?(S=[i,u,g(i,u),1],s.aw(S,S,_)):(S=[i,u,0,1],el(S,S,_));const C=S[3];return{point:new s.P(S[0]/C,S[1]/C),signedDistanceFromCamera:C,isOccluded:!1}}populateCache(i){for(const u of i)this.calculatePosMatrix(u)}getMatrixForModel(i,u){const p=s.a1.fromLngLat(i,u),g=p.meterInMercatorCoordinateUnits(),_=s.b9();return s.M(_,_,[p.x,p.y,p.z]),s.b6(_,_,Math.PI),s.b7(_,_,Math.PI/2),s.N(_,_,[-g,g,g]),_}getProjectionDataForCustomLayer(i=!0){const u=new s.Z(0,0,0,0,0),p=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:i}),g=Ee(u,this.worldSize);s.O(g,this._viewProjMatrix,g),p.tileMercatorCoords=[0,0,1,1];const _=[s.$,s.$,this.worldSize/this._helper.pixelsPerMeter],S=s.ba();return s.N(S,g,_),p.fallbackMatrix=S,p.mainMatrix=S,p}getFastPathSimpleProjectionMatrix(i){return this.calculatePosMatrix(i)}}function zg(){s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function ui(v){if(v.useSlerp)if(v.k<1){const i=s.bb(v.startEulerAngles.roll,v.startEulerAngles.pitch,v.startEulerAngles.bearing),u=s.bb(v.endEulerAngles.roll,v.endEulerAngles.pitch,v.endEulerAngles.bearing),p=new Float64Array(4);s.bc(p,i,u,v.k);const g=s.bd(p);v.tr.setRoll(g.roll),v.tr.setPitch(g.pitch),v.tr.setBearing(g.bearing)}else v.tr.setRoll(v.endEulerAngles.roll),v.tr.setPitch(v.endEulerAngles.pitch),v.tr.setBearing(v.endEulerAngles.bearing);else v.tr.setRoll(s.C.number(v.startEulerAngles.roll,v.endEulerAngles.roll,v.k)),v.tr.setPitch(s.C.number(v.startEulerAngles.pitch,v.endEulerAngles.pitch,v.k)),v.tr.setBearing(s.C.number(v.startEulerAngles.bearing,v.endEulerAngles.bearing,v.k))}function Di(v,i,u,p,g){const _=g.padding,S=ie(g.worldSize,u.getNorthWest()),C=ie(g.worldSize,u.getNorthEast()),M=ie(g.worldSize,u.getSouthEast()),R=ie(g.worldSize,u.getSouthWest()),$=s.ae(-p),G=S.rotate($),V=C.rotate($),X=M.rotate($),Q=R.rotate($),se=new s.P(Math.max(G.x,V.x,Q.x,X.x),Math.max(G.y,V.y,Q.y,X.y)),oe=new s.P(Math.min(G.x,V.x,Q.x,X.x),Math.min(G.y,V.y,Q.y,X.y)),le=se.sub(oe),ue=(g.width-(_.left+_.right+i.left+i.right))/le.x,me=(g.height-(_.top+_.bottom+i.top+i.bottom))/le.y;if(me<0||ue<0)return void zg();const de=Math.min(s.ak(g.scale*Math.min(ue,me)),v.maxZoom),ye=s.P.convert(v.offset),xe=new s.P((i.left-i.right)/2,(i.top-i.bottom)/2).rotate(s.ae(p)),pe=ye.add(xe).mult(g.scale/s.af(de));return{center:fe(g.worldSize,S.add(M).div(2).sub(pe)),zoom:de,bearing:p}}class Qn{get useGlobeControls(){return!1}handlePanInertia(i,u){return{easingOffset:i,easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(i,u){i.bearingDelta&&u.setBearing(u.bearing+i.bearingDelta),i.pitchDelta&&u.setPitch(u.pitch+i.pitchDelta),i.rollDelta&&u.setRoll(u.roll+i.rollDelta),i.zoomDelta&&u.setZoom(u.zoom+i.zoomDelta)}handleMapControlsPan(i,u,p){i.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(p,i.around)}cameraForBoxAndBearing(i,u,p,g,_){return Di(i,u,p,g,_)}handleJumpToCenterZoom(i,u){i.zoom!==(u.zoom!==void 0?+u.zoom:i.zoom)&&i.setZoom(+u.zoom),u.center!==void 0&&i.setCenter(s.S.convert(u.center))}handleEaseTo(i,u){const p=i.zoom,g=i.padding,_={roll:i.roll,pitch:i.pitch,bearing:i.bearing},S={roll:u.roll===void 0?i.roll:u.roll,pitch:u.pitch===void 0?i.pitch:u.pitch,bearing:u.bearing===void 0?i.bearing:u.bearing},C=u.zoom!==void 0,M=!i.isPaddingEqual(u.padding);let R=!1;const $=C?+u.zoom:i.zoom;let G=i.centerPoint.add(u.offsetAsPoint);const V=i.screenPointToLocation(G),{center:X,zoom:Q}=i.getConstrained(s.S.convert(u.center||V),$??p);ju(i,X);const se=ie(i.worldSize,V),oe=ie(i.worldSize,X).sub(se),le=s.af(Q-p);return R=Q!==p,{easeFunc:ue=>{if(R&&i.setZoom(s.C.number(p,Q,ue)),s.be(_,S)||ui({startEulerAngles:_,endEulerAngles:S,tr:i,k:ue,useSlerp:_.roll!=S.roll}),M&&(i.interpolatePadding(g,u.padding,ue),G=i.centerPoint.add(u.offsetAsPoint)),u.around)i.setLocationAtPoint(u.around,u.aroundPoint);else{const me=s.af(i.zoom-p),de=Q>p?Math.min(2,le):Math.max(.5,le),ye=Math.pow(de,1-ue),xe=fe(i.worldSize,se.add(oe.mult(ue*ye)).mult(me));i.setLocationAtPoint(i.renderWorldCopies?xe.wrap():xe,G)}},isZooming:R,elevationCenter:X}}handleFlyTo(i,u){const p=u.zoom!==void 0,g=i.zoom,_=i.getConstrained(s.S.convert(u.center||u.locationAtOffset),p?+u.zoom:g),S=_.center,C=_.zoom;ju(i,S);const M=ie(i.worldSize,u.locationAtOffset),R=ie(i.worldSize,S).sub(M),$=R.mag(),G=s.af(C-g);let V;if(u.minZoom!==void 0){const X=Math.min(+u.minZoom,g,C),Q=i.getConstrained(S,X).zoom;V=s.af(Q-g)}return{easeFunc:(X,Q,se,oe)=>{i.setZoom(X===1?C:g+s.ak(Q));const le=X===1?S:fe(i.worldSize,M.add(R.mult(se)).mult(Q));i.setLocationAtPoint(i.renderWorldCopies?le.wrap():le,oe)},scaleOfZoom:G,targetCenter:S,scaleOfMinZoom:V,pixelPathLength:$}}}class jr{constructor(i,u,p){this.blendFunction=i,this.blendColor=u,this.mask=p}}jr.Replace=[1,0],jr.disabled=new jr(jr.Replace,s.bf.transparent,[!1,!1,!1,!1]),jr.unblended=new jr(jr.Replace,s.bf.transparent,[!0,!0,!0,!0]),jr.alphaBlended=new jr([1,771],s.bf.transparent,[!0,!0,!0,!0]);const os=2305;class jt{constructor(i,u,p){this.enable=i,this.mode=u,this.frontFace=p}}jt.disabled=new jt(!1,1029,os),jt.backCCW=new jt(!0,1029,os),jt.frontCCW=new jt(!0,1028,os);class Bt{constructor(i,u,p){this.func=i,this.mask=u,this.range=p}}Bt.ReadOnly=!1,Bt.ReadWrite=!0,Bt.disabled=new Bt(519,Bt.ReadOnly,[0,1]);const to=7680;class ir{constructor(i,u,p,g,_,S){this.test=i,this.ref=u,this.mask=p,this.fail=g,this.depthFail=_,this.pass=S}}ir.disabled=new ir({func:519,mask:0},0,0,to,to,to);const Ri=new WeakMap;function Oa(v){var i;if(Ri.has(v))return Ri.get(v);{const u=(i=v.getParameter(v.VERSION))===null||i===void 0?void 0:i.startsWith("WebGL 2.0");return Ri.set(v,u),u}}class Da{get awaitingQuery(){return!!this._readbackQueue}constructor(i){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=i;const u=i.context,p=u.gl;this._texFormat=p.RGBA,this._texType=p.UNSIGNED_BYTE;const g=new s.aL;g.emplaceBack(-1,-1),g.emplaceBack(2,-1),g.emplaceBack(-1,2);const _=new s.aN;_.emplaceBack(0,1,2),this._fullscreenTriangle=new ns(u.createVertexBuffer(g,Do.members),u.createIndexBuffer(_),s.aM.simpleSegment(0,0,g.length,_.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(p.TEXTURE1);const S=p.createTexture();p.bindTexture(p.TEXTURE_2D,S),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texImage2D(p.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),Oa(p)&&(this._pbo=p.createBuffer(),p.bindBuffer(p.PIXEL_PACK_BUFFER,this._pbo),p.bufferData(p.PIXEL_PACK_BUFFER,4,p.STREAM_READ),p.bindBuffer(p.PIXEL_PACK_BUFFER,null))}destroy(){const i=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),i.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(i,u){const p=this._updateCount;return this._readbackQueue?p>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():p>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(i,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const i=this._cachedRenderContext.context,u=i.gl;i.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),i.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(i,u){const p=this._cachedRenderContext.context,g=p.gl;if(this._bindFramebuffer(),p.viewport.set([0,0,this._texWidth,this._texHeight]),p.clear({color:s.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(p,g.TRIANGLES,Bt.disabled,ir.disabled,jr.unblended,jt.disabled,((_,S)=>({u_input:_,u_output_expected:S}))(i,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Oa(g)){g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.readBuffer(g.COLOR_ATTACHMENT0),g.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),g.bindBuffer(g.PIXEL_PACK_BUFFER,null);const _=g.fenceSync(g.SYNC_GPU_COMMANDS_COMPLETE,0);g.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:_}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const i=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Oa(i)){const u=i.clientWaitSync(this._readbackQueue.sync,0,0);if(u===i.WAIT_FAILED)return s.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===i.TIMEOUT_EXPIRED)return;i.bindBuffer(i.PIXEL_PACK_BUFFER,this._pbo),i.getBufferSubData(i.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),i.bindBuffer(i.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),i.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Da._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(i){let u=0;return u+=i[0]/256,u+=i[1]/65536,u+=i[2]/16777216,i[3]<127&&(u=-u),u/128}}const Du=s.$/128;function _f(v,i){const u=v.granularity!==void 0?Math.max(v.granularity,1):1,p=u+(v.generateBorders?2:0),g=u+(v.extendToNorthPole||v.generateBorders?1:0)+(v.extendToSouthPole||v.generateBorders?1:0),_=p+1,S=g+1,C=v.generateBorders?-1:0,M=v.generateBorders||v.extendToNorthPole?-1:0,R=u+(v.generateBorders?1:0),$=u+(v.generateBorders||v.extendToSouthPole?1:0),G=_*S,V=p*g*6,X=_*S>65536;if(X&&i==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Q=X||i==="32bit",se=new Int16Array(2*G);let oe=0;for(let me=M;me<=$;me++)for(let de=C;de<=R;de++){let ye=de/u*s.$;de===-1&&(ye=-Du),de===u+1&&(ye=s.$+Du);let xe=me/u*s.$;me===-1&&(xe=v.extendToNorthPole?s.bh:-Du),me===u+1&&(xe=v.extendToSouthPole?s.bi:s.$+Du),se[oe++]=ye,se[oe++]=xe}const le=Q?new Uint32Array(V):new Uint16Array(V);let ue=0;for(let me=0;me<g;me++)for(let de=0;de<p;de++){const ye=de+1+me*_,xe=de+(me+1)*_,pe=de+1+(me+1)*_;le[ue++]=de+me*_,le[ue++]=xe,le[ue++]=ye,le[ue++]=ye,le[ue++]=xe,le[ue++]=pe}return{vertices:se.buffer.slice(0),indices:le.buffer.slice(0),uses32bitIndices:Q}}const al=new s.aK({fill:new s.bj(128,2),line:new s.bj(512,0),tile:new s.bj(128,32),stencil:new s.bj(128,1),circle:3});class dc{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return sa.projectionGlobe}get vertexShaderPreludeCode(){return sa.projectionMercator.vertexSource}get subdivisionGranularity(){return al}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(i){this._errorMeasurement||(this._errorMeasurement=new Da(i));const u=s.U(this._errorQueryLatitudeDegrees),p=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,g=this._errorMeasurement.updateErrorLoop(u,p),_=I.now();g!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=g,this._errorMeasurementLastChangeTime=_);const S=Math.min(Math.max((_-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=s.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,s.bl(S))}_getMeshKey(i){return`${i.granularity.toString(36)}_${i.generateBorders?"b":""}${i.extendToNorthPole?"n":""}${i.extendToSouthPole?"s":""}`}getMeshFromTileID(i,u,p,g,_){const S=(_==="stencil"?al.stencil:al.tile).getGranularityForZoomLevel(u.z);return this._getMesh(i,{granularity:S,generateBorders:p,extendToNorthPole:u.y===0&&g,extendToSouthPole:u.y===(1<<u.z)-1&&g})}_getMesh(i,u){const p=this._getMeshKey(u);if(p in this._tileMeshCache)return this._tileMeshCache[p];const g=function(_,S){const C=_f(S,"16bit"),M=s.aL.deserialize({arrayBuffer:C.vertices,length:C.vertices.byteLength/2/2}),R=s.aN.deserialize({arrayBuffer:C.indices,length:C.indices.byteLength/2/3});return new ns(_.createVertexBuffer(M,Do.members),_.createIndexBuffer(R),s.aM.simpleSegment(0,0,M.length,R.length))}(i,u);return this._tileMeshCache[p]=g,g}recalculate(i){}hasTransition(){const i=I.now();let u=!1;return u=u||(i-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(i){this._errorQueryLatitudeDegrees=i}}const Ru=new s.r({type:new s.D(s.v.projection.type)});class Nu extends s.E{constructor(i){super(),this._transitionable=new s.t(Ru),this.setProjection(i),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0)),this._mercatorProjection=new Xt,this._verticalPerspectiveProjection=new dc}get transitionState(){const i=this.properties.get("type");if(typeof i=="string"&&i==="mercator")return 0;if(typeof i=="string"&&i==="vertical-perspective")return 1;if(i instanceof s.bm){if(i.from==="vertical-perspective"&&i.to==="mercator")return 1-i.transition;if(i.from==="mercator"&&i.to==="vertical-perspective")return i.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(i){this._mercatorProjection.updateGPUdependent(i),this._verticalPerspectiveProjection.updateGPUdependent(i)}getMeshFromTileID(i,u,p,g,_){return this.currentProjection.getMeshFromTileID(i,u,p,g,_)}setProjection(i){this._transitionable.setValue("type",(i==null?void 0:i.type)||"mercator")}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}setErrorQueryLatitudeDegrees(i){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(i),this._mercatorProjection.setErrorQueryLatitudeDegrees(i)}}function $u(v){const i=ol(v.worldSize,v.center.lat);return 2*Math.PI*i}function la(v,i,u,p,g){const _=1/(1<<g),S=i/s.$*_+p*_,C=s.bo((v/s.$*_+u*_)*Math.PI*2+Math.PI,2*Math.PI),M=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,R=Math.cos(M),$=new Float64Array(3);return $[0]=Math.sin(C)*R,$[1]=Math.sin(M),$[2]=Math.cos(C)*R,$}function kn(v){return function(i,u){const p=Math.cos(u),g=new Float64Array(3);return g[0]=Math.sin(i)*p,g[1]=Math.sin(u),g[2]=Math.cos(i)*p,g}(v.lng*Math.PI/180,v.lat*Math.PI/180)}function ol(v,i){return v/(2*Math.PI)/Math.cos(i*Math.PI/180)}function fc(v){const i=Math.asin(v[1])/Math.PI*180,u=Math.sqrt(v[0]*v[0]+v[2]*v[2]);if(u>1e-6){const p=v[0]/u,g=Math.acos(v[2]/u),_=(p>0?g:-g)/Math.PI*180;return new s.S(s.aO(_,-180,180),i)}return new s.S(0,i)}function ss(v){return Math.cos(v*Math.PI/180)}function Qr(v,i){const u=ss(v),p=ss(i);return s.ak(p/u)}function Lg(v,i){const u=v.rotate(i.bearingInRadians),p=i.zoom+Qr(i.center.lat,0),g=s.bk(1/ss(i.center.lat),1/ss(Math.min(Math.abs(i.center.lat),60)),s.bn(p,7,3,0,1)),_=360/$u({worldSize:i.worldSize,center:{lat:i.center.lat}});return new s.S(i.center.lng-u.x*_*g,s.ah(i.center.lat+u.y*_,-s.ai,s.ai))}function pc(v){const i=.5*v,u=Math.sin(i),p=Math.cos(i);return Math.log(u+p)-Math.log(p-u)}function xf(v,i,u,p){const g=v.lat+u*p;if(Math.abs(u)>1){const _=(Math.sign(v.lat+u)!==Math.sign(v.lat)?-Math.abs(v.lat):Math.abs(v.lat))*Math.PI/180,S=Math.abs(v.lat+u)*Math.PI/180,C=pc(_+p*(S-_)),M=pc(_),R=pc(S);return new s.S(v.lng+i*((C-M)/(R-M)),g)}return new s.S(v.lng+i*p,g)}class Sx{constructor(i){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=i}swapBuffers(){if(!this._hadAnyChanges)return;const i=this._cachePrevious;this._cachePrevious=this._cache,this._cache=i,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(i,u,p,g){const _=`${i.z}_${i.x}_${i.y}_${g!=null&&g.terrain?"t":""}`,S=this._cache.get(_);if(S)return S;const C=this._cachePrevious.get(_);if(C)return this._cache.set(_,C),C;const M=this._boundingVolumeFactory(i,u,p,g);return this._cache.set(_,M),this._hadAnyChanges=!0,M}}class sl{constructor(i,u,p,g){this.min=p,this.max=g,this.points=i,this.planes=u}static fromAabb(i,u){const p=[];for(let g=0;g<8;g++)p.push([1&~g?i[0]:u[0],(g>>1&1)==1?u[1]:i[1],(g>>2&1)==1?u[2]:i[2]]);return new sl(p,[[-1,0,0,u[0]],[1,0,0,-i[0]],[0,-1,0,u[1]],[0,1,0,-i[1]],[0,0,-1,u[2]],[0,0,1,-i[2]]],i,u)}static fromCenterSizeAngles(i,u,p){const g=s.br([],p[0],p[1],p[2]),_=s.bs([],[u[0],0,0],g),S=s.bs([],[0,u[1],0],g),C=s.bs([],[0,0,u[2]],g),M=[...i],R=[...i];for(let G=0;G<8;G++)for(let V=0;V<3;V++){const X=i[V]+_[V]*(1&~G?-1:1)+S[V]*((G>>1&1)==1?1:-1)+C[V]*((G>>2&1)==1?1:-1);M[V]=Math.min(M[V],X),R[V]=Math.max(R[V],X)}const $=[];for(let G=0;G<8;G++){const V=[...i];s.aS(V,V,s.aR([],_,1&~G?-1:1)),s.aS(V,V,s.aR([],S,(G>>1&1)==1?1:-1)),s.aS(V,V,s.aR([],C,(G>>2&1)==1?1:-1)),$.push(V)}return new sl($,[[..._,-s.aX(_,$[0])],[...S,-s.aX(S,$[0])],[...C,-s.aX(C,$[0])],[-_[0],-_[1],-_[2],-s.aX(_,$[7])],[-S[0],-S[1],-S[2],-s.aX(S,$[7])],[-C[0],-C[1],-C[2],-s.aX(C,$[7])]],M,R)}intersectsFrustum(i){let u=!0;const p=this.points.length,g=this.planes.length,_=i.planes.length,S=i.points.length;for(let C=0;C<_;C++){const M=i.planes[C];let R=0;for(let $=0;$<p;$++){const G=this.points[$];M[0]*G[0]+M[1]*G[1]+M[2]*G[2]+M[3]>=0&&R++}if(R===0)return 0;R<p&&(u=!1)}if(u)return 2;for(let C=0;C<g;C++){const M=this.planes[C];let R=0;for(let $=0;$<S;$++){const G=i.points[$];M[0]*G[0]+M[1]*G[1]+M[2]*G[2]+M[3]>=0&&R++}if(R===0)return 0}return 1}intersectsPlane(i){const u=this.points.length;let p=0;for(let g=0;g<u;g++){const _=this.points[g];i[0]*_[0]+i[1]*_[1]+i[2]*_[2]+i[3]>=0&&p++}return p===u?2:p===0?0:1}}function zn(v,i,u){const p=v-i;return p<0?-p:Math.max(0,p-u)}function mc(v,i,u,p,g){const _=v-u;let S;return S=_<0?Math.min(-_,1+_-g):_>1?Math.min(Math.max(_-g,0),1-_):0,Math.max(S,zn(i,p,g))}class Ra{constructor(){this._boundingVolumeCache=new Sx(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(i,u,p,g){const _=1<<p.z,S=1/_,C=p.x/_,M=p.y/_;let R=2;return R=Math.min(R,mc(i,u,C,M,S)),R=Math.min(R,mc(i,u,C+.5,-M-S,S)),R=Math.min(R,mc(i,u,C+.5,2-M-S,S)),R}getWrap(i,u,p){const g=1<<u.z,_=1/g,S=u.x/g,C=zn(i.x,S,_),M=zn(i.x,S-1,_),R=zn(i.x,S+1,_),$=Math.min(C,M,R);return $===R?1:$===M?-1:0}allowVariableZoom(i,u){return wt(i,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(i,u,p,g){return this._boundingVolumeCache.getTileBoundingVolume(i,u,p,g)}_computeTileBoundingVolume(i,u,p,g){var _,S;let C=0,M=0;if(g!=null&&g.terrain){const R=new s.Z(i.z,u,i.z,i.x,i.y),$=g.terrain.getMinMaxElevation(R);C=(_=$.minElevation)!==null&&_!==void 0?_:Math.min(0,p),M=(S=$.maxElevation)!==null&&S!==void 0?S:Math.max(0,p)}if(C/=s.bu,M/=s.bu,C+=1,M+=1,i.z<=0)return sl.fromAabb([-M,-M,-M],[M,M,M]);if(i.z===1)return sl.fromAabb([i.x===0?-M:0,i.y===0?0:-M,-M],[i.x===0?0:M,i.y===0?M:0,M]);{const R=[la(0,0,i.x,i.y,i.z),la(s.$,0,i.x,i.y,i.z),la(s.$,s.$,i.x,i.y,i.z),la(0,s.$,i.x,i.y,i.z)],$=[];for(const De of R)$.push(s.aR([],De,M));if(M!==C)for(const De of R)$.push(s.aR([],De,C));i.y===0&&$.push([0,1,0]),i.y===(1<<i.z)-1&&$.push([0,-1,0]);const G=[1,1,1],V=[-1,-1,-1];for(const De of $)for(let $e=0;$e<3;$e++)G[$e]=Math.min(G[$e],De[$e]),V[$e]=Math.max(V[$e],De[$e]);const X=la(s.$/2,s.$/2,i.x,i.y,i.z),Q=s.aW([],[0,1,0],X);s.aV(Q,Q);const se=s.aW([],X,Q);s.aV(se,se);const oe=s.aW([],R[2],R[1]);s.aV(oe,oe);const le=s.aW([],R[0],R[3]);s.aV(le,le),$.push(s.aR([],X,M)),i.y>=(1<<i.z)/2&&$.push(s.aR([],la(s.$/2,0,i.x,i.y,i.z),M)),i.y<(1<<i.z)/2&&$.push(s.aR([],la(s.$/2,s.$,i.x,i.y,i.z),M));const ue=gc(X,$),me=gc(se,$),de=[-X[0],-X[1],-X[2],ue.max],ye=[X[0],X[1],X[2],-ue.min],xe=[-se[0],-se[1],-se[2],me.max],pe=[se[0],se[1],se[2],-me.min],ke=[...oe,0],ze=[...le,0],je=[];return i.y===0?je.push(s.bt(ze,ke,de),s.bt(ze,ke,ye)):je.push(s.bt(xe,ke,de),s.bt(xe,ke,ye),s.bt(xe,ze,de),s.bt(xe,ze,ye)),i.y===(1<<i.z)-1?je.push(s.bt(ze,ke,de),s.bt(ze,ke,ye)):je.push(s.bt(pe,ke,de),s.bt(pe,ke,ye),s.bt(pe,ze,de),s.bt(pe,ze,ye)),new sl(je,[de,ye,xe,pe,ke,ze],G,V)}}}function gc(v,i){let u=1/0,p=-1/0;for(const g of i){const _=s.aX(v,g);u=Math.min(u,_),p=Math.max(p,_)}return{min:u,max:p}}class yc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(i){this._helper.setMinZoom(i)}setMaxZoom(i){this._helper.setMaxZoom(i)}setMinPitch(i){this._helper.setMinPitch(i)}setMaxPitch(i){this._helper.setMaxPitch(i)}setRenderWorldCopies(i){this._helper.setRenderWorldCopies(i)}setBearing(i){this._helper.setBearing(i)}setPitch(i){this._helper.setPitch(i)}setRoll(i){this._helper.setRoll(i)}setFov(i){this._helper.setFov(i)}setZoom(i){this._helper.setZoom(i)}setCenter(i){this._helper.setCenter(i)}setElevation(i){this._helper.setElevation(i)}setMinElevationForCurrentTile(i){this._helper.setMinElevationForCurrentTile(i)}setPadding(i){this._helper.setPadding(i)}interpolatePadding(i,u,p){return this._helper.interpolatePadding(i,u,p)}isPaddingEqual(i){return this._helper.isPaddingEqual(i)}resize(i,u){this._helper.resize(i,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(i){this._helper.setMaxBounds(i)}overrideNearFarZ(i,u){this._helper.overrideNearFarZ(i,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(i){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),i)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(i){}constructor(){this._cachedClippingPlane=s.bv(),this._projectionMatrix=s.b9(),this._globeViewProjMatrix32f=s.b8(),this._globeViewProjMatrixNoCorrection=s.b9(),this._globeViewProjMatrixNoCorrectionInverted=s.b9(),this._globeProjMatrixInverted=s.b9(),this._cameraPosition=s.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new li({calcMatrices:()=>{this._calcMatrices()},getConstrained:(i,u)=>this.getConstrained(i,u)}),this._coveringTilesDetailsProvider=new Ra}clone(){const i=new yc;return i.apply(this),i}apply(i,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(i)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const i=s.bp();return i[0]=this._cameraPosition[0],i[1]=this._cameraPosition[1],i[2]=this._cameraPosition[2],i}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(i){const{overscaledTileID:u,applyGlobeMatrix:p}=i,g=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:g,clippingPlane:this._cachedClippingPlane,projectionTransition:p?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(i){const u=this.pitchInRadians,p=this.cameraToCenterDistance/i,g=Math.sin(u)*p,_=Math.cos(u)*p+1,S=1/Math.sqrt(g*g+_*_)*1;let C=-g,M=_;const R=Math.sqrt(C*C+M*M);C/=R,M/=R;const $=[0,C,M];s.bw($,$,[0,0,0],-this.bearingInRadians),s.bx($,$,[0,0,0],-1*this.center.lat*Math.PI/180),s.by($,$,[0,0,0],this.center.lng*Math.PI/180);const G=1/s.aZ($);return s.aR($,$,G),[...$,-S*G]}isLocationOccluded(i){return!this.isSurfacePointVisible(kn(i))}transformLightDirection(i){const u=this._helper._center.lng*Math.PI/180,p=this._helper._center.lat*Math.PI/180,g=Math.cos(p),_=[Math.sin(u)*g,Math.sin(p),Math.cos(u)*g],S=[_[2],0,-_[0]],C=[0,0,0];s.aW(C,S,_),s.aV(S,S),s.aV(C,C);const M=[0,0,0];return s.aV(M,[S[0]*i[0]+C[0]*i[1]+_[0]*i[2],S[1]*i[0]+C[1]*i[1]+_[1]*i[2],S[2]*i[0]+C[2]*i[1]+_[2]*i[2]]),M}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(i,u,p){const g=function(C,M,R){const $=1/(1<<R.z);return new s.a1(C/s.$*$+R.x*$,M/s.$*$+R.y*$)}(i,u,p.canonical),_=(S=g.y,[s.bo(g.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(_[1])}projectTileCoordinates(i,u,p,g){const _=p.canonical,S=la(i,u,_.x,_.y,_.z),C=1+(g?g(i,u):0)/s.bu,M=[S[0]*C,S[1]*C,S[2]*C,1];s.aw(M,M,this._globeViewProjMatrixNoCorrection);const R=this._cachedClippingPlane,$=R[0]*S[0]+R[1]*S[1]+R[2]*S[2]+R[3]<0;return{point:new s.P(M[0]/M[3],M[1]/M[3]),signedDistanceFromCamera:M[3],isOccluded:$}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const i=ol(this.worldSize,this.center.lat),u=s.ba(),p=s.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*i),s.b4(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const g=this.centerOffset;u[8]=2*-g.x/this._helper._width,u[9]=2*g.y/this._helper._height,this._projectionMatrix=s.b5(u),this._globeProjMatrixInverted=s.ba(),s.aq(this._globeProjMatrixInverted,u),s.M(u,u,[0,0,-this.cameraToCenterDistance]),s.b6(u,u,this.rollInRadians),s.b7(u,u,-this.pitchInRadians),s.b6(u,u,this.bearingInRadians),s.M(u,u,[0,0,-i]);const _=s.bp();_[0]=i,_[1]=i,_[2]=i,s.b7(p,u,this.center.lat*Math.PI/180),s.bz(p,p,-this.center.lng*Math.PI/180),s.N(p,p,_),this._globeViewProjMatrixNoCorrection=p,s.b7(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),s.bz(u,u,-this.center.lng*Math.PI/180),s.N(u,u,_),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=s.ba(),s.aq(this._globeViewProjMatrixNoCorrectionInverted,p);const S=s.bp();this._cameraPosition=s.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/i,s.bw(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),s.bx(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),s.bw(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),s.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),s.bx(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),s.by(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(i);const C=s.b5(this._globeViewProjMatrixNoCorrectionInverted);s.N(C,C,[1,1,-1]),this._cachedFrustum=un.fromInvProjectionMatrix(C,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(i){s.w("calculateFogMatrix is not supported on globe projection.");const u=s.ba();return s.ag(u),u}getVisibleUnwrappedCoordinates(i){return[new s.b2(0,i)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(i){i&&s.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(i,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const p=kn(i);s.aR(p,p,1+u/s.bu);const g=s.bv();return s.aw(g,[p[0],p[1],p[2],1],this._globeViewProjMatrixNoCorrection),g[2]/g[3]}populateCache(i){}getBounds(){const i=.5*this.width,u=.5*this.height,p=[new s.P(0,0),new s.P(i,0),new s.P(this.width,0),new s.P(this.width,u),new s.P(this.width,this.height),new s.P(i,this.height),new s.P(0,this.height),new s.P(0,u)],g=[];for(const G of p)g.push(this.unprojectScreenPoint(G));let _=0,S=0,C=0,M=0;const R=this.center;for(const G of g){const V=s.bA(R.lng,G.lng),X=s.bA(R.lat,G.lat);V<S&&(S=V),V>_&&(_=V),X<M&&(M=X),X>C&&(C=X)}const $=[R.lng+S,R.lat+M,R.lng+_,R.lat+C];return this.isSurfacePointOnScreen([0,1,0])&&($[3]=90,$[0]=-180,$[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&($[1]=-90,$[0]=-180,$[2]=180),new Vt($)}getConstrained(i,u){const p=s.ah(i.lat,-s.ai,s.ai),g=s.ah(+u,this.minZoom+Qr(0,p),this.maxZoom);return{center:new s.S(i.lng,p),zoom:g}}calculateCenterFromCameraLngLatAlt(i,u,p,g){return this._helper.calculateCenterFromCameraLngLatAlt(i,u,p,g)}setLocationAtPoint(i,u){const p=kn(this.unprojectScreenPoint(u)),g=kn(i),_=s.bp();s.bB(_);const S=s.bp();s.by(S,p,_,-this.center.lng*Math.PI/180),s.bx(S,S,_,this.center.lat*Math.PI/180);const C=g[0]*g[0]+g[2]*g[2],M=S[0]*S[0];if(C<M)return;const R=Math.sqrt(C-M),$=-R,G=s.bC(g[0],g[2],S[0],R),V=s.bC(g[0],g[2],S[0],$),X=s.bp();s.by(X,g,_,-G);const Q=s.bC(X[1],X[2],S[1],S[2]),se=s.bp();s.by(se,g,_,-V);const oe=s.bC(se[1],se[2],S[1],S[2]),le=.5*Math.PI,ue=Q>=-le&&Q<=le,me=oe>=-le&&oe<=le;let de,ye;if(ue&&me){const ze=this.center.lng*Math.PI/180,je=this.center.lat*Math.PI/180;s.bD(G,ze)+s.bD(Q,je)<s.bD(V,ze)+s.bD(oe,je)?(de=G,ye=Q):(de=V,ye=oe)}else if(ue)de=G,ye=Q;else{if(!me)return;de=V,ye=oe}const xe=de/Math.PI*180,pe=ye/Math.PI*180,ke=this.center.lat;this.setCenter(new s.S(xe,s.ah(pe,-90,90))),this.setZoom(this.zoom+Qr(ke,this.center.lat))}locationToScreenPoint(i,u){const p=kn(i);if(u){const g=u.getElevationForLngLatZoom(i,this._helper._tileZoom);s.aR(p,p,1+g/s.bu)}return this._projectSurfacePointToScreen(p)}_projectSurfacePointToScreen(i){const u=s.bv();return s.aw(u,[...i,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new s.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(i,u){if(u){const p=u.pointCoordinate(i);if(p)return p}return s.a1.fromLngLat(this.unprojectScreenPoint(i))}screenPointToLocation(i,u){var p;return(p=this.screenPointToMercatorCoordinate(i,u))===null||p===void 0?void 0:p.toLngLat()}isPointOnMapSurface(i,u){const p=this._cameraPosition,g=this.getRayDirectionFromPixel(i);return!!this.rayPlanetIntersection(p,g)}getRayDirectionFromPixel(i){const u=s.bv();u[0]=i.x/this.width*2-1,u[1]=-1*(i.y/this.height*2-1),u[2]=1,u[3]=1,s.aw(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const p=s.bp();p[0]=u[0]-this._cameraPosition[0],p[1]=u[1]-this._cameraPosition[1],p[2]=u[2]-this._cameraPosition[2];const g=s.bp();return s.aV(g,p),g}isSurfacePointVisible(i){const u=this._cachedClippingPlane;return u[0]*i[0]+u[1]*i[1]+u[2]*i[2]+u[3]>=0}isSurfacePointOnScreen(i){if(!this.isSurfacePointVisible(i))return!1;const u=s.bv();return s.aw(u,[...i,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(i,u){const p=s.aX(i,u),g=s.bp(),_=s.bp();s.aR(_,u,p),s.aU(g,i,_);const S=1-s.aX(g,g);if(S<0)return null;const C=s.aX(i,i)-1,M=-p+(p<0?1:-1)*Math.sqrt(S),R=C/M,$=M;return{tMin:Math.min(R,$),tMax:Math.max(R,$)}}unprojectScreenPoint(i){const u=this._cameraPosition,p=this.getRayDirectionFromPixel(i),g=this.rayPlanetIntersection(u,p);if(g){const $=s.bp();s.aS($,u,[p[0]*g.tMin,p[1]*g.tMin,p[2]*g.tMin]);const G=s.bp();return s.aV(G,$),fc(G)}const _=this._cachedClippingPlane,S=_[0]*p[0]+_[1]*p[1]+_[2]*p[2],C=-s.b1(_,u)/S,M=s.bp();if(C>0)s.aS(M,u,[p[0]*C,p[1]*C,p[2]*C]);else{const $=s.bp();s.aS($,u,[2*p[0],2*p[1],2*p[2]]);const G=s.b1(this._cachedClippingPlane,$);s.aU(M,$,[this._cachedClippingPlane[0]*G,this._cachedClippingPlane[1]*G,this._cachedClippingPlane[2]*G])}const R=function($){const G=s.bp();return G[0]=$[0]*-$[3],G[1]=$[1]*-$[3],G[2]=$[2]*-$[3],{center:G,radius:Math.sqrt(1-$[3]*$[3])}}(_);return fc(function($,G,V){const X=s.bp();s.aU(X,V,$);const Q=s.bp();return s.bq(Q,$,X,G/s.a$(X)),Q}(R.center,R.radius,M))}getMatrixForModel(i,u){const p=s.S.convert(i),g=1/s.bu,_=s.b9();return s.bz(_,_,p.lng/180*Math.PI),s.b7(_,_,-p.lat/180*Math.PI),s.M(_,_,[0,0,1+u/s.bu]),s.b7(_,_,.5*Math.PI),s.N(_,_,[g,g,g]),_}getProjectionDataForCustomLayer(i=!0){const u=this.getProjectionData({overscaledTileID:new s.Z(0,0,0,0,0),applyGlobeMatrix:i});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(i){}}class vc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(i){this._helper.setMinZoom(i)}setMaxZoom(i){this._helper.setMaxZoom(i)}setMinPitch(i){this._helper.setMinPitch(i)}setMaxPitch(i){this._helper.setMaxPitch(i)}setRenderWorldCopies(i){this._helper.setRenderWorldCopies(i)}setBearing(i){this._helper.setBearing(i)}setPitch(i){this._helper.setPitch(i)}setRoll(i){this._helper.setRoll(i)}setFov(i){this._helper.setFov(i)}setZoom(i){this._helper.setZoom(i)}setCenter(i){this._helper.setCenter(i)}setElevation(i){this._helper.setElevation(i)}setMinElevationForCurrentTile(i){this._helper.setMinElevationForCurrentTile(i)}setPadding(i){this._helper.setPadding(i)}interpolatePadding(i,u,p){return this._helper.interpolatePadding(i,u,p)}isPaddingEqual(i){return this._helper.isPaddingEqual(i)}resize(i,u,p=!0){this._helper.resize(i,u,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(i){this._helper.setMaxBounds(i)}overrideNearFarZ(i,u){this._helper.overrideNearFarZ(i,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(i){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),i)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(i,u){this._globeness=i,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new li({calcMatrices:()=>{this._calcMatrices()},getConstrained:(i,u)=>this.getConstrained(i,u)}),this._globeness=1,this._mercatorTransform=new Tr,this._verticalPerspectiveTransform=new yc}clone(){const i=new vc;return i._globeness=this._globeness,i._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,i.apply(this),i}apply(i){this._helper.apply(i),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(i){const u=this._mercatorTransform.getProjectionData(i),p=this._verticalPerspectiveTransform.getProjectionData(i);return{mainMatrix:this.isGlobeRendering?p.mainMatrix:u.mainMatrix,clippingPlane:p.clippingPlane,tileMercatorCoords:p.tileMercatorCoords,projectionTransition:i.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(i){return this.currentTransform.isLocationOccluded(i)}transformLightDirection(i){return this.currentTransform.transformLightDirection(i)}getPixelScale(){return s.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return s.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(i,u,p){const g=this._mercatorTransform.getPitchedTextCorrection(i,u,p),_=this._verticalPerspectiveTransform.getPitchedTextCorrection(i,u,p);return s.bk(g,_,this._globeness)}projectTileCoordinates(i,u,p,g){return this.currentTransform.projectTileCoordinates(i,u,p,g)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(i){return this.currentTransform.calculateFogMatrix(i)}getVisibleUnwrappedCoordinates(i){return this.currentTransform.getVisibleUnwrappedCoordinates(i)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(i){this._mercatorTransform.recalculateZoomAndCenter(i),this._verticalPerspectiveTransform.recalculateZoomAndCenter(i)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(i,u){return this.currentTransform.lngLatToCameraDepth(i,u)}populateCache(i){this._mercatorTransform.populateCache(i),this._verticalPerspectiveTransform.populateCache(i)}getBounds(){return this.currentTransform.getBounds()}getConstrained(i,u){return this.currentTransform.getConstrained(i,u)}calculateCenterFromCameraLngLatAlt(i,u,p,g){return this._helper.calculateCenterFromCameraLngLatAlt(i,u,p,g)}setLocationAtPoint(i,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(i,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(i,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(i,u){return this.currentTransform.locationToScreenPoint(i,u)}screenPointToMercatorCoordinate(i,u){return this.currentTransform.screenPointToMercatorCoordinate(i,u)}screenPointToLocation(i,u){return this.currentTransform.screenPointToLocation(i,u)}isPointOnMapSurface(i,u){return this.currentTransform.isPointOnMapSurface(i,u)}getRayDirectionFromPixel(i){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(i)}getMatrixForModel(i,u){return this.currentTransform.getMatrixForModel(i,u)}getProjectionDataForCustomLayer(i=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(i);if(!this.isGlobeRendering)return u;const p=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(i);return p.fallbackMatrix=u.mainMatrix,p}getFastPathSimpleProjectionMatrix(i){return this.currentTransform.getFastPathSimpleProjectionMatrix(i)}}class ei{get useGlobeControls(){return!0}handlePanInertia(i,u){const p=Lg(i,u);return Math.abs(p.lng-u.center.lng)>180&&(p.lng=u.center.lng+179.5*Math.sign(p.lng-u.center.lng)),{easingCenter:p,easingOffset:new s.P(0,0)}}handleMapControlsRollPitchBearingZoom(i,u){const p=i.around,g=u.screenPointToLocation(p);i.bearingDelta&&u.setBearing(u.bearing+i.bearingDelta),i.pitchDelta&&u.setPitch(u.pitch+i.pitchDelta),i.rollDelta&&u.setRoll(u.roll+i.rollDelta);const _=u.zoom;i.zoomDelta&&u.setZoom(u.zoom+i.zoomDelta);const S=u.zoom-_;if(S===0)return;const C=s.bA(u.center.lng,g.lng),M=C/(Math.abs(C/180)+1),R=s.bA(u.center.lat,g.lat),$=u.getRayDirectionFromPixel(p),G=u.cameraPosition,V=-1*s.aX(G,$),X=s.bp();s.aS(X,G,[$[0]*V,$[1]*V,$[2]*V]);const Q=s.aZ(X)-1,se=Math.exp(.5*-Math.max(Q-.3,0)),oe=ol(u.worldSize,u.center.lat)/Math.min(u.width,u.height),le=s.bn(oe,.9,.5,1,.25),ue=(1-s.af(-S))*Math.min(se,le),me=u.center.lat,de=u.zoom,ye=new s.S(u.center.lng+M*ue,s.ah(u.center.lat+R*ue,-s.ai,s.ai));u.setLocationAtPoint(g,p);const xe=u.center,pe=s.bn(Math.abs(C),45,85,0,1),ke=s.bn(oe,.75,.35,0,1),ze=Math.pow(Math.max(pe,ke),.25),je=s.bA(xe.lng,ye.lng),De=s.bA(xe.lat,ye.lat);u.setCenter(new s.S(xe.lng+je*ze,xe.lat+De*ze).wrap()),u.setZoom(de+Qr(me,u.center.lat))}handleMapControlsPan(i,u,p){if(!i.panDelta)return;const g=u.center.lat,_=u.zoom;u.setCenter(Lg(i.panDelta,u).wrap()),u.setZoom(_+Qr(g,u.center.lat))}cameraForBoxAndBearing(i,u,p,g,_){const S=Di(i,u,p,g,_),C=u.left/_.width*2-1,M=(_.width-u.right)/_.width*2-1,R=u.top/_.height*-2+1,$=(_.height-u.bottom)/_.height*-2+1,G=s.bA(p.getWest(),p.getEast())<0,V=G?p.getEast():p.getWest(),X=G?p.getWest():p.getEast(),Q=Math.max(p.getNorth(),p.getSouth()),se=Math.min(p.getNorth(),p.getSouth()),oe=V+.5*s.bA(V,X),le=Q+.5*s.bA(Q,se),ue=_.clone();ue.setCenter(S.center),ue.setBearing(S.bearing),ue.setPitch(0),ue.setRoll(0),ue.setZoom(S.zoom);const me=ue.modelViewProjectionMatrix,de=[kn(p.getNorthWest()),kn(p.getNorthEast()),kn(p.getSouthWest()),kn(p.getSouthEast()),kn(new s.S(X,le)),kn(new s.S(V,le)),kn(new s.S(oe,Q)),kn(new s.S(oe,se))],ye=kn(S.center);let xe=Number.POSITIVE_INFINITY;for(const pe of de)C<0&&(xe=ei.getLesserNonNegativeNonNull(xe,ei.solveVectorScale(pe,ye,me,"x",C))),M>0&&(xe=ei.getLesserNonNegativeNonNull(xe,ei.solveVectorScale(pe,ye,me,"x",M))),R>0&&(xe=ei.getLesserNonNegativeNonNull(xe,ei.solveVectorScale(pe,ye,me,"y",R))),$<0&&(xe=ei.getLesserNonNegativeNonNull(xe,ei.solveVectorScale(pe,ye,me,"y",$)));if(Number.isFinite(xe)&&xe!==0)return S.zoom=ue.zoom+s.ak(xe),S;zg()}handleJumpToCenterZoom(i,u){const p=i.center.lat,g=i.getConstrained(u.center?s.S.convert(u.center):i.center,i.zoom).center;i.setCenter(g.wrap());const _=u.zoom!==void 0?+u.zoom:i.zoom+Qr(p,g.lat);i.zoom!==_&&i.setZoom(_)}handleEaseTo(i,u){const p=i.zoom,g=i.center,_=i.padding,S={roll:i.roll,pitch:i.pitch,bearing:i.bearing},C={roll:u.roll===void 0?i.roll:u.roll,pitch:u.pitch===void 0?i.pitch:u.pitch,bearing:u.bearing===void 0?i.bearing:u.bearing},M=u.zoom!==void 0,R=!i.isPaddingEqual(u.padding);let $=!1;const G=u.center?s.S.convert(u.center):g,V=i.getConstrained(G,p).center;ju(i,V);const X=i.clone();X.setCenter(V),X.setZoom(M?+u.zoom:p+Qr(g.lat,G.lat)),X.setBearing(u.bearing);const Q=new s.P(s.ah(i.centerPoint.x+u.offsetAsPoint.x,0,i.width),s.ah(i.centerPoint.y+u.offsetAsPoint.y,0,i.height));X.setLocationAtPoint(V,Q);const se=(u.offset&&u.offsetAsPoint.mag())>0?X.center:V,oe=M?+u.zoom:p+Qr(g.lat,se.lat),le=p+Qr(g.lat,0),ue=oe+Qr(se.lat,0),me=s.bA(g.lng,se.lng),de=s.bA(g.lat,se.lat),ye=s.af(ue-le);return $=oe!==p,{easeFunc:xe=>{if(s.be(S,C)||ui({startEulerAngles:S,endEulerAngles:C,tr:i,k:xe,useSlerp:S.roll!=C.roll}),R&&i.interpolatePadding(_,u.padding,xe),u.around)s.w("Easing around a point is not supported under globe projection."),i.setLocationAtPoint(u.around,u.aroundPoint);else{const pe=ue>le?Math.min(2,ye):Math.max(.5,ye),ke=Math.pow(pe,1-xe),ze=xf(g,me,de,xe*ke);i.setCenter(ze.wrap())}if($){const pe=s.C.number(le,ue,xe)+Qr(0,i.center.lat);i.setZoom(pe)}},isZooming:$,elevationCenter:se}}handleFlyTo(i,u){const p=u.zoom!==void 0,g=i.center,_=i.zoom,S=i.padding,C=!i.isPaddingEqual(u.padding),M=i.getConstrained(s.S.convert(u.center||u.locationAtOffset),_).center,R=p?+u.zoom:i.zoom+Qr(i.center.lat,M.lat),$=i.clone();$.setCenter(M),$.setZoom(R),$.setBearing(u.bearing);const G=new s.P(s.ah(i.centerPoint.x+u.offsetAsPoint.x,0,i.width),s.ah(i.centerPoint.y+u.offsetAsPoint.y,0,i.height));$.setLocationAtPoint(M,G);const V=$.center;ju(i,V);const X=function(de,ye,xe){const pe=kn(ye),ke=kn(xe),ze=s.aX(pe,ke),je=Math.acos(ze),De=$u(de);return je/(2*Math.PI)*De}(i,g,V),Q=_+Qr(g.lat,0),se=R+Qr(V.lat,0),oe=s.af(se-Q);let le;if(typeof u.minZoom=="number"){const de=+u.minZoom+Qr(V.lat,0),ye=Math.min(de,Q,se)+Qr(0,V.lat),xe=i.getConstrained(V,ye).zoom+Qr(V.lat,0);le=s.af(xe-Q)}const ue=s.bA(g.lng,V.lng),me=s.bA(g.lat,V.lat);return{easeFunc:(de,ye,xe,pe)=>{const ke=xf(g,ue,me,xe);C&&i.interpolatePadding(S,u.padding,de);const ze=de===1?V:ke;i.setCenter(ze.wrap());const je=Q+s.ak(ye);i.setZoom(de===1?R:je+Qr(0,ze.lat))},scaleOfZoom:oe,targetCenter:V,scaleOfMinZoom:le,pixelPathLength:X}}static solveVectorScale(i,u,p,g,_){const S=g==="x"?[p[0],p[4],p[8],p[12]]:[p[1],p[5],p[9],p[13]],C=[p[3],p[7],p[11],p[15]],M=i[0]*S[0]+i[1]*S[1]+i[2]*S[2],R=i[0]*C[0]+i[1]*C[1]+i[2]*C[2],$=u[0]*S[0]+u[1]*S[1]+u[2]*S[2],G=u[0]*C[0]+u[1]*C[1]+u[2]*C[2];return $+_*R===M+_*G||C[3]*(M-$)+S[3]*(G-R)+M*G==$*R?null:($+S[3]-_*G-_*C[3])/($-M-_*G+_*R)}static getLesserNonNegativeNonNull(i,u){return u!==null&&u>=0&&u<i?u:i}}class Bg{constructor(i){this._globe=i,this._mercatorCameraHelper=new Qn,this._verticalPerspectiveCameraHelper=new ei}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(i,u){return this.currentHelper.handlePanInertia(i,u)}handleMapControlsRollPitchBearingZoom(i,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(i,u)}handleMapControlsPan(i,u,p){this.currentHelper.handleMapControlsPan(i,u,p)}cameraForBoxAndBearing(i,u,p,g,_){return this.currentHelper.cameraForBoxAndBearing(i,u,p,g,_)}handleJumpToCenterZoom(i,u){this.currentHelper.handleJumpToCenterZoom(i,u)}handleEaseTo(i,u){return this.currentHelper.handleEaseTo(i,u)}handleFlyTo(i,u){return this.currentHelper.handleFlyTo(i,u)}}const zu=(v,i)=>s.y(v,i&&i.filter(u=>u.identifier!=="source.canvas")),Px=s.bE();class bf extends s.E{constructor(i,u={}){var p,g;super(),this._rtlPluginLoaded=()=>{for(const S in this.sourceCaches){const C=this.sourceCaches[S].getSource().type;C!=="vector"&&C!=="geojson"||this.sourceCaches[S].reload()}},this.map=i,this.dispatcher=new Nt(Pt(),i._getMapId()),this.dispatcher.registerMessageHandler("GG",(S,C)=>this.getGlyphs(S,C)),this.dispatcher.registerMessageHandler("GI",(S,C)=>this.getImages(S,C)),this.imageManager=new we,this.imageManager.setEventedParent(this);const _=((p=i._container)===null||p===void 0?void 0:p.lang)||typeof document<"u"&&((g=document.documentElement)===null||g===void 0?void 0:g.lang)||void 0;this.glyphManager=new Ue(i._requestManager,u.localIdeographFontFamily,_),this.lineAtlas=new Be(256,512),this.crossTileSymbolIndex=new il,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",s.bG()),Ao().on(Ia,this._rtlPluginLoaded),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const C=this.sourceCaches[S.sourceId];if(!C)return;const M=C.getSource();if(M&&M.vectorLayerIds)for(const R in this._layers){const $=this._layers[R];$.source===M.id&&this._validateLayer($)}})}setGlobalStateProperty(i,u){var p,g,_;this._checkLoaded();const S=u===null?(_=(g=(p=this.stylesheet.state)===null||p===void 0?void 0:p[i])===null||g===void 0?void 0:g.default)!==null&&_!==void 0?_:null:u;if(s.bH(S,this._globalState[i]))return this;this._globalState[i]=S,this._applyGlobalStateChanges([i])}getGlobalState(){return this._globalState}setGlobalState(i){this._checkLoaded();const u=[];for(const p in i)!s.bH(this._globalState[p],i[p].default)&&(u.push(p),this._globalState[p]=i[p].default);this._applyGlobalStateChanges(u)}_applyGlobalStateChanges(i){if(i.length===0)return;const u=new Set;for(const p in this._layers){const g=this._layers[p],_=g.getLayoutAffectingGlobalStateRefs(),S=g.getPaintAffectingGlobalStateRefs();for(const C of i)if(_.has(C)&&u.add(g.source),S.has(C))for(const{name:M,value:R}of S.get(C))this._updatePaintProperty(g,M,R)}for(const p in this.sourceCaches)u.has(p)&&(this._reloadSource(p),this._changed=!0)}loadURL(i,u={},p){this.fire(new s.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const g=this.map._requestManager.transformRequest(i,"Style");this._loadStyleRequest=new AbortController;const _=this._loadStyleRequest;s.j(g,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,u,p)}).catch(S=>{this._loadStyleRequest=null,S&&!_.signal.aborted&&this.fire(new s.k(S))})}loadJSON(i,u={},p){this.fire(new s.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,I.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(i,u,p)}).catch(()=>{})}loadEmpty(){this.fire(new s.l("dataloading",{dataType:"style"})),this._load(Px,{validate:!1})}_load(i,u,p){var g,_,S;let C=u.transformStyle?u.transformStyle(p,i):i;if(!u.validate||!zu(this,s.z(C))){C=Object.assign({},C),this._loaded=!0,this.stylesheet=C;for(const M in C.sources)this.addSource(M,C.sources[M],{validate:!1});C.sprite?this._loadSprite(C.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(C.glyphs),this._createLayers(),this.light=new Je(this.stylesheet.light),this._setProjectionInternal(((g=this.stylesheet.projection)===null||g===void 0?void 0:g.type)||"mercator"),this.sky=new Le(this.stylesheet.sky),this.map.setTerrain((_=this.stylesheet.terrain)!==null&&_!==void 0?_:null),this.setGlobalState((S=this.stylesheet.state)!==null&&S!==void 0?S:null),this.fire(new s.l("data",{dataType:"style"})),this.fire(new s.l("style.load"))}}_createLayers(){const i=s.bI(this.stylesheet.layers);this.dispatcher.broadcast("SL",i),this._order=i.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of i){const p=s.bJ(u);p.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=p}}_loadSprite(i,u=!1,p=void 0){let g;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(_,S,C,M){return s._(this,void 0,void 0,function*(){const R=Z(_),$=C>1?"@2x":"",G={},V={};for(const{id:X,url:Q}of R){const se=S.transformRequest(re(Q,$,".json"),"SpriteJSON");G[X]=s.j(se,M);const oe=S.transformRequest(re(Q,$,".png"),"SpriteImage");V[X]=W.getImage(oe,M)}return yield Promise.all([...Object.values(G),...Object.values(V)]),function(X,Q){return s._(this,void 0,void 0,function*(){const se={};for(const oe in X){se[oe]={};const le=I.getImageCanvasContext((yield Q[oe]).data),ue=(yield X[oe]).data;for(const me in ue){const{width:de,height:ye,x:xe,y:pe,sdf:ke,pixelRatio:ze,stretchX:je,stretchY:De,content:$e,textFitWidth:at,textFitHeight:lt}=ue[me];se[oe][me]={data:null,pixelRatio:ze,sdf:ke,stretchX:je,stretchY:De,content:$e,textFitWidth:at,textFitHeight:lt,spriteData:{width:de,height:ye,x:xe,y:pe,context:le}}}}return se})}(G,V)})}(i,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(_=>{if(this._spriteRequest=null,_)for(const S in _){this._spritesImagesIds[S]=[];const C=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(M=>!(M in _)):[];for(const M of C)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in _[S]){const R=S==="default"?M:`${S}:${M}`;this._spritesImagesIds[S].push(R),R in this.imageManager.images?this.imageManager.updateImage(R,_[S][M],!1):this.imageManager.addImage(R,_[S][M]),u&&(this._changedImages[R]=!0)}}}).catch(_=>{this._spriteRequest=null,g=_,this.fire(new s.k(g))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"})),p&&p(g)})}_unloadSprite(){for(const i of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(i),this._changedImages[i]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}_validateLayer(i){const u=this.sourceCaches[i.source];if(!u)return;const p=i.sourceLayer;if(!p)return;const g=u.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(p)===-1)&&this.fire(new s.k(new Error(`Source layer "${p}" does not exist on source "${g.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(i,u=!1){const p=this._serializedAllLayers();if(!i||i.length===0)return Object.values(u?s.bK(p):p);const g=[];for(const _ of i)if(p[_]){const S=u?s.bK(p[_]):p[_];g.push(S)}return g}_serializedAllLayers(){let i=this._serializedLayers;if(i)return i;i=this._serializedLayers={};const u=Object.keys(this._layers);for(const p of u){const g=this._layers[p];g.type!=="custom"&&(i[p]=g.serialize())}return i}hasTransitions(){var i,u,p;if(!((i=this.light)===null||i===void 0)&&i.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((p=this.projection)===null||p===void 0)&&p.hasTransition())return!0;for(const g in this.sourceCaches)if(this.sourceCaches[g].hasTransition())return!0;for(const g in this._layers)if(this._layers[g].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const u=this._changed;if(u){const g=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(g.length||_.length)&&this._updateWorkerLayers(g,_);for(const S in this._updatedSources){const C=this._updatedSources[S];if(C==="reload")this._reloadSource(S);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(i);this.light.updateTransitions(i),this.sky.updateTransitions(i),this._resetUpdates()}const p={};for(const g in this.sourceCaches){const _=this.sourceCaches[g];p[g]=_.used,_.used=!1}for(const g of this._order){const _=this._layers[g];_.recalculate(i,this._availableImages),!_.isHidden(i.zoom)&&_.source&&(this.sourceCaches[_.source].used=!0)}for(const g in p){const _=this.sourceCaches[g];!!p[g]!=!!_.used&&_.fire(new s.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(i),this.sky.recalculate(i),this.projection.recalculate(i),this.z=i.zoom,u&&this.fire(new s.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(i,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(i,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(i,u={}){var p;this._checkLoaded();const g=this.serialize();if(i=u.transformStyle?u.transformStyle(g,i):i,((p=u.validate)===null||p===void 0||p)&&zu(this,s.z(i)))return!1;(i=s.bK(i)).layers=s.bI(i.layers);const _=s.bL(g,i),S=this._getOperationsToPerform(_);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const C of S.operations)C();return this.stylesheet=i,this._serializedLayers=null,!0}_getOperationsToPerform(i){const u=[],p=[];for(const g of i)switch(g.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push(()=>this.addLayer.apply(this,g.args));break;case"removeLayer":u.push(()=>this.removeLayer.apply(this,g.args));break;case"setPaintProperty":u.push(()=>this.setPaintProperty.apply(this,g.args));break;case"setLayoutProperty":u.push(()=>this.setLayoutProperty.apply(this,g.args));break;case"setFilter":u.push(()=>this.setFilter.apply(this,g.args));break;case"addSource":u.push(()=>this.addSource.apply(this,g.args));break;case"removeSource":u.push(()=>this.removeSource.apply(this,g.args));break;case"setLayerZoomRange":u.push(()=>this.setLayerZoomRange.apply(this,g.args));break;case"setLight":u.push(()=>this.setLight.apply(this,g.args));break;case"setGeoJSONSourceData":u.push(()=>this.setGeoJSONSourceData.apply(this,g.args));break;case"setGlyphs":u.push(()=>this.setGlyphs.apply(this,g.args));break;case"setSprite":u.push(()=>this.setSprite.apply(this,g.args));break;case"setTerrain":u.push(()=>this.map.setTerrain.apply(this,g.args));break;case"setSky":u.push(()=>this.setSky.apply(this,g.args));break;case"setProjection":this.setProjection.apply(this,g.args);break;case"setGlobalState":u.push(()=>this.setGlobalState.apply(this,g.args));break;case"setTransition":u.push(()=>{});break;default:p.push(g.command)}return{operations:u,unimplemented:p}}addImage(i,u){if(this.getImage(i))return this.fire(new s.k(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,u),this._afterImageUpdated(i)}updateImage(i,u){this.imageManager.updateImage(i,u)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new s.k(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,u,p={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(s.z.source,`sources.${i}`,u,null,p))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const g=this.sourceCaches[i]=new Ht(i,u,this.dispatcher);g.style=this,g.setEventedParent(this,()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:i})),g.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===i)return this.fire(new s.k(new Error(`Source "${i}" cannot be removed while layer "${p}" is using it.`)));const u=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],u.fire(new s.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,u){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const p=this.sourceCaches[i].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(u),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,u,p={}){this._checkLoaded();const g=i.id;if(this.getLayer(g))return void this.fire(new s.k(new Error(`Layer "${g}" already exists on this map.`)));let _;if(i.type==="custom"){if(zu(this,s.bM(i)))return;_=s.bJ(i)}else{if("source"in i&&typeof i.source=="object"&&(this.addSource(g,i.source),i=s.bK(i),i=s.e(i,{source:g})),this._validate(s.z.layer,`layers.${g}`,i,{arrayIndex:-1},p))return;_=s.bJ(i),this._validateLayer(_),_.setEventedParent(this,{layer:{id:g}})}const S=u?this._order.indexOf(u):this._order.length;if(u&&S===-1)this.fire(new s.k(new Error(`Cannot add layer "${g}" before non-existing layer "${u}".`)));else{if(this._order.splice(S,0,g),this._layerOrderChanged=!0,this._layers[g]=_,this._removedLayers[g]&&_.source&&_.type!=="custom"){const C=this._removedLayers[g];delete this._removedLayers[g],C.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map)}}moveLayer(i,u){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new s.k(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===u)return;const p=this._order.indexOf(i);this._order.splice(p,1);const g=u?this._order.indexOf(u):this._order.length;u&&g===-1?this.fire(new s.k(new Error(`Cannot move layer "${i}" before non-existing layer "${u}".`))):(this._order.splice(g,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const u=this._layers[i];if(!u)return void this.fire(new s.k(new Error(`Cannot remove non-existing layer "${i}".`)));u.setEventedParent(null);const p=this._order.indexOf(i);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=u,delete this._layers[i],this._serializedLayers&&delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],u.onRemove&&u.onRemove(this.map)}getLayer(i){return this._layers[i]}getLayersOrder(){return[...this._order]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,u,p){this._checkLoaded();const g=this.getLayer(i);g?g.minzoom===u&&g.maxzoom===p||(u!=null&&(g.minzoom=u),p!=null&&(g.maxzoom=p),this._updateLayer(g)):this.fire(new s.k(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,u,p={}){this._checkLoaded();const g=this.getLayer(i);if(g){if(!s.bH(g.filter,u))return u==null?(g.setFilter(void 0),void this._updateLayer(g)):void(this._validate(s.z.filter,`layers.${g.id}.filter`,u,null,p)||(g.setFilter(s.bK(u)),this._updateLayer(g)))}else this.fire(new s.k(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return s.bK(this.getLayer(i).filter)}setLayoutProperty(i,u,p,g={}){this._checkLoaded();const _=this.getLayer(i);_?s.bH(_.getLayoutProperty(u),p)||(_.setLayoutProperty(u,p,g),this._updateLayer(_)):this.fire(new s.k(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,u){const p=this.getLayer(i);if(p)return p.getLayoutProperty(u);this.fire(new s.k(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,u,p,g={}){this._checkLoaded();const _=this.getLayer(i);_?s.bH(_.getPaintProperty(u),p)||this._updatePaintProperty(_,u,p,g):this.fire(new s.k(new Error(`Cannot style non-existing layer "${i}".`)))}_updatePaintProperty(i,u,p,g={}){i.setPaintProperty(u,p,g)&&this._updateLayer(i),this._changed=!0,this._updatedPaintProps[i.id]=!0,this._serializedLayers=null}getPaintProperty(i,u){return this.getLayer(i).getPaintProperty(u)}setFeatureState(i,u){this._checkLoaded();const p=i.source,g=i.sourceLayer,_=this.sourceCaches[p];if(_===void 0)return void this.fire(new s.k(new Error(`The source '${p}' does not exist in the map's style.`)));const S=_.getSource().type;S==="geojson"&&g?this.fire(new s.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||g?(i.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),_.setFeatureState(g,i.id,u)):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,u){this._checkLoaded();const p=i.source,g=this.sourceCaches[p];if(g===void 0)return void this.fire(new s.k(new Error(`The source '${p}' does not exist in the map's style.`)));const _=g.getSource().type,S=_==="vector"?i.sourceLayer:void 0;_!=="vector"||S?u&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new s.k(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(S,i.id,u):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const u=i.source,p=i.sourceLayer,g=this.sourceCaches[u];if(g!==void 0)return g.getSource().type!=="vector"||p?(i.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),g.getFeatureState(p,i.id)):void this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const i=s.bN(this.sourceCaches,_=>_.serialize()),u=this._serializeByIds(this._order,!0),p=this.map.getTerrain()||void 0,g=this.stylesheet;return s.bO({version:g.version,name:g.name,metadata:g.metadata,light:g.light,sky:g.sky,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,projection:g.projection,sources:i,layers:u,terrain:p},_=>_!==void 0)}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(i){const u=S=>this._layers[S].type==="fill-extrusion",p={},g=[];for(let S=this._order.length-1;S>=0;S--){const C=this._order[S];if(u(C)){p[C]=S;for(const M of i){const R=M[C];if(R)for(const $ of R)g.push($)}}}g.sort((S,C)=>C.intersectionZ-S.intersectionZ);const _=[];for(let S=this._order.length-1;S>=0;S--){const C=this._order[S];if(u(C))for(let M=g.length-1;M>=0;M--){const R=g[M].feature;if(p[R.layer.id]<S)break;_.push(R),g.pop()}else for(const M of i){const R=M[C];if(R)for(const $ of R)_.push($.feature)}}return _}queryRenderedFeatures(i,u,p){u&&u.filter&&this._validate(s.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);const g={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new s.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const R of u.layers){const $=this._layers[R];if(!$)return this.fire(new s.k(new Error(`The layer '${R}' does not exist in the map's style and cannot be queried for features.`))),[];g[$.source]=!0}}const _=[];u.availableImages=this._availableImages;const S=this._serializedAllLayers(),C=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,M=Object.assign(Object.assign({},u),{layers:C});for(const R in this.sourceCaches)u.layers&&!g[R]||_.push(pt(this.sourceCaches[R],this._layers,S,i,M,p,this.map.terrain?($,G,V)=>this.map.terrain.getElevation($,G,V):void 0));return this.placement&&_.push(function(R,$,G,V,X,Q,se){const oe={},le=Q.queryRenderedSymbols(V),ue=[];for(const me of Object.keys(le).map(Number))ue.push(se[me]);ue.sort(Dt);for(const me of ue){const de=me.featureIndex.lookupSymbolFeatures(le[me.bucketInstanceId],$,me.bucketIndex,me.sourceLayerIndex,X.filter,X.layers,X.availableImages,R);for(const ye in de){const xe=oe[ye]=oe[ye]||[],pe=de[ye];pe.sort((ke,ze)=>{const je=me.featureSortOrder;if(je){const De=je.indexOf(ke.featureIndex);return je.indexOf(ze.featureIndex)-De}return ze.featureIndex-ke.featureIndex});for(const ke of pe)xe.push(ke)}}return function(me,de,ye){for(const xe in me)for(const pe of me[xe])zt(pe,ye[de[xe].source]);return me}(oe,R,G)}(this._layers,S,this.sourceCaches,i,M,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(i,u){u&&u.filter&&this._validate(s.z.filter,"querySourceFeatures.filter",u.filter,null,u);const p=this.sourceCaches[i];return p?function(g,_){const S=g.getRenderableIds().map(R=>g.getTileByID(R)),C=[],M={};for(let R=0;R<S.length;R++){const $=S[R],G=$.tileID.canonical.key;M[G]||(M[G]=!0,$.querySourceFeatures(C,_))}return C}(p,u):[]}getLight(){return this.light.getLight()}setLight(i,u={}){this._checkLoaded();const p=this.light.getLight();let g=!1;for(const S in i)if(!s.bH(i[S],p[S])){g=!0;break}if(!g)return;const _={now:I.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,u),this.light.updateTransitions(_)}getProjection(){var i;return(i=this.stylesheet)===null||i===void 0?void 0:i.projection}setProjection(i){if(this._checkLoaded(),this.projection){if(this.projection.name===i.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=i,this._setProjectionInternal(i.type)}getSky(){var i;return(i=this.stylesheet)===null||i===void 0?void 0:i.sky}setSky(i,u={}){this._checkLoaded();const p=this.getSky();let g=!1;if(!i&&!p)return;if(i&&!p)g=!0;else if(!i&&p)g=!0;else for(const S in i)if(!s.bH(i[S],p[S])){g=!0;break}if(!g)return;const _={now:I.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=i,this.sky.setSky(i,u),this.sky.updateTransitions(_)}_setProjectionInternal(i){const u=function(p){if(Array.isArray(p)){const g=new Nu({type:p});return{projection:g,transform:new vc,cameraHelper:new Bg(g)}}switch(p){case"mercator":return{projection:new Xt,transform:new Tr,cameraHelper:new Qn};case"globe":{const g=new Nu({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:g,transform:new vc,cameraHelper:new Bg(g)}}case"vertical-perspective":return{projection:new dc,transform:new yc,cameraHelper:new ei};default:return s.w(`Unknown projection name: ${p}. Falling back to mercator projection.`),{projection:new Xt,transform:new Tr,cameraHelper:new Qn}}}(i);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const p in this.sourceCaches)this.sourceCaches[p].reload()}_validate(i,u,p,g,_={}){return(!_||_.validate!==!1)&&zu(this,i.call(s.z,s.e({key:u,style:this.serialize(),value:p,styleSpec:s.v},g)))}_remove(i=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ao().off(Ia,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const p=this.sourceCaches[u];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),i&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(i)}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const u in this.sourceCaches)this.sourceCaches[u].update(i,this.map.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,u,p,g,_=!1){let S=!1,C=!1;const M={};for(const R of this._order){const $=this._layers[R];if($.type!=="symbol")continue;if(!M[$.source]){const V=this.sourceCaches[$.source];M[$.source]=V.getRenderableIds(!0).map(X=>V.getTileByID(X)).sort((X,Q)=>Q.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(Q.tileID)?-1:1))}const G=this.crossTileSymbolIndex.addLayer($,M[$.source],i.center.lng);S=S||G}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((_=_||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(I.now(),i.zoom))&&(this.pauseablePlacement=new gf(i,this.map.terrain,this._order,_,u,p,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(I.now()),C=!0),S&&this.pauseablePlacement.placement.setStale()),C||S)for(const R of this._order){const $=this._layers[R];$.type==="symbol"&&this.placement.updateLayerOpacities($,M[$.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(I.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,u){return s._(this,void 0,void 0,function*(){const p=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const g=this.sourceCaches[u.source];return g&&g.setDependencies(u.tileID.key,u.type,u.icons),p})}getGlyphs(i,u){return s._(this,void 0,void 0,function*(){const p=yield this.glyphManager.getGlyphs(u.stacks),g=this.sourceCaches[u.source];return g&&g.setDependencies(u.tileID.key,u.type,[""]),p})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(i,u={}){this._checkLoaded(),i&&this._validate(s.z.glyphs,"glyphs",i,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=i,this.glyphManager.entries={},this.glyphManager.setURL(i))}addSprite(i,u,p={},g){this._checkLoaded();const _=[{id:i,url:u}],S=[...Z(this.stylesheet.sprite),..._];this._validate(s.z.sprite,"sprite",S,null,p)||(this.stylesheet.sprite=S,this._loadSprite(_,!0,g))}removeSprite(i){this._checkLoaded();const u=Z(this.stylesheet.sprite);if(u.find(p=>p.id===i)){if(this._spritesImagesIds[i])for(const p of this._spritesImagesIds[i])this.imageManager.removeImage(p),this._changedImages[p]=!0;u.splice(u.findIndex(p=>p.id===i),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[i],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}else this.fire(new s.k(new Error(`Sprite "${i}" doesn't exists on this map.`)))}getSprite(){return Z(this.stylesheet.sprite)}setSprite(i,u={},p){this._checkLoaded(),i&&this._validate(s.z.sprite,"sprite",i,null,u)||(this.stylesheet.sprite=i,i?this._loadSprite(i,!0,p):(this._unloadSprite(),p&&p(null)))}}var Tx=s.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class kx{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,u,p,g,_,S,C,M,R){this.context=i;let $=this.boundPaintVertexBuffers.length!==g.length;for(let G=0;!$&&G<g.length;G++)this.boundPaintVertexBuffers[G]!==g[G]&&($=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==p||$||this.boundIndexBuffer!==_||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==M||this.boundDynamicVertexBuffer3!==R?this.freshBind(u,p,g,_,S,C,M,R):(i.bindVertexArray.set(this.vao),C&&C.bind(),_&&_.dynamicDraw&&_.bind(),M&&M.bind(),R&&R.bind())}freshBind(i,u,p,g,_,S,C,M){const R=i.numAttributes,$=this.context,G=$.gl;this.vao&&this.destroy(),this.vao=$.createVertexArray(),$.bindVertexArray.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=g,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=M,u.enableAttributes(G,i);for(const V of p)V.enableAttributes(G,i);S&&S.enableAttributes(G,i),C&&C.enableAttributes(G,i),M&&M.enableAttributes(G,i),u.bind(),u.setVertexAttribPointers(G,i,_);for(const V of p)V.bind(),V.setVertexAttribPointers(G,i,_);S&&(S.bind(),S.setVertexAttribPointers(G,i,_)),g&&g.bind(),C&&(C.bind(),C.setVertexAttribPointers(G,i,_)),M&&(M.bind(),M.setVertexAttribPointers(G,i,_)),$.currentNumAttributes=R}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Lu=(v,i,u,p,g)=>({u_texture:0,u_ele_delta:v,u_fog_matrix:i,u_fog_color:u?u.properties.get("fog-color"):s.bf.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:g?0:u?u.calculateFogBlendOpacity(p):0,u_horizon_color:u?u.properties.get("horizon-color"):s.bf.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:g?1:0}),wf={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ls(v){const i=[];for(let u=0;u<v.length;u++){if(v[u]===null)continue;const p=v[u].split(" ");i.push(p.pop())}return i}class Sf{constructor(i,u,p,g,_,S,C,M,R=[]){const $=i.gl;this.program=$.createProgram();const G=ls(u.staticAttributes),V=p?p.getBinderAttributes():[],X=G.concat(V),Q=sa.prelude.staticUniforms?ls(sa.prelude.staticUniforms):[],se=C.staticUniforms?ls(C.staticUniforms):[],oe=u.staticUniforms?ls(u.staticUniforms):[],le=p?p.getBinderUniforms():[],ue=Q.concat(se).concat(oe).concat(le),me=[];for(const je of ue)me.indexOf(je)<0&&me.push(je);const de=p?p.defines():[];Oa($)&&de.unshift("#version 300 es"),_&&de.push("#define OVERDRAW_INSPECTOR;"),S&&de.push("#define TERRAIN3D;"),M&&de.push(M),R&&de.push(...R);let ye=de.concat(sa.prelude.fragmentSource,C.fragmentSource,u.fragmentSource).join(`
`),xe=de.concat(sa.prelude.vertexSource,C.vertexSource,u.vertexSource).join(`
`);Oa($)||(ye=function(je){return je.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(ye),xe=function(je){return je.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(xe));const pe=$.createShader($.FRAGMENT_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);if($.shaderSource(pe,ye),$.compileShader(pe),!$.getShaderParameter(pe,$.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${$.getShaderInfoLog(pe)}`);$.attachShader(this.program,pe);const ke=$.createShader($.VERTEX_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);if($.shaderSource(ke,xe),$.compileShader(ke),!$.getShaderParameter(ke,$.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${$.getShaderInfoLog(ke)}`);$.attachShader(this.program,ke),this.attributes={};const ze={};this.numAttributes=X.length;for(let je=0;je<this.numAttributes;je++)X[je]&&($.bindAttribLocation(this.program,je,X[je]),this.attributes[X[je]]=je);if($.linkProgram(this.program),!$.getProgramParameter(this.program,$.LINK_STATUS))throw new Error(`Program failed to link: ${$.getProgramInfoLog(this.program)}`);$.deleteShader(ke),$.deleteShader(pe);for(let je=0;je<me.length;je++){const De=me[je];if(De&&!ze[De]){const $e=$.getUniformLocation(this.program,De);$e&&(ze[De]=$e)}}this.fixedUniforms=g(i,ze),this.terrainUniforms=((je,De)=>({u_depth:new s.bP(je,De.u_depth),u_terrain:new s.bP(je,De.u_terrain),u_terrain_dim:new s.bg(je,De.u_terrain_dim),u_terrain_matrix:new s.bR(je,De.u_terrain_matrix),u_terrain_unpack:new s.bS(je,De.u_terrain_unpack),u_terrain_exaggeration:new s.bg(je,De.u_terrain_exaggeration)}))(i,ze),this.projectionUniforms=((je,De)=>({u_projection_matrix:new s.bR(je,De.u_projection_matrix),u_projection_tile_mercator_coords:new s.bS(je,De.u_projection_tile_mercator_coords),u_projection_clipping_plane:new s.bS(je,De.u_projection_clipping_plane),u_projection_transition:new s.bg(je,De.u_projection_transition),u_projection_fallback_matrix:new s.bR(je,De.u_projection_fallback_matrix)}))(i,ze),this.binderUniforms=p?p.getUniforms(i,ze):[]}draw(i,u,p,g,_,S,C,M,R,$,G,V,X,Q,se,oe,le,ue,me){const de=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(p),i.setStencilMode(g),i.setColorMode(_),i.setCullFace(S),M){i.activeTexture.set(de.TEXTURE2),de.bindTexture(de.TEXTURE_2D,M.depthTexture),i.activeTexture.set(de.TEXTURE3),de.bindTexture(de.TEXTURE_2D,M.texture);for(const xe in this.terrainUniforms)this.terrainUniforms[xe].set(M[xe])}if(R)for(const xe in R)this.projectionUniforms[wf[xe]].set(R[xe]);if(C)for(const xe in this.fixedUniforms)this.fixedUniforms[xe].set(C[xe]);oe&&oe.setUniforms(i,this.binderUniforms,Q,{zoom:se});let ye=0;switch(u){case de.LINES:ye=2;break;case de.TRIANGLES:ye=3;break;case de.LINE_STRIP:ye=1}for(const xe of X.get()){const pe=xe.vaos||(xe.vaos={});(pe[$]||(pe[$]=new kx)).bind(i,this,G,oe?oe.getPaintVertexBuffers():[],V,xe.vertexOffset,le,ue,me),de.drawElements(u,xe.primitiveLength*ye,de.UNSIGNED_SHORT,xe.primitiveOffset*ye*2)}}}function Bu(v,i,u){const p=1/s.aC(u,1,i.transform.tileZoom),g=Math.pow(2,u.tileID.overscaledZ),_=u.tileSize*Math.pow(2,i.transform.tileZoom)/g,S=_*(u.tileID.canonical.x+u.tileID.wrap*g),C=_*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[p,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[S>>16,C>>16],u_pixel_coord_lower:[65535&S,65535&C]}}const ca=(v,i,u,p)=>{const g=v.style.light,_=g.properties.get("position"),S=[_.x,_.y,_.z],C=s.bV();g.properties.get("anchor")==="viewport"&&s.bW(C,v.transform.bearingInRadians),s.bX(S,S,C);const M=v.transform.transformLightDirection(S),R=g.properties.get("color");return{u_lightpos:S,u_lightpos_globe:M,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[R.r,R.g,R.b],u_vertical_gradient:+i,u_opacity:u,u_fill_translate:p}},Ex=(v,i,u,p,g,_,S)=>s.e(ca(v,i,u,p),Bu(_,v,S),{u_height_factor:-Math.pow(2,g.overscaledZ)/S.tileSize/8}),Fu=(v,i,u,p)=>s.e(Bu(i,v,u),{u_fill_translate:p}),_c=(v,i)=>({u_world:v,u_fill_translate:i}),xc=(v,i,u,p,g)=>s.e(Fu(v,i,u,g),{u_world:p}),Ax=(v,i,u,p,g)=>{const _=v.transform;let S,C,M=0;if(u.paint.get("circle-pitch-alignment")==="map"){const R=s.aC(i,1,_.zoom);S=!0,C=[R,R],M=R/(s.$*Math.pow(2,i.tileID.overscaledZ))*2*Math.PI*g}else S=!1,C=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+S,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:C,u_globe_extrude_scale:M,u_translate:p}},Uu=v=>({u_pixel_extrude_scale:[1/v.width,1/v.height]}),Cx=v=>({u_viewport_size:[v.width,v.height]}),cs=(v,i=1)=>({u_color:v,u_overlay:0,u_overlay_scale:i}),Fg=(v,i,u,p)=>{const g=s.aC(v,1,i)/(s.$*Math.pow(2,v.tileID.overscaledZ))*2*Math.PI*p;return{u_extrude_scale:s.aC(v,1,i),u_intensity:u,u_globe_extrude_scale:g}},Pf=(v,i,u,p)=>{const g=s.L();s.bY(g,0,v.width,v.height,0,0,1);const _=v.context.gl;return{u_matrix:g,u_world:[_.drawingBufferWidth,_.drawingBufferHeight],u_image:u,u_color_ramp:p,u_opacity:i.paint.get("heatmap-opacity")}},Mx=(v,i,u)=>{const p=u.paint.get("hillshade-accent-color");let g;switch(u.paint.get("hillshade-method")){case"basic":g=4;break;case"combined":g=1;break;case"igor":g=2;break;case"multidirectional":g=3;break;default:g=0}const _=u.getIlluminationProperties();for(let S=0;S<_.directionRadians.length;S++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(_.directionRadians[S]+=v.transform.bearingInRadians);return{u_image:0,u_latrange:Tf(0,i.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:_.altitudeRadians,u_azimuths:_.directionRadians,u_accent:p,u_method:g,u_highlights:_.highlightColor,u_shadows:_.shadowColor}},Ug=(v,i)=>{const u=i.stride,p=s.L();return s.bY(p,0,s.$,-s.$,0,0,1),s.M(p,p,[0,-s.$,0]),{u_matrix:p,u_image:1,u_dimension:[u,u],u_zoom:v.overscaledZ,u_unpack:i.getUnpackVector()}};function Tf(v,i){const u=Math.pow(2,i.canonical.z),p=i.canonical.y;return[new s.a1(0,p/u).toLngLat().lat,new s.a1(0,(p+1)/u).toLngLat().lat]}const Vg=(v,i,u=0)=>({u_image:0,u_unpack:i.getUnpackVector(),u_dimension:[i.stride,i.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:v.paint.get("color-relief-opacity")}),Vu=(v,i,u,p)=>{const g=v.transform;return{u_translation:Ef(v,i,u),u_ratio:p/s.aC(i,1,g.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Gg=(v,i,u,p,g)=>s.e(Vu(v,i,u,p),{u_image:0,u_image_height:g}),qg=(v,i,u,p,g)=>{const _=v.transform,S=kf(i,_);return{u_translation:Ef(v,i,u),u_texsize:i.imageAtlasTexture.size,u_ratio:p/s.aC(i,1,_.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[S,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},us=(v,i,u,p,g,_)=>{const S=v.lineAtlas,C=kf(i,v.transform),M=u.layout.get("line-cap")==="round",R=S.getDash(g.from,M),$=S.getDash(g.to,M),G=R.width*_.fromScale,V=$.width*_.toScale;return s.e(Vu(v,i,u,p),{u_patternscale_a:[C/G,-R.height/2],u_patternscale_b:[C/V,-$.height/2],u_sdfgamma:S.width/(256*Math.min(G,V)*v.pixelRatio)/2,u_image:0,u_tex_y_a:R.y,u_tex_y_b:$.y,u_mix:_.t})};function kf(v,i){return 1/s.aC(v,1,i.tileZoom)}function Ef(v,i,u){return s.aD(v.transform,i,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const bc=(v,i,u,p,g)=>{return{u_tl_parent:v,u_scale_parent:i,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(S=p.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(_=p.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:Ix(p.paint.get("raster-hue-rotate")),u_coords_top:[g[0].x,g[0].y,g[1].x,g[1].y],u_coords_bottom:[g[3].x,g[3].y,g[2].x,g[2].y]};var _,S};function Ix(v){v*=Math.PI/180;const i=Math.sin(v),u=Math.cos(v);return[(2*u+1)/3,(-Math.sqrt(3)*i-u+1)/3,(Math.sqrt(3)*i-u+1)/3]}const wc=(v,i,u,p,g,_,S,C,M,R,$,G,V)=>{const X=S.transform;return{u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:X.cameraToCenterDistance,u_pitch:X.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:X.width/X.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:C,u_coord_matrix:M,u_is_text:+$,u_pitch_with_map:+p,u_is_along_line:g,u_is_variable_anchor:_,u_texsize:G,u_texture:0,u_translation:R,u_pitched_scale:V}},Wg=(v,i,u,p,g,_,S,C,M,R,$,G,V,X)=>{const Q=S.transform;return s.e(wc(v,i,u,p,g,_,S,C,M,R,$,G,X),{u_gamma_scale:p?Math.cos(Q.pitch*Math.PI/180)*Q.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},jx=(v,i,u,p,g,_,S,C,M,R,$,G,V)=>s.e(Wg(v,i,u,p,g,_,S,C,M,R,!0,$,0,V),{u_texsize_icon:G,u_texture_icon:1}),Hg=(v,i)=>({u_opacity:v,u_color:i}),Zg=(v,i,u,p,g)=>s.e(function(_,S,C,M){const R=C.imageManager.getPattern(_.from.toString()),$=C.imageManager.getPattern(_.to.toString()),{width:G,height:V}=C.imageManager.getPixelSize(),X=Math.pow(2,M.tileID.overscaledZ),Q=M.tileSize*Math.pow(2,C.transform.tileZoom)/X,se=Q*(M.tileID.canonical.x+M.tileID.wrap*X),oe=Q*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:R.tl,u_pattern_br_a:R.br,u_pattern_tl_b:$.tl,u_pattern_br_b:$.br,u_texsize:[G,V],u_mix:S.t,u_pattern_size_a:R.displaySize,u_pattern_size_b:$.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/s.aC(M,1,C.transform.tileZoom),u_pixel_coord_upper:[se>>16,oe>>16],u_pixel_coord_lower:[65535&se,65535&oe]}}(u,g,i,p),{u_opacity:v}),Af=(v,i)=>{},Cf={fillExtrusion:(v,i)=>({u_lightpos:new s.bT(v,i.u_lightpos),u_lightpos_globe:new s.bT(v,i.u_lightpos_globe),u_lightintensity:new s.bg(v,i.u_lightintensity),u_lightcolor:new s.bT(v,i.u_lightcolor),u_vertical_gradient:new s.bg(v,i.u_vertical_gradient),u_opacity:new s.bg(v,i.u_opacity),u_fill_translate:new s.bU(v,i.u_fill_translate)}),fillExtrusionPattern:(v,i)=>({u_lightpos:new s.bT(v,i.u_lightpos),u_lightpos_globe:new s.bT(v,i.u_lightpos_globe),u_lightintensity:new s.bg(v,i.u_lightintensity),u_lightcolor:new s.bT(v,i.u_lightcolor),u_vertical_gradient:new s.bg(v,i.u_vertical_gradient),u_height_factor:new s.bg(v,i.u_height_factor),u_opacity:new s.bg(v,i.u_opacity),u_fill_translate:new s.bU(v,i.u_fill_translate),u_image:new s.bP(v,i.u_image),u_texsize:new s.bU(v,i.u_texsize),u_pixel_coord_upper:new s.bU(v,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.bU(v,i.u_pixel_coord_lower),u_scale:new s.bT(v,i.u_scale),u_fade:new s.bg(v,i.u_fade)}),fill:(v,i)=>({u_fill_translate:new s.bU(v,i.u_fill_translate)}),fillPattern:(v,i)=>({u_image:new s.bP(v,i.u_image),u_texsize:new s.bU(v,i.u_texsize),u_pixel_coord_upper:new s.bU(v,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.bU(v,i.u_pixel_coord_lower),u_scale:new s.bT(v,i.u_scale),u_fade:new s.bg(v,i.u_fade),u_fill_translate:new s.bU(v,i.u_fill_translate)}),fillOutline:(v,i)=>({u_world:new s.bU(v,i.u_world),u_fill_translate:new s.bU(v,i.u_fill_translate)}),fillOutlinePattern:(v,i)=>({u_world:new s.bU(v,i.u_world),u_image:new s.bP(v,i.u_image),u_texsize:new s.bU(v,i.u_texsize),u_pixel_coord_upper:new s.bU(v,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.bU(v,i.u_pixel_coord_lower),u_scale:new s.bT(v,i.u_scale),u_fade:new s.bg(v,i.u_fade),u_fill_translate:new s.bU(v,i.u_fill_translate)}),circle:(v,i)=>({u_camera_to_center_distance:new s.bg(v,i.u_camera_to_center_distance),u_scale_with_map:new s.bP(v,i.u_scale_with_map),u_pitch_with_map:new s.bP(v,i.u_pitch_with_map),u_extrude_scale:new s.bU(v,i.u_extrude_scale),u_device_pixel_ratio:new s.bg(v,i.u_device_pixel_ratio),u_globe_extrude_scale:new s.bg(v,i.u_globe_extrude_scale),u_translate:new s.bU(v,i.u_translate)}),collisionBox:(v,i)=>({u_pixel_extrude_scale:new s.bU(v,i.u_pixel_extrude_scale)}),collisionCircle:(v,i)=>({u_viewport_size:new s.bU(v,i.u_viewport_size)}),debug:(v,i)=>({u_color:new s.bQ(v,i.u_color),u_overlay:new s.bP(v,i.u_overlay),u_overlay_scale:new s.bg(v,i.u_overlay_scale)}),depth:Af,clippingMask:Af,heatmap:(v,i)=>({u_extrude_scale:new s.bg(v,i.u_extrude_scale),u_intensity:new s.bg(v,i.u_intensity),u_globe_extrude_scale:new s.bg(v,i.u_globe_extrude_scale)}),heatmapTexture:(v,i)=>({u_matrix:new s.bR(v,i.u_matrix),u_world:new s.bU(v,i.u_world),u_image:new s.bP(v,i.u_image),u_color_ramp:new s.bP(v,i.u_color_ramp),u_opacity:new s.bg(v,i.u_opacity)}),hillshade:(v,i)=>({u_image:new s.bP(v,i.u_image),u_latrange:new s.bU(v,i.u_latrange),u_exaggeration:new s.bg(v,i.u_exaggeration),u_altitudes:new s.b_(v,i.u_altitudes),u_azimuths:new s.b_(v,i.u_azimuths),u_accent:new s.bQ(v,i.u_accent),u_method:new s.bP(v,i.u_method),u_shadows:new s.bZ(v,i.u_shadows),u_highlights:new s.bZ(v,i.u_highlights)}),hillshadePrepare:(v,i)=>({u_matrix:new s.bR(v,i.u_matrix),u_image:new s.bP(v,i.u_image),u_dimension:new s.bU(v,i.u_dimension),u_zoom:new s.bg(v,i.u_zoom),u_unpack:new s.bS(v,i.u_unpack)}),colorRelief:(v,i)=>({u_image:new s.bP(v,i.u_image),u_unpack:new s.bS(v,i.u_unpack),u_dimension:new s.bU(v,i.u_dimension),u_elevation_stops:new s.bP(v,i.u_elevation_stops),u_color_stops:new s.bP(v,i.u_color_stops),u_color_ramp_size:new s.bP(v,i.u_color_ramp_size),u_opacity:new s.bg(v,i.u_opacity)}),line:(v,i)=>({u_translation:new s.bU(v,i.u_translation),u_ratio:new s.bg(v,i.u_ratio),u_device_pixel_ratio:new s.bg(v,i.u_device_pixel_ratio),u_units_to_pixels:new s.bU(v,i.u_units_to_pixels)}),lineGradient:(v,i)=>({u_translation:new s.bU(v,i.u_translation),u_ratio:new s.bg(v,i.u_ratio),u_device_pixel_ratio:new s.bg(v,i.u_device_pixel_ratio),u_units_to_pixels:new s.bU(v,i.u_units_to_pixels),u_image:new s.bP(v,i.u_image),u_image_height:new s.bg(v,i.u_image_height)}),linePattern:(v,i)=>({u_translation:new s.bU(v,i.u_translation),u_texsize:new s.bU(v,i.u_texsize),u_ratio:new s.bg(v,i.u_ratio),u_device_pixel_ratio:new s.bg(v,i.u_device_pixel_ratio),u_image:new s.bP(v,i.u_image),u_units_to_pixels:new s.bU(v,i.u_units_to_pixels),u_scale:new s.bT(v,i.u_scale),u_fade:new s.bg(v,i.u_fade)}),lineSDF:(v,i)=>({u_translation:new s.bU(v,i.u_translation),u_ratio:new s.bg(v,i.u_ratio),u_device_pixel_ratio:new s.bg(v,i.u_device_pixel_ratio),u_units_to_pixels:new s.bU(v,i.u_units_to_pixels),u_patternscale_a:new s.bU(v,i.u_patternscale_a),u_patternscale_b:new s.bU(v,i.u_patternscale_b),u_sdfgamma:new s.bg(v,i.u_sdfgamma),u_image:new s.bP(v,i.u_image),u_tex_y_a:new s.bg(v,i.u_tex_y_a),u_tex_y_b:new s.bg(v,i.u_tex_y_b),u_mix:new s.bg(v,i.u_mix)}),raster:(v,i)=>({u_tl_parent:new s.bU(v,i.u_tl_parent),u_scale_parent:new s.bg(v,i.u_scale_parent),u_buffer_scale:new s.bg(v,i.u_buffer_scale),u_fade_t:new s.bg(v,i.u_fade_t),u_opacity:new s.bg(v,i.u_opacity),u_image0:new s.bP(v,i.u_image0),u_image1:new s.bP(v,i.u_image1),u_brightness_low:new s.bg(v,i.u_brightness_low),u_brightness_high:new s.bg(v,i.u_brightness_high),u_saturation_factor:new s.bg(v,i.u_saturation_factor),u_contrast_factor:new s.bg(v,i.u_contrast_factor),u_spin_weights:new s.bT(v,i.u_spin_weights),u_coords_top:new s.bS(v,i.u_coords_top),u_coords_bottom:new s.bS(v,i.u_coords_bottom)}),symbolIcon:(v,i)=>({u_is_size_zoom_constant:new s.bP(v,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bP(v,i.u_is_size_feature_constant),u_size_t:new s.bg(v,i.u_size_t),u_size:new s.bg(v,i.u_size),u_camera_to_center_distance:new s.bg(v,i.u_camera_to_center_distance),u_pitch:new s.bg(v,i.u_pitch),u_rotate_symbol:new s.bP(v,i.u_rotate_symbol),u_aspect_ratio:new s.bg(v,i.u_aspect_ratio),u_fade_change:new s.bg(v,i.u_fade_change),u_label_plane_matrix:new s.bR(v,i.u_label_plane_matrix),u_coord_matrix:new s.bR(v,i.u_coord_matrix),u_is_text:new s.bP(v,i.u_is_text),u_pitch_with_map:new s.bP(v,i.u_pitch_with_map),u_is_along_line:new s.bP(v,i.u_is_along_line),u_is_variable_anchor:new s.bP(v,i.u_is_variable_anchor),u_texsize:new s.bU(v,i.u_texsize),u_texture:new s.bP(v,i.u_texture),u_translation:new s.bU(v,i.u_translation),u_pitched_scale:new s.bg(v,i.u_pitched_scale)}),symbolSDF:(v,i)=>({u_is_size_zoom_constant:new s.bP(v,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bP(v,i.u_is_size_feature_constant),u_size_t:new s.bg(v,i.u_size_t),u_size:new s.bg(v,i.u_size),u_camera_to_center_distance:new s.bg(v,i.u_camera_to_center_distance),u_pitch:new s.bg(v,i.u_pitch),u_rotate_symbol:new s.bP(v,i.u_rotate_symbol),u_aspect_ratio:new s.bg(v,i.u_aspect_ratio),u_fade_change:new s.bg(v,i.u_fade_change),u_label_plane_matrix:new s.bR(v,i.u_label_plane_matrix),u_coord_matrix:new s.bR(v,i.u_coord_matrix),u_is_text:new s.bP(v,i.u_is_text),u_pitch_with_map:new s.bP(v,i.u_pitch_with_map),u_is_along_line:new s.bP(v,i.u_is_along_line),u_is_variable_anchor:new s.bP(v,i.u_is_variable_anchor),u_texsize:new s.bU(v,i.u_texsize),u_texture:new s.bP(v,i.u_texture),u_gamma_scale:new s.bg(v,i.u_gamma_scale),u_device_pixel_ratio:new s.bg(v,i.u_device_pixel_ratio),u_is_halo:new s.bP(v,i.u_is_halo),u_translation:new s.bU(v,i.u_translation),u_pitched_scale:new s.bg(v,i.u_pitched_scale)}),symbolTextAndIcon:(v,i)=>({u_is_size_zoom_constant:new s.bP(v,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bP(v,i.u_is_size_feature_constant),u_size_t:new s.bg(v,i.u_size_t),u_size:new s.bg(v,i.u_size),u_camera_to_center_distance:new s.bg(v,i.u_camera_to_center_distance),u_pitch:new s.bg(v,i.u_pitch),u_rotate_symbol:new s.bP(v,i.u_rotate_symbol),u_aspect_ratio:new s.bg(v,i.u_aspect_ratio),u_fade_change:new s.bg(v,i.u_fade_change),u_label_plane_matrix:new s.bR(v,i.u_label_plane_matrix),u_coord_matrix:new s.bR(v,i.u_coord_matrix),u_is_text:new s.bP(v,i.u_is_text),u_pitch_with_map:new s.bP(v,i.u_pitch_with_map),u_is_along_line:new s.bP(v,i.u_is_along_line),u_is_variable_anchor:new s.bP(v,i.u_is_variable_anchor),u_texsize:new s.bU(v,i.u_texsize),u_texsize_icon:new s.bU(v,i.u_texsize_icon),u_texture:new s.bP(v,i.u_texture),u_texture_icon:new s.bP(v,i.u_texture_icon),u_gamma_scale:new s.bg(v,i.u_gamma_scale),u_device_pixel_ratio:new s.bg(v,i.u_device_pixel_ratio),u_is_halo:new s.bP(v,i.u_is_halo),u_translation:new s.bU(v,i.u_translation),u_pitched_scale:new s.bg(v,i.u_pitched_scale)}),background:(v,i)=>({u_opacity:new s.bg(v,i.u_opacity),u_color:new s.bQ(v,i.u_color)}),backgroundPattern:(v,i)=>({u_opacity:new s.bg(v,i.u_opacity),u_image:new s.bP(v,i.u_image),u_pattern_tl_a:new s.bU(v,i.u_pattern_tl_a),u_pattern_br_a:new s.bU(v,i.u_pattern_br_a),u_pattern_tl_b:new s.bU(v,i.u_pattern_tl_b),u_pattern_br_b:new s.bU(v,i.u_pattern_br_b),u_texsize:new s.bU(v,i.u_texsize),u_mix:new s.bg(v,i.u_mix),u_pattern_size_a:new s.bU(v,i.u_pattern_size_a),u_pattern_size_b:new s.bU(v,i.u_pattern_size_b),u_scale_a:new s.bg(v,i.u_scale_a),u_scale_b:new s.bg(v,i.u_scale_b),u_pixel_coord_upper:new s.bU(v,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.bU(v,i.u_pixel_coord_lower),u_tile_units_to_pixels:new s.bg(v,i.u_tile_units_to_pixels)}),terrain:(v,i)=>({u_texture:new s.bP(v,i.u_texture),u_ele_delta:new s.bg(v,i.u_ele_delta),u_fog_matrix:new s.bR(v,i.u_fog_matrix),u_fog_color:new s.bQ(v,i.u_fog_color),u_fog_ground_blend:new s.bg(v,i.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.bg(v,i.u_fog_ground_blend_opacity),u_horizon_color:new s.bQ(v,i.u_horizon_color),u_horizon_fog_blend:new s.bg(v,i.u_horizon_fog_blend),u_is_globe_mode:new s.bg(v,i.u_is_globe_mode)}),terrainDepth:(v,i)=>({u_ele_delta:new s.bg(v,i.u_ele_delta)}),terrainCoords:(v,i)=>({u_texture:new s.bP(v,i.u_texture),u_terrain_coords_id:new s.bg(v,i.u_terrain_coords_id),u_ele_delta:new s.bg(v,i.u_ele_delta)}),projectionErrorMeasurement:(v,i)=>({u_input:new s.bg(v,i.u_input),u_output_expected:new s.bg(v,i.u_output_expected)}),atmosphere:(v,i)=>({u_sun_pos:new s.bT(v,i.u_sun_pos),u_atmosphere_blend:new s.bg(v,i.u_atmosphere_blend),u_globe_position:new s.bT(v,i.u_globe_position),u_globe_radius:new s.bg(v,i.u_globe_radius),u_inv_proj_matrix:new s.bR(v,i.u_inv_proj_matrix)}),sky:(v,i)=>({u_sky_color:new s.bQ(v,i.u_sky_color),u_horizon_color:new s.bQ(v,i.u_horizon_color),u_horizon:new s.bU(v,i.u_horizon),u_horizon_normal:new s.bU(v,i.u_horizon_normal),u_sky_horizon_blend:new s.bg(v,i.u_sky_horizon_blend),u_sky_blend:new s.bg(v,i.u_sky_blend)})};class Kg{constructor(i,u,p){this.context=i;const g=i.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Gu={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ro{constructor(i,u,p,g){this.length=u.length,this.attributes=p,this.itemSize=u.bytesPerElement,this.dynamicDraw=g,this.context=i;const _=i.gl;this.buffer=_.createBuffer(),i.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,u){for(let p=0;p<this.attributes.length;p++){const g=u.attributes[this.attributes[p].name];g!==void 0&&i.enableVertexAttribArray(g)}}setVertexAttribPointers(i,u,p){for(let g=0;g<this.attributes.length;g++){const _=this.attributes[g],S=u.attributes[_.name];S!==void 0&&i.vertexAttribPointer(S,_.components,i[Gu[_.type]],!1,this.itemSize,_.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ur{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Mf extends ur{getDefault(){return s.bf.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class If extends ur{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class Xg extends ur{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class jf extends ur{getDefault(){return[!0,!0,!0,!0]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class hs extends ur{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class Of extends ur{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Ox extends ur{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const u=this.current;(i.func!==u.func||i.ref!==u.ref||i.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class Dx extends ur{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class Rx extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=i,this.dirty=!1}}class Nx extends ur{getDefault(){return[0,1]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Yg extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=i,this.dirty=!1}}class $x extends ur{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Jg extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.BLEND):u.disable(u.BLEND),this.current=i,this.dirty=!1}}class qu extends ur{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class Wu extends ur{getDefault(){return s.bf.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Hu extends ur{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class Df extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=i,this.dirty=!1}}class ds extends ur{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Sc extends ur{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class ll extends ur{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class Hi extends ur{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class Qg extends ur{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class ey extends ur{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Rf extends ur{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class fs extends ur{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Zu extends ur{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Ku extends ur{getDefault(){return null}set(i){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Pc extends ur{getDefault(){return null}set(i){var u;if(i===this.current&&!this.dirty)return;const p=this.gl;Oa(p)?p.bindVertexArray(i):(u=p.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(i),this.current=i,this.dirty=!1}}class Xu extends ur{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class ty extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class cl extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class Ro extends ur{constructor(i,u){super(i),this.context=i,this.parent=u}getDefault(){return null}}class ry extends Ro{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class Nf extends Ro{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Jt extends Ro{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}const Tc="Framebuffer is not complete";class zx{constructor(i,u,p,g,_){this.context=i,this.width=u,this.height=p;const S=i.gl,C=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new ry(i,C),g)this.depthAttachment=_?new Jt(i,C):new Nf(i,C);else if(_)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(Tc)}destroy(){const i=this.context.gl,u=this.colorAttachment.get();if(u&&i.deleteTexture(u),this.depthAttachment){const p=this.depthAttachment.get();p&&i.deleteRenderbuffer(p)}i.deleteFramebuffer(this.framebuffer)}}class ny{constructor(i){var u,p;if(this.gl=i,this.clearColor=new Mf(this),this.clearDepth=new If(this),this.clearStencil=new Xg(this),this.colorMask=new jf(this),this.depthMask=new hs(this),this.stencilMask=new Of(this),this.stencilFunc=new Ox(this),this.stencilOp=new Dx(this),this.stencilTest=new Rx(this),this.depthRange=new Nx(this),this.depthTest=new Yg(this),this.depthFunc=new $x(this),this.blend=new Jg(this),this.blendFunc=new qu(this),this.blendColor=new Wu(this),this.blendEquation=new Hu(this),this.cullFace=new Df(this),this.cullFaceSide=new ds(this),this.frontFace=new Sc(this),this.program=new ll(this),this.activeTexture=new Hi(this),this.viewport=new Qg(this),this.bindFramebuffer=new ey(this),this.bindRenderbuffer=new Rf(this),this.bindTexture=new fs(this),this.bindVertexBuffer=new Zu(this),this.bindElementBuffer=new Ku(this),this.bindVertexArray=new Pc(this),this.pixelStoreUnpack=new Xu(this),this.pixelStoreUnpackPremultiplyAlpha=new ty(this),this.pixelStoreUnpackFlipY=new cl(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),Oa(i)){this.HALF_FLOAT=i.HALF_FLOAT;const g=i.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=i.RGBA16F)!==null&&u!==void 0?u:g==null?void 0:g.RGBA16F_EXT,this.RGB16F=(p=i.RGB16F)!==null&&p!==void 0?p:g==null?void 0:g.RGB16F_EXT,i.getExtension("EXT_color_buffer_float")}else{i.getExtension("EXT_color_buffer_half_float"),i.getExtension("OES_texture_half_float_linear");const g=i.getExtension("OES_texture_half_float");this.HALF_FLOAT=g==null?void 0:g.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,u){return new Kg(this,i,u)}createVertexBuffer(i,u,p){return new ro(this,i,u,p)}createRenderbuffer(i,u,p){const g=this.gl,_=g.createRenderbuffer();return this.bindRenderbuffer.set(_),g.renderbufferStorage(g.RENDERBUFFER,i,u,p),this.bindRenderbuffer.set(null),_}createFramebuffer(i,u,p,g){return new zx(this,i,u,p,g)}clear({color:i,depth:u,stencil:p}){const g=this.gl;let _=0;i&&(_|=g.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(_|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),p!==void 0&&(_|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),g.clear(_)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){s.bH(i.blendFunction,jr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}createVertexArray(){var i;return Oa(this.gl)?this.gl.createVertexArray():(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.createVertexArrayOES()}deleteVertexArray(i){var u;return Oa(this.gl)?this.gl.deleteVertexArray(i):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(i)}unbindVAO(){this.bindVertexArray.set(null)}}let No;function iy(v,i,u,p,g){const _=v.context,S=v.transform,C=_.gl,M=v.useProgram("collisionBox"),R=[];let $=0,G=0;for(let le=0;le<p.length;le++){const ue=p[le],me=i.getTile(ue).getBucket(u);if(!me)continue;const de=g?me.textCollisionBox:me.iconCollisionBox,ye=me.collisionCircleArray;ye.length>0&&(R.push({circleArray:ye,circleOffset:G,coord:ue}),$+=ye.length/4,G=$),de&&M.draw(_,C.LINES,Bt.disabled,ir.disabled,v.colorModeForRenderPass(),jt.disabled,Uu(v.transform),v.style.map.terrain&&v.style.map.terrain.getTerrainData(ue),S.getProjectionData({overscaledTileID:ue,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,null,v.transform.zoom,null,null,de.collisionVertexBuffer)}if(!g||!R.length)return;const V=v.useProgram("collisionCircle"),X=new s.b$;X.resize(4*$),X._trim();let Q=0;for(const le of R)for(let ue=0;ue<le.circleArray.length/4;ue++){const me=4*ue,de=le.circleArray[me+0],ye=le.circleArray[me+1],xe=le.circleArray[me+2],pe=le.circleArray[me+3];X.emplace(Q++,de,ye,xe,pe,0),X.emplace(Q++,de,ye,xe,pe,1),X.emplace(Q++,de,ye,xe,pe,2),X.emplace(Q++,de,ye,xe,pe,3)}(!No||No.length<2*$)&&(No=function(le){const ue=2*le,me=new s.c1;me.resize(ue),me._trim();for(let de=0;de<ue;de++){const ye=6*de;me.uint16[ye+0]=4*de+0,me.uint16[ye+1]=4*de+1,me.uint16[ye+2]=4*de+2,me.uint16[ye+3]=4*de+2,me.uint16[ye+4]=4*de+3,me.uint16[ye+5]=4*de+0}return me}($));const se=_.createIndexBuffer(No,!0),oe=_.createVertexBuffer(X,s.c0.members,!0);for(const le of R){const ue=Cx(v.transform);V.draw(_,C.TRIANGLES,Bt.disabled,ir.disabled,v.colorModeForRenderPass(),jt.disabled,ue,v.style.map.terrain&&v.style.map.terrain.getTerrainData(le.coord),null,u.id,oe,se,s.aM.simpleSegment(0,2*le.circleOffset,le.circleArray.length,le.circleArray.length/2),null,v.transform.zoom,null,null,null)}oe.destroy(),se.destroy()}const Lx=s.ag(new Float32Array(16));function ay(v,i,u,p,g,_){const{horizontalAlign:S,verticalAlign:C}=s.aH(v);return new s.P((-(S-.5)*i/g+p[0])*_,(-(C-.5)*u/g+p[1])*_)}function Bx(v,i,u,p,g,_){const S=i.tileAnchorPoint.add(new s.P(i.translation[0],i.translation[1]));if(i.pitchWithMap){let C=p.mult(_);u||(C=C.rotate(-g));const M=S.add(C);return cn(M.x,M.y,i.pitchedLabelPlaneMatrix,i.getElevation).point}if(u){const C=$n(i.tileAnchorPoint.x+1,i.tileAnchorPoint.y,i).point.sub(v),M=Math.atan(C.y/C.x)+(C.x<0?Math.PI:0);return v.add(p.rotate(M))}return v.add(p)}function $f(v,i,u,p,g,_,S,C,M,R,$,G){const V=v.text.placedSymbolArray,X=v.text.dynamicLayoutVertexArray,Q=v.icon.dynamicLayoutVertexArray,se={};X.clear();for(let oe=0;oe<V.length;oe++){const le=V.get(oe),ue=le.hidden||!le.crossTileID||v.allowVerticalPlacement&&!le.placedOrientation?null:p[le.crossTileID];if(ue){const me=new s.P(le.anchorX,le.anchorY),de={getElevation:G,width:g.width,height:g.height,pitchedLabelPlaneMatrix:_,pitchWithMap:u,transform:g,tileAnchorPoint:me,translation:R,unwrappedTileID:$},ye=u?Mo(me.x,me.y,de):$n(me.x,me.y,de),xe=ot(g.cameraToCenterDistance,ye.signedDistanceFromCamera);let pe=s.ap(v.textSizeData,C,le)*xe/s.aB;u&&(pe*=v.tilePixelRatio/S);const{width:ke,height:ze,anchor:je,textOffset:De,textBoxScale:$e}=ue,at=ay(je,ke,ze,De,$e,pe),lt=g.getPitchedTextCorrection(me.x+R[0],me.y+R[1],$),Ye=Bx(ye.point,de,i,at,-g.bearingInRadians,lt),xt=v.allowVerticalPlacement&&le.placedOrientation===s.ao.vertical?Math.PI/2:0;for(let qt=0;qt<le.numGlyphs;qt++)s.av(X,Ye,xt);M&&le.associatedIconIndex>=0&&(se[le.associatedIconIndex]={shiftedAnchor:Ye,angle:xt})}else ja(le.numGlyphs,X)}if(M){Q.clear();const oe=v.icon.placedSymbolArray;for(let le=0;le<oe.length;le++){const ue=oe.get(le);if(ue.hidden)ja(ue.numGlyphs,Q);else{const me=se[le];if(me)for(let de=0;de<ue.numGlyphs;de++)s.av(Q,me.shiftedAnchor,me.angle);else ja(ue.numGlyphs,Q)}}v.icon.dynamicLayoutVertexBuffer.updateData(Q)}v.text.dynamicLayoutVertexBuffer.updateData(X)}function Yu(v,i,u){return u.iconsInText&&i?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function kc(v,i,u,p,g,_,S,C,M,R,$,G,V){const X=v.context,Q=X.gl,se=v.transform,oe=C==="map",le=M==="map",ue=C!=="viewport"&&u.layout.get("symbol-placement")!=="point",me=oe&&!le&&!ue,de=!u.layout.get("symbol-sort-key").isConstant();let ye=!1;const xe=v.getDepthModeForSublayer(0,Bt.ReadOnly),pe=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ke=[],ze=se.getCircleRadiusCorrection();for(const je of p){const De=i.getTile(je),$e=De.getBucket(u);if(!$e)continue;const at=g?$e.text:$e.icon;if(!at||!at.segments.get().length||!at.hasVisibleVertices)continue;const lt=at.programConfigurations.get(u.id),Ye=g||$e.sdfIcons,xt=g?$e.textSizeData:$e.iconSizeData,qt=le||se.pitch!==0,hr=v.useProgram(Yu(Ye,g,$e),lt),_r=s.an(xt,se.zoom),gr=v.style.map.terrain&&v.style.map.terrain.getTerrainData(je);let $r,Gr,Ut,xr,hn=[0,0],xn=null;if(g)Gr=De.glyphAtlasTexture,Ut=Q.LINEAR,$r=De.glyphAtlasTexture.size,$e.iconsInText&&(hn=De.imageAtlasTexture.size,xn=De.imageAtlasTexture,xr=qt||v.options.rotating||v.options.zooming||xt.kind==="composite"||xt.kind==="camera"?Q.LINEAR:Q.NEAREST);else{const dn=u.layout.get("icon-size").constantOr(0)!==1||$e.iconsNeedLinear;Gr=De.imageAtlasTexture,Ut=Ye||v.options.rotating||v.options.zooming||dn||qt?Q.LINEAR:Q.NEAREST,$r=De.imageAtlasTexture.size}const En=s.aC(De,1,v.transform.zoom),di=nn(oe,v.transform,En),ma=s.L();s.aq(ma,di);const zo=Yt(le,oe,v.transform,En),Lo=s.aD(se,De,_,S),bl=se.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),wl=pe&&$e.hasTextData(),xs=u.layout.get("icon-text-fit")!=="none"&&wl&&$e.hasIconData();if(ue){const dn=v.style.map.terrain?(Xi,fn)=>v.style.map.terrain.getElevation(je,Xi,fn):null,bn=u.layout.get("text-rotation-alignment")==="map";Ur($e,v,g,di,ma,le,R,bn,je.toUnwrapped(),se.width,se.height,Lo,dn)}const bs=g&&pe||xs,Pi=ue||bs?Lx:le?di:v.transform.clipSpaceToPixelsMatrix,ga=Ye&&u.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let fi;fi=Ye?$e.iconsInText?jx(xt.kind,_r,me,le,ue,bs,v,Pi,zo,Lo,$r,hn,ze):Wg(xt.kind,_r,me,le,ue,bs,v,Pi,zo,Lo,g,$r,0,ze):wc(xt.kind,_r,me,le,ue,bs,v,Pi,zo,Lo,g,$r,ze);const Bo={program:hr,buffers:at,uniformValues:fi,projectionData:bl,atlasTexture:Gr,atlasTextureIcon:xn,atlasInterpolation:Ut,atlasInterpolationIcon:xr,isSDF:Ye,hasHalo:ga};if(de&&$e.canOverlap){ye=!0;const dn=at.segments.get();for(const bn of dn)ke.push({segments:new s.aM([bn]),sortKey:bn.sortKey,state:Bo,terrainData:gr})}else ke.push({segments:at.segments,sortKey:0,state:Bo,terrainData:gr})}ye&&ke.sort((je,De)=>je.sortKey-De.sortKey);for(const je of ke){const De=je.state;if(X.activeTexture.set(Q.TEXTURE0),De.atlasTexture.bind(De.atlasInterpolation,Q.CLAMP_TO_EDGE),De.atlasTextureIcon&&(X.activeTexture.set(Q.TEXTURE1),De.atlasTextureIcon&&De.atlasTextureIcon.bind(De.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),De.isSDF){const $e=De.uniformValues;De.hasHalo&&($e.u_is_halo=1,Ec(De.buffers,je.segments,u,v,De.program,xe,$,G,$e,De.projectionData,je.terrainData)),$e.u_is_halo=0}Ec(De.buffers,je.segments,u,v,De.program,xe,$,G,De.uniformValues,De.projectionData,je.terrainData)}}function Ec(v,i,u,p,g,_,S,C,M,R,$){const G=p.context;g.draw(G,G.gl.TRIANGLES,_,S,C,jt.backCCW,M,$,R,u.id,v.layoutVertexBuffer,v.indexBuffer,i,u.paint,p.transform.zoom,v.programConfigurations.get(u.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function zf(v,i,u,p,g){const _=v.context,S=_.gl,C=ir.disabled,M=new jr([S.ONE,S.ONE],s.bf.transparent,[!0,!0,!0,!0]),R=i.getBucket(u);if(!R)return;const $=p.key;let G=u.heatmapFbos.get($);G||(G=Ac(_,i.tileSize,i.tileSize),u.heatmapFbos.set($,G)),_.bindFramebuffer.set(G.framebuffer),_.viewport.set([0,0,i.tileSize,i.tileSize]),_.clear({color:s.bf.transparent});const V=R.programConfigurations.get(u.id),X=v.useProgram("heatmap",V,!g),Q=v.transform.getProjectionData({overscaledTileID:i.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),se=v.style.map.terrain.getTerrainData(p);X.draw(_,S.TRIANGLES,Bt.disabled,C,M,jt.disabled,Fg(i,v.transform.zoom,u.paint.get("heatmap-intensity"),1),se,Q,u.id,R.layoutVertexBuffer,R.indexBuffer,R.segments,u.paint,v.transform.zoom,V)}function oy(v,i,u,p,g){const _=v.context,S=_.gl,C=v.transform;_.setColorMode(v.colorModeForRenderPass());const M=Cc(_,i),R=u.key,$=i.heatmapFbos.get(R);if(!$)return;_.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,$.colorAttachment.get()),_.activeTexture.set(S.TEXTURE1),M.bind(S.LINEAR,S.CLAMP_TO_EDGE);const G=C.getProjectionData({overscaledTileID:u,applyTerrainMatrix:g,applyGlobeMatrix:!p});v.useProgram("heatmapTexture").draw(_,S.TRIANGLES,Bt.disabled,ir.disabled,v.colorModeForRenderPass(),jt.disabled,Pf(v,i,0,1),null,G,i.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments,i.paint,C.zoom),$.destroy(),i.heatmapFbos.delete(R)}function Ac(v,i,u){var p,g;const _=v.gl,S=_.createTexture();_.bindTexture(_.TEXTURE_2D,S),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR);const C=(p=v.HALF_FLOAT)!==null&&p!==void 0?p:_.UNSIGNED_BYTE,M=(g=v.RGBA16F)!==null&&g!==void 0?g:_.RGBA;_.texImage2D(_.TEXTURE_2D,0,M,i,u,0,_.RGBA,C,null);const R=v.createFramebuffer(i,u,!1,!1);return R.colorAttachment.set(S),R}function Cc(v,i){return i.colorRampTexture||(i.colorRampTexture=new s.T(v,i.colorRamp,v.gl.RGBA)),i.colorRampTexture}function Mc(v,i,u,p,g){if(!u||!p||!p.imageAtlas)return;const _=p.imageAtlas.patternPositions;let S=_[u.to.toString()],C=_[u.from.toString()];if(!S&&C&&(S=C),!C&&S&&(C=S),!S||!C){const M=g.getPaintProperty(i);S=_[M],C=_[M]}S&&C&&v.setConstantPatternPositions(S,C)}function Ju(v,i,u,p,g,_,S,C){const M=v.context.gl,R="fill-pattern",$=u.paint.get(R),G=$&&$.constantOr(1),V=u.getCrossfadeParameters();let X,Q,se,oe,le;const ue=v.transform,me=u.paint.get("fill-translate"),de=u.paint.get("fill-translate-anchor");S?(Q=G&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=M.LINES):(Q=G?"fillPattern":"fill",X=M.TRIANGLES);const ye=$.constantOr(null);for(const xe of p){const pe=i.getTile(xe);if(G&&!pe.patternsLoaded())continue;const ke=pe.getBucket(u);if(!ke)continue;const ze=ke.programConfigurations.get(u.id),je=v.useProgram(Q,ze),De=v.style.map.terrain&&v.style.map.terrain.getTerrainData(xe);G&&(v.context.activeTexture.set(M.TEXTURE0),pe.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),ze.updatePaintBuffers(V)),Mc(ze,R,ye,pe,u);const $e=ue.getProjectionData({overscaledTileID:xe,applyGlobeMatrix:!C,applyTerrainMatrix:!0}),at=s.aD(ue,pe,me,de);if(S){oe=ke.indexBuffer2,le=ke.segments2;const Ye=[M.drawingBufferWidth,M.drawingBufferHeight];se=Q==="fillOutlinePattern"&&G?xc(v,V,pe,Ye,at):_c(Ye,at)}else oe=ke.indexBuffer,le=ke.segments,se=G?Fu(v,V,pe,at):{u_fill_translate:at};const lt=v.stencilModeForClipping(xe);je.draw(v.context,X,g,lt,_,jt.backCCW,se,De,$e,u.id,ke.layoutVertexBuffer,oe,le,u.paint,v.transform.zoom,ze)}}function Lf(v,i,u,p,g,_,S,C){const M=v.context,R=M.gl,$="fill-extrusion-pattern",G=u.paint.get($),V=G.constantOr(1),X=u.getCrossfadeParameters(),Q=u.paint.get("fill-extrusion-opacity"),se=G.constantOr(null),oe=v.transform;for(const le of p){const ue=i.getTile(le),me=ue.getBucket(u);if(!me)continue;const de=v.style.map.terrain&&v.style.map.terrain.getTerrainData(le),ye=me.programConfigurations.get(u.id),xe=v.useProgram(V?"fillExtrusionPattern":"fillExtrusion",ye);V&&(v.context.activeTexture.set(R.TEXTURE0),ue.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),ye.updatePaintBuffers(X));const pe=oe.getProjectionData({overscaledTileID:le,applyGlobeMatrix:!C,applyTerrainMatrix:!0});Mc(ye,$,se,ue,u);const ke=s.aD(oe,ue,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),ze=u.paint.get("fill-extrusion-vertical-gradient"),je=V?Ex(v,ze,Q,ke,le,X,ue):ca(v,ze,Q,ke);xe.draw(M,M.gl.TRIANGLES,g,_,S,jt.backCCW,je,de,pe,u.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,u.paint,v.transform.zoom,ye,v.style.map.terrain&&me.centroidVertexBuffer)}}function ps(v,i,u,p,g,_,S,C,M){var R;const $=v.style.projection,G=v.context,V=v.transform,X=G.gl,Q=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],se=v.useProgram("hillshade",null,!1,Q),oe=!v.options.moving;for(const le of p){const ue=i.getTile(le),me=ue.fbo;if(!me)continue;const de=$.getMeshFromTileID(G,le.canonical,C,!0,"raster"),ye=(R=v.style.map.terrain)===null||R===void 0?void 0:R.getTerrainData(le);G.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,me.colorAttachment.get());const xe=V.getProjectionData({overscaledTileID:le,aligned:oe,applyGlobeMatrix:!M,applyTerrainMatrix:!0});se.draw(G,X.TRIANGLES,_,g[le.overscaledZ],S,jt.backCCW,Mx(v,ue,u),ye,xe,u.id,de.vertexBuffer,de.indexBuffer,de.segments)}}function Bf(v,i,u,p,g,_,S,C,M){var R;const $=v.style.projection,G=v.context,V=v.transform,X=G.gl,Q=v.useProgram("colorRelief"),se=!v.options.moving;let oe=!0,le=0;for(const ue of p){const me=i.getTile(ue),de=me.dem;if(oe){const je=X.getParameter(X.MAX_TEXTURE_SIZE),{elevationTexture:De,colorTexture:$e}=u.getColorRampTextures(G,je,de.getUnpackVector());G.activeTexture.set(X.TEXTURE1),De.bind(X.NEAREST,X.CLAMP_TO_EDGE),G.activeTexture.set(X.TEXTURE4),$e.bind(X.LINEAR,X.CLAMP_TO_EDGE),oe=!1,le=De.size[0]}if(!de||!de.data)continue;const ye=de.stride,xe=de.getPixels();if(G.activeTexture.set(X.TEXTURE0),G.pixelStoreUnpackPremultiplyAlpha.set(!1),me.demTexture=me.demTexture||v.getTileTexture(ye),me.demTexture){const je=me.demTexture;je.update(xe,{premultiply:!1}),je.bind(X.LINEAR,X.CLAMP_TO_EDGE)}else me.demTexture=new s.T(G,xe,X.RGBA,{premultiply:!1}),me.demTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE);const pe=$.getMeshFromTileID(G,ue.canonical,C,!0,"raster"),ke=(R=v.style.map.terrain)===null||R===void 0?void 0:R.getTerrainData(ue),ze=V.getProjectionData({overscaledTileID:ue,aligned:se,applyGlobeMatrix:!M,applyTerrainMatrix:!0});Q.draw(G,X.TRIANGLES,_,g[ue.overscaledZ],S,jt.backCCW,Vg(u,me.dem,le),ke,ze,u.id,pe.vertexBuffer,pe.indexBuffer,pe.segments)}}const Qu=[new s.P(0,0),new s.P(s.$,0),new s.P(s.$,s.$),new s.P(0,s.$)];function ms(v,i,u,p,g,_,S,C,M=!1,R=!1){const $=p[p.length-1].overscaledZ,G=v.context,V=G.gl,X=v.useProgram("raster"),Q=v.transform,se=v.style.projection,oe=v.colorModeForRenderPass(),le=!v.options.moving;for(const ue of p){const me=v.getDepthModeForSublayer(ue.overscaledZ-$,u.paint.get("raster-opacity")===1?Bt.ReadWrite:Bt.ReadOnly,V.LESS),de=i.getTile(ue);de.registerFadeDuration(u.paint.get("raster-fade-duration"));const ye=i.findLoadedParent(ue,0),xe=i.findLoadedSibling(ue),pe=Ff(de,ye||xe||null,i,u,v.transform,v.style.map.terrain);let ke,ze;const je=u.paint.get("raster-resampling")==="nearest"?V.NEAREST:V.LINEAR;G.activeTexture.set(V.TEXTURE0),de.texture.bind(je,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),G.activeTexture.set(V.TEXTURE1),ye?(ye.texture.bind(je,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),ke=Math.pow(2,ye.tileID.overscaledZ-de.tileID.overscaledZ),ze=[de.tileID.canonical.x*ke%1,de.tileID.canonical.y*ke%1]):de.texture.bind(je,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),de.texture.useMipmap&&G.extTextureFilterAnisotropic&&v.transform.pitch>20&&V.texParameterf(V.TEXTURE_2D,G.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,G.extTextureFilterAnisotropicMax);const De=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ue),$e=Q.getProjectionData({overscaledTileID:ue,aligned:le,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),at=bc(ze||[0,0],ke||1,pe,u,C),lt=se.getMeshFromTileID(G,ue.canonical,_,S,"raster");X.draw(G,V.TRIANGLES,me,g?g[ue.overscaledZ]:ir.disabled,oe,M?jt.frontCCW:jt.backCCW,at,De,$e,u.id,lt.vertexBuffer,lt.indexBuffer,lt.segments)}}function Ff(v,i,u,p,g,_){const S=p.paint.get("raster-fade-duration");if(!_&&S>0){const C=I.now(),M=(C-v.timeAdded)/S,R=i?(C-i.timeAdded)/S:-1,$=u.getSource(),G=wt(g,{tileSize:$.tileSize,roundZoom:$.roundZoom}),V=!i||Math.abs(i.tileID.overscaledZ-G)>Math.abs(v.tileID.overscaledZ-G),X=V&&v.refreshedUponExpiration?1:s.ah(V?M:1-R,0,1);return v.refreshedUponExpiration&&M>=1&&(v.refreshedUponExpiration=!1),i?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const sy=new s.bf(1,0,0,1),ly=new s.bf(0,1,0,1),eh=new s.bf(0,0,1,1),Uf=new s.bf(1,0,1,1),Fx=new s.bf(0,1,1,1);function Vf(v,i,u,p){Na(v,0,i+u/2,v.transform.width,u,p)}function Vr(v,i,u,p){Na(v,i-u/2,0,u,v.transform.height,p)}function Na(v,i,u,p,g,_){const S=v.context,C=S.gl;C.enable(C.SCISSOR_TEST),C.scissor(i*v.pixelRatio,u*v.pixelRatio,p*v.pixelRatio,g*v.pixelRatio),S.clear({color:_}),C.disable(C.SCISSOR_TEST)}function Zi(v,i,u){const p=v.context,g=p.gl,_=v.useProgram("debug"),S=Bt.disabled,C=ir.disabled,M=v.colorModeForRenderPass(),R="$debug",$=v.style.map.terrain&&v.style.map.terrain.getTerrainData(u);p.activeTexture.set(g.TEXTURE0);const G=i.getTileByID(u.key).latestRawTileData,V=Math.floor((G&&G.byteLength||0)/1024),X=i.getTile(u).tileSize,Q=512/Math.min(X,512)*(u.overscaledZ/v.transform.zoom)*.5;let se=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(se+=` => ${u.overscaledZ}`),function(le,ue){le.initDebugOverlayCanvas();const me=le.debugOverlayCanvas,de=le.context.gl,ye=le.debugOverlayCanvas.getContext("2d");ye.clearRect(0,0,me.width,me.height),ye.shadowColor="white",ye.shadowBlur=2,ye.lineWidth=1.5,ye.strokeStyle="white",ye.textBaseline="top",ye.font="bold 36px Open Sans, sans-serif",ye.fillText(ue,5,5),ye.strokeText(ue,5,5),le.debugOverlayTexture.update(me),le.debugOverlayTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)}(v,`${se} ${V}kB`);const oe=v.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});_.draw(p,g.TRIANGLES,S,C,jr.alphaBlended,jt.disabled,cs(s.bf.transparent,Q),null,oe,R,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),_.draw(p,g.LINE_STRIP,S,C,M,jt.disabled,cs(s.bf.red),$,oe,R,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function th(v,i,u,p){const{isRenderingGlobe:g}=p,_=v.context,S=_.gl,C=v.transform,M=v.colorModeForRenderPass(),R=v.getDepthModeFor3D(),$=v.useProgram("terrain");_.bindFramebuffer.set(null),_.viewport.set([0,0,v.width,v.height]);for(const G of u){const V=i.getTerrainMesh(G.tileID),X=v.renderToTexture.getTexture(G),Q=i.getTerrainData(G.tileID);_.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,X.texture);const se=i.getMeshFrameDelta(C.zoom),oe=C.calculateFogMatrix(G.tileID.toUnwrapped()),le=Lu(se,oe,v.style.sky,C.pitch,g),ue=C.getProjectionData({overscaledTileID:G.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});$.draw(_,S.TRIANGLES,R,ir.disabled,M,jt.backCCW,le,Q,ue,"terrain",V.vertexBuffer,V.indexBuffer,V.segments)}}function Ic(v,i){if(!i.mesh){const u=new s.aL;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const p=new s.aN;p.emplaceBack(0,1,2),p.emplaceBack(0,2,3),i.mesh=new ns(v.createVertexBuffer(u,Do.members),v.createIndexBuffer(p),s.aM.simpleSegment(0,0,u.length,p.length))}return i.mesh}class cy{constructor(i,u){this.context=new ny(i),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ht.maxUnderzooming+Ht.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new il}resize(i,u,p){if(this.width=Math.floor(i*p),this.height=Math.floor(u*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const i=this.context,u=new s.aL;u.emplaceBack(0,0),u.emplaceBack(s.$,0),u.emplaceBack(0,s.$),u.emplaceBack(s.$,s.$),this.tileExtentBuffer=i.createVertexBuffer(u,Do.members),this.tileExtentSegments=s.aM.simpleSegment(0,0,4,2);const p=new s.aL;p.emplaceBack(0,0),p.emplaceBack(s.$,0),p.emplaceBack(0,s.$),p.emplaceBack(s.$,s.$),this.debugBuffer=i.createVertexBuffer(p,Do.members),this.debugSegments=s.aM.simpleSegment(0,0,4,5);const g=new s.c6;g.emplaceBack(0,0,0,0),g.emplaceBack(s.$,0,s.$,0),g.emplaceBack(0,s.$,0,s.$),g.emplaceBack(s.$,s.$,s.$,s.$),this.rasterBoundsBuffer=i.createVertexBuffer(g,Tx.members),this.rasterBoundsSegments=s.aM.simpleSegment(0,0,4,2);const _=new s.aL;_.emplaceBack(0,0),_.emplaceBack(s.$,0),_.emplaceBack(0,s.$),_.emplaceBack(s.$,s.$),this.rasterBoundsBufferPosOnly=i.createVertexBuffer(_,Do.members),this.rasterBoundsSegmentsPosOnly=s.aM.simpleSegment(0,0,4,5);const S=new s.aL;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(S,Do.members),this.viewportSegments=s.aM.simpleSegment(0,0,4,2);const C=new s.c7;C.emplaceBack(0),C.emplaceBack(1),C.emplaceBack(3),C.emplaceBack(2),C.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(C);const M=new s.aN;M.emplaceBack(1,0,2),M.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(M);const R=this.context.gl;this.stencilClearMode=new ir({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO),this.tileExtentMesh=new ns(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const i=this.context,u=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=s.L();s.bY(p,0,this.width,this.height,0,0,1),s.N(p,p,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const g={mainMatrix:p,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:p};this.useProgram("clippingMask",null,!0).draw(i,u.TRIANGLES,Bt.disabled,this.stencilClearMode,jr.disabled,jt.disabled,null,null,g,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,u,p){if(this.currentStencilSource===i.source||!i.isTileClipped()||!u||!u.length)return;this.currentStencilSource=i.source,this.nextStencilID+u.length>256&&this.clearStencil();const g=this.context;g.setColorMode(jr.disabled),g.setDepthMode(Bt.disabled);const _={};for(const S of u)_[S.key]=this.nextStencilID++;this._renderTileMasks(_,u,p,!0),this._renderTileMasks(_,u,p,!1),this._tileClippingMaskIDs=_}_renderTileMasks(i,u,p,g){const _=this.context,S=_.gl,C=this.style.projection,M=this.transform,R=this.useProgram("clippingMask");for(const $ of u){const G=i[$.key],V=this.style.map.terrain&&this.style.map.terrain.getTerrainData($),X=C.getMeshFromTileID(this.context,$.canonical,g,!0,"stencil"),Q=M.getProjectionData({overscaledTileID:$,applyGlobeMatrix:!p,applyTerrainMatrix:!0});R.draw(_,S.TRIANGLES,Bt.disabled,new ir({func:S.ALWAYS,mask:0},G,255,S.KEEP,S.KEEP,S.REPLACE),jr.disabled,p?jt.disabled:jt.backCCW,null,V,Q,"$clipping",X.vertexBuffer,X.indexBuffer,X.segments)}}_renderTilesDepthBuffer(){const i=this.context,u=i.gl,p=this.style.projection,g=this.transform,_=this.useProgram("depth"),S=this.getDepthModeFor3D(),C=Ce(g,{tileSize:g.tileSize});for(const M of C){const R=this.style.map.terrain&&this.style.map.terrain.getTerrainData(M),$=p.getMeshFromTileID(this.context,M.canonical,!0,!0,"raster"),G=g.getProjectionData({overscaledTileID:M,applyGlobeMatrix:!0,applyTerrainMatrix:!0});_.draw(i,u.TRIANGLES,S,ir.disabled,jr.disabled,jt.backCCW,null,R,G,"$clipping",$.vertexBuffer,$.indexBuffer,$.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,u=this.context.gl;return new ir({func:u.NOTEQUAL,mask:255},i,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(i){const u=this.context.gl;return new ir({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(i){const u=this.context.gl,p=i.sort((S,C)=>C.overscaledZ-S.overscaledZ),g=p[p.length-1].overscaledZ,_=p[0].overscaledZ-g+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const S={};for(let C=0;C<_;C++)S[C+g]=new ir({func:u.GEQUAL,mask:255},C+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=_,[S,p]}return[{[g]:ir.disabled},p]}stencilConfigForOverlapTwoPass(i){const u=this.context.gl,p=i.sort((S,C)=>C.overscaledZ-S.overscaledZ),g=p[p.length-1].overscaledZ,_=p[0].overscaledZ-g+1;if(this.clearStencil(),_>1){const S={},C={};for(let M=0;M<_;M++)S[M+g]=new ir({func:u.GREATER,mask:255},_+1+M,255,u.KEEP,u.KEEP,u.REPLACE),C[M+g]=new ir({func:u.GREATER,mask:255},1+M,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*_+1,[S,C,p]}return this.nextStencilID=3,[{[g]:new ir({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[g]:new ir({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},p]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new jr([i.CONSTANT_COLOR,i.ONE],new s.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?jr.unblended:jr.alphaBlended}getDepthModeForSublayer(i,u,p){if(!this.opaquePassEnabledForLayer())return Bt.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new Bt(p||this.context.gl.LEQUAL,u,[g,g])}getDepthModeFor3D(){return new Bt(this.context.gl.LEQUAL,Bt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,u){var p,g;this.style=i,this.options=u,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(I.now()),this.imageManager.beginFrame();const _=this.style._order,S=this.style.sourceCaches,C={},M={},R={},$={isRenderingToTexture:!1,isRenderingGlobe:((p=i.projection)===null||p===void 0?void 0:p.transitionState)>0};for(const V in S){const X=S[V];X.used&&X.prepare(this.context),C[V]=X.getVisibleCoordinates(!1),M[V]=C[V].slice().reverse(),R[V]=X.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let V=0;V<_.length;V++)if(this.style._layers[_[V]].is3D()){this.opaquePassCutoff=V;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const V of _){const X=this.style._layers[V];if(!X.hasOffscreenPass()||X.isHidden(this.transform.zoom))continue;const Q=M[X.source];(X.type==="custom"||Q.length)&&this.renderLayer(this,S[X.source],X,Q,$)}if((g=this.style.projection)===null||g===void 0||g.updateGPUdependent({context:this.context,useProgram:V=>this.useProgram(V)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?s.bf.black:s.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(V,X){const Q=V.context,se=Q.gl,oe=((xe,pe,ke)=>{const ze=Math.cos(pe.rollInRadians),je=Math.sin(pe.rollInRadians),De=_e(pe),$e=pe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:xe.properties.get("sky-color"),u_horizon_color:xe.properties.get("horizon-color"),u_horizon:[(pe.width/2-De*je)*ke,(pe.height/2+De*ze)*ke],u_horizon_normal:[-je,ze],u_sky_horizon_blend:xe.properties.get("sky-horizon-blend")*pe.height/2*ke,u_sky_blend:$e}})(X,V.style.map.transform,V.pixelRatio),le=new Bt(se.LEQUAL,Bt.ReadWrite,[0,1]),ue=ir.disabled,me=V.colorModeForRenderPass(),de=V.useProgram("sky"),ye=Ic(Q,X);de.draw(Q,se.TRIANGLES,le,ue,me,jt.disabled,oe,null,void 0,"sky",ye.vertexBuffer,ye.indexBuffer,ye.segments)}(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const V=this.style._layers[_[this.currentLayer]],X=S[V.source],Q=C[V.source];this._renderTileClippingMasks(V,Q,!1),this.renderLayer(this,X,V,Q,$)}this.renderPass="translucent";let G=!1;for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const V=this.style._layers[_[this.currentLayer]],X=S[V.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(V,$))continue;this.opaquePassEnabledForLayer()||G||(G=!0,$.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Q=(V.type==="symbol"?R:M)[V.source];this._renderTileClippingMasks(V,C[V.source],!!this.renderToTexture),this.renderLayer(this,X,V,Q,$)}if($.isRenderingGlobe&&function(V,X,Q){const se=V.context,oe=se.gl,le=V.useProgram("atmosphere"),ue=new Bt(oe.LEQUAL,Bt.ReadOnly,[0,1]),me=V.transform,de=function($e,at){const lt=$e.properties.get("position"),Ye=[-lt.x,-lt.y,-lt.z],xt=s.ag(new Float64Array(16));return $e.properties.get("anchor")==="map"&&(s.b6(xt,xt,at.rollInRadians),s.b7(xt,xt,-at.pitchInRadians),s.b6(xt,xt,at.bearingInRadians),s.b7(xt,xt,at.center.lat*Math.PI/180),s.bz(xt,xt,-at.center.lng*Math.PI/180)),s.c5(Ye,Ye,xt),Ye}(Q,V.transform),ye=me.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),xe=X.properties.get("atmosphere-blend")*ye.projectionTransition;if(xe===0)return;const pe=ol(me.worldSize,me.center.lat),ke=me.inverseProjectionMatrix,ze=new Float64Array(4);ze[3]=1,s.aw(ze,ze,me.modelViewProjectionMatrix),ze[0]/=ze[3],ze[1]/=ze[3],ze[2]/=ze[3],ze[3]=1,s.aw(ze,ze,ke),ze[0]/=ze[3],ze[1]/=ze[3],ze[2]/=ze[3],ze[3]=1;const je=(($e,at,lt,Ye,xt)=>({u_sun_pos:$e,u_atmosphere_blend:at,u_globe_position:lt,u_globe_radius:Ye,u_inv_proj_matrix:xt}))(de,xe,[ze[0],ze[1],ze[2]],pe,ke),De=Ic(se,X);le.draw(se,oe.TRIANGLES,ue,ir.disabled,jr.alphaBlended,jt.disabled,je,null,null,"atmosphere",De.vertexBuffer,De.indexBuffer,De.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const V=function(X,Q){let se=null;const oe=Object.values(X._layers).flatMap(de=>de.source&&!de.isHidden(Q)?[X.sourceCaches[de.source]]:[]),le=oe.filter(de=>de.getSource().type==="vector"),ue=oe.filter(de=>de.getSource().type!=="vector"),me=de=>{(!se||se.getSource().maxzoom<de.getSource().maxzoom)&&(se=de)};return le.forEach(de=>me(de)),se||ue.forEach(de=>me(de)),se}(this.style,this.transform.zoom);V&&function(X,Q,se){for(let oe=0;oe<se.length;oe++)Zi(X,Q,se[oe])}(this,V,V.getVisibleCoordinates())}this.options.showPadding&&function(V){const X=V.transform.padding;Vf(V,V.transform.height-(X.top||0),3,sy),Vf(V,X.bottom||0,3,ly),Vr(V,X.left||0,3,eh),Vr(V,V.transform.width-(X.right||0),3,Uf);const Q=V.transform.centerPoint;(function(se,oe,le,ue){Na(se,oe-1,le-10,2,20,ue),Na(se,oe-10,le-1,20,2,ue)})(V,Q.x,V.transform.height-Q.y,Fx)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(i){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,p=this.transform.modelViewProjectionMatrix;let g=this.terrainFacilitator.dirty;g||(g=i?!s.c8(u,p):!s.c9(u,p)),g||(g=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),g&&(s.ca(u,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(_,S){const C=_.context,M=C.gl,R=_.transform,$=jr.unblended,G=new Bt(M.LEQUAL,Bt.ReadWrite,[0,1]),V=S.sourceCache.getRenderableTiles(),X=_.useProgram("terrainDepth");C.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),C.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),C.clear({color:s.bf.transparent,depth:1});for(const Q of V){const se=S.getTerrainMesh(Q.tileID),oe=S.getTerrainData(Q.tileID),le=R.getProjectionData({overscaledTileID:Q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ue={u_ele_delta:S.getMeshFrameDelta(R.zoom)};X.draw(C,M.TRIANGLES,G,ir.disabled,$,jt.backCCW,ue,oe,le,"terrain",se.vertexBuffer,se.indexBuffer,se.segments)}C.bindFramebuffer.set(null),C.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain),function(_,S){const C=_.context,M=C.gl,R=_.transform,$=jr.unblended,G=new Bt(M.LEQUAL,Bt.ReadWrite,[0,1]),V=S.getCoordsTexture(),X=S.sourceCache.getRenderableTiles(),Q=_.useProgram("terrainCoords");C.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),C.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),C.clear({color:s.bf.transparent,depth:1}),S.coordsIndex=[];for(const se of X){const oe=S.getTerrainMesh(se.tileID),le=S.getTerrainData(se.tileID);C.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,V.texture);const ue={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(R.zoom)},me=R.getProjectionData({overscaledTileID:se.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Q.draw(C,M.TRIANGLES,G,ir.disabled,$,jt.backCCW,ue,le,me,"terrain",oe.vertexBuffer,oe.indexBuffer,oe.segments),S.coordsIndex.push(se.tileID.key)}C.bindFramebuffer.set(null),C.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain))}renderLayer(i,u,p,g,_){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="custom"||(g||[]).length)&&(this.id=p.id,s.cb(p)?function(S,C,M,R,$,G){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:V}=G,X=ir.disabled,Q=S.colorModeForRenderPass();(M._unevaluatedLayout.hasValue("text-variable-anchor")||M._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(se,oe,le,ue,me,de,ye,xe,pe){const ke=oe.transform,ze=oe.style.map.terrain,je=me==="map",De=de==="map";for(const $e of se){const at=ue.getTile($e),lt=at.getBucket(le);if(!lt||!lt.text||!lt.text.segments.get().length)continue;const Ye=s.an(lt.textSizeData,ke.zoom),xt=s.aC(at,1,oe.transform.zoom),qt=nn(je,oe.transform,xt),hr=le.layout.get("icon-text-fit")!=="none"&&lt.hasIconData();if(Ye){const _r=Math.pow(2,ke.zoom-at.tileID.overscaledZ),gr=ze?($r,Gr)=>ze.getElevation($e,$r,Gr):null;$f(lt,je,De,pe,ke,qt,_r,Ye,hr,s.aD(ke,at,ye,xe),$e.toUnwrapped(),gr)}}}(R,S,M,C,M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),$),M.paint.get("icon-opacity").constantOr(1)!==0&&kc(S,C,M,R,!1,M.paint.get("icon-translate"),M.paint.get("icon-translate-anchor"),M.layout.get("icon-rotation-alignment"),M.layout.get("icon-pitch-alignment"),M.layout.get("icon-keep-upright"),X,Q,V),M.paint.get("text-opacity").constantOr(1)!==0&&kc(S,C,M,R,!0,M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.layout.get("text-keep-upright"),X,Q,V),C.map.showCollisionBoxes&&(iy(S,C,M,R,!0),iy(S,C,M,R,!1))}(i,u,p,g,this.style.placement.variableOffsets,_):s.cc(p)?function(S,C,M,R,$){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:G}=$,V=M.paint.get("circle-opacity"),X=M.paint.get("circle-stroke-width"),Q=M.paint.get("circle-stroke-opacity"),se=!M.layout.get("circle-sort-key").isConstant();if(V.constantOr(1)===0&&(X.constantOr(1)===0||Q.constantOr(1)===0))return;const oe=S.context,le=oe.gl,ue=S.transform,me=S.getDepthModeForSublayer(0,Bt.ReadOnly),de=ir.disabled,ye=S.colorModeForRenderPass(),xe=[],pe=ue.getCircleRadiusCorrection();for(let ke=0;ke<R.length;ke++){const ze=R[ke],je=C.getTile(ze),De=je.getBucket(M);if(!De)continue;const $e=M.paint.get("circle-translate"),at=M.paint.get("circle-translate-anchor"),lt=s.aD(ue,je,$e,at),Ye=De.programConfigurations.get(M.id),xt=S.useProgram("circle",Ye),qt=De.layoutVertexBuffer,hr=De.indexBuffer,_r=S.style.map.terrain&&S.style.map.terrain.getTerrainData(ze),gr={programConfiguration:Ye,program:xt,layoutVertexBuffer:qt,indexBuffer:hr,uniformValues:Ax(S,je,M,lt,pe),terrainData:_r,projectionData:ue.getProjectionData({overscaledTileID:ze,applyGlobeMatrix:!G,applyTerrainMatrix:!0})};if(se){const $r=De.segments.get();for(const Gr of $r)xe.push({segments:new s.aM([Gr]),sortKey:Gr.sortKey,state:gr})}else xe.push({segments:De.segments,sortKey:0,state:gr})}se&&xe.sort((ke,ze)=>ke.sortKey-ze.sortKey);for(const ke of xe){const{programConfiguration:ze,program:je,layoutVertexBuffer:De,indexBuffer:$e,uniformValues:at,terrainData:lt,projectionData:Ye}=ke.state;je.draw(oe,le.TRIANGLES,me,de,ye,jt.backCCW,at,lt,Ye,M.id,De,$e,ke.segments,M.paint,S.transform.zoom,ze)}}(i,u,p,g,_):s.cd(p)?function(S,C,M,R,$){if(M.paint.get("heatmap-opacity")===0)return;const G=S.context,{isRenderingToTexture:V,isRenderingGlobe:X}=$;if(S.style.map.terrain){for(const Q of R){const se=C.getTile(Q);C.hasRenderableParent(Q)||(S.renderPass==="offscreen"?zf(S,se,M,Q,X):S.renderPass==="translucent"&&oy(S,M,Q,V,X))}G.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?function(Q,se,oe,le){const ue=Q.context,me=ue.gl,de=Q.transform,ye=ir.disabled,xe=new jr([me.ONE,me.ONE],s.bf.transparent,[!0,!0,!0,!0]);(function(pe,ke,ze){const je=pe.gl;pe.activeTexture.set(je.TEXTURE1),pe.viewport.set([0,0,ke.width/4,ke.height/4]);let De=ze.heatmapFbos.get(s.c2);De?(je.bindTexture(je.TEXTURE_2D,De.colorAttachment.get()),pe.bindFramebuffer.set(De.framebuffer)):(De=Ac(pe,ke.width/4,ke.height/4),ze.heatmapFbos.set(s.c2,De))})(ue,Q,oe),ue.clear({color:s.bf.transparent});for(let pe=0;pe<le.length;pe++){const ke=le[pe];if(se.hasRenderableParent(ke))continue;const ze=se.getTile(ke),je=ze.getBucket(oe);if(!je)continue;const De=je.programConfigurations.get(oe.id),$e=Q.useProgram("heatmap",De),at=de.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),lt=de.getCircleRadiusCorrection();$e.draw(ue,me.TRIANGLES,Bt.disabled,ye,xe,jt.backCCW,Fg(ze,de.zoom,oe.paint.get("heatmap-intensity"),lt),null,at,oe.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,oe.paint,de.zoom,De)}ue.viewport.set([0,0,Q.width,Q.height])}(S,C,M,R):S.renderPass==="translucent"&&function(Q,se){const oe=Q.context,le=oe.gl;oe.setColorMode(Q.colorModeForRenderPass());const ue=se.heatmapFbos.get(s.c2);ue&&(oe.activeTexture.set(le.TEXTURE0),le.bindTexture(le.TEXTURE_2D,ue.colorAttachment.get()),oe.activeTexture.set(le.TEXTURE1),Cc(oe,se).bind(le.LINEAR,le.CLAMP_TO_EDGE),Q.useProgram("heatmapTexture").draw(oe,le.TRIANGLES,Bt.disabled,ir.disabled,Q.colorModeForRenderPass(),jt.disabled,Pf(Q,se,0,1),null,null,se.id,Q.viewportBuffer,Q.quadTriangleIndexBuffer,Q.viewportSegments,se.paint,Q.transform.zoom))}(S,M)}(i,u,p,g,_):s.ce(p)?function(S,C,M,R,$){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:G}=$,V=M.paint.get("line-opacity"),X=M.paint.get("line-width");if(V.constantOr(1)===0||X.constantOr(1)===0)return;const Q=S.getDepthModeForSublayer(0,Bt.ReadOnly),se=S.colorModeForRenderPass(),oe=M.paint.get("line-dasharray"),le=M.paint.get("line-pattern"),ue=le.constantOr(1),me=M.paint.get("line-gradient"),de=M.getCrossfadeParameters(),ye=ue?"linePattern":oe?"lineSDF":me?"lineGradient":"line",xe=S.context,pe=xe.gl,ke=S.transform;let ze=!0;for(const je of R){const De=C.getTile(je);if(ue&&!De.patternsLoaded())continue;const $e=De.getBucket(M);if(!$e)continue;const at=$e.programConfigurations.get(M.id),lt=S.context.program.get(),Ye=S.useProgram(ye,at),xt=ze||Ye.program!==lt,qt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(je),hr=le.constantOr(null);if(hr&&De.imageAtlas){const Ut=De.imageAtlas,xr=Ut.patternPositions[hr.to.toString()],hn=Ut.patternPositions[hr.from.toString()];xr&&hn&&at.setConstantPatternPositions(xr,hn)}const _r=ke.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!G,applyTerrainMatrix:!0}),gr=ke.getPixelScale(),$r=ue?qg(S,De,M,gr,de):oe?us(S,De,M,gr,oe,de):me?Gg(S,De,M,gr,$e.lineClipsArray.length):Vu(S,De,M,gr);if(ue)xe.activeTexture.set(pe.TEXTURE0),De.imageAtlasTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),at.updatePaintBuffers(de);else if(oe&&(xt||S.lineAtlas.dirty))xe.activeTexture.set(pe.TEXTURE0),S.lineAtlas.bind(xe);else if(me){const Ut=$e.gradients[M.id];let xr=Ut.texture;if(M.gradientVersion!==Ut.version){let hn=256;if(M.stepInterpolant){const xn=C.getSource().maxzoom,En=je.canonical.z===xn?Math.ceil(1<<S.transform.maxZoom-je.canonical.z):1;hn=s.ah(s.c3($e.maxLineLength/s.$*1024*En),256,xe.maxTextureSize)}Ut.gradient=s.c4({expression:M.gradientExpression(),evaluationKey:"lineProgress",resolution:hn,image:Ut.gradient||void 0,clips:$e.lineClipsArray}),Ut.texture?Ut.texture.update(Ut.gradient):Ut.texture=new s.T(xe,Ut.gradient,pe.RGBA),Ut.version=M.gradientVersion,xr=Ut.texture}xe.activeTexture.set(pe.TEXTURE0),xr.bind(M.stepInterpolant?pe.NEAREST:pe.LINEAR,pe.CLAMP_TO_EDGE)}const Gr=S.stencilModeForClipping(je);Ye.draw(xe,pe.TRIANGLES,Q,Gr,se,jt.disabled,$r,qt,_r,M.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,M.paint,S.transform.zoom,at,$e.layoutVertexBuffer2),ze=!1}}(i,u,p,g,_):s.cf(p)?function(S,C,M,R,$){const G=M.paint.get("fill-color"),V=M.paint.get("fill-opacity");if(V.constantOr(1)===0)return;const{isRenderingToTexture:X}=$,Q=S.colorModeForRenderPass(),se=M.paint.get("fill-pattern"),oe=S.opaquePassEnabledForLayer()&&!se.constantOr(1)&&G.constantOr(s.bf.transparent).a===1&&V.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===oe){const le=S.getDepthModeForSublayer(1,S.renderPass==="opaque"?Bt.ReadWrite:Bt.ReadOnly);Ju(S,C,M,R,le,Q,!1,X)}if(S.renderPass==="translucent"&&M.paint.get("fill-antialias")){const le=S.getDepthModeForSublayer(M.getPaintProperty("fill-outline-color")?2:0,Bt.ReadOnly);Ju(S,C,M,R,le,Q,!0,X)}}(i,u,p,g,_):s.cg(p)?function(S,C,M,R,$){const G=M.paint.get("fill-extrusion-opacity");if(G===0)return;const{isRenderingToTexture:V}=$;if(S.renderPass==="translucent"){const X=new Bt(S.context.gl.LEQUAL,Bt.ReadWrite,S.depthRangeFor3D);if(G!==1||M.paint.get("fill-extrusion-pattern").constantOr(1))Lf(S,C,M,R,X,ir.disabled,jr.disabled,V),Lf(S,C,M,R,X,S.stencilModeFor3D(),S.colorModeForRenderPass(),V);else{const Q=S.colorModeForRenderPass();Lf(S,C,M,R,X,ir.disabled,Q,V)}}}(i,u,p,g,_):s.ch(p)?function(S,C,M,R,$){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const{isRenderingToTexture:G}=$,V=S.context,X=S.style.projection.useSubdivision,Q=S.getDepthModeForSublayer(0,Bt.ReadOnly),se=S.colorModeForRenderPass();if(S.renderPass==="offscreen")(function(oe,le,ue,me,de,ye,xe){const pe=oe.context,ke=pe.gl;for(const ze of ue){const je=le.getTile(ze),De=je.dem;if(!De||!De.data||!je.needsHillshadePrepare)continue;const $e=De.dim,at=De.stride,lt=De.getPixels();if(pe.activeTexture.set(ke.TEXTURE1),pe.pixelStoreUnpackPremultiplyAlpha.set(!1),je.demTexture=je.demTexture||oe.getTileTexture(at),je.demTexture){const xt=je.demTexture;xt.update(lt,{premultiply:!1}),xt.bind(ke.NEAREST,ke.CLAMP_TO_EDGE)}else je.demTexture=new s.T(pe,lt,ke.RGBA,{premultiply:!1}),je.demTexture.bind(ke.NEAREST,ke.CLAMP_TO_EDGE);pe.activeTexture.set(ke.TEXTURE0);let Ye=je.fbo;if(!Ye){const xt=new s.T(pe,{width:$e,height:$e,data:null},ke.RGBA);xt.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),Ye=je.fbo=pe.createFramebuffer($e,$e,!0,!1),Ye.colorAttachment.set(xt.texture)}pe.bindFramebuffer.set(Ye.framebuffer),pe.viewport.set([0,0,$e,$e]),oe.useProgram("hillshadePrepare").draw(pe,ke.TRIANGLES,de,ye,xe,jt.disabled,Ug(je.tileID,De),null,null,me.id,oe.rasterBoundsBuffer,oe.quadTriangleIndexBuffer,oe.rasterBoundsSegments),je.needsHillshadePrepare=!1}})(S,C,R,M,Q,ir.disabled,se),V.viewport.set([0,0,S.width,S.height]);else if(S.renderPass==="translucent")if(X){const[oe,le,ue]=S.stencilConfigForOverlapTwoPass(R);ps(S,C,M,ue,oe,Q,se,!1,G),ps(S,C,M,ue,le,Q,se,!0,G)}else{const[oe,le]=S.getStencilConfigForOverlapAndUpdateStencilID(R);ps(S,C,M,le,oe,Q,se,!1,G)}}(i,u,p,g,_):s.ci(p)?function(S,C,M,R,$){if(S.renderPass!=="translucent"||!R.length)return;const{isRenderingToTexture:G}=$,V=S.style.projection.useSubdivision,X=S.getDepthModeForSublayer(0,Bt.ReadOnly),Q=S.colorModeForRenderPass();if(V){const[se,oe,le]=S.stencilConfigForOverlapTwoPass(R);Bf(S,C,M,le,se,X,Q,!1,G),Bf(S,C,M,le,oe,X,Q,!0,G)}else{const[se,oe]=S.getStencilConfigForOverlapAndUpdateStencilID(R);Bf(S,C,M,oe,se,X,Q,!1,G)}}(i,u,p,g,_):s.cj(p)?function(S,C,M,R,$){if(S.renderPass!=="translucent"||M.paint.get("raster-opacity")===0||!R.length)return;const{isRenderingToTexture:G}=$,V=C.getSource(),X=S.style.projection.useSubdivision;if(V instanceof Nn)ms(S,C,M,R,null,!1,!1,V.tileCoords,V.flippedWindingOrder,G);else if(X){const[Q,se,oe]=S.stencilConfigForOverlapTwoPass(R);ms(S,C,M,oe,Q,!1,!0,Qu,!1,G),ms(S,C,M,oe,se,!0,!0,Qu,!1,G)}else{const[Q,se]=S.getStencilConfigForOverlapAndUpdateStencilID(R);ms(S,C,M,se,Q,!1,!0,Qu,!1,G)}}(i,u,p,g,_):s.ck(p)?function(S,C,M,R,$){const G=M.paint.get("background-color"),V=M.paint.get("background-opacity");if(V===0)return;const{isRenderingToTexture:X}=$,Q=S.context,se=Q.gl,oe=S.style.projection,le=S.transform,ue=le.tileSize,me=M.paint.get("background-pattern");if(S.isPatternMissing(me))return;const de=!me&&G.a===1&&V===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==de)return;const ye=ir.disabled,xe=S.getDepthModeForSublayer(0,de==="opaque"?Bt.ReadWrite:Bt.ReadOnly),pe=S.colorModeForRenderPass(),ke=S.useProgram(me?"backgroundPattern":"background"),ze=R||Ce(le,{tileSize:ue,terrain:S.style.map.terrain});me&&(Q.activeTexture.set(se.TEXTURE0),S.imageManager.bind(S.context));const je=M.getCrossfadeParameters();for(const De of ze){const $e=le.getProjectionData({overscaledTileID:De,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),at=me?Zg(V,S,me,{tileID:De,tileSize:ue},je):Hg(V,G),lt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(De),Ye=oe.getMeshFromTileID(Q,De.canonical,!1,!0,"raster");ke.draw(Q,se.TRIANGLES,xe,ye,pe,jt.backCCW,at,lt,$e,M.id,Ye.vertexBuffer,Ye.indexBuffer,Ye.segments)}}(i,0,p,g,_):s.cl(p)&&function(S,C,M,R){const{isRenderingGlobe:$}=R,G=S.context,V=M.implementation,X=S.style.projection,Q=S.transform,se=Q.getProjectionDataForCustomLayer($),oe={farZ:Q.farZ,nearZ:Q.nearZ,fov:Q.fov*Math.PI/180,modelViewProjectionMatrix:Q.modelViewProjectionMatrix,projectionMatrix:Q.projectionMatrix,shaderData:{variantName:X.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${X.shaderPreludeCode.vertexSource}`,define:X.shaderDefine},defaultProjectionData:se},le=V.renderingMode?V.renderingMode:"2d";if(S.renderPass==="offscreen"){const ue=V.prerender;ue&&(S.setCustomLayerDefaults(),G.setColorMode(S.colorModeForRenderPass()),ue.call(V,G.gl,oe),G.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),G.setColorMode(S.colorModeForRenderPass()),G.setStencilMode(ir.disabled);const ue=le==="3d"?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,Bt.ReadOnly);G.setDepthMode(ue),V.render(G.gl,oe),G.setDirty(),S.setBaseState(),G.bindFramebuffer.set(null)}}(i,0,p,_))}saveTileTexture(i){const u=this._tileTextures[i.size[0]];u?u.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const u=this._tileTextures[i];return u&&u.length>0?u.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const u=this.imageManager.getPattern(i.from.toString()),p=this.imageManager.getPattern(i.to.toString());return!u||!p}useProgram(i,u,p=!1,g=[]){this.cache=this.cache||{};const _=!!this.style.map.terrain,S=this.style.projection,C=p?sa.projectionMercator:S.shaderPreludeCode,M=p?eo:S.shaderDefine,R=i+(u?u.cacheKey:"")+`/${p?is:S.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(_?"/terrain":"")+(g?`/${g.join("/")}`:"");return this.cache[R]||(this.cache[R]=new Sf(this.context,sa[i],u,Cf[i],this._showOverdrawInspector,_,C,M,g)),this.cache[R]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:i,drawingBufferHeight:u}=this.context.gl;return this.width!==i||this.height!==u}}function gs(v,i){let u,p=!1,g=null,_=null;const S=()=>{g=null,p&&(v.apply(_,u),g=setTimeout(S,i),p=!1)};return(...C)=>(p=!0,_=this,u=C,g||S(),g)}class rh{constructor(i){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let p;return u.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(p=g)}),(p&&p[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:p,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const p=u.join("/");let g=p;g.split("&").length>0&&(g=g.split("&")[0]),this._hashName&&(g=`${this._hashName}=${p}`);let _=window.location.hash.replace(g,"");_.startsWith("#&")?_=_.slice(0,1)+_.slice(2):_==="#"&&(_="");let S=window.location.href.replace(/(#.+)?$/,_);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=gs(this._updateHashUnthrottled,300),this._hashName=i&&encodeURIComponent(i)}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(i){const u=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,g=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,g),S=Math.round(u.lng*_)/_,C=Math.round(u.lat*_)/_,M=this._map.getBearing(),R=this._map.getPitch();let $="";if($+=i?`/${S}/${C}/${p}`:`${p}/${C}/${S}`,(M||R)&&($+="/"+Math.round(10*M)/10),R&&($+=`/${Math.round(R)}`),this._hashName){const G=this._hashName;let V=!1;const X=window.location.hash.slice(1).split("&").map(Q=>{const se=Q.split("=")[0];return se===G?(V=!0,`${se}=${$}`):Q}).filter(Q=>Q);return V||X.push(`${G}=${$}`),`#${X.join("&")}`}return`#${$}`}_isValidHash(i){if(i.length<3||i.some(isNaN))return!1;try{new s.S(+i[2],+i[1])}catch{return!1}const u=+i[0],p=+(i[3]||0),g=+(i[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&p>=-180&&p<=180&&g>=this._map.getMinPitch()&&g<=this._map.getMaxPitch()}}const no={linearity:.3,easing:s.cm(0,0,.3,1)},Gf=s.e({deceleration:2500,maxSpeed:1400},no),uy=s.e({deceleration:20,maxSpeed:1400},no),hy=s.e({deceleration:1e3,maxSpeed:360},no),dy=s.e({deceleration:1e3,maxSpeed:90},no),fy=s.e({deceleration:1e3,maxSpeed:360},no);class py{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:I.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,u=I.now();for(;i.length>0&&u-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)u.zoom+=_.zoomDelta||0,u.bearing+=_.bearingDelta||0,u.pitch+=_.pitchDelta||0,u.roll+=_.rollDelta||0,_.panDelta&&u.pan._add(_.panDelta),_.around&&(u.around=_.around),_.pinchAround&&(u.pinchAround=_.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(u.pan.mag()){const _=ul(u.pan.mag(),p,s.e({},Gf,i||{})),S=u.pan.mult(_.amount/u.pan.mag()),C=this._map.cameraHelper.handlePanInertia(S,this._map.transform);g.center=C.easingCenter,g.offset=C.easingOffset,ua(g,_)}if(u.zoom){const _=ul(u.zoom,p,uy);g.zoom=this._map.transform.zoom+_.amount,ua(g,_)}if(u.bearing){const _=ul(u.bearing,p,hy);g.bearing=this._map.transform.bearing+s.ah(_.amount,-179,179),ua(g,_)}if(u.pitch){const _=ul(u.pitch,p,dy);g.pitch=this._map.transform.pitch+_.amount,ua(g,_)}if(u.roll){const _=ul(u.roll,p,fy);g.roll=this._map.transform.roll+s.ah(_.amount,-179,179),ua(g,_)}if(g.zoom||g.bearing){const _=u.pinchAround===void 0?u.around:u.pinchAround;g.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),s.e(g,{noMoveStart:!0})}}function ua(v,i){(!v.duration||v.duration<i.duration)&&(v.duration=i.duration,v.easing=i.easing)}function ul(v,i,u){const{maxSpeed:p,linearity:g,deceleration:_}=u,S=s.ah(v*g/(i/1e3),-p,p),C=Math.abs(S)/(_*g);return{easing:u.easing,duration:1e3*C,amount:S*(C/2)}}class wi extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,p,g={}){p=p instanceof MouseEvent?p:new MouseEvent(i,p);const _=j.mousePos(u.getCanvas(),p),S=u.unproject(_);super(i,s.e({point:_,lngLat:S,originalEvent:p},g)),this._defaultPrevented=!1,this.target=u}}class hl extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,p){const g=i==="touchend"?p.changedTouches:p.touches,_=j.touchPos(u.getCanvasContainer(),g),S=_.map(M=>u.unproject(M)),C=_.reduce((M,R,$,G)=>M.add(R.div(G.length)),new s.P(0,0));super(i,{points:_,point:C,lngLats:S,lngLat:u.unproject(C),originalEvent:p}),this._defaultPrevented=!1}}class qf extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,p){super(i,{originalEvent:p}),this._defaultPrevented=!1}}class my{constructor(i,u){this._map=i,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new qf(i.type,this._map,i))}mousedown(i,u){return this._mousedownPos=u,this._firePreventable(new wi(i.type,this._map,i))}mouseup(i){this._map.fire(new wi(i.type,this._map,i))}click(i,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new wi(i.type,this._map,i))}dblclick(i){return this._firePreventable(new wi(i.type,this._map,i))}mouseover(i){this._map.fire(new wi(i.type,this._map,i))}mouseout(i){this._map.fire(new wi(i.type,this._map,i))}touchstart(i){return this._firePreventable(new hl(i.type,this._map,i))}touchmove(i){this._map.fire(new hl(i.type,this._map,i))}touchend(i){this._map.fire(new hl(i.type,this._map,i))}touchcancel(i){this._map.fire(new hl(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class gy{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new wi(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new wi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new wi(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class dl{constructor(i){this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.screenPointToLocation(s.P.convert(i),this._map.terrain)}}class Wf{constructor(i,u){this._map=i,this._tr=new dl(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,u){this.isEnabled()&&i.shiftKey&&i.button===0&&(j.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(i,u){if(!this._active)return;const p=u;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=p,this._box||(this._box=j.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",i));const _=Math.min(g.x,p.x),S=Math.max(g.x,p.x),C=Math.min(g.y,p.y),M=Math.max(g.y,p.y);j.setTransform(this._box,`translate(${_}px,${C}px)`),this._box.style.width=S-_+"px",this._box.style.height=M-C+"px"}mouseupWindow(i,u){if(!this._active||i.button!==0)return;const p=this._startPos,g=u;if(this.reset(),j.suppressClick(),p.x!==g.x||p.y!==g.y)return this._map.fire(new s.l("boxzoomend",{originalEvent:i})),{cameraAnimation:_=>_.fitScreenCoordinates(p,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(j.remove(this._box),this._box=null),j.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,u){return this._map.fire(new s.l(i,{originalEvent:u}))}}function fl(v,i){if(v.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${i.length}`);const u={};for(let p=0;p<v.length;p++)u[v[p].identifier]=i[p];return u}class yy{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,u,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),p.length===this.numTouches&&(this.centroid=function(g){const _=new s.P(0,0);for(const S of g)_._add(S);return _.div(g.length)}(u),this.touches=fl(p,u)))}touchmove(i,u,p){if(this.aborted||!this.centroid)return;const g=fl(p,u);for(const _ in this.touches){const S=g[_];(!S||S.dist(this.touches[_])>30)&&(this.aborted=!0)}}touchend(i,u,p){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Si{constructor(i){this.singleTap=new yy(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,u,p){this.singleTap.touchstart(i,u,p)}touchmove(i,u,p){this.singleTap.touchmove(i,u,p)}touchend(i,u,p){const g=this.singleTap.touchend(i,u,p);if(g){const _=i.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(g)<30;if(_&&S||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class ha{constructor(i){this._tr=new dl(i),this._zoomIn=new Si({numTouches:1,numTaps:2}),this._zoomOut=new Si({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,u,p){this._zoomIn.touchstart(i,u,p),this._zoomOut.touchstart(i,u,p)}touchmove(i,u,p){this._zoomIn.touchmove(i,u,p),this._zoomOut.touchmove(i,u,p)}touchend(i,u,p){const g=this._zoomIn.touchend(i,u,p),_=this._zoomOut.touchend(i,u,p),S=this._tr;return g?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(g)},{originalEvent:i})}):_?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(_)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pl{constructor(i){this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){const u=this._moveFunction(...i);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(i,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,u){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i))return void this.reset(i);const g=Array.isArray(u)?u[0]:u;return!this._moved&&g.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(p,g))}dragEnd(i){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(i)&&(this._moved&&j.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const da=0,ml=2,Ux={[da]:1,[ml]:2};class jc{constructor(i){this._correctEvent=i.checkCorrectEvent}startMove(i){const u=j.mouseButton(i);this._eventButton=u}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!function(u,p){const g=Ux[p];return u.buttons===void 0||(u.buttons&g)!==g}(i,this._eventButton)}isValidEndEvent(i){return j.mouseButton(i)===this._eventButton}}class Vx{constructor(){this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){this._firstTouch=i.targetTouches[0].identifier}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}class Gx{constructor(i=new jc({checkCorrectEvent:()=>!0}),u=new Vx){this.mouseMoveStateManager=i,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(i,u,p){return i instanceof MouseEvent?u(i):typeof TouchEvent<"u"&&i instanceof TouchEvent?p(i):void 0}startMove(i){this._executeRelevantHandler(i,u=>this.mouseMoveStateManager.startMove(u),u=>this.oneFingerTouchMoveStateManager.startMove(u))}endMove(i){this._executeRelevantHandler(i,u=>this.mouseMoveStateManager.endMove(u),u=>this.oneFingerTouchMoveStateManager.endMove(u))}isValidStartEvent(i){return this._executeRelevantHandler(i,u=>this.mouseMoveStateManager.isValidStartEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u))}isValidMoveEvent(i){return this._executeRelevantHandler(i,u=>this.mouseMoveStateManager.isValidMoveEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u))}isValidEndEvent(i){return this._executeRelevantHandler(i,u=>this.mouseMoveStateManager.isValidEndEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u))}}const Oc=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=i=>{i.preventDefault()}};class Dc{constructor(i,u){this._clickTolerance=i.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(i){return i<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(i,u,p){return this._calculateTransform(i,u,p)}touchmove(i,u,p){if(this._active){if(!this._shouldBePrevented(p.length))return i.preventDefault(),this._calculateTransform(i,u,p);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",i)}}touchend(i,u,p){this._calculateTransform(i,u,p),this._active&&this._shouldBePrevented(p.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,u,p){p.length>0&&(this._active=!0);const g=fl(p,u),_=new s.P(0,0),S=new s.P(0,0);let C=0;for(const R in g){const $=g[R],G=this._touches[R];G&&(_._add($),S._add($.sub(G)),C++,g[R]=$)}if(this._touches=g,this._shouldBePrevented(C)||!S.mag())return;const M=S.div(C);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(C),panDelta:M}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,u,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([u[0],u[1]]))}touchmove(i,u,p){if(!this._firstTwoTouches)return;i.preventDefault();const[g,_]=this._firstTwoTouches,S=yt(p,u,g),C=yt(p,u,_);if(!S||!C)return;const M=this._aroundCenter?null:S.add(C).div(2);return this._move([S,C],M,i)}touchend(i,u,p){if(!this._firstTwoTouches)return;const[g,_]=this._firstTwoTouches,S=yt(p,u,g),C=yt(p,u,_);S&&C||(this._active&&j.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function yt(v,i,u){for(let p=0;p<v.length;p++)if(v[p].identifier===u)return i[p]}function Hf(v,i){return Math.log(v/i)/Math.LN2}class nh extends fa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,u){const p=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Hf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Hf(this._distance,p),pinchAround:u}}}function Zf(v,i){return 180*v.angleWith(i)/Math.PI}class gl extends fa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,u,p){const g=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Zf(this._vector,g),pinchAround:u}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const u=25/(Math.PI*this._minDiameter)*360,p=Zf(i,this._startVector);return Math.abs(p)<u}}function ys(v){return Math.abs(v.y)>Math.abs(v.x)}class ih extends fa{constructor(i){super(),this._currentTouchCount=0,this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,u,p){super.touchstart(i,u,p),this._currentTouchCount=p.length}_start(i){this._lastPoints=i,ys(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,u,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const g=i[0].sub(this._lastPoints[0]),_=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,_,p.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(g.y+_.y)/2*-.5}):void 0}gestureBeginsVertically(i,u,p){if(this._valid!==void 0)return this._valid;const g=i.mag()>=2,_=u.mag()>=2;if(!g&&!_)return;if(!g||!_)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const S=i.y>0==u.y>0;return ys(i)&&ys(u)&&S}}const er={panStep:100,bearingStep:15,pitchStep:10};class ah{constructor(i){this._tr=new dl(i);const u=er;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let u=0,p=0,g=0,_=0,S=0;switch(i.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:i.shiftKey?p=-1:(i.preventDefault(),_=-1);break;case 39:i.shiftKey?p=1:(i.preventDefault(),_=1);break;case 38:i.shiftKey?g=1:(i.preventDefault(),S=-1);break;case 40:i.shiftKey?g=-1:(i.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(p=0,g=0),{cameraAnimation:C=>{const M=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:qx,zoom:u?Math.round(M.zoom)+u*(i.shiftKey?2:1):M.zoom,bearing:M.bearing+p*this._bearingStep,pitch:M.pitch+g*this._pitchStep,offset:[-_*this._panStep,-S*this._panStep],center:M.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function qx(v){return v*(2-v)}const oh=4.000244140625,Wx=1/450;class vy{constructor(i,u){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=i,this._tr=new dl(i),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Wx}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(i){return!!this._map.cooperativeGestures.isEnabled()&&!(i.ctrlKey||this._map.cooperativeGestures.isBypassed(i))}wheel(i){if(!this.isEnabled())return;if(this._shouldBePrevented(i))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",i);let u=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const p=I.now(),g=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,u!==0&&u%oh==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(g*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),i.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=i,this._delta-=u,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=j.mousePos(this._map.getCanvas(),i),p=this._tr;this._aroundPoint=this._aroundCenter?p.transform.locationToScreenPoint(s.S.convert(p.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const C=i.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=C),typeof this._targetZoom=="number"&&(this._targetZoom+=C)}if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>oh?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&M!==0&&(M=1/M);const R=typeof this._targetZoom!="number"?i.scale:s.af(this._targetZoom);this._targetZoom=i.getConstrained(i.getCameraLngLat(),s.ak(R*M)).zoom,this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?i.zoom:this._targetZoom,p=this._startZoom,g=this._easing;let _,S=!1;if(this._type==="wheel"&&p&&g){const C=I.now()-this._lastWheelEventTime,M=Math.min((C+5)/200,1),R=g(M);_=s.C.number(p,u,R),M<1?this._frameId||(this._frameId=!0):S=!0}else _=u,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=_,{noInertia:!0,needsRenderFrame:!S,zoomDelta:_-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let u=s.co;if(this._prevEase){const p=this._prevEase,g=(I.now()-p.start)/p.duration,_=p.easing(g+.01)-p.easing(g),S=.27/Math.sqrt(_*_+1e-4)*.01,C=Math.sqrt(.0729-S*S);u=s.cm(S,C,.25,1)}return this._prevEase={start:I.now(),duration:i,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Kf{constructor(i,u){this._clickZoom=i,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Xf{constructor(i){this._tr=new dl(i),this.reset()}reset(){this._active=!1}dblclick(i,u){return i.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _y{constructor(){this._tap=new Si({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,u,p){if(!this._swipePoint)if(this._tapTime){const g=u[0],_=i.timeStamp-this._tapTime<500,S=this._tapPoint.dist(g)<30;_&&S?p.length>0&&(this._swipePoint=g,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(i,u,p)}touchmove(i,u,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const g=u[0],_=g.y-this._swipePoint.y;return this._swipePoint=g,i.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(i,u,p)}touchend(i,u,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const g=this._tap.touchend(i,u,p);g&&(this._tapTime=i.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xy{constructor(i,u,p){this._el=i,this._mousePan=u,this._touchPan=p}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Yf{constructor(i,u,p,g){this._pitchWithRotate=i.pitchWithRotate,this._rollEnabled=i.rollEnabled,this._mouseRotate=u,this._mousePitch=p,this._mouseRoll=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class by{constructor(i,u,p,g){this._el=i,this._touchZoom=u,this._touchRotate=p,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class wy{constructor(i,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=i,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const i=this._map.getCanvasContainer();i.classList.add("maplibregl-cooperative-gestures"),this._container=j.create("div","maplibregl-cooperative-gesture-screen",i);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),g=document.createElement("div");g.className="maplibregl-desktop-message",g.textContent=u,this._container.appendChild(g);const _=document.createElement("div");_.className="maplibregl-mobile-message",_.textContent=p,this._container.appendChild(_),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(j.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(i){return i[this._bypassKey]}notifyGestureBlocked(i,u){this._enabled&&(this._map.fire(new s.l("cooperativegestureprevented",{gestureType:i,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const pa=v=>v.zoom||v.drag||v.roll||v.pitch||v.rotate;class kr extends s.l{}function yl(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta||v.rollDelta}class Jf{constructor(i,u){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,_)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=g.type==="renderFrame"?void 0:g,C={needsRenderFrame:!1},M={},R={};for(const{handlerName:V,handler:X,allowed:Q}of this._handlers){if(!X.isEnabled())continue;let se;if(this._blockedByActive(R,Q,V))X.reset();else if(X[_||g.type]){if(s.cp(g,_||g.type)){const oe=j.mousePos(this._map.getCanvas(),g);se=X[_||g.type](g,oe)}else if(s.cq(g,_||g.type)){const oe=this._getMapTouches(g.touches),le=j.touchPos(this._map.getCanvas(),oe);se=X[_||g.type](g,le,oe)}else s.cr(_||g.type)||(se=X[_||g.type](g));this.mergeHandlerResult(C,M,se,V,S),se&&se.needsRenderFrame&&this._triggerRenderFrame()}(se||X.isActive())&&(R[V]=X)}const $={};for(const V in this._previousActiveHandlers)R[V]||($[V]=S);this._previousActiveHandlers=R,(Object.keys($).length||yl(C))&&(this._changes.push([C,M,$]),this._triggerRenderFrame()),(Object.keys(R).length||yl(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:G}=C;G&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],G(this._map))},this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new py(i),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,_,S]of this._listeners)j.addEventListener(g,_,g===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[i,u,p]of this._listeners)j.removeEventListener(i,u,i===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(i){const u=this._map,p=u.getCanvasContainer();this._add("mapEvent",new my(u,i));const g=u.boxZoom=new Wf(u,i);this._add("boxZoom",g),i.interactive&&i.boxZoom&&g.enable();const _=u.cooperativeGestures=new wy(u,i.cooperativeGestures);this._add("cooperativeGestures",_),i.cooperativeGestures&&_.enable();const S=new ha(u),C=new Xf(u);u.doubleClickZoom=new Kf(C,S),this._add("tapZoom",S),this._add("clickZoom",C),i.interactive&&i.doubleClickZoom&&u.doubleClickZoom.enable();const M=new _y;this._add("tapDragZoom",M);const R=u.touchPitch=new ih(u);this._add("touchPitch",R),i.interactive&&i.touchPitch&&u.touchPitch.enable(i.touchPitch);const $=()=>u.project(u.getCenter()),G=function({enable:de,clickTolerance:ye,aroundCenter:xe=!0,minPixelCenterThreshold:pe=100,rotateDegreesPerPixelMoved:ke=.8},ze){const je=new jc({checkCorrectEvent:De=>j.mouseButton(De)===0&&De.ctrlKey||j.mouseButton(De)===2&&!De.ctrlKey});return new pl({clickTolerance:ye,move:(De,$e)=>{const at=ze();if(xe&&Math.abs(at.y-De.y)>pe)return{bearingDelta:s.cn(new s.P(De.x,$e.y),$e,at)};let lt=($e.x-De.x)*ke;return xe&&$e.y<at.y&&(lt=-lt),{bearingDelta:lt}},moveStateManager:je,enable:de,assignEvents:Oc})}(i,$),V=function({enable:de,clickTolerance:ye,pitchDegreesPerPixelMoved:xe=-.5}){const pe=new jc({checkCorrectEvent:ke=>j.mouseButton(ke)===0&&ke.ctrlKey||j.mouseButton(ke)===2});return new pl({clickTolerance:ye,move:(ke,ze)=>({pitchDelta:(ze.y-ke.y)*xe}),moveStateManager:pe,enable:de,assignEvents:Oc})}(i),X=function({enable:de,clickTolerance:ye,rollDegreesPerPixelMoved:xe=.3},pe){const ke=new jc({checkCorrectEvent:ze=>j.mouseButton(ze)===2&&ze.ctrlKey});return new pl({clickTolerance:ye,move:(ze,je)=>{const De=pe();let $e=(je.x-ze.x)*xe;return je.y<De.y&&($e=-$e),{rollDelta:$e}},moveStateManager:ke,enable:de,assignEvents:Oc})}(i,$);u.dragRotate=new Yf(i,G,V,X),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",V,["mouseRotate","mouseRoll"]),this._add("mouseRoll",X,["mousePitch"]),i.interactive&&i.dragRotate&&u.dragRotate.enable();const Q=function({enable:de,clickTolerance:ye}){const xe=new jc({checkCorrectEvent:pe=>j.mouseButton(pe)===0&&!pe.ctrlKey});return new pl({clickTolerance:ye,move:(pe,ke)=>({around:ke,panDelta:ke.sub(pe)}),activateOnStart:!0,moveStateManager:xe,enable:de,assignEvents:Oc})}(i),se=new Dc(i,u);u.dragPan=new xy(p,Q,se),this._add("mousePan",Q),this._add("touchPan",se,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&u.dragPan.enable(i.dragPan);const oe=new gl,le=new nh;u.touchZoomRotate=new by(p,le,oe,M),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&u.touchZoomRotate.enable(i.touchZoomRotate);const ue=u.scrollZoom=new vy(u,()=>this._triggerRenderFrame());this._add("scrollZoom",ue,["mousePan"]),i.interactive&&i.scrollZoom&&u.scrollZoom.enable(i.scrollZoom);const me=u.keyboard=new ah(u);this._add("keyboard",me),i.interactive&&i.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new gy(u))}_add(i,u,p){this._handlers.push({handlerName:i,handler:u,allowed:p}),this._handlersById[i]=u}stop(i){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!pa(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,u,p){for(const g in i)if(g!==p&&(!u||u.indexOf(g)<0))return!0;return!1}_getMapTouches(i){const u=[];for(const p of i)this._el.contains(p.target)&&u.push(p);return u}mergeHandlerResult(i,u,p,g,_){if(!p)return;s.e(i,p);const S={handlerName:g,originalEvent:p.originalEvent||_};p.zoomDelta!==void 0&&(u.zoom=S),p.panDelta!==void 0&&(u.drag=S),p.rollDelta!==void 0&&(u.roll=S),p.pitchDelta!==void 0&&(u.pitch=S),p.bearingDelta!==void 0&&(u.rotate=S)}_applyChanges(){const i={},u={},p={};for(const[g,_,S]of this._changes)g.panDelta&&(i.panDelta=(i.panDelta||new s.P(0,0))._add(g.panDelta)),g.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+g.pitchDelta),g.rollDelta&&(i.rollDelta=(i.rollDelta||0)+g.rollDelta),g.around!==void 0&&(i.around=g.around),g.pinchAround!==void 0&&(i.pinchAround=g.pinchAround),g.noInertia&&(i.noInertia=g.noInertia),s.e(u,_),s.e(p,S);this._updateMapTransform(i,u,p),this._changes=[]}_updateMapTransform(i,u,p){const g=this._map,_=g._getTransformForUpdate(),S=g.terrain;if(!(yl(i)||S&&this._terrainMovement))return this._fireEvents(u,p,!0);g._stop(!0);let{panDelta:C,zoomDelta:M,bearingDelta:R,pitchDelta:$,rollDelta:G,around:V,pinchAround:X}=i;X!==void 0&&(V=X),V=V||g.transform.centerPoint,S&&!_.isPointOnMapSurface(V)&&(V=_.centerPoint);const Q={panDelta:C,zoomDelta:M,rollDelta:G,pitchDelta:$,bearingDelta:R,around:V};this._map.cameraHelper.useGlobeControls&&!_.isPointOnMapSurface(V)&&(V=_.centerPoint);const se=V.distSqr(_.centerPoint)<.01?_.center:_.screenPointToLocation(C?V.sub(C):V);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Q,_),this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?_.setCenter(_.screenPointToLocation(_.centerPoint.sub(C))):this._map.cameraHelper.handleMapControlsPan(Q,_,se):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Q,_,se))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Q,_),this._map.cameraHelper.handleMapControlsPan(Q,_,se)),g._applyUpdatedTransform(_),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(u,p,!0)}_fireEvents(i,u,p){const g=pa(this._eventsInProgress),_=pa(i),S={};for(const G in i){const{originalEvent:V}=i[G];this._eventsInProgress[G]||(S[`${G}start`]=V),this._eventsInProgress[G]=i[G]}!g&&_&&this._fireEvent("movestart",_.originalEvent);for(const G in S)this._fireEvent(G,S[G]);_&&this._fireEvent("move",_.originalEvent);for(const G in i){const{originalEvent:V}=i[G];this._fireEvent(G,V)}const C={};let M;for(const G in this._eventsInProgress){const{handlerName:V,originalEvent:X}=this._eventsInProgress[G];this._handlersById[V].isActive()||(delete this._eventsInProgress[G],M=u[V]||X,C[`${G}end`]=M)}for(const G in C)this._fireEvent(G,C[G]);const R=pa(this._eventsInProgress),$=(g||_)&&!R;if($&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const G=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&G.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(G)}if(p&&$){this._updatingCamera=!0;const G=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!G||!G.essential&&I.prefersReducedMotion?(this._map.fire(new s.l("moveend",{originalEvent:M})),V(this._map.getBearing())&&this._map.resetNorth()):(V(G.bearing||this._map.getBearing())&&(G.bearing=0),G.freezeElevation=!0,this._map.easeTo(G,{originalEvent:M})),this._updatingCamera=!1}}_fireEvent(i,u){this._map.fire(new s.l(i,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new kr("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Sy extends s.E{constructor(i,u,p){super(),this._renderFrameCallback=()=>{const g=Math.min((I.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=p.bearingSnap,this.cameraHelper=u,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(i,u){i.apply(this.transform),this.transform=i,this.cameraHelper=u}getCenter(){return new s.S(this.transform.center.lng,this.transform.center.lat)}setCenter(i,u){return this.jumpTo({center:i},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(i,u){return this.jumpTo({elevation:i},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(i){this._centerClampedToGround=i}panBy(i,u,p){return i=s.P.convert(i).mult(-1),this.panTo(this.transform.center,s.e({offset:i},u),p)}panTo(i,u,p){return this.easeTo(s.e({center:i},u),p)}getZoom(){return this.transform.zoom}setZoom(i,u){return this.jumpTo({zoom:i},u),this}zoomTo(i,u,p){return this.easeTo(s.e({zoom:i},u),p)}zoomIn(i,u){return this.zoomTo(this.getZoom()+1,i,u),this}zoomOut(i,u){return this.zoomTo(this.getZoom()-1,i,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(i,u){return i!=this.transform.fov&&(this.transform.setFov(i),this.fire(new s.l("movestart",u)).fire(new s.l("move",u)).fire(new s.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(i,u){return this.jumpTo({bearing:i},u),this}getPadding(){return this.transform.padding}setPadding(i,u){return this.jumpTo({padding:i},u),this}rotateTo(i,u,p){return this.easeTo(s.e({bearing:i},u),p)}resetNorth(i,u){return this.rotateTo(0,s.e({duration:1e3},i),u),this}resetNorthPitch(i,u){return this.easeTo(s.e({bearing:0,pitch:0,roll:0,duration:1e3},i),u),this}snapToNorth(i,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,u):this}getPitch(){return this.transform.pitch}setPitch(i,u){return this.jumpTo({pitch:i},u),this}getRoll(){return this.transform.roll}setRoll(i,u){return this.jumpTo({roll:i},u),this}cameraForBounds(i,u){i=Vt.convert(i).adjustAntiMeridian();const p=u&&u.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),p,u)}_cameraForBoxAndBearing(i,u,p,g){const _={top:0,bottom:0,right:0,left:0};if(typeof(g=s.e({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const R=g.padding;g.padding={top:R,bottom:R,right:R,left:R}}const S=s.e(_,g.padding);g.padding=S;const C=this.transform,M=new Vt(i,u);return this.cameraHelper.cameraForBoxAndBearing(g,S,M,p,C)}fitBounds(i,u,p){return this._fitInternal(this.cameraForBounds(i,u),u,p)}fitScreenCoordinates(i,u,p,g,_){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(s.P.convert(i)),this.transform.screenPointToLocation(s.P.convert(u)),p,g),g,_)}_fitInternal(i,u,p){return i?(delete(u=s.e(i,u)).padding,u.linear?this.easeTo(u,p):this.flyTo(u,p)):this}jumpTo(i,u){this.stop();const p=this._getTransformForUpdate();let g=!1,_=!1,S=!1;const C=p.zoom;this.cameraHelper.handleJumpToCenterZoom(p,i);const M=p.zoom!==C;return"elevation"in i&&p.elevation!==+i.elevation&&p.setElevation(+i.elevation),"bearing"in i&&p.bearing!==+i.bearing&&(g=!0,p.setBearing(+i.bearing)),"pitch"in i&&p.pitch!==+i.pitch&&(_=!0,p.setPitch(+i.pitch)),"roll"in i&&p.roll!==+i.roll&&(S=!0,p.setRoll(+i.roll)),i.padding==null||p.isPaddingEqual(i.padding)||p.setPadding(i.padding),this._applyUpdatedTransform(p),this.fire(new s.l("movestart",u)).fire(new s.l("move",u)),M&&this.fire(new s.l("zoomstart",u)).fire(new s.l("zoom",u)).fire(new s.l("zoomend",u)),g&&this.fire(new s.l("rotatestart",u)).fire(new s.l("rotate",u)).fire(new s.l("rotateend",u)),_&&this.fire(new s.l("pitchstart",u)).fire(new s.l("pitch",u)).fire(new s.l("pitchend",u)),S&&this.fire(new s.l("rollstart",u)).fire(new s.l("roll",u)).fire(new s.l("rollend",u)),this.fire(new s.l("moveend",u))}calculateCameraOptionsFromTo(i,u,p,g=0){const _=s.a1.fromLngLat(i,u),S=s.a1.fromLngLat(p,g),C=S.x-_.x,M=S.y-_.y,R=S.z-_.z,$=Math.hypot(C,M,R);if($===0)throw new Error("Can't calculate camera options with same From and To");const G=Math.hypot(C,M),V=s.ak(this.transform.cameraToCenterDistance/$/this.transform.tileSize),X=180*Math.atan2(C,-M)/Math.PI;let Q=180*Math.acos(G/$)/Math.PI;return Q=R<0?90-Q:90+Q,{center:S.toLngLat(),elevation:g,zoom:V,pitch:Q,bearing:X}}calculateCameraOptionsFromCameraLngLatAltRotation(i,u,p,g,_){const S=this.transform.calculateCenterFromCameraLngLatAlt(i,u,p,g);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:p,pitch:g,roll:_}}easeTo(i,u){this._stop(!1,i.easeId),((i=s.e({offset:[0,0],duration:500,easing:s.co},i)).animate===!1||!i.essential&&I.prefersReducedMotion)&&(i.duration=0);const p=this._getTransformForUpdate(),g=this.getBearing(),_=p.pitch,S=p.roll,C="bearing"in i?this._normalizeBearing(i.bearing,g):g,M="pitch"in i?+i.pitch:_,R="roll"in i?this._normalizeBearing(i.roll,S):S,$="padding"in i?i.padding:p.padding,G=s.P.convert(i.offset);let V,X;i.around&&(V=s.S.convert(i.around),X=p.locationToScreenPoint(V));const Q={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},se=this.cameraHelper.handleEaseTo(p,{bearing:C,pitch:M,roll:R,padding:$,around:V,aroundPoint:X,offsetAsPoint:G,offset:i.offset,zoom:i.zoom,center:i.center});return this._rotating=this._rotating||g!==C,this._pitching=this._pitching||M!==_,this._rolling=this._rolling||R!==S,this._padding=!p.isPaddingEqual($),this._zooming=this._zooming||se.isZooming,this._easeId=i.easeId,this._prepareEase(u,i.noMoveStart,Q),this.terrain&&this._prepareElevation(se.elevationCenter),this._ease(oe=>{se.easeFunc(oe),this.terrain&&!i.freezeElevation&&this._updateElevation(oe),this._applyUpdatedTransform(p),this._fireMoveEvents(u)},oe=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(u,oe)},i),this}_prepareEase(i,u,p={}){this._moving=!0,u||p.moving||this.fire(new s.l("movestart",i)),this._zooming&&!p.zooming&&this.fire(new s.l("zoomstart",i)),this._rotating&&!p.rotating&&this.fire(new s.l("rotatestart",i)),this._pitching&&!p.pitching&&this.fire(new s.l("pitchstart",i)),this._rolling&&!p.rolling&&this.fire(new s.l("rollstart",i))}_prepareElevation(i){this._elevationCenter=i,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(i){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(i<1&&u!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=i*(p-(u-(p*i+this._elevationStart))/(1-i)),this._elevationTarget=u}this.transform.setElevation(s.C.number(this._elevationStart,this._elevationTarget,i))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(i){if(!this.terrain&&i.elevation>=0&&i.pitch<=90)return{};const u=i.getCameraLngLat(),p=i.getCameraAltitude(),g=this.terrain?this.terrain.getElevationForLngLatZoom(u,i.zoom):0;if(p<g){const _=this.calculateCameraOptionsFromTo(u,g,i.center,i.elevation);return{pitch:_.pitch,zoom:_.zoom}}return{}}_applyUpdatedTransform(i){const u=[];if(u.push(g=>this._elevateCameraIfInsideTerrain(g)),this.transformCameraUpdate&&u.push(g=>this.transformCameraUpdate(g)),!u.length)return;const p=i.clone();for(const g of u){const _=p.clone(),{center:S,zoom:C,roll:M,pitch:R,bearing:$,elevation:G}=g(_);S&&_.setCenter(S),G!==void 0&&_.setElevation(G),C!==void 0&&_.setZoom(C),M!==void 0&&_.setRoll(M),R!==void 0&&_.setPitch(R),$!==void 0&&_.setBearing($),p.apply(_)}this.transform.apply(p)}_fireMoveEvents(i){this.fire(new s.l("move",i)),this._zooming&&this.fire(new s.l("zoom",i)),this._rotating&&this.fire(new s.l("rotate",i)),this._pitching&&this.fire(new s.l("pitch",i)),this._rolling&&this.fire(new s.l("roll",i))}_afterEase(i,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const p=this._zooming,g=this._rotating,_=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,p&&this.fire(new s.l("zoomend",i)),g&&this.fire(new s.l("rotateend",i)),_&&this.fire(new s.l("pitchend",i)),S&&this.fire(new s.l("rollend",i)),this.fire(new s.l("moveend",i))}flyTo(i,u){if(!i.essential&&I.prefersReducedMotion){const $e=s.Q(i,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo($e,u)}this.stop(),i=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.co},i);const p=this._getTransformForUpdate(),g=p.bearing,_=p.pitch,S=p.roll,C=p.padding,M="bearing"in i?this._normalizeBearing(i.bearing,g):g,R="pitch"in i?+i.pitch:_,$="roll"in i?this._normalizeBearing(i.roll,S):S,G="padding"in i?i.padding:p.padding,V=s.P.convert(i.offset);let X=p.centerPoint.add(V);const Q=p.screenPointToLocation(X),se=this.cameraHelper.handleFlyTo(p,{bearing:M,pitch:R,roll:$,padding:G,locationAtOffset:Q,offsetAsPoint:V,center:i.center,minZoom:i.minZoom,zoom:i.zoom});let oe=i.curve;const le=Math.max(p.width,p.height),ue=le/se.scaleOfZoom,me=se.pixelPathLength;typeof se.scaleOfMinZoom=="number"&&(oe=Math.sqrt(le/se.scaleOfMinZoom/me*2));const de=oe*oe;function ye($e){const at=(ue*ue-le*le+($e?-1:1)*de*de*me*me)/(2*($e?ue:le)*de*me);return Math.log(Math.sqrt(at*at+1)-at)}function xe($e){return(Math.exp($e)-Math.exp(-$e))/2}function pe($e){return(Math.exp($e)+Math.exp(-$e))/2}const ke=ye(!1);let ze=function($e){return pe(ke)/pe(ke+oe*$e)},je=function($e){return le*((pe(ke)*(xe(at=ke+oe*$e)/pe(at))-xe(ke))/de)/me;var at},De=(ye(!0)-ke)/oe;if(Math.abs(me)<2e-6||!isFinite(De)){if(Math.abs(le-ue)<1e-6)return this.easeTo(i,u);const $e=ue<le?-1:1;De=Math.abs(Math.log(ue/le))/oe,je=()=>0,ze=at=>Math.exp($e*oe*at)}return i.duration="duration"in i?+i.duration:1e3*De/("screenSpeed"in i?+i.screenSpeed/oe:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=g!==M,this._pitching=R!==_,this._rolling=$!==S,this._padding=!p.isPaddingEqual(G),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(se.targetCenter),this._ease($e=>{const at=$e*De,lt=1/ze(at),Ye=je(at);this._rotating&&p.setBearing(s.C.number(g,M,$e)),this._pitching&&p.setPitch(s.C.number(_,R,$e)),this._rolling&&p.setRoll(s.C.number(S,$,$e)),this._padding&&(p.interpolatePadding(C,G,$e),X=p.centerPoint.add(V)),se.easeFunc($e,lt,Ye,X),this.terrain&&!i.freezeElevation&&this._updateElevation($e),this._applyUpdatedTransform(p),this._fireMoveEvents(u)},()=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(u)},i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,u){var p;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,u)}return i||(p=this.handlers)===null||p===void 0||p.stop(!1),this}_ease(i,u,p){p.animate===!1||p.duration===0?(i(1),u()):(this._easeStart=I.now(),this._easeOptions=p,this._onEaseFrame=i,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,u){i=s.aO(i,-180,180);const p=Math.abs(i-u);return Math.abs(i-360-u)<p&&(i-=360),Math.abs(i+360-u)<p&&(i+=360),i}queryTerrainElevation(i){return this.terrain?this.terrain.getElevationForLngLatZoom(s.S.convert(i),this.transform.tileZoom):null}}const Qf={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ep{constructor(i=Qf){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=i}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options.compact,this._container=j.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=j.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=j.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){j.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,u){const p=this._map._getUIString(`AttributionControl.${u}`);i.title=p,i.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(g=>typeof g!="string"?"":g)):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const u=this._map.style.sourceCaches;for(const g in u){const _=u[g];if(_.used||_.usedForTerrain){const S=_.getSource();S.attribution&&i.indexOf(S.attribution)<0&&i.push(S.attribution)}}i=i.filter(g=>String(g).trim()),i.sort((g,_)=>g.length-_.length),i=i.filter((g,_)=>{for(let S=_+1;S<i.length;S++)if(i[S].indexOf(g)>=0)return!1;return!0});const p=i.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,i.length?(this._innerContainer.innerHTML=j.sanitize(p),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Py{constructor(i={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const p=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=i}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=j.create("div","maplibregl-ctrl");const u=j.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){j.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class $a{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const u=++this._id;return this._queue.push({callback:i,id:u,cancelled:!1}),u}remove(i){const u=this._currentlyRunning,p=u?this._queue.concat(u):this._queue;for(const g of p)if(g.id===i)return void(g.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const p of u)if(!p.cancelled&&(p.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var sh=s.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class St extends s.E{constructor(i){super(),this._lastTilesetChange=I.now(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=i._source.tileSize*2**this.deltaZoom,i.usedForTerrain=!0,i.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(i,u){this.sourceCache.update(i,u),this._renderableTilesKeys=[];const p={};for(const g of Ce(i,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))p[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.terrainRttPosMatrix32f=new Float64Array(16),s.bY(g.terrainRttPosMatrix32f,0,s.$,s.$,0,0,1),this._tiles[g.key]=new Js(g,this.tileSize),this._lastTilesetChange=I.now());for(const g in this._tiles)p[g]||delete this._tiles[g]}freeRtt(i){for(const u in this._tiles){const p=this._tiles[u];(!i||p.tileID.equals(i)||p.tileID.isChildOf(i)||i.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(i=>this.getTileByID(i))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i,u){return u?this._getTerrainCoordsForTileRanges(i,u):this._getTerrainCoordsForRegularTile(i)}_getTerrainCoordsForRegularTile(i){const u={};for(const p of this._renderableTilesKeys){const g=this._tiles[p].tileID,_=i.clone(),S=s.ba();if(g.canonical.equals(i.canonical))s.bY(S,0,s.$,s.$,0,0,1);else if(g.canonical.isChildOf(i.canonical)){const C=g.canonical.z-i.canonical.z,M=g.canonical.x-(g.canonical.x>>C<<C),R=g.canonical.y-(g.canonical.y>>C<<C),$=s.$>>C;s.bY(S,0,$,$,0,0,1),s.M(S,S,[-M*$,-R*$,0])}else{if(!i.canonical.isChildOf(g.canonical))continue;{const C=i.canonical.z-g.canonical.z,M=i.canonical.x-(i.canonical.x>>C<<C),R=i.canonical.y-(i.canonical.y>>C<<C),$=s.$>>C;s.bY(S,0,s.$,s.$,0,0,1),s.M(S,S,[M*$,R*$,0]),s.N(S,S,[1/2**C,1/2**C,0])}}_.terrainRttPosMatrix32f=new Float32Array(S),u[p]=_}return u}_getTerrainCoordsForTileRanges(i,u){const p={};for(const g of this._renderableTilesKeys){const _=this._tiles[g].tileID;if(!this._isWithinTileRanges(_,u))continue;const S=i.clone(),C=s.ba();if(_.canonical.z===i.canonical.z){const M=i.canonical.x-_.canonical.x,R=i.canonical.y-_.canonical.y;s.bY(C,0,s.$,s.$,0,0,1),s.M(C,C,[M*s.$,R*s.$,0])}else if(_.canonical.z>i.canonical.z){const M=_.canonical.z-i.canonical.z,R=_.canonical.x-(_.canonical.x>>M<<M),$=_.canonical.y-(_.canonical.y>>M<<M),G=i.canonical.x-(_.canonical.x>>M),V=i.canonical.y-(_.canonical.y>>M),X=s.$>>M;s.bY(C,0,X,X,0,0,1),s.M(C,C,[-R*X+G*s.$,-$*X+V*s.$,0])}else{const M=i.canonical.z-_.canonical.z,R=i.canonical.x-(i.canonical.x>>M<<M),$=i.canonical.y-(i.canonical.y>>M<<M),G=(i.canonical.x>>M)-_.canonical.x,V=(i.canonical.y>>M)-_.canonical.y,X=s.$<<M;s.bY(C,0,X,X,0,0,1),s.M(C,C,[R*s.$+G*X,$*s.$+V*X,0])}S.terrainRttPosMatrix32f=new Float32Array(C),p[g]=S}return p}getSourceTile(i,u){const p=this.sourceCache._source;let g=i.overscaledZ-this.deltaZoom;if(g>p.maxzoom&&(g=p.maxzoom),g<p.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(g).key);let _=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!_||!_.dem)&&u)for(;g>=p.minzoom&&(!_||!_.dem);)_=this.sourceCache.getTileByID(i.scaledTo(g--).key);return _}anyTilesAfterTime(i=Date.now()){return this._lastTilesetChange>=i}_isWithinTileRanges(i,u){return u[i.canonical.z]&&i.canonical.x>=u[i.canonical.z].minTileX&&i.canonical.x<=u[i.canonical.z].maxTileX&&i.canonical.y>=u[i.canonical.z].minTileY&&i.canonical.y<=u[i.canonical.z].maxTileY}}class Mt{constructor(i,u,p){this._meshCache={},this.painter=i,this.sourceCache=new St(u),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(i,u,p,g=s.$){var _;if(!(u>=0&&u<g&&p>=0&&p<g))return 0;const S=this.getTerrainData(i),C=(_=S.tile)===null||_===void 0?void 0:_.dem;if(!C)return 0;const M=s.cs([],[u/g*s.$,p/g*s.$],S.u_terrain_matrix),R=[M[0]*C.dim,M[1]*C.dim],$=Math.floor(R[0]),G=Math.floor(R[1]),V=R[0]-$,X=R[1]-G;return C.get($,G)*(1-V)*(1-X)+C.get($+1,G)*V*(1-X)+C.get($,G+1)*(1-V)*X+C.get($+1,G+1)*V*X}getElevationForLngLatZoom(i,u){if(!s.ct(u,i.wrap()))return 0;const{tileID:p,mercatorX:g,mercatorY:_}=this._getOverscaledTileIDFromLngLatZoom(i,u);return this.getElevation(p,g%s.$,_%s.$,s.$)}getElevation(i,u,p,g=s.$){return this.getDEMElevation(i,u,p,g)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const g=this.painter.context,_=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new s.T(g,_,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new s.T(g,new s.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.ag([])}const u=this.sourceCache.getSourceTile(i,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const g=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new s.T(g,u.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),u.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const p=u&&u+u.tileID.key+i.key;if(p&&!this._demMatrixCache[p]){const g=this.sourceCache.sourceCache._source.maxzoom;let _=i.canonical.z-u.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=g?_=i.canonical.z-g:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=i.canonical.x-(i.canonical.x>>_<<_),C=i.canonical.y-(i.canonical.y>>_<<_),M=s.cu(new Float64Array(16),[1/(s.$<<_),1/(s.$<<_),0]);s.M(M,M,[S*s.$,C*s.$,0]),this._demMatrixCache[i.key]={matrix:M,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(i){const u=this.painter,p=u.width/devicePixelRatio,g=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new s.T(u.context,{width:p,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new s.T(u.context,{width:p,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(p,g,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,p,g))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let _=0,S=0;_<this._coordsTextureSize;_++)for(let C=0;C<this._coordsTextureSize;C++,S+=4)u[S+0]=255&C,u[S+1]=255&_,u[S+2]=C>>8<<4|_>>8,u[S+3]=0;const p=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),g=new s.T(i,p,i.gl.RGBA,{premultiply:!1});return g.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(i){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),p=this.painter.context,g=p.gl,_=Math.round(i.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(i.y*this.painter.pixelRatio/devicePixelRatio),C=Math.round(this.painter.height/devicePixelRatio);p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(_,C-S-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),p.bindFramebuffer.set(null);const M=u[0]+(u[2]>>4<<8),R=u[1]+((15&u[2])<<8),$=this.coordsIndex[255-u[3]],G=$&&this.sourceCache.getTileByID($);if(!G)return null;const V=this._coordsTextureSize,X=(1<<G.tileID.canonical.z)*V;return new s.a1((G.tileID.canonical.x*V+M)/X+G.tileID.wrap,(G.tileID.canonical.y*V+R)/X,this.getElevation(G.tileID,M,R,V))}depthAtPoint(i){const u=new Uint8Array(4),p=this.painter.context,g=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),g.readPixels(i.x,this.painter.height/devicePixelRatio-i.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),p.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(i){var u;const p=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,g=p&&i.canonical.y===0,_=p&&i.canonical.y===(1<<i.canonical.z)-1,S=`m_${g?"n":""}_${_?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const C=this.painter.context,M=new s.cv,R=new s.aN,$=this.meshSize,G=s.$/$,V=$*$;for(let pe=0;pe<=$;pe++)for(let ke=0;ke<=$;ke++)M.emplaceBack(ke*G,pe*G,0);for(let pe=0;pe<V;pe+=$+1)for(let ke=0;ke<$;ke++)R.emplaceBack(ke+pe,$+ke+pe+1,$+ke+pe+2),R.emplaceBack(ke+pe,$+ke+pe+2,ke+pe+1);const X=M.length,Q=X+($+1),se=($+1)*$,oe=g?s.bh:0,le=g?0:1,ue=_?s.bi:s.$,me=_?0:1;for(let pe=0;pe<=$;pe++)M.emplaceBack(pe*G,oe,le);for(let pe=0;pe<=$;pe++)M.emplaceBack(pe*G,ue,me);for(let pe=0;pe<$;pe++)R.emplaceBack(se+pe,Q+pe,Q+pe+1),R.emplaceBack(se+pe,Q+pe+1,se+pe+1),R.emplaceBack(0+pe,X+pe+1,X+pe),R.emplaceBack(0+pe,0+pe+1,X+pe+1);const de=M.length,ye=de+2*($+1);for(const pe of[0,1])for(let ke=0;ke<=$;ke++)for(const ze of[0,1])M.emplaceBack(pe*s.$,ke*G,ze);for(let pe=0;pe<2*$;pe+=2)R.emplaceBack(de+pe,de+pe+1,de+pe+3),R.emplaceBack(de+pe,de+pe+3,de+pe+2),R.emplaceBack(ye+pe,ye+pe+3,ye+pe+1),R.emplaceBack(ye+pe,ye+pe+2,ye+pe+3);const xe=new ns(C.createVertexBuffer(M,sh.members),C.createIndexBuffer(R),s.aM.simpleSegment(0,0,M.length,R.length));return this._meshCache[S]=xe,xe}getMeshFrameDelta(i){return 2*Math.PI*s.bu/Math.pow(2,Math.max(i,0))/5}getMinTileElevationForLngLatZoom(i,u){var p;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(i,u);return(p=this.getMinMaxElevation(g).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(i){const u=this.getTerrainData(i).tile,p={minElevation:null,maxElevation:null};return u&&u.dem&&(p.minElevation=u.dem.min*this.exaggeration,p.maxElevation=u.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(i,u){const p=s.a1.fromLngLat(i.wrap()),g=(1<<u)*s.$,_=p.x*g,S=p.y*g,C=Math.floor(_/s.$),M=Math.floor(S/s.$);return{tileID:new s.Z(u,0,u,C,M),mercatorX:_,mercatorY:S}}}class lh{constructor(i,u,p){this._context=i,this._size=u,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const i of this._objects)i.texture.destroy(),i.fbo.destroy()}_createObject(i){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new s.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(p.texture),{id:i,fbo:u,texture:p,stamp:-1,inUse:!1}}getObjectForId(i){return this._objects[i]}useObject(i){i.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>i.id!==u),this._recentlyUsed.push(i.id)}stampObject(i){i.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const i=this._createObject(this._objects.length);return this._objects.push(i),i}freeObject(i){i.inUse=!1}freeAllObjects(){for(const i of this._objects)this.freeObject(i)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(i=>!i.inUse)===!1}}const $o={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class ch{constructor(i,u){this.painter=i,this.terrain=u,this.pool=new lh(i.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(i){return this.pool.getObjectForId(i.rtt[this._stacks.length-1].id).texture}prepareForRender(i,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=i._order.filter(p=>!i._layers[p].isHidden(u)),this._coordsAscending={};for(const p in i.sourceCaches){this._coordsAscending[p]={};const g=i.sourceCaches[p].getVisibleCoordinates(),_=i.sourceCaches[p].getSource(),S=_ instanceof Nn?_.terrainTileRanges:null;for(const C of g){const M=this.terrain.sourceCache.getTerrainCoords(C,S);for(const R in M)this._coordsAscending[p][R]||(this._coordsAscending[p][R]=[]),this._coordsAscending[p][R].push(M[R])}}this._coordsAscendingStr={};for(const p of i._order){const g=i._layers[p],_=g.source;if($o[g.type]&&!this._coordsAscendingStr[_]){this._coordsAscendingStr[_]={};for(const S in this._coordsAscending[_])this._coordsAscendingStr[_][S]=this._coordsAscending[_][S].map(C=>C.key).sort().join()}}for(const p of this._renderableTiles)for(const g in this._coordsAscendingStr){const _=this._coordsAscendingStr[g][p.tileID.key];_&&_!==p.rttCoords[g]&&(p.rtt=[])}}renderLayer(i,u){if(i.isHidden(this.painter.transform.zoom))return!1;const p=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),g=i.type,_=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===i.id;if($o[g]&&(this._prevType&&$o[this._prevType]||this._stacks.push([]),this._prevType=g,this._stacks[this._stacks.length-1].push(i.id),!S))return!0;if($o[this._prevType]||$o[g]&&S){this._prevType=g;const C=this._stacks.length-1,M=this._stacks[C]||[];for(const R of this._renderableTiles){if(this.pool.isFull()&&(th(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(R),R.rtt[C]){const G=this.pool.getObjectForId(R.rtt[C].id);if(G.stamp===R.rtt[C].stamp){this.pool.useObject(G);continue}}const $=this.pool.getOrCreateFreeObject();this.pool.useObject($),this.pool.stampObject($),R.rtt[C]={id:$.id,stamp:$.stamp},_.context.bindFramebuffer.set($.fbo.framebuffer),_.context.clear({color:s.bf.transparent,stencil:0}),_.currentStencilSource=void 0;for(let G=0;G<M.length;G++){const V=_.style._layers[M[G]],X=V.source?this._coordsAscending[V.source][R.tileID.key]:[R.tileID];_.context.viewport.set([0,0,$.fbo.width,$.fbo.height]),_._renderTileClippingMasks(V,X,!0),_.renderLayer(_,_.style.sourceCaches[V.source],V,X,p),V.source&&(R.rttCoords[V.source]=this._coordsAscendingStr[V.source][R.tileID.key])}}return th(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects(),$o[g]}return!1}}const hi={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ty=y,Ki={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Qf,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Hx={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Rc{constructor(i,u,p=!1){this.mousedown=_=>{this.startMove(_,j.mousePos(this.element,_)),j.addEventListener(window,"mousemove",this.mousemove),j.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=_=>{this.move(_,j.mousePos(this.element,_))},this.mouseup=_=>{this._rotatePitchHandler.dragEnd(_),this.offTemp()},this.touchstart=_=>{_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=j.touchPos(this.element,_.targetTouches)[0],this.startMove(_,this._startPos),j.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),j.addEventListener(window,"touchend",this.touchend))},this.touchmove=_=>{_.targetTouches.length!==1?this.reset():(this._lastPos=j.touchPos(this.element,_.targetTouches)[0],this.move(_,this._lastPos))},this.touchend=_=>{_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const g=new Gx;this._rotatePitchHandler=new pl({clickTolerance:3,move:(_,S)=>{const C=u.getBoundingClientRect(),M=new s.P((C.bottom-C.top)/2,(C.right-C.left)/2);return{bearingDelta:s.cn(new s.P(_.x,S.y),S,M),pitchDelta:p?-.5*(S.y-_.y):void 0}},moveStateManager:g,enable:!0,assignEvents:()=>{}}),this.map=i,j.addEventListener(u,"mousedown",this.mousedown),j.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),j.addEventListener(u,"touchcancel",this.reset)}startMove(i,u){this._rotatePitchHandler.dragStart(i,u),j.disableDrag()}move(i,u){const p=this.map,{bearingDelta:g,pitchDelta:_}=this._rotatePitchHandler.dragMove(i,u)||{};g&&p.setBearing(p.getBearing()+g),_&&p.setPitch(p.getPitch()+_)}off(){const i=this.element;j.removeEventListener(i,"mousedown",this.mousedown),j.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),j.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),j.removeEventListener(window,"touchend",this.touchend),j.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){j.enableDrag(),j.removeEventListener(window,"mousemove",this.mousemove),j.removeEventListener(window,"mouseup",this.mouseup),j.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),j.removeEventListener(window,"touchend",this.touchend)}}let vr;function en(v,i,u,p=!1){if(p||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return v==null?void 0:v.wrap();const g=new s.S(v.lng,v.lat);if(v=new s.S(v.lng,v.lat),i){const _=new s.S(v.lng-360,v.lat),S=new s.S(v.lng+360,v.lat),C=u.locationToScreenPoint(v).distSqr(i);u.locationToScreenPoint(_).distSqr(i)<C?v=_:u.locationToScreenPoint(S).distSqr(i)<C&&(v=S)}for(;Math.abs(v.lng-u.center.lng)>180;){const _=u.locationToScreenPoint(v);if(_.x>=0&&_.y>=0&&_.x<=u.width&&_.y<=u.height)break;v.lng>u.center.lng?v.lng-=360:v.lng+=360}return v.lng!==g.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(v))?v:g}const uh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function vl(v,i,u){const p=v.classList;for(const g in uh)p.remove(`maplibregl-${u}-anchor-${g}`);p.add(`maplibregl-${u}-anchor-${i}`)}class _l extends s.E{constructor(i){if(super(),this._onKeyPress=u=>{const p=u.code,g=u.charCode||u.keyCode;p!=="Space"&&p!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=u=>{const p=u.originalEvent.target,g=this._element;this._popup&&(p===g||g.contains(p))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();((u==null?void 0:u.type)==="terrain"||(u==null?void 0:u.type)==="render"&&!p)&&this._map.once("render",this._update),this._lngLat=en(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),j.setTransform(this._element,`${uh[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${g}`),I.frameAsync(new AbortController).then(()=>{this._updateOpacity(u&&u.type==="moveend")}).catch(()=>{})},this._onMove=u=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.l("dragstart"))),this.fire(new s.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._subpixelPositioning=i&&i.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,this.setOpacity(i==null?void 0:i.opacity,i==null?void 0:i.opacityWhenCovered),i&&i.element)this._element=i.element,this._offset=s.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=j.create("div");const u=j.createNS("http://www.w3.org/2000/svg","svg"),p=41,g=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${p}px`),u.setAttributeNS(null,"width",`${g}px`),u.setAttributeNS(null,"viewBox",`0 0 ${g} ${p}`);const _=j.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");const S=j.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const C=j.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const le of M){const ue=j.createNS("http://www.w3.org/2000/svg","ellipse");ue.setAttributeNS(null,"opacity","0.04"),ue.setAttributeNS(null,"cx","10.5"),ue.setAttributeNS(null,"cy","5.80029008"),ue.setAttributeNS(null,"rx",le.rx),ue.setAttributeNS(null,"ry",le.ry),C.appendChild(ue)}const R=j.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill",this._color);const $=j.createNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),R.appendChild($);const G=j.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"opacity","0.25"),G.setAttributeNS(null,"fill","#000000");const V=j.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),G.appendChild(V);const X=j.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const Q=j.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const se=j.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#000000"),se.setAttributeNS(null,"opacity","0.25"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962");const oe=j.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#FFFFFF"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962"),Q.appendChild(se),Q.appendChild(oe),S.appendChild(C),S.appendChild(R),S.appendChild(G),S.appendChild(X),S.appendChild(Q),u.appendChild(S),u.setAttributeNS(null,"height",p*this._scale+"px"),u.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(u),this._offset=s.P.convert(i&&i.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),vl(this._element,this._anchor,"marker"),i&&i.className)for(const u of i.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(i){return this.remove(),this._map=i,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",i._getUIString("Marker.Title")),i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("terrain",this._update),i.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),j.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=s.S.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const g=Math.abs(13.5)/Math.SQRT2;i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(i){return this._subpixelPositioning=i,this}getPopup(){return this._popup}togglePopup(){const i=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:i?(i.isOpen()?i.remove():(i.setLngLat(this._lngLat),i.addTo(this._map)),this):this}_updateOpacity(i=!1){var u,p;const g=(u=this._map)===null||u===void 0?void 0:u.terrain,_=this._map.transform.isLocationOccluded(this._lngLat);if(!g||_){const X=_?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==X&&(this._element.style.opacity=X))}if(i)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const S=this._map,C=S.terrain.depthAtPoint(this._pos),M=S.terrain.getElevationForLngLatZoom(this._lngLat,S.transform.tileZoom);if(S.transform.lngLatToCameraDepth(this._lngLat,M)-C<.006)return void(this._element.style.opacity=this._opacity);const R=-this._offset.y/S.transform.pixelsPerMeter,$=Math.sin(S.getPitch()*Math.PI/180)*R,G=S.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),V=S.transform.lngLatToCameraDepth(this._lngLat,M+$)-G>.006;!((p=this._popup)===null||p===void 0)&&p.isOpen()&&V&&this._popup.remove(),this._element.style.opacity=V?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(i){return this._offset=s.P.convert(i),this._update(),this}addClassName(i){this._element.classList.add(i)}removeClassName(i){this._element.classList.remove(i)}toggleClassName(i){return this._element.classList.toggle(i)}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(i,u){return(this._opacity===void 0||i===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),i!==void 0&&(this._opacity=i),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const tp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let xl=0,vs=!1;const Nc={maxWidth:100,unit:"metric"};function hh(v,i,u){const p=u&&u.maxWidth||100,g=v._container.clientHeight/2,_=v._container.clientWidth/2,S=v.unproject([_-p/2,g]),C=v.unproject([_+p/2,g]),M=Math.round(v.project(C).x-v.project(S).x),R=Math.min(p,M,v._container.clientWidth),$=S.distanceTo(C);if(u&&u.unit==="imperial"){const G=3.2808*$;G>5280?_s(i,R,G/5280,v._getUIString("ScaleControl.Miles")):_s(i,R,G,v._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?_s(i,R,$/1852,v._getUIString("ScaleControl.NauticalMiles")):$>=1e3?_s(i,R,$/1e3,v._getUIString("ScaleControl.Kilometers")):_s(i,R,$,v._getUIString("ScaleControl.Meters"))}function _s(v,i,u,p){const g=function(_){const S=Math.pow(10,`${Math.floor(_)}`.length-1);let C=_/S;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(M){const R=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*R)/R}(C),S*C}(u);v.style.width=i*(g/u)+"px",v.innerHTML=`${g}&nbsp;${p}`}const rp={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},np=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function dh(v){if(v){if(typeof v=="number"){const i=Math.round(Math.abs(v)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,v),"top-left":new s.P(i,i),"top-right":new s.P(-i,i),bottom:new s.P(0,-v),"bottom-left":new s.P(i,-i),"bottom-right":new s.P(-i,-i),left:new s.P(v,0),right:new s.P(-v,0)}}if(v instanceof s.P||Array.isArray(v)){const i=s.P.convert(v);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:s.P.convert(v.center||[0,0]),top:s.P.convert(v.top||[0,0]),"top-left":s.P.convert(v["top-left"]||[0,0]),"top-right":s.P.convert(v["top-right"]||[0,0]),bottom:s.P.convert(v.bottom||[0,0]),"bottom-left":s.P.convert(v["bottom-left"]||[0,0]),"bottom-right":s.P.convert(v["bottom-right"]||[0,0]),left:s.P.convert(v.left||[0,0]),right:s.P.convert(v.right||[0,0])}}return dh(new s.P(0,0))}const ip=y;d.AJAXError=s.cz,d.Event=s.l,d.Evented=s.E,d.LngLat=s.S,d.MercatorCoordinate=s.a1,d.Point=s.P,d.addProtocol=s.cA,d.config=s.a,d.removeProtocol=s.cB,d.AttributionControl=ep,d.BoxZoomHandler=Wf,d.CanvasSource=Xn,d.CooperativeGesturesHandler=wy,d.DoubleClickZoomHandler=Kf,d.DragPanHandler=xy,d.DragRotateHandler=Yf,d.EdgeInsets=as,d.FullscreenControl=class extends s.E{constructor(v={}){super(),this._onFullscreenChange=()=>{var i;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((i=u==null?void 0:u.shadowRoot)===null||i===void 0)&&i.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){j.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=j.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);j.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},d.GeoJSONSource=yn,d.GeolocateControl=class extends s.E{constructor(v){super(),this._onSuccess=i=>{if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new s.l("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.l("geolocate",i)),this._finish()}},this._updateCamera=i=>{const u=new s.S(i.coords.longitude,i.coords.latitude),p=i.coords.accuracy,g=this._map.getBearing(),_=s.e({bearing:g},this.options.fitBoundsOptions),S=Vt.fromLngLat(u,p);this._map.fitBounds(S,_,{geolocateSource:!0})},this._updateMarker=i=>{if(i){const u=new s.S(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=i=>{if(this._map){if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&vs)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.l("error",i)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=j.create("button","maplibregl-ctrl-geolocate",this._container),j.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=i=>{if(this._map){if(i===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=j.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new _l({element:this._dotElement}),this._circleElement=j.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _l({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{const p=(u==null?void 0:u[0])instanceof ResizeObserverEntry;u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||p||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.l("trackuserlocationend")),this.fire(new s.l("userlocationlostfocus")))})}},this.options=s.e({},tp,v)}onAdd(v){return this._map=v,this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return s._(this,arguments,void 0,function*(i=!1){if(vr!==void 0&&!i)return vr;if(window.navigator.permissions===void 0)return vr=!!window.navigator.geolocation,vr;try{vr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{vr=!!window.navigator.geolocation}return vr})}().then(i=>this._finishSetupUI(i)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),j.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,xl=0,vs=!1}_isOutOfMapMaxBounds(v){const i=this._map.getMaxBounds(),u=v.coords;return i&&(u.longitude<i.getWest()||u.longitude>i.getEast()||u.latitude<i.getSouth()||u.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const v=this._map.getBounds(),i=v.getSouthEast(),u=v.getNorthEast(),p=i.distanceTo(u),g=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":xl--,vs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.l("trackuserlocationstart")),this.fire(new s.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),xl++,xl>1?(v={maximumAge:6e5,timeout:0},vs=!0):(v=this.options.positionOptions,vs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},d.GlobeControl=class{constructor(){this._toggleProjection=()=>{var v;const i=(v=this._map.getProjection())===null||v===void 0?void 0:v.type;this._map.setProjection(i!=="mercator"&&i?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var v;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((v=this._map.getProjection())===null||v===void 0?void 0:v.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(v){return this._map=v,this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=j.create("button","maplibregl-ctrl-globe",this._container),j.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){j.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},d.Hash=rh,d.ImageSource=Nn,d.KeyboardHandler=ah,d.LngLatBounds=Vt,d.LogoControl=Py,d.Map=class extends Sy{constructor(v){var i,u;s.cw.mark(s.cx.create);const p=Object.assign(Object.assign(Object.assign({},Ki),v),{canvasContextAttributes:Object.assign(Object.assign({},Ki.canvasContextAttributes),v.canvasContextAttributes)});if(p.minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const g=new Tr,_=new Qn;if(p.minZoom!==void 0&&g.setMinZoom(p.minZoom),p.maxZoom!==void 0&&g.setMaxZoom(p.maxZoom),p.minPitch!==void 0&&g.setMinPitch(p.minPitch),p.maxPitch!==void 0&&g.setMaxPitch(p.maxPitch),p.renderWorldCopies!==void 0&&g.setRenderWorldCopies(p.renderWorldCopies),super(g,_,{bearingSnap:p.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new $a,this._controls=[],this._mapId=s.a7(),this._contextLost=C=>{C.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new s.l("webglcontextlost",{originalEvent:C}))},this._contextRestored=C=>{this._setupPainter(),this.resize(),this._update(),this.fire(new s.l("webglcontextrestored",{originalEvent:C}))},this._onMapScroll=C=>{if(C.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},p.canvasContextAttributes),this._trackResize=p.trackResize===!0,this._bearingSnap=p.bearingSnap,this._centerClampedToGround=p.centerClampedToGround,this._refreshExpiredTiles=p.refreshExpiredTiles===!0,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions===!0,this._collectResourceTiming=p.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},hi),p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=p.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=W.addThrottleControl(()=>this.isMoving()),this._requestManager=new H(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let C=!1;const M=gs(R=>{this._trackResize&&!this._removed&&(this.resize(R),this.redraw())},50);this._resizeObserver=new ResizeObserver(R=>{C?M(R):C=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Jf(this,p),this._hash=p.hash&&new rh(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,elevation:p.elevation,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,roll:p.roll}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,s.e({},p.fitBoundsOptions,{duration:0}))));const S=typeof p.style=="string"||((u=(i=p.style)===null||i===void 0?void 0:i.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,S),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new ep(typeof p.attributionControl=="boolean"?void 0:p.attributionControl)),p.maplibreLogo&&this.addControl(new Py,p.logoPosition),this.on("style.load",()=>{if(S||this._resizeTransform(),this.transform.unmodified){const C=s.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(C)}}),this.on("data",C=>{this._update(C.dataType==="style"),this.fire(new s.l(`${C.dataType}data`,C))}),this.on("dataloading",C=>{this.fire(new s.l(`${C.dataType}dataloading`,C))}),this.on("dataabort",C=>{this.fire(new s.l("sourcedataabort",C))})}_getMapId(){return this._mapId}setGlobalStateProperty(v,i){return this.style.setGlobalStateProperty(v,i),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(v,i){if(i===void 0&&(i=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new s.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=v.onAdd(this);this._controls.push(v);const p=this._controlPositions[i];return i.indexOf("bottom")!==-1?p.insertBefore(u,p.firstChild):p.appendChild(u),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new s.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(v);return i>-1&&this._controls.splice(i,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}coveringTiles(v){return Ce(this.transform,v)}calculateCameraOptionsFromTo(v,i,u,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,i,u,p)}resize(v,i=!0){const[u,p]=this._containerDimensions(),g=this._getClampedPixelRatio(u,p);if(this._resizeCanvas(u,p,g),this.painter.resize(u,p,g),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const C=this._getClampedPixelRatio(u,p);this._resizeCanvas(u,p,C),this.painter.resize(u,p,C)}this._resizeTransform(i);const _=!this._moving;return _&&(this.stop(),this.fire(new s.l("movestart",v)).fire(new s.l("move",v))),this.fire(new s.l("resize",v)),_&&this.fire(new s.l("moveend",v)),this}_resizeTransform(v=!0){var i;const[u,p]=this._containerDimensions();this.transform.resize(u,p,v),(i=this._requestedCameraState)===null||i===void 0||i.resize(u,p,v)}_getClampedPixelRatio(v,i){const{0:u,1:p}=this._maxCanvasSize,g=this.getPixelRatio(),_=v*g,S=i*g;return Math.min(_>u?u/_:1,S>p?p/S:1)*g}getPixelRatio(){var v;return(v=this._overridePixelRatio)!==null&&v!==void 0?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(Vt.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.setMinZoom(v),this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.setMaxZoom(v),this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.setMinPitch(v),this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(v>=this.transform.minPitch)return this.transform.setMaxPitch(v),this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.setRenderWorldCopies(v),this._update()}project(v){return this.transform.locationToScreenPoint(s.S.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.screenPointToLocation(s.P.convert(v),this.terrain)}isMoving(){var v;return this._moving||((v=this.handlers)===null||v===void 0?void 0:v.isMoving())}isZooming(){var v;return this._zooming||((v=this.handlers)===null||v===void 0?void 0:v.isZooming())}isRotating(){var v;return this._rotating||((v=this.handlers)===null||v===void 0?void 0:v.isRotating())}_createDelegatedListener(v,i,u){if(v==="mouseenter"||v==="mouseover"){let p=!1;return{layers:i,listener:u,delegates:{mousemove:_=>{const S=i.filter(M=>this.getLayer(M)),C=S.length!==0?this.queryRenderedFeatures(_.point,{layers:S}):[];C.length?p||(p=!0,u.call(this,new wi(v,this,_.originalEvent,{features:C}))):p=!1},mouseout:()=>{p=!1}}}}if(v==="mouseleave"||v==="mouseout"){let p=!1;return{layers:i,listener:u,delegates:{mousemove:S=>{const C=i.filter(M=>this.getLayer(M));(C.length!==0?this.queryRenderedFeatures(S.point,{layers:C}):[]).length?p=!0:p&&(p=!1,u.call(this,new wi(v,this,S.originalEvent)))},mouseout:S=>{p&&(p=!1,u.call(this,new wi(v,this,S.originalEvent)))}}}}{const p=g=>{const _=i.filter(C=>this.getLayer(C)),S=_.length!==0?this.queryRenderedFeatures(g.point,{layers:_}):[];S.length&&(g.features=S,u.call(this,g),delete g.features)};return{layers:i,listener:u,delegates:{[v]:p}}}}_saveDelegatedListener(v,i){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(i)}_removeDelegatedListener(v,i,u){if(!this._delegatedListeners||!this._delegatedListeners[v])return;const p=this._delegatedListeners[v];for(let g=0;g<p.length;g++){const _=p[g];if(_.listener===u&&_.layers.length===i.length&&_.layers.every(S=>i.includes(S))){for(const S in _.delegates)this.off(S,_.delegates[S]);return void p.splice(g,1)}}}on(v,i,u){if(u===void 0)return super.on(v,i);const p=typeof i=="string"?[i]:i,g=this._createDelegatedListener(v,p,u);this._saveDelegatedListener(v,g);for(const _ in g.delegates)this.on(_,g.delegates[_]);return{unsubscribe:()=>{this._removeDelegatedListener(v,p,u)}}}once(v,i,u){if(u===void 0)return super.once(v,i);const p=typeof i=="string"?[i]:i,g=this._createDelegatedListener(v,p,u);for(const _ in g.delegates){const S=g.delegates[_];g.delegates[_]=(...C)=>{this._removeDelegatedListener(v,p,u),S(...C)}}this._saveDelegatedListener(v,g);for(const _ in g.delegates)this.once(_,g.delegates[_]);return this}off(v,i,u){return u===void 0?super.off(v,i):(this._removeDelegatedListener(v,typeof i=="string"?[i]:i,u),this)}queryRenderedFeatures(v,i){if(!this.style)return[];let u;const p=v instanceof s.P||Array.isArray(v),g=p?v:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(p?{}:v)||{},g instanceof s.P||typeof g[0]=="number")u=[s.P.convert(g)];else{const _=s.P.convert(g[0]),S=s.P.convert(g[1]);u=[_,new s.P(S.x,_.y),S,new s.P(_.x,S.y),_]}return this.style.queryRenderedFeatures(u,i,this.transform)}querySourceFeatures(v,i){return this.style.querySourceFeatures(v,i)}setStyle(v,i){return(i=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(v,i))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const i=this._locale[v];if(i==null)throw new Error(`Missing UI string '${v}'`);return i}_updateStyle(v,i){var u,p;if(i.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(v,i));const g=this.style&&i.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new bf(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v,i,g):this.style.loadJSON(v,i,g),this):((p=(u=this.style)===null||u===void 0?void 0:u.projection)===null||p===void 0||p.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new bf(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,i){if(typeof v=="string"){const u=this._requestManager.transformRequest(v,"Style");s.j(u,new AbortController).then(p=>{this._updateDiff(p.data,i)}).catch(p=>{p&&this.fire(new s.k(p))})}else typeof v=="object"&&this._updateDiff(v,i)}_updateDiff(v,i){try{this.style.setState(v,i)&&this._update(!0)}catch(u){s.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(v,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(v,i){return this._lazyInitEmptyStyle(),this.style.addSource(v,i),this._update(!0)}isSourceLoaded(v){const i=this.style&&this.style.sourceCaches[v];if(i!==void 0)return i.loaded();this.fire(new s.k(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const i=this.style.sourceCaches[v.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);this.terrain===null&&i.reload();for(const u in this.style._layers){const p=this.style._layers[u];p.type==="hillshade"&&p.source===v.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),p.type==="color-relief"&&p.source===v.source&&s.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Mt(this.painter,i,v),this.painter.renderToTexture=new ch(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var p;u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==v.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((p=u.source)===null||p===void 0?void 0:p.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new s.l("terrain",{terrain:v})),this}getTerrain(){var v,i;return(i=(v=this.terrain)===null||v===void 0?void 0:v.options)!==null&&i!==void 0?i:null}areTilesLoaded(){const v=this.style&&this.style.sourceCaches;for(const i in v){const u=v[i]._tiles;for(const p in u){const g=u[p];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}setSourceTileLodParams(v,i,u){if(u){const p=this.getSource(u);if(!p)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);p.calculateTileZoom=tt(Math.max(1,v),Math.max(1,i))}else for(const p in this.style.sourceCaches)this.style.sourceCaches[p].getSource().calculateTileZoom=tt(Math.max(1,v),Math.max(1,i));return this._update(!0),this}refreshTiles(v,i){const u=this.style.sourceCaches[v];if(!u)throw new Error(`There is no source cache with ID "${v}", cannot refresh tile`);i===void 0?u.reload(!0):u.refreshTiles(i.map(p=>new s.a4(p.z,p.x,p.y)))}addImage(v,i,u={}){const{pixelRatio:p=1,sdf:g=!1,stretchX:_,stretchY:S,content:C,textFitWidth:M,textFitHeight:R}=u;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||s.b(i))){if(i.width===void 0||i.height===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:$,height:G,data:V}=i,X=i;return this.style.addImage(v,{data:new s.R({width:$,height:G},new Uint8Array(V)),pixelRatio:p,stretchX:_,stretchY:S,content:C,textFitWidth:M,textFitHeight:R,sdf:g,version:0,userImage:X}),X.onAdd&&X.onAdd(this,v),this}}{const{width:$,height:G,data:V}=I.getImageData(i);this.style.addImage(v,{data:new s.R({width:$,height:G},V),pixelRatio:p,stretchX:_,stretchY:S,content:C,textFitWidth:M,textFitHeight:R,sdf:g,version:0})}}updateImage(v,i){const u=this.style.getImage(v);if(!u)return this.fire(new s.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=i instanceof HTMLImageElement||s.b(i)?I.getImageData(i):i,{width:g,height:_,data:S}=p;if(g===void 0||_===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==u.data.width||_!==u.data.height)return this.fire(new s.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(i instanceof HTMLImageElement||s.b(i));return u.data.replace(S,C),this.style.updateImage(v,u),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new s.k(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v){return W.getImage(this._requestManager.transformRequest(v,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(v,i){return this._lazyInitEmptyStyle(),this.style.addLayer(v,i),this._update(!0)}moveLayer(v,i){return this.style.moveLayer(v,i),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(v,i,u){return this.style.setLayerZoomRange(v,i,u),this._update(!0)}setFilter(v,i,u={}){return this.style.setFilter(v,i,u),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,i,u,p={}){return this.style.setPaintProperty(v,i,u,p),this._update(!0)}getPaintProperty(v,i){return this.style.getPaintProperty(v,i)}setLayoutProperty(v,i,u,p={}){return this.style.setLayoutProperty(v,i,u,p),this._update(!0)}getLayoutProperty(v,i){return this.style.getLayoutProperty(v,i)}setGlyphs(v,i={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,i),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,i,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,i,u,p=>{p||this._update(!0)}),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,i={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,i,u=>{u||this._update(!0)}),this}setLight(v,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,i),this._update(!0)}getLight(){return this.style.getLight()}setSky(v,i={}){return this._lazyInitEmptyStyle(),this.style.setSky(v,i),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(v,i){return this.style.setFeatureState(v,i),this._update()}removeFeatureState(v,i){return this.style.removeFeatureState(v,i),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,i=0;return this._container&&(v=this._container.clientWidth||400,i=this._container.clientHeight||300),[v,i]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const i=this._canvasContainer=j.create("div","maplibregl-canvas-container",v);this._interactive&&i.classList.add("maplibregl-interactive"),this._canvas=j.create("canvas","maplibregl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),p=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],p);const g=this._controlContainer=j.create("div","maplibregl-control-container",v),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{_[S]=j.create("div",`maplibregl-ctrl-${S} `,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,i,u){this._canvas.width=Math.floor(u*v),this._canvas.height=Math.floor(u*i),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const v=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let i=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{i={requestedAttributes:v},p&&(i.statusMessage=p.statusMessage,i.type=p.type)},{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,v):this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v),!u){const p="Failed to initialize WebGL";throw i?(i.message=p,new Error(JSON.stringify(i))):new Error(p)}this.painter=new cy(u,this.transform),z.testSupport(u)}migrateProjection(v,i){super.migrateProjection(v,i),this.painter.transform=v,this.fire(new s.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){var i,u,p,g,_;const S=this._idleTriggered?this._fadeDuration:0,C=((i=this.style.projection)===null||i===void 0?void 0:i.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let M=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const G=this.transform.zoom,V=I.now();this.style.zoomHistory.update(G,V);const X=new s.F(G,{now:V,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),Q=X.crossFadingFactor();Q===1&&Q===this._crossFadingFactor||(M=!0,this._crossFadingFactor=Q),this.style.update(X)}const R=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==C;(p=this.style.projection)===null||p===void 0||p.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((g=this.style.projection)===null||g===void 0?void 0:g.transitionState,(_=this.style.projection)===null||_===void 0?void 0:_.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||R)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,R),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new s.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.cw.mark(s.cx.load),this.fire(new s.l("load"))),this.style&&(this.style.hasTransitions()||M)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const $=this._sourcesDirty||this._styleDirty||this._placementDirty;return $||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.l("idle")),!this._loaded||this._fullyLoaded||$||(this._fullyLoaded=!0,s.cw.mark(s.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),W.removeThrottleControl(this._imageQueueHandle),(v=this._resizeObserver)===null||v===void 0||v.disconnect();const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i!=null&&i.loseContext&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),j.remove(this._canvasContainer),j.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),s.cw.clearMetrics(),this._removed=!0,this.fire(new s.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,I.frame(this._frameRequest,v=>{s.cw.frame(v),this._frameRequest=null;try{this._render(v)}catch(i){if(!s.cy(i)&&!function(u){return u.message===Tc}(i))throw i}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return Ty}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(v){return this._lazyInitEmptyStyle(),this.style.setProjection(v),this._update(!0)}},d.MapMouseEvent=wi,d.MapTouchEvent=hl,d.MapWheelEvent=qf,d.Marker=_l,d.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const i=this._map.getZoom(),u=i===this._map.getMaxZoom(),p=i===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(i,u)=>{const p=this._map._getUIString(`NavigationControl.${u}`);i.title=p,i.setAttribute("aria-label",p)},this.options=s.e({},Hx,v),this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),j.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),j.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=j.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Rc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){j.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,i){const u=j.create("button",v,this._container);return u.type="button",u.addEventListener("click",i),u}},d.Popup=class extends s.E{constructor(v){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&j.remove(this._content),this._container&&(j.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.l("close"))),this),this._onMouseUp=i=>{this._update(i.point)},this._onMouseMove=i=>{this._update(i.point)},this._onDrag=i=>{this._update(i.point)},this._update=i=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=j.create("div","maplibregl-popup",this._map.getContainer()),this._tip=j.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=en(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!i)return;const u=this._flatPos=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&i?i:this._map.transform.locationToScreenPoint(this._lngLat));let p=this.options.anchor;const g=dh(this.options.offset);if(!p){const S=this._container.offsetWidth,C=this._container.offsetHeight;let M;M=u.y+g.bottom.y<C?["top"]:u.y>this._map.transform.height-C?["bottom"]:[],u.x<S/2?M.push("left"):u.x>this._map.transform.width-S/2&&M.push("right"),p=M.length===0?"bottom":M.join("-")}let _=u.add(g[p]);this.options.subpixelPositioning||(_=_.round()),j.setTransform(this._container,`${uh[p]} translate(${_.x}px,${_.y}px)`),vl(this._container,p,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(rp),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=s.S.convert(v),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const i=document.createDocumentFragment(),u=document.createElement("body");let p;for(u.innerHTML=v;p=u.firstChild,p;)i.appendChild(p);return this.setDOMContent(i)}getMaxWidth(){var v;return(v=this._container)===null||v===void 0?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=j.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){return this._container&&this._container.classList.add(v),this}removeClassName(v){return this._container&&this._container.classList.remove(v),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}setSubpixelPositioning(v){this.options.subpixelPositioning=v}_createCloseButton(){this.options.closeButton&&(this._closeButton=j.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(np);v&&v.focus()}},d.RasterDEMTileSource=Yr,d.RasterTileSource=mr,d.ScaleControl=class{constructor(v){this._onMove=()=>{hh(this._map,this._container,this.options)},this.setUnit=i=>{this.options.unit=i,hh(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Nc),v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){j.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},d.ScrollZoomHandler=vy,d.Style=bf,d.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=v}onAdd(v){return this._map=v,this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=j.create("button","maplibregl-ctrl-terrain",this._container),j.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){j.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},d.TwoFingersTouchPitchHandler=ih,d.TwoFingersTouchRotateHandler=gl,d.TwoFingersTouchZoomHandler=nh,d.TwoFingersTouchZoomRotateHandler=by,d.VectorTileSource=fr,d.VideoSource=aa,d.addSourceType=(v,i)=>s._(void 0,void 0,void 0,function*(){if(Wi(v))throw new Error(`A source type called "${v}" already exists.`);((u,p)=>{Yn[u]=p})(v,i)}),d.clearPrewarmedResources=function(){const v=it;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(nt),it=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},d.createTileMesh=_f,d.getMaxParallelImageRequests=function(){return s.a.MAX_PARALLEL_IMAGE_REQUESTS},d.getRTLTextPluginStatus=function(){return Ao().getRTLTextPluginStatus()},d.getVersion=function(){return ip},d.getWorkerCount=function(){return Xe.workerCount},d.getWorkerUrl=function(){return s.a.WORKER_URL},d.importScriptInWorkers=function(v){return or().broadcast("IS",v)},d.prewarm=function(){Pt().acquire(nt)},d.setMaxParallelImageRequests=function(v){s.a.MAX_PARALLEL_IMAGE_REQUESTS=v},d.setRTLTextPlugin=function(v,i){return Ao().setRTLTextPlugin(v,i)},d.setWorkerCount=function(v){Xe.workerCount=v},d.setWorkerUrl=function(v){s.a.WORKER_URL=v}});var h=r;return h})})(sR);var l6=sR.exports;const Ih=Rr(l6),qp=[{id:"route-001",name:"Electronic City to Majestic",estimatedDuration:45,distance:28,coordinates:[{lat:12.8456,lng:77.6632,name:"Electronic City Phase 1",isStop:!0},{lat:12.8475,lng:77.6615,name:"Electronic City Metro"},{lat:12.852,lng:77.658,name:"Hebbagodi"},{lat:12.858,lng:77.654,name:"Bommanahalli"},{lat:12.865,lng:77.648,name:"BTM Layout",isStop:!0},{lat:12.872,lng:77.642,name:"Silk Board Junction"},{lat:12.88,lng:77.635,name:"HSR Layout"},{lat:12.892,lng:77.625,name:"Koramangala",isStop:!0},{lat:12.905,lng:77.615,name:"Ejipura"},{lat:12.915,lng:77.605,name:"Shanthi Nagar"},{lat:12.925,lng:77.595,name:"Richmond Town"},{lat:12.935,lng:77.585,name:"Cubbon Park"},{lat:12.945,lng:77.575,name:"Vidhana Soudha"},{lat:12.955,lng:77.565,name:"Majestic Bus Stand",isStop:!0}]},{id:"route-002",name:"Whitefield to Silk Board",estimatedDuration:55,distance:32,coordinates:[{lat:12.9698,lng:77.75,name:"Whitefield Bus Stand",isStop:!0},{lat:12.965,lng:77.74,name:"ITPL Main Gate"},{lat:12.96,lng:77.73,name:"Kundalahalli"},{lat:12.955,lng:77.72,name:"Brookefield"},{lat:12.95,lng:77.71,name:"KR Puram",isStop:!0},{lat:12.945,lng:77.7,name:"Ramamurthy Nagar"},{lat:12.935,lng:77.68,name:"Banaswadi"},{lat:12.925,lng:77.66,name:"Kalyan Nagar"},{lat:12.915,lng:77.64,name:"Hebbal",isStop:!0},{lat:12.905,lng:77.63,name:"RT Nagar"},{lat:12.895,lng:77.625,name:"Yeshwanthpur"},{lat:12.885,lng:77.62,name:"Malleswaram"},{lat:12.875,lng:77.615,name:"Rajajinagar",isStop:!0},{lat:12.872,lng:77.642,name:"Silk Board Junction",isStop:!0}]},{id:"route-003",name:"Banashankari to KR Puram",estimatedDuration:40,distance:25,coordinates:[{lat:12.928,lng:77.557,name:"Banashankari Bus Stand",isStop:!0},{lat:12.932,lng:77.562,name:"Banashankari 2nd Stage"},{lat:12.938,lng:77.568,name:"South End Circle"},{lat:12.945,lng:77.575,name:"Lalbagh"},{lat:12.952,lng:77.582,name:"Wilson Garden"},{lat:12.958,lng:77.59,name:"Shivaji Nagar",isStop:!0},{lat:12.965,lng:77.6,name:"Cantonment"},{lat:12.972,lng:77.61,name:"MG Road",isStop:!0},{lat:12.978,lng:77.62,name:"Trinity Circle"},{lat:12.982,lng:77.63,name:"Ulsoor"},{lat:12.985,lng:77.645,name:"HAL Airport Road"},{lat:12.98,lng:77.66,name:"Domlur"},{lat:12.975,lng:77.675,name:"Indiranagar",isStop:!0},{lat:12.97,lng:77.69,name:"Banaswadi"},{lat:12.955,lng:77.72,name:"KR Puram",isStop:!0}]}],c6=[{id:"route-004",name:"Andheri to CST",estimatedDuration:60,distance:35,coordinates:[{lat:19.1136,lng:72.8697,name:"Andheri Station",isStop:!0},{lat:19.11,lng:72.865,name:"Chakala"},{lat:19.105,lng:72.86,name:"Sahar Road"},{lat:19.095,lng:72.85,name:"Ghatkopar",isStop:!0},{lat:19.085,lng:72.84,name:"Vikhroli"},{lat:19.075,lng:72.835,name:"Bhandup"},{lat:19.065,lng:72.83,name:"Mulund"},{lat:19.055,lng:72.825,name:"Thane",isStop:!0},{lat:19.045,lng:72.82,name:"Sion"},{lat:19.035,lng:72.815,name:"Matunga"},{lat:19.025,lng:72.81,name:"Dadar",isStop:!0},{lat:19.015,lng:72.805,name:"Lower Parel"},{lat:19.005,lng:72.8,name:"Grant Road"},{lat:18.995,lng:72.795,name:"Churchgate"},{lat:18.94,lng:72.835,name:"CST Station",isStop:!0}]}],u6=[{id:"route-005",name:"Connaught Place to Gurgaon",estimatedDuration:50,distance:30,coordinates:[{lat:28.6315,lng:77.2167,name:"Connaught Place",isStop:!0},{lat:28.628,lng:77.22,name:"Rajiv Chowk"},{lat:28.62,lng:77.23,name:"India Gate"},{lat:28.61,lng:77.24,name:"ITO",isStop:!0},{lat:28.6,lng:77.25,name:"Lajpat Nagar"},{lat:28.59,lng:77.26,name:"AIIMS"},{lat:28.58,lng:77.27,name:"Green Park",isStop:!0},{lat:28.57,lng:77.28,name:"Hauz Khas"},{lat:28.56,lng:77.29,name:"Malviya Nagar"},{lat:28.55,lng:77.3,name:"Saket",isStop:!0},{lat:28.54,lng:77.31,name:"Chattarpur"},{lat:28.53,lng:77.32,name:"Gwal Pahari"},{lat:28.4595,lng:77.0266,name:"Cyber City, Gurgaon",isStop:!0}]}],cR=[...qp,...c6,...u6],nm=e=>cR.find(t=>t.id===e),h6=(e,t)=>{const n=(t.lat-e.lat)*Math.PI/180,o=(t.lng-e.lng)*Math.PI/180,h=Math.sin(n/2)*Math.sin(n/2)+Math.cos(e.lat*Math.PI/180)*Math.cos(t.lat*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return 6371*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))},d6=(e,t)=>{const r=(t.lng-e.lng)*Math.PI/180,n=e.lat*Math.PI/180,o=t.lat*Math.PI/180,h=Math.sin(r)*Math.cos(o),d=Math.cos(n)*Math.sin(o)-Math.sin(n)*Math.cos(o)*Math.cos(r);return(Math.atan2(h,d)*180/Math.PI+360)%360};class f6{constructor(){za(this,"activeBuses",new Map);za(this,"simulationIntervals",new Map);za(this,"eventListeners",[]);za(this,"updateListeners",[])}onEvent(t){return this.eventListeners.push(t),()=>{const r=this.eventListeners.indexOf(t);r>-1&&this.eventListeners.splice(r,1)}}onUpdate(t){return this.updateListeners.push(t),()=>{const r=this.updateListeners.indexOf(t);r>-1&&this.updateListeners.splice(r,1)}}startBusJourney(t,r){if(this.activeBuses.has(t))return console.warn(`Bus ${t} is already active`),!1;const n=nm(r);if(!n||n.coordinates.length===0)return console.error(`Invalid route: ${r}`),!1;const o={busId:t,routeId:r,isActive:!0,currentPosition:n.coordinates[0],currentCoordinateIndex:0,progress:0,estimatedTimeRemaining:n.estimatedDuration,speed:35,status:"moving",bearing:0,nextStop:this.findNextStop(n,0),distanceToDestination:n.distance,startTime:new Date,lastUpdate:new Date};return this.activeBuses.set(t,o),this.startSimulationLoop(t),this.emitEvent({id:this.generateEventId(),busId:t,type:"started",message:`Bus ${t} started journey on ${n.name}`,timestamp:new Date,location:n.coordinates[0]}),!0}stopBusJourney(t){const r=this.activeBuses.get(t);return r?(this.clearSimulationInterval(t),this.activeBuses.delete(t),this.emitEvent({id:this.generateEventId(),busId:t,type:"stopped",message:`Bus ${t} journey stopped`,timestamp:new Date,location:r.currentPosition}),this.notifyUpdates(),!0):!1}simulateDelay(t,r){const n=this.activeBuses.get(t);return!n||!n.isActive?!1:(n.status="delayed",n.estimatedTimeRemaining+=r,n.speed=Math.max(n.speed*.5,10),this.emitEvent({id:this.generateEventId(),busId:t,type:"delay",message:`Bus ${t} delayed by ${r} minutes`,timestamp:new Date,location:n.currentPosition}),this.notifyUpdates(),!0)}simulateEmergency(t){const r=this.activeBuses.get(t);return!r||!r.isActive?!1:(r.status="emergency",r.speed=0,this.emitEvent({id:this.generateEventId(),busId:t,type:"emergency",message:`EMERGENCY: Bus ${t} stopped unexpectedly`,timestamp:new Date,location:r.currentPosition}),this.notifyUpdates(),!0)}resumeBusJourney(t){const r=this.activeBuses.get(t);return!r||!r.isActive?!1:(r.status="moving",r.speed=35,this.emitEvent({id:this.generateEventId(),busId:t,type:"started",message:`Bus ${t} resumed journey`,timestamp:new Date,location:r.currentPosition}),this.notifyUpdates(),!0)}getActiveBuses(){return Array.from(this.activeBuses.values())}getBusState(t){return this.activeBuses.get(t)}startSimulationLoop(t){const r=setInterval(()=>{this.updateBusPosition(t)},3e3);this.simulationIntervals.set(t,r)}clearSimulationInterval(t){const r=this.simulationIntervals.get(t);r&&(clearInterval(r),this.simulationIntervals.delete(t))}updateBusPosition(t){const r=this.activeBuses.get(t);if(!r||!r.isActive||r.status!=="moving")return;const n=nm(r.routeId);if(!n)return;const o=r.currentCoordinateIndex+1;if(o>=n.coordinates.length){this.completeBusJourney(t);return}r.currentCoordinateIndex=o,r.currentPosition=n.coordinates[o],r.progress=o/(n.coordinates.length-1)*100;let h=0;for(let s=o;s<n.coordinates.length-1;s++)h+=h6(n.coordinates[s],n.coordinates[s+1]);r.distanceToDestination=h,r.estimatedTimeRemaining=h/r.speed*60,o<n.coordinates.length-1&&(r.bearing=d6(n.coordinates[o],n.coordinates[o+1])),r.nextStop=this.findNextStop(n,o),r.lastUpdate=new Date;const d=n.coordinates[o];d.isStop&&this.emitEvent({id:this.generateEventId(),busId:t,type:"milestone",message:`Bus ${t} reached ${d.name}`,timestamp:new Date,location:d}),this.notifyUpdates()}completeBusJourney(t){const r=this.activeBuses.get(t);if(!r)return;r.status="completed",r.progress=100,r.estimatedTimeRemaining=0,r.distanceToDestination=0,r.isActive=!1;const n=nm(r.routeId),o=n==null?void 0:n.coordinates[n.coordinates.length-1];this.emitEvent({id:this.generateEventId(),busId:t,type:"completed",message:`Bus ${t} completed journey to ${(o==null?void 0:o.name)||"destination"}`,timestamp:new Date,location:o}),this.clearSimulationInterval(t),this.notifyUpdates(),setTimeout(()=>{this.activeBuses.delete(t),this.notifyUpdates()},3e4)}findNextStop(t,r){for(let n=r+1;n<t.coordinates.length;n++)if(t.coordinates[n].isStop)return t.coordinates[n].name;return t.coordinates[t.coordinates.length-1].name}emitEvent(t){this.eventListeners.forEach(r=>{try{r(t)}catch(n){console.error("Error in event listener:",n)}})}notifyUpdates(){const t=this.getActiveBuses();this.updateListeners.forEach(r=>{try{r(t)}catch(n){console.error("Error in update listener:",n)}})}generateEventId(){return`event_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}cleanup(){this.simulationIntervals.forEach(t=>clearInterval(t)),this.simulationIntervals.clear(),this.activeBuses.clear(),this.eventListeners.length=0,this.updateListeners.length=0}}const As=new f6,p6="cXEywNCr1BRH73NEwP9I",m6=({className:e="",showAllBuses:t=!1,selectedBusId:r,onBusSelect:n})=>{var Le,Be,nt;const o=be.useRef(null),h=be.useRef(null),d=be.useRef({}),s=Oi(),{theme:y}=Mr(),[w,k]=be.useState(null),[E,I]=be.useState(!0),[j,z]=be.useState([]),[L,q]=be.useState([]),[F,U]=be.useState([]),[N,W]=be.useState([]),[H,Z]=be.useState(null),[re]=be.useState(!0);be.useEffect(()=>{},[H]);const he=be.useMemo(()=>`https://api.maptiler.com/maps/streets-v2/style.json?key=${p6}`,[]),we=(Xe,Ge)=>Xe.map(it=>{const gt=Ge[Math.floor(Math.random()*Ge.length)],Pt=qp.find(Nt=>Nt.name.includes((gt==null?void 0:gt.name.split(" ")[0])||"Electronic"));if(Pt&&Pt.coordinates.length>0){const Nt=Math.floor(Math.random()*Pt.coordinates.length),or=Pt.coordinates[Nt];return{...it,currentLocation:{lat:or.lat,lng:or.lng},assignedRouteGPS:Pt}}return{...it,currentLocation:{lat:12.9716,lng:77.5946},assignedRouteGPS:qp[0]}}),Oe=Xe=>{if(!h.current)return;const Ge=qp.find(gt=>gt.id===Xe);if(!Ge)return;const it=Ge.coordinates.map(gt=>[gt.lng,gt.lat]);h.current.getLayer("route-line")&&h.current.removeLayer("route-line"),h.current.getSource("route-line")&&h.current.removeSource("route-line"),h.current.addSource("route-line",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:it}}}),h.current.addLayer({id:"route-line",type:"line",source:"route-line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":y==="dark"?"#60a5fa":"#3b82f6","line-width":4,"line-opacity":.8}}),Ge.coordinates.forEach(gt=>{if(gt.isStop){const Pt=document.createElement("div");Pt.className="route-stop",Pt.style.cssText=`
          width: 12px;
          height: 12px;
          border-radius: 50%;
          background-color: ${y==="dark"?"#fbbf24":"#f59e0b"};
          border: 2px solid white;
          box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        `,new Ih.Marker({element:Pt}).setLngLat([gt.lng,gt.lat]).setPopup(new Ih.Popup({offset:15}).setHTML(`<div style="font-weight: bold; color: #1f2937;">${gt.name}</div>`)).addTo(h.current)}})},Me=()=>{h.current&&(h.current.getLayer("route-line")&&h.current.removeLayer("route-line"),h.current.getSource("route-line")&&h.current.removeSource("route-line"))};be.useEffect(()=>{if(!o.current)return;if(h.current){try{h.current.remove()}catch{}h.current=null}h.current=new Ih.Map({container:o.current,style:he,center:[77.5946,12.9716],zoom:11,attributionControl:!1}),h.current.addControl(new Ih.NavigationControl({showCompass:!0}),"top-left");const Xe=()=>{I(!1)};return h.current.on("load",Xe),()=>{if(Object.values(d.current).forEach(Ge=>Ge.remove()),d.current={},h.current){h.current.off("load",Xe);try{h.current.remove()}catch{}h.current=null}}},[he]),be.useEffect(()=>{const Xe=As.onUpdate(async Ge=>{z(Ge),re&&await Ue(Ge)});return()=>Xe()},[re]);const Se=Xe=>{h.current&&(Object.values(d.current).forEach(Ge=>Ge.remove()),d.current={},Xe.forEach(Ge=>{const it=new Ih.Popup({offset:16}).setText(Ge.label),gt=new Ih.Marker({color:"#ef4444"}).setLngLat([Ge.lng,Ge.lat]).setPopup(it).addTo(h.current);Ge.onClick&&gt.getElement().addEventListener("click",()=>Ge.onClick&&Ge.onClick()),d.current[Ge.id]=gt}))},Ue=async Xe=>{if(!h.current)return;const Ge=await s.listBuses(),it=await s.listDrivers(),gt=Xe.map(Pt=>{const Nt=nm(Pt.routeId),or=Ge.find(Dt=>Dt.id===Pt.busId),rr=it.find(Dt=>Dt.id===(or==null?void 0:or.assignedDriverId)),pt=`Bus ${(or==null?void 0:or.busNumber)||Pt.busId} - ${(rr==null?void 0:rr.fullName)||"Unknown Driver"} - ${(Nt==null?void 0:Nt.name)||"Unknown Route"} - ${Pt.status} - ${Pt.speed} km/h`;return{id:Pt.busId,lat:Pt.currentPosition.lat,lng:Pt.currentPosition.lng,label:pt,onClick:()=>{k({bus:Pt,driver:rr,busInfo:or})}}});Se(gt)};be.useEffect(()=>{let Xe=!1;return(async()=>{try{const[it,gt,Pt]=await Promise.all([s.listBuses(),s.listDrivers(),s.listRoutes()]);if(Xe)return;q(it),U(gt),W(Pt)}catch(it){console.error("Failed to load fleet data",it)}})(),()=>{Xe=!0}},[s]),be.useEffect(()=>{if(!h.current||!t||L.length===0)return;const Ge=we(L,N).map(it=>{const gt=F.find(Nt=>Nt.assignedBusId===it.id),Pt=N.find(Nt=>{var or;return(or=gt==null?void 0:gt.assignedRouteIds)==null?void 0:or.includes(Nt.id)});return{id:it.id,lat:it.currentLocation.lat,lng:it.currentLocation.lng,label:`${it.busNumber} - ${(gt==null?void 0:gt.fullName)||"Unassigned"} - ${(Pt==null?void 0:Pt.name)||"No Route"}`,onClick:()=>{n&&n(it.id),it.assignedRouteGPS&&(Z(it.assignedRouteGPS.id),Oe(it.assignedRouteGPS.id))}}});Se(Ge)},[t,L,F,N,n]),be.useEffect(()=>{if(r&&L.length>0){const Xe=L.find(Ge=>Ge.id===r);if(Xe){const Ge=F.find(gt=>gt.assignedBusId===Xe.id),it=N.find(gt=>{var Pt;return(Pt=Ge==null?void 0:Ge.assignedRouteIds)==null?void 0:Pt.includes(gt.id)});if(it){const gt=qp.find(Pt=>Pt.name.toLowerCase().includes(it.name.split(" ")[0].toLowerCase()));gt&&(Z(gt.id),Oe(gt.id))}}}else Z(null),Me()},[r,L,F,N]),be.useEffect(()=>{let Xe=!1;return E||(async()=>{if(!(!h.current||t))try{const it=await s.listDrivers("approved"),gt=await s.listBuses();if(Xe)return;const Pt=12.9716,Nt=77.5946,or=it.filter(rr=>rr.assignedBusId).map(rr=>{const pt=gt.find(et=>et.id===rr.assignedBusId),Dt=Pt+(Math.random()-.5)*.1,zt=Nt+(Math.random()-.5)*.1;return{id:rr.id,lat:Dt,lng:zt,label:`${rr.fullName} - ${(pt==null?void 0:pt.busNumber)||"Unknown Bus"}`}});Se(or)}catch(it){console.error("Failed to load initial markers",it)}})(),()=>{Xe=!0}},[s,E,t]);const We=[{label:"Active Buses",value:j.length,icon:Gs,color:"text-blue-500"},{label:"Routes",value:6,icon:Mm,color:"text-green-500"},{label:"Avg Speed",value:"42 km/h",icon:iR,color:"text-purple-500"}],qe=()=>{h.current&&h.current.zoomIn()},Je=()=>{h.current&&h.current.zoomOut()},rt=()=>{var Ge,it,gt;const Xe=(Ge=o.current)==null?void 0:Ge.parentElement;Xe&&(document.fullscreenElement?(gt=document.exitFullscreen)==null||gt.call(document):(it=Xe.requestFullscreen)==null||it.call(Xe))};return P.jsxs("div",{className:`relative overflow-hidden rounded-2xl ${y==="dark"?"bg-gray-800/50 backdrop-blur-xl border border-gray-700/50":"bg-white/70 backdrop-blur-xl border border-gray-200/50"} shadow-xl group ${e}`,children:[P.jsx("div",{className:`p-6 border-b ${y==="dark"?"border-gray-700/50":"border-gray-200/50"}`,children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{className:"flex items-center space-x-3",children:[P.jsx("div",{className:`p-2 rounded-xl bg-gradient-to-br ${y==="dark"?"from-purple-500 to-cyan-500":"from-blue-500 to-indigo-600"}`,children:P.jsx(Cm,{className:"h-5 w-5 text-white"})}),P.jsxs("div",{children:[P.jsx("h3",{className:`text-lg font-semibold ${y==="dark"?"text-white":"text-gray-900"}`,children:"Live Bus Tracking"}),P.jsx("p",{className:`text-sm ${y==="dark"?"text-gray-400":"text-gray-500"}`,children:"Real-time driver locations"})]})]}),P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("button",{onClick:qe,className:`p-2 rounded-lg transition-colors ${y==="dark"?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:P.jsx(ZB,{className:"h-4 w-4"})}),P.jsx("button",{onClick:Je,className:`p-2 rounded-lg transition-colors ${y==="dark"?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:P.jsx(KB,{className:"h-4 w-4"})}),P.jsx("button",{onClick:rt,className:`p-2 rounded-lg transition-colors ${y==="dark"?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:P.jsx(i6,{className:"h-4 w-4"})})]})]})}),P.jsxs("div",{className:"p-6 space-y-4",children:[P.jsx("div",{className:"grid grid-cols-3 gap-4",children:We.map((Xe,Ge)=>{const it=Xe.icon;return P.jsx("div",{className:`p-4 rounded-xl border transition-all ${y==="dark"?"bg-gray-700/30 border-gray-600/30 hover:bg-gray-700/50":"bg-white/50 border-gray-200/50 hover:bg-white/70"}`,children:P.jsxs("div",{className:"flex items-center space-x-3",children:[P.jsx(it,{className:`h-5 w-5 ${Xe.color}`}),P.jsxs("div",{children:[P.jsx("p",{className:`text-sm font-medium ${y==="dark"?"text-white":"text-gray-900"}`,children:Xe.value}),P.jsx("p",{className:`text-xs ${y==="dark"?"text-gray-400":"text-gray-500"}`,children:Xe.label})]})]})},Ge)})}),P.jsxs("div",{className:"relative",children:[E&&P.jsx("div",{className:`absolute inset-0 flex items-center justify-center rounded-lg z-10 ${y==="dark"?"bg-gray-800/80":"bg-white/80"}`,children:P.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[P.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),P.jsx("p",{className:`text-sm ${y==="dark"?"text-gray-300":"text-gray-600"}`,children:"Loading map..."})]})}),P.jsx("div",{ref:o,className:`w-full h-96 rounded-lg transition-all ${y==="dark"?"bg-gray-900 border border-gray-700":"bg-gray-100 border border-gray-200"}`,"aria-label":"Live driver locations map"}),!E&&P.jsx("div",{className:"absolute top-4 right-4 z-10",children:P.jsx("div",{className:`px-3 py-2 rounded-lg shadow-lg ${y==="dark"?"bg-gray-800/90 backdrop-blur-sm border border-gray-700/50":"bg-white/90 backdrop-blur-sm border border-gray-200/50"}`,children:P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("div",{className:"h-2 w-2 bg-green-400 rounded-full animate-pulse"}),P.jsx("span",{className:`text-sm font-medium ${y==="dark"?"text-white":"text-gray-900"}`,children:"Live"})]})})})]})]}),w&&P.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-20 p-4",children:P.jsxs("div",{className:`w-full max-w-md p-6 rounded-2xl shadow-2xl ${y==="dark"?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"}`,children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("h3",{className:`text-lg font-semibold ${y==="dark"?"text-white":"text-gray-900"}`,children:"Bus Details"}),P.jsx("button",{onClick:()=>k(null),className:`p-2 rounded-lg transition-colors ${y==="dark"?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:P.jsx(aR,{className:"h-5 w-5"})})]}),P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[P.jsx(Gs,{className:"h-5 w-5 text-blue-500"}),P.jsxs("div",{children:[P.jsx("p",{className:`font-medium ${y==="dark"?"text-white":"text-gray-900"}`,children:((Le=w.busInfo)==null?void 0:Le.busNumber)||w.bus.busId}),P.jsx("p",{className:`text-sm ${y==="dark"?"text-gray-400":"text-gray-500"}`,children:"Bus Number"})]})]}),P.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-green-50 dark:bg-green-900/20",children:[P.jsx(lv,{className:"h-5 w-5 text-green-500"}),P.jsxs("div",{children:[P.jsx("p",{className:`font-medium ${y==="dark"?"text-white":"text-gray-900"}`,children:((Be=w.driver)==null?void 0:Be.fullName)||"Unknown Driver"}),P.jsx("p",{className:`text-sm ${y==="dark"?"text-gray-400":"text-gray-500"}`,children:"Driver"})]})]}),P.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-purple-50 dark:bg-purple-900/20",children:[P.jsx(Mm,{className:"h-5 w-5 text-purple-500"}),P.jsxs("div",{children:[P.jsx("p",{className:`font-medium ${y==="dark"?"text-white":"text-gray-900"}`,children:((nt=nm(w.bus.routeId))==null?void 0:nt.name)||"Unknown Route"}),P.jsx("p",{className:`text-sm ${y==="dark"?"text-gray-400":"text-gray-500"}`,children:"Route"})]})]}),P.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-orange-50 dark:bg-orange-900/20",children:[P.jsx($0,{className:"h-5 w-5 text-orange-500"}),P.jsxs("div",{children:[P.jsx("p",{className:`font-medium ${y==="dark"?"text-white":"text-gray-900"}`,children:"On Time"}),P.jsx("p",{className:`text-sm ${y==="dark"?"text-gray-400":"text-gray-500"}`,children:"Status"})]})]})]})]})})]})};function uR(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=uR(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function wr(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=uR(e))&&(n&&(n+=" "),n+=t);return n}var g6=Array.isArray,ia=g6,y6=typeof yi=="object"&&yi&&yi.Object===Object&&yi,hR=y6,v6=hR,_6=typeof self=="object"&&self&&self.Object===Object&&self,x6=v6||_6||Function("return this")(),ts=x6,b6=ts,w6=b6.Symbol,_g=w6,wA=_g,dR=Object.prototype,S6=dR.hasOwnProperty,P6=dR.toString,Mp=wA?wA.toStringTag:void 0;function T6(e){var t=S6.call(e,Mp),r=e[Mp];try{e[Mp]=void 0;var n=!0}catch{}var o=P6.call(e);return n&&(t?e[Mp]=r:delete e[Mp]),o}var k6=T6,E6=Object.prototype,A6=E6.toString;function C6(e){return A6.call(e)}var M6=C6,SA=_g,I6=k6,j6=M6,O6="[object Null]",D6="[object Undefined]",PA=SA?SA.toStringTag:void 0;function R6(e){return e==null?e===void 0?D6:O6:PA&&PA in Object(e)?I6(e):j6(e)}var Ks=R6;function N6(e){return e!=null&&typeof e=="object"}var Xs=N6,$6=Ks,z6=Xs,L6="[object Symbol]";function B6(e){return typeof e=="symbol"||z6(e)&&$6(e)==L6}var Zd=B6,F6=ia,U6=Zd,V6=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,G6=/^\w*$/;function q6(e,t){if(F6(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||U6(e)?!0:G6.test(e)||!V6.test(e)||t!=null&&e in Object(t)}var mP=q6;function W6(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var nc=W6;const Kd=Rr(nc);var H6=Ks,Z6=nc,K6="[object AsyncFunction]",X6="[object Function]",Y6="[object GeneratorFunction]",J6="[object Proxy]";function Q6(e){if(!Z6(e))return!1;var t=H6(e);return t==X6||t==Y6||t==K6||t==J6}var gP=Q6;const ar=Rr(gP);var eF=ts,tF=eF["__core-js_shared__"],rF=tF,o1=rF,TA=function(){var e=/[^.]+$/.exec(o1&&o1.keys&&o1.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function nF(e){return!!TA&&TA in e}var iF=nF,aF=Function.prototype,oF=aF.toString;function sF(e){if(e!=null){try{return oF.call(e)}catch{}try{return e+""}catch{}}return""}var fR=sF,lF=gP,cF=iF,uF=nc,hF=fR,dF=/[\\^$.*+?()[\]{}|]/g,fF=/^\[object .+?Constructor\]$/,pF=Function.prototype,mF=Object.prototype,gF=pF.toString,yF=mF.hasOwnProperty,vF=RegExp("^"+gF.call(yF).replace(dF,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function _F(e){if(!uF(e)||cF(e))return!1;var t=lF(e)?vF:fF;return t.test(hF(e))}var xF=_F;function bF(e,t){return e==null?void 0:e[t]}var wF=bF,SF=xF,PF=wF;function TF(e,t){var r=PF(e,t);return SF(r)?r:void 0}var Pu=TF,kF=Pu,EF=kF(Object,"create"),P_=EF,kA=P_;function AF(){this.__data__=kA?kA(null):{},this.size=0}var CF=AF;function MF(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var IF=MF,jF=P_,OF="__lodash_hash_undefined__",DF=Object.prototype,RF=DF.hasOwnProperty;function NF(e){var t=this.__data__;if(jF){var r=t[e];return r===OF?void 0:r}return RF.call(t,e)?t[e]:void 0}var $F=NF,zF=P_,LF=Object.prototype,BF=LF.hasOwnProperty;function FF(e){var t=this.__data__;return zF?t[e]!==void 0:BF.call(t,e)}var UF=FF,VF=P_,GF="__lodash_hash_undefined__";function qF(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=VF&&t===void 0?GF:t,this}var WF=qF,HF=CF,ZF=IF,KF=$F,XF=UF,YF=WF;function Xd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Xd.prototype.clear=HF;Xd.prototype.delete=ZF;Xd.prototype.get=KF;Xd.prototype.has=XF;Xd.prototype.set=YF;var JF=Xd;function QF(){this.__data__=[],this.size=0}var e8=QF;function t8(e,t){return e===t||e!==e&&t!==t}var yP=t8,r8=yP;function n8(e,t){for(var r=e.length;r--;)if(r8(e[r][0],t))return r;return-1}var T_=n8,i8=T_,a8=Array.prototype,o8=a8.splice;function s8(e){var t=this.__data__,r=i8(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():o8.call(t,r,1),--this.size,!0}var l8=s8,c8=T_;function u8(e){var t=this.__data__,r=c8(t,e);return r<0?void 0:t[r][1]}var h8=u8,d8=T_;function f8(e){return d8(this.__data__,e)>-1}var p8=f8,m8=T_;function g8(e,t){var r=this.__data__,n=m8(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var y8=g8,v8=e8,_8=l8,x8=h8,b8=p8,w8=y8;function Yd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Yd.prototype.clear=v8;Yd.prototype.delete=_8;Yd.prototype.get=x8;Yd.prototype.has=b8;Yd.prototype.set=w8;var k_=Yd,S8=Pu,P8=ts,T8=S8(P8,"Map"),vP=T8,EA=JF,k8=k_,E8=vP;function A8(){this.size=0,this.__data__={hash:new EA,map:new(E8||k8),string:new EA}}var C8=A8;function M8(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var I8=M8,j8=I8;function O8(e,t){var r=e.__data__;return j8(t)?r[typeof t=="string"?"string":"hash"]:r.map}var E_=O8,D8=E_;function R8(e){var t=D8(this,e).delete(e);return this.size-=t?1:0,t}var N8=R8,$8=E_;function z8(e){return $8(this,e).get(e)}var L8=z8,B8=E_;function F8(e){return B8(this,e).has(e)}var U8=F8,V8=E_;function G8(e,t){var r=V8(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var q8=G8,W8=C8,H8=N8,Z8=L8,K8=U8,X8=q8;function Jd(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Jd.prototype.clear=W8;Jd.prototype.delete=H8;Jd.prototype.get=Z8;Jd.prototype.has=K8;Jd.prototype.set=X8;var _P=Jd,pR=_P,Y8="Expected a function";function xP(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Y8);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],h=r.cache;if(h.has(o))return h.get(o);var d=e.apply(this,n);return r.cache=h.set(o,d)||h,d};return r.cache=new(xP.Cache||pR),r}xP.Cache=pR;var mR=xP;const J8=Rr(mR);var Q8=mR,eU=500;function tU(e){var t=Q8(e,function(n){return r.size===eU&&r.clear(),n}),r=t.cache;return t}var rU=tU,nU=rU,iU=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,aU=/\\(\\)?/g,oU=nU(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(iU,function(r,n,o,h){t.push(o?h.replace(aU,"$1"):n||r)}),t}),sU=oU;function lU(e,t){for(var r=-1,n=e==null?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var bP=lU,AA=_g,cU=bP,uU=ia,hU=Zd,dU=1/0,CA=AA?AA.prototype:void 0,MA=CA?CA.toString:void 0;function gR(e){if(typeof e=="string")return e;if(uU(e))return cU(e,gR)+"";if(hU(e))return MA?MA.call(e):"";var t=e+"";return t=="0"&&1/e==-dU?"-0":t}var fU=gR,pU=fU;function mU(e){return e==null?"":pU(e)}var yR=mU,gU=ia,yU=mP,vU=sU,_U=yR;function xU(e,t){return gU(e)?e:yU(e,t)?[e]:vU(_U(e))}var vR=xU,bU=Zd,wU=1/0;function SU(e){if(typeof e=="string"||bU(e))return e;var t=e+"";return t=="0"&&1/e==-wU?"-0":t}var A_=SU,PU=vR,TU=A_;function kU(e,t){t=PU(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[TU(t[r++])];return r&&r==n?e:void 0}var wP=kU,EU=wP;function AU(e,t,r){var n=e==null?void 0:EU(e,t);return n===void 0?r:n}var _R=AU;const Ha=Rr(_R);function CU(e){return e==null}var MU=CU;const Sr=Rr(MU);var IU=Ks,jU=ia,OU=Xs,DU="[object String]";function RU(e){return typeof e=="string"||!jU(e)&&OU(e)&&IU(e)==DU}var NU=RU;const yu=Rr(NU);var xR={exports:{}},Ir={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SP=Symbol.for("react.element"),PP=Symbol.for("react.portal"),C_=Symbol.for("react.fragment"),M_=Symbol.for("react.strict_mode"),I_=Symbol.for("react.profiler"),j_=Symbol.for("react.provider"),O_=Symbol.for("react.context"),$U=Symbol.for("react.server_context"),D_=Symbol.for("react.forward_ref"),R_=Symbol.for("react.suspense"),N_=Symbol.for("react.suspense_list"),$_=Symbol.for("react.memo"),z_=Symbol.for("react.lazy"),zU=Symbol.for("react.offscreen"),bR;bR=Symbol.for("react.module.reference");function Ja(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case SP:switch(e=e.type,e){case C_:case I_:case M_:case R_:case N_:return e;default:switch(e=e&&e.$$typeof,e){case $U:case O_:case D_:case z_:case $_:case j_:return e;default:return t}}case PP:return t}}}Ir.ContextConsumer=O_;Ir.ContextProvider=j_;Ir.Element=SP;Ir.ForwardRef=D_;Ir.Fragment=C_;Ir.Lazy=z_;Ir.Memo=$_;Ir.Portal=PP;Ir.Profiler=I_;Ir.StrictMode=M_;Ir.Suspense=R_;Ir.SuspenseList=N_;Ir.isAsyncMode=function(){return!1};Ir.isConcurrentMode=function(){return!1};Ir.isContextConsumer=function(e){return Ja(e)===O_};Ir.isContextProvider=function(e){return Ja(e)===j_};Ir.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===SP};Ir.isForwardRef=function(e){return Ja(e)===D_};Ir.isFragment=function(e){return Ja(e)===C_};Ir.isLazy=function(e){return Ja(e)===z_};Ir.isMemo=function(e){return Ja(e)===$_};Ir.isPortal=function(e){return Ja(e)===PP};Ir.isProfiler=function(e){return Ja(e)===I_};Ir.isStrictMode=function(e){return Ja(e)===M_};Ir.isSuspense=function(e){return Ja(e)===R_};Ir.isSuspenseList=function(e){return Ja(e)===N_};Ir.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===C_||e===I_||e===M_||e===R_||e===N_||e===zU||typeof e=="object"&&e!==null&&(e.$$typeof===z_||e.$$typeof===$_||e.$$typeof===j_||e.$$typeof===O_||e.$$typeof===D_||e.$$typeof===bR||e.getModuleId!==void 0)};Ir.typeOf=Ja;xR.exports=Ir;var LU=xR.exports,BU=Ks,FU=Xs,UU="[object Number]";function VU(e){return typeof e=="number"||FU(e)&&BU(e)==UU}var wR=VU;const GU=Rr(wR);var qU=wR;function WU(e){return qU(e)&&e!=+e}var HU=WU;const xg=Rr(HU);var bo=function(t){return t===0?0:t>0?1:-1},nu=function(t){return yu(t)&&t.indexOf("%")===t.length-1},vt=function(t){return GU(t)&&!xg(t)},ZU=function(t){return Sr(t)},Zn=function(t){return vt(t)||yu(t)},KU=0,L_=function(t){var r=++KU;return"".concat(t||"").concat(r)},vu=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!vt(t)&&!yu(t))return n;var h;if(nu(t)){var d=t.indexOf("%");h=r*parseFloat(t.slice(0,d))/100}else h=+t;return xg(h)&&(h=n),o&&h>r&&(h=r),h},Nl=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},XU=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},o=0;o<r;o++)if(!n[t[o]])n[t[o]]=!0;else return!0;return!1},jh=function(t,r){return vt(t)&&vt(r)?function(n){return t+n*(r-t)}:function(){return r}};function Bw(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Ha(n,t))===r})}var YU=function(t,r){return vt(t)&&vt(r)?t-r:yu(t)&&yu(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function hd(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function Fw(e){"@babel/helpers - typeof";return Fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fw(e)}var JU=["viewBox","children"],QU=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],IA=["points","pathLength"],s1={svg:JU,polygon:IA,polyline:IA},TP=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],cv=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(be.isValidElement(t)&&(n=t.props),!Kd(n))return null;var o={};return Object.keys(n).forEach(function(h){TP.includes(h)&&(o[h]=r||function(d){return n[h](n,d)})}),o},e7=function(t,r,n){return function(o){return t(r,n,o),null}},uv=function(t,r,n){if(!Kd(t)||Fw(t)!=="object")return null;var o=null;return Object.keys(t).forEach(function(h){var d=t[h];TP.includes(h)&&typeof d=="function"&&(o||(o={}),o[h]=e7(d,r,n))}),o},t7=["children"],r7=["children"];function jA(e,t){if(e==null)return{};var r=n7(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function n7(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var OA={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},$s=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},DA=null,l1=null,kP=function e(t){if(t===DA&&Array.isArray(l1))return l1;var r=[];return be.Children.forEach(t,function(n){Sr(n)||(LU.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),l1=r,DA=t,r};function Po(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(o){return $s(o)}):n=[$s(t)],kP(e).forEach(function(o){var h=Ha(o,"type.displayName")||Ha(o,"type.name");n.indexOf(h)!==-1&&r.push(o)}),r}function Pa(e,t){var r=Po(e,t);return r&&r[0]}var RA=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,o=r.height;return!(!vt(n)||n<=0||!vt(o)||o<=0)},i7=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],a7=function(t){return t&&t.type&&yu(t.type)&&i7.indexOf(t.type)>=0},o7=function(t,r,n,o){var h,d=(h=s1==null?void 0:s1[o])!==null&&h!==void 0?h:[];return r.startsWith("data-")||!ar(t)&&(o&&d.includes(r)||QU.includes(r))||n&&TP.includes(r)},br=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var o=t;if(be.isValidElement(t)&&(o=t.props),!Kd(o))return null;var h={};return Object.keys(o).forEach(function(d){var s;o7((s=o)===null||s===void 0?void 0:s[d],d,r,n)&&(h[d]=o[d])}),h},Uw=function e(t,r){if(t===r)return!0;var n=be.Children.count(t);if(n!==be.Children.count(r))return!1;if(n===0)return!0;if(n===1)return NA(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var o=0;o<n;o++){var h=t[o],d=r[o];if(Array.isArray(h)||Array.isArray(d)){if(!e(h,d))return!1}else if(!NA(h,d))return!1}return!0},NA=function(t,r){if(Sr(t)&&Sr(r))return!0;if(!Sr(t)&&!Sr(r)){var n=t.props||{},o=n.children,h=jA(n,t7),d=r.props||{},s=d.children,y=jA(d,r7);return o&&s?hd(h,y)&&Uw(o,s):!o&&!s?hd(h,y):!1}return!1},$A=function(t,r){var n=[],o={};return kP(t).forEach(function(h,d){if(a7(h))n.push(h);else if(h){var s=$s(h.type),y=r[s]||{},w=y.handler,k=y.once;if(w&&(!k||!o[s])){var E=w(h,s,d);n.push(E),o[s]=!0}}}),n},s7=function(t){var r=t&&t.type;return r&&OA[r]?OA[r]:null},l7=function(t,r){return kP(r).indexOf(t)},c7=["children","width","height","viewBox","className","style","title","desc"];function Vw(){return Vw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vw.apply(this,arguments)}function u7(e,t){if(e==null)return{};var r=h7(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function h7(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Gw(e){var t=e.children,r=e.width,n=e.height,o=e.viewBox,h=e.className,d=e.style,s=e.title,y=e.desc,w=u7(e,c7),k=o||{width:r,height:n,x:0,y:0},E=wr("recharts-surface",h);return Ie.createElement("svg",Vw({},br(w,!0,"svg"),{className:E,width:r,height:n,style:d,viewBox:"".concat(k.x," ").concat(k.y," ").concat(k.width," ").concat(k.height)}),Ie.createElement("title",null,s),Ie.createElement("desc",null,y),t)}var d7=["children","className"];function qw(){return qw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qw.apply(this,arguments)}function f7(e,t){if(e==null)return{};var r=p7(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function p7(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var ai=Ie.forwardRef(function(e,t){var r=e.children,n=e.className,o=f7(e,d7),h=wr("recharts-layer",n);return Ie.createElement("g",qw({className:h},br(o,!0),{ref:t}),r)}),zs=function(t,r){for(var n=arguments.length,o=new Array(n>2?n-2:0),h=2;h<n;h++)o[h-2]=arguments[h]};function m7(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),r=r>o?o:r,r<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var h=Array(o);++n<o;)h[n]=e[n+t];return h}var g7=m7,y7=g7;function v7(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:y7(e,t,r)}var _7=v7,x7="\\ud800-\\udfff",b7="\\u0300-\\u036f",w7="\\ufe20-\\ufe2f",S7="\\u20d0-\\u20ff",P7=b7+w7+S7,T7="\\ufe0e\\ufe0f",k7="\\u200d",E7=RegExp("["+k7+x7+P7+T7+"]");function A7(e){return E7.test(e)}var SR=A7;function C7(e){return e.split("")}var M7=C7,PR="\\ud800-\\udfff",I7="\\u0300-\\u036f",j7="\\ufe20-\\ufe2f",O7="\\u20d0-\\u20ff",D7=I7+j7+O7,R7="\\ufe0e\\ufe0f",N7="["+PR+"]",Ww="["+D7+"]",Hw="\\ud83c[\\udffb-\\udfff]",$7="(?:"+Ww+"|"+Hw+")",TR="[^"+PR+"]",kR="(?:\\ud83c[\\udde6-\\uddff]){2}",ER="[\\ud800-\\udbff][\\udc00-\\udfff]",z7="\\u200d",AR=$7+"?",CR="["+R7+"]?",L7="(?:"+z7+"(?:"+[TR,kR,ER].join("|")+")"+CR+AR+")*",B7=CR+AR+L7,F7="(?:"+[TR+Ww+"?",Ww,kR,ER,N7].join("|")+")",U7=RegExp(Hw+"(?="+Hw+")|"+F7+B7,"g");function V7(e){return e.match(U7)||[]}var G7=V7,q7=M7,W7=SR,H7=G7;function Z7(e){return W7(e)?H7(e):q7(e)}var K7=Z7,X7=_7,Y7=SR,J7=K7,Q7=yR;function e9(e){return function(t){t=Q7(t);var r=Y7(t)?J7(t):void 0,n=r?r[0]:t.charAt(0),o=r?X7(r,1).join(""):t.slice(1);return n[e]()+o}}var t9=e9,r9=t9,n9=r9("toUpperCase"),i9=n9;const B_=Rr(i9);function Br(e){return function(){return e}}const MR=Math.cos,hv=Math.sin,ko=Math.sqrt,dv=Math.PI,F_=2*dv,Zw=Math.PI,Kw=2*Zw,Kc=1e-6,a9=Kw-Kc;function IR(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function o9(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return IR;const r=10**t;return function(n){this._+=n[0];for(let o=1,h=n.length;o<h;++o)this._+=Math.round(arguments[o]*r)/r+n[o]}}class s9{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?IR:o9(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,o){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+o}`}bezierCurveTo(t,r,n,o,h,d){this._append`C${+t},${+r},${+n},${+o},${this._x1=+h},${this._y1=+d}`}arcTo(t,r,n,o,h){if(t=+t,r=+r,n=+n,o=+o,h=+h,h<0)throw new Error(`negative radius: ${h}`);let d=this._x1,s=this._y1,y=n-t,w=o-r,k=d-t,E=s-r,I=k*k+E*E;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(I>Kc)if(!(Math.abs(E*y-w*k)>Kc)||!h)this._append`L${this._x1=t},${this._y1=r}`;else{let j=n-d,z=o-s,L=y*y+w*w,q=j*j+z*z,F=Math.sqrt(L),U=Math.sqrt(I),N=h*Math.tan((Zw-Math.acos((L+I-q)/(2*F*U)))/2),W=N/U,H=N/F;Math.abs(W-1)>Kc&&this._append`L${t+W*k},${r+W*E}`,this._append`A${h},${h},0,0,${+(E*j>k*z)},${this._x1=t+H*y},${this._y1=r+H*w}`}}arc(t,r,n,o,h,d){if(t=+t,r=+r,n=+n,d=!!d,n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(o),y=n*Math.sin(o),w=t+s,k=r+y,E=1^d,I=d?o-h:h-o;this._x1===null?this._append`M${w},${k}`:(Math.abs(this._x1-w)>Kc||Math.abs(this._y1-k)>Kc)&&this._append`L${w},${k}`,n&&(I<0&&(I=I%Kw+Kw),I>a9?this._append`A${n},${n},0,1,${E},${t-s},${r-y}A${n},${n},0,1,${E},${this._x1=w},${this._y1=k}`:I>Kc&&this._append`A${n},${n},0,${+(I>=Zw)},${E},${this._x1=t+n*Math.cos(h)},${this._y1=r+n*Math.sin(h)}`)}rect(t,r,n,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+o}h${-n}Z`}toString(){return this._}}function EP(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new s9(t)}function AP(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function jR(e){this._context=e}jR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function U_(e){return new jR(e)}function OR(e){return e[0]}function DR(e){return e[1]}function RR(e,t){var r=Br(!0),n=null,o=U_,h=null,d=EP(s);e=typeof e=="function"?e:e===void 0?OR:Br(e),t=typeof t=="function"?t:t===void 0?DR:Br(t);function s(y){var w,k=(y=AP(y)).length,E,I=!1,j;for(n==null&&(h=o(j=d())),w=0;w<=k;++w)!(w<k&&r(E=y[w],w,y))===I&&((I=!I)?h.lineStart():h.lineEnd()),I&&h.point(+e(E,w,y),+t(E,w,y));if(j)return h=null,j+""||null}return s.x=function(y){return arguments.length?(e=typeof y=="function"?y:Br(+y),s):e},s.y=function(y){return arguments.length?(t=typeof y=="function"?y:Br(+y),s):t},s.defined=function(y){return arguments.length?(r=typeof y=="function"?y:Br(!!y),s):r},s.curve=function(y){return arguments.length?(o=y,n!=null&&(h=o(n)),s):o},s.context=function(y){return arguments.length?(y==null?n=h=null:h=o(n=y),s):n},s}function s0(e,t,r){var n=null,o=Br(!0),h=null,d=U_,s=null,y=EP(w);e=typeof e=="function"?e:e===void 0?OR:Br(+e),t=typeof t=="function"?t:Br(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?DR:Br(+r);function w(E){var I,j,z,L=(E=AP(E)).length,q,F=!1,U,N=new Array(L),W=new Array(L);for(h==null&&(s=d(U=y())),I=0;I<=L;++I){if(!(I<L&&o(q=E[I],I,E))===F)if(F=!F)j=I,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),z=I-1;z>=j;--z)s.point(N[z],W[z]);s.lineEnd(),s.areaEnd()}F&&(N[I]=+e(q,I,E),W[I]=+t(q,I,E),s.point(n?+n(q,I,E):N[I],r?+r(q,I,E):W[I]))}if(U)return s=null,U+""||null}function k(){return RR().defined(o).curve(d).context(h)}return w.x=function(E){return arguments.length?(e=typeof E=="function"?E:Br(+E),n=null,w):e},w.x0=function(E){return arguments.length?(e=typeof E=="function"?E:Br(+E),w):e},w.x1=function(E){return arguments.length?(n=E==null?null:typeof E=="function"?E:Br(+E),w):n},w.y=function(E){return arguments.length?(t=typeof E=="function"?E:Br(+E),r=null,w):t},w.y0=function(E){return arguments.length?(t=typeof E=="function"?E:Br(+E),w):t},w.y1=function(E){return arguments.length?(r=E==null?null:typeof E=="function"?E:Br(+E),w):r},w.lineX0=w.lineY0=function(){return k().x(e).y(t)},w.lineY1=function(){return k().x(e).y(r)},w.lineX1=function(){return k().x(n).y(t)},w.defined=function(E){return arguments.length?(o=typeof E=="function"?E:Br(!!E),w):o},w.curve=function(E){return arguments.length?(d=E,h!=null&&(s=d(h)),w):d},w.context=function(E){return arguments.length?(E==null?h=s=null:s=d(h=E),w):h},w}class NR{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function l9(e){return new NR(e,!0)}function c9(e){return new NR(e,!1)}const CP={draw(e,t){const r=ko(t/dv);e.moveTo(r,0),e.arc(0,0,r,0,F_)}},u9={draw(e,t){const r=ko(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},$R=ko(1/3),h9=$R*2,d9={draw(e,t){const r=ko(t/h9),n=r*$R;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},f9={draw(e,t){const r=ko(t),n=-r/2;e.rect(n,n,r,r)}},p9=.8908130915292852,zR=hv(dv/10)/hv(7*dv/10),m9=hv(F_/10)*zR,g9=-MR(F_/10)*zR,y9={draw(e,t){const r=ko(t*p9),n=m9*r,o=g9*r;e.moveTo(0,-r),e.lineTo(n,o);for(let h=1;h<5;++h){const d=F_*h/5,s=MR(d),y=hv(d);e.lineTo(y*r,-s*r),e.lineTo(s*n-y*o,y*n+s*o)}e.closePath()}},c1=ko(3),v9={draw(e,t){const r=-ko(t/(c1*3));e.moveTo(0,r*2),e.lineTo(-c1*r,-r),e.lineTo(c1*r,-r),e.closePath()}},La=-.5,Ba=ko(3)/2,Xw=1/ko(12),_9=(Xw/2+1)*3,x9={draw(e,t){const r=ko(t/_9),n=r/2,o=r*Xw,h=n,d=r*Xw+r,s=-h,y=d;e.moveTo(n,o),e.lineTo(h,d),e.lineTo(s,y),e.lineTo(La*n-Ba*o,Ba*n+La*o),e.lineTo(La*h-Ba*d,Ba*h+La*d),e.lineTo(La*s-Ba*y,Ba*s+La*y),e.lineTo(La*n+Ba*o,La*o-Ba*n),e.lineTo(La*h+Ba*d,La*d-Ba*h),e.lineTo(La*s+Ba*y,La*y-Ba*s),e.closePath()}};function b9(e,t){let r=null,n=EP(o);e=typeof e=="function"?e:Br(e||CP),t=typeof t=="function"?t:Br(t===void 0?64:+t);function o(){let h;if(r||(r=h=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),h)return r=null,h+""||null}return o.type=function(h){return arguments.length?(e=typeof h=="function"?h:Br(h),o):e},o.size=function(h){return arguments.length?(t=typeof h=="function"?h:Br(+h),o):t},o.context=function(h){return arguments.length?(r=h??null,o):r},o}function fv(){}function pv(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function LR(e){this._context=e}LR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:pv(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:pv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function w9(e){return new LR(e)}function BR(e){this._context=e}BR.prototype={areaStart:fv,areaEnd:fv,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:pv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function S9(e){return new BR(e)}function FR(e){this._context=e}FR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:pv(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function P9(e){return new FR(e)}function UR(e){this._context=e}UR.prototype={areaStart:fv,areaEnd:fv,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function T9(e){return new UR(e)}function zA(e){return e<0?-1:1}function LA(e,t,r){var n=e._x1-e._x0,o=t-e._x1,h=(e._y1-e._y0)/(n||o<0&&-0),d=(r-e._y1)/(o||n<0&&-0),s=(h*o+d*n)/(n+o);return(zA(h)+zA(d))*Math.min(Math.abs(h),Math.abs(d),.5*Math.abs(s))||0}function BA(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function u1(e,t,r){var n=e._x0,o=e._y0,h=e._x1,d=e._y1,s=(h-n)/3;e._context.bezierCurveTo(n+s,o+s*t,h-s,d-s*r,h,d)}function mv(e){this._context=e}mv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:u1(this,this._t0,BA(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,u1(this,BA(this,r=LA(this,e,t)),r);break;default:u1(this,this._t0,r=LA(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function VR(e){this._context=new GR(e)}(VR.prototype=Object.create(mv.prototype)).point=function(e,t){mv.prototype.point.call(this,t,e)};function GR(e){this._context=e}GR.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,o,h){this._context.bezierCurveTo(t,e,n,r,h,o)}};function k9(e){return new mv(e)}function E9(e){return new VR(e)}function qR(e){this._context=e}qR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=FA(e),o=FA(t),h=0,d=1;d<r;++h,++d)this._context.bezierCurveTo(n[0][h],o[0][h],n[1][h],o[1][h],e[d],t[d]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function FA(e){var t,r=e.length-1,n,o=new Array(r),h=new Array(r),d=new Array(r);for(o[0]=0,h[0]=2,d[0]=e[0]+2*e[1],t=1;t<r-1;++t)o[t]=1,h[t]=4,d[t]=4*e[t]+2*e[t+1];for(o[r-1]=2,h[r-1]=7,d[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=o[t]/h[t-1],h[t]-=n,d[t]-=n*d[t-1];for(o[r-1]=d[r-1]/h[r-1],t=r-2;t>=0;--t)o[t]=(d[t]-o[t+1])/h[t];for(h[r-1]=(e[r]+o[r-1])/2,t=0;t<r-1;++t)h[t]=2*e[t+1]-o[t+1];return[o,h]}function A9(e){return new qR(e)}function V_(e,t){this._context=e,this._t=t}V_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function C9(e){return new V_(e,.5)}function M9(e){return new V_(e,0)}function I9(e){return new V_(e,1)}function Sd(e,t){if((d=e.length)>1)for(var r=1,n,o,h=e[t[0]],d,s=h.length;r<d;++r)for(o=h,h=e[t[r]],n=0;n<s;++n)h[n][1]+=h[n][0]=isNaN(o[n][1])?o[n][0]:o[n][1]}function Yw(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function j9(e,t){return e[t]}function O9(e){const t=[];return t.key=e,t}function D9(){var e=Br([]),t=Yw,r=Sd,n=j9;function o(h){var d=Array.from(e.apply(this,arguments),O9),s,y=d.length,w=-1,k;for(const E of h)for(s=0,++w;s<y;++s)(d[s][w]=[0,+n(E,d[s].key,w,h)]).data=E;for(s=0,k=AP(t(d));s<y;++s)d[k[s]].index=s;return r(d,k),d}return o.keys=function(h){return arguments.length?(e=typeof h=="function"?h:Br(Array.from(h)),o):e},o.value=function(h){return arguments.length?(n=typeof h=="function"?h:Br(+h),o):n},o.order=function(h){return arguments.length?(t=h==null?Yw:typeof h=="function"?h:Br(Array.from(h)),o):t},o.offset=function(h){return arguments.length?(r=h??Sd,o):r},o}function R9(e,t){if((n=e.length)>0){for(var r,n,o=0,h=e[0].length,d;o<h;++o){for(d=r=0;r<n;++r)d+=e[r][o][1]||0;if(d)for(r=0;r<n;++r)e[r][o][1]/=d}Sd(e,t)}}function N9(e,t){if((o=e.length)>0){for(var r=0,n=e[t[0]],o,h=n.length;r<h;++r){for(var d=0,s=0;d<o;++d)s+=e[d][r][1]||0;n[r][1]+=n[r][0]=-s/2}Sd(e,t)}}function $9(e,t){if(!(!((d=e.length)>0)||!((h=(o=e[t[0]]).length)>0))){for(var r=0,n=1,o,h,d;n<h;++n){for(var s=0,y=0,w=0;s<d;++s){for(var k=e[t[s]],E=k[n][1]||0,I=k[n-1][1]||0,j=(E-I)/2,z=0;z<s;++z){var L=e[t[z]],q=L[n][1]||0,F=L[n-1][1]||0;j+=q-F}y+=E,w+=j*E}o[n-1][1]+=o[n-1][0]=r,y&&(r-=w/y)}o[n-1][1]+=o[n-1][0]=r,Sd(e,t)}}function Im(e){"@babel/helpers - typeof";return Im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Im(e)}var z9=["type","size","sizeType"];function Jw(){return Jw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jw.apply(this,arguments)}function UA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function VA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UA(Object(r),!0).forEach(function(n){L9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L9(e,t,r){return t=B9(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B9(e){var t=F9(e,"string");return Im(t)=="symbol"?t:t+""}function F9(e,t){if(Im(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Im(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U9(e,t){if(e==null)return{};var r=V9(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function V9(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var WR={symbolCircle:CP,symbolCross:u9,symbolDiamond:d9,symbolSquare:f9,symbolStar:y9,symbolTriangle:v9,symbolWye:x9},G9=Math.PI/180,q9=function(t){var r="symbol".concat(B_(t));return WR[r]||CP},W9=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var o=18*G9;return 1.25*t*t*(Math.tan(o)-Math.tan(o*2)*Math.pow(Math.tan(o),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},H9=function(t,r){WR["symbol".concat(B_(t))]=r},MP=function(t){var r=t.type,n=r===void 0?"circle":r,o=t.size,h=o===void 0?64:o,d=t.sizeType,s=d===void 0?"area":d,y=U9(t,z9),w=VA(VA({},y),{},{type:n,size:h,sizeType:s}),k=function(){var q=q9(n),F=b9().type(q).size(W9(h,s,n));return F()},E=w.className,I=w.cx,j=w.cy,z=br(w,!0);return I===+I&&j===+j&&h===+h?Ie.createElement("path",Jw({},z,{className:wr("recharts-symbols",E),transform:"translate(".concat(I,", ").concat(j,")"),d:k()})):null};MP.registerSymbol=H9;function Pd(e){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pd(e)}function Qw(){return Qw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qw.apply(this,arguments)}function GA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Z9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GA(Object(r),!0).forEach(function(n){jm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function K9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qA(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZR(n.key),n)}}function X9(e,t,r){return t&&qA(e.prototype,t),r&&qA(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y9(e,t,r){return t=gv(t),J9(e,HR()?Reflect.construct(t,r||[],gv(e).constructor):t.apply(e,r))}function J9(e,t){if(t&&(Pd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q9(e)}function Q9(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HR(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HR=function(){return!!e})()}function gv(e){return gv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gv(e)}function eV(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e2(e,t)}function e2(e,t){return e2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},e2(e,t)}function jm(e,t,r){return t=ZR(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZR(e){var t=tV(e,"string");return Pd(t)=="symbol"?t:t+""}function tV(e,t){if(Pd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fa=32,IP=function(e){function t(){return K9(this,t),Y9(this,t,arguments)}return eV(t,e),X9(t,[{key:"renderIcon",value:function(n){var o=this.props.inactiveColor,h=Fa/2,d=Fa/6,s=Fa/3,y=n.inactive?o:n.color;if(n.type==="plainline")return Ie.createElement("line",{strokeWidth:4,fill:"none",stroke:y,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:h,x2:Fa,y2:h,className:"recharts-legend-icon"});if(n.type==="line")return Ie.createElement("path",{strokeWidth:4,fill:"none",stroke:y,d:"M0,".concat(h,"h").concat(s,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(2*s,",").concat(h,`
            H`).concat(Fa,"M").concat(2*s,",").concat(h,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(s,",").concat(h),className:"recharts-legend-icon"});if(n.type==="rect")return Ie.createElement("path",{stroke:"none",fill:y,d:"M0,".concat(Fa/8,"h").concat(Fa,"v").concat(Fa*3/4,"h").concat(-Fa,"z"),className:"recharts-legend-icon"});if(Ie.isValidElement(n.legendIcon)){var w=Z9({},n);return delete w.legendIcon,Ie.cloneElement(n.legendIcon,w)}return Ie.createElement(MP,{fill:y,cx:h,cy:h,size:Fa,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,o=this.props,h=o.payload,d=o.iconSize,s=o.layout,y=o.formatter,w=o.inactiveColor,k={x:0,y:0,width:Fa,height:Fa},E={display:s==="horizontal"?"inline-block":"block",marginRight:10},I={display:"inline-block",verticalAlign:"middle",marginRight:4};return h.map(function(j,z){var L=j.formatter||y,q=wr(jm(jm({"recharts-legend-item":!0},"legend-item-".concat(z),!0),"inactive",j.inactive));if(j.type==="none")return null;var F=ar(j.value)?null:j.value;zs(!ar(j.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var U=j.inactive?w:j.color;return Ie.createElement("li",Qw({className:q,style:E,key:"legend-item-".concat(z)},uv(n.props,j,z)),Ie.createElement(Gw,{width:d,height:d,viewBox:k,style:I},n.renderIcon(j)),Ie.createElement("span",{className:"recharts-legend-item-text",style:{color:U}},L?L(F,j,z):F))})}},{key:"render",value:function(){var n=this.props,o=n.payload,h=n.layout,d=n.align;if(!o||!o.length)return null;var s={padding:0,margin:0,textAlign:h==="horizontal"?d:"left"};return Ie.createElement("ul",{className:"recharts-default-legend",style:s},this.renderItems())}}])}(be.PureComponent);jm(IP,"displayName","Legend");jm(IP,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var rV=k_;function nV(){this.__data__=new rV,this.size=0}var iV=nV;function aV(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var oV=aV;function sV(e){return this.__data__.get(e)}var lV=sV;function cV(e){return this.__data__.has(e)}var uV=cV,hV=k_,dV=vP,fV=_P,pV=200;function mV(e,t){var r=this.__data__;if(r instanceof hV){var n=r.__data__;if(!dV||n.length<pV-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new fV(n)}return r.set(e,t),this.size=r.size,this}var gV=mV,yV=k_,vV=iV,_V=oV,xV=lV,bV=uV,wV=gV;function Qd(e){var t=this.__data__=new yV(e);this.size=t.size}Qd.prototype.clear=vV;Qd.prototype.delete=_V;Qd.prototype.get=xV;Qd.prototype.has=bV;Qd.prototype.set=wV;var KR=Qd,SV="__lodash_hash_undefined__";function PV(e){return this.__data__.set(e,SV),this}var TV=PV;function kV(e){return this.__data__.has(e)}var EV=kV,AV=_P,CV=TV,MV=EV;function yv(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new AV;++t<r;)this.add(e[t])}yv.prototype.add=yv.prototype.push=CV;yv.prototype.has=MV;var XR=yv;function IV(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var YR=IV;function jV(e,t){return e.has(t)}var JR=jV,OV=XR,DV=YR,RV=JR,NV=1,$V=2;function zV(e,t,r,n,o,h){var d=r&NV,s=e.length,y=t.length;if(s!=y&&!(d&&y>s))return!1;var w=h.get(e),k=h.get(t);if(w&&k)return w==t&&k==e;var E=-1,I=!0,j=r&$V?new OV:void 0;for(h.set(e,t),h.set(t,e);++E<s;){var z=e[E],L=t[E];if(n)var q=d?n(L,z,E,t,e,h):n(z,L,E,e,t,h);if(q!==void 0){if(q)continue;I=!1;break}if(j){if(!DV(t,function(F,U){if(!RV(j,U)&&(z===F||o(z,F,r,n,h)))return j.push(U)})){I=!1;break}}else if(!(z===L||o(z,L,r,n,h))){I=!1;break}}return h.delete(e),h.delete(t),I}var QR=zV,LV=ts,BV=LV.Uint8Array,FV=BV;function UV(e){var t=-1,r=Array(e.size);return e.forEach(function(n,o){r[++t]=[o,n]}),r}var VV=UV;function GV(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var jP=GV,WA=_g,HA=FV,qV=yP,WV=QR,HV=VV,ZV=jP,KV=1,XV=2,YV="[object Boolean]",JV="[object Date]",QV="[object Error]",eG="[object Map]",tG="[object Number]",rG="[object RegExp]",nG="[object Set]",iG="[object String]",aG="[object Symbol]",oG="[object ArrayBuffer]",sG="[object DataView]",ZA=WA?WA.prototype:void 0,h1=ZA?ZA.valueOf:void 0;function lG(e,t,r,n,o,h,d){switch(r){case sG:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case oG:return!(e.byteLength!=t.byteLength||!h(new HA(e),new HA(t)));case YV:case JV:case tG:return qV(+e,+t);case QV:return e.name==t.name&&e.message==t.message;case rG:case iG:return e==t+"";case eG:var s=HV;case nG:var y=n&KV;if(s||(s=ZV),e.size!=t.size&&!y)return!1;var w=d.get(e);if(w)return w==t;n|=XV,d.set(e,t);var k=WV(s(e),s(t),n,o,h,d);return d.delete(e),k;case aG:if(h1)return h1.call(e)==h1.call(t)}return!1}var cG=lG;function uG(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var eN=uG,hG=eN,dG=ia;function fG(e,t,r){var n=t(e);return dG(e)?n:hG(n,r(e))}var pG=fG;function mG(e,t){for(var r=-1,n=e==null?0:e.length,o=0,h=[];++r<n;){var d=e[r];t(d,r,e)&&(h[o++]=d)}return h}var gG=mG;function yG(){return[]}var vG=yG,_G=gG,xG=vG,bG=Object.prototype,wG=bG.propertyIsEnumerable,KA=Object.getOwnPropertySymbols,SG=KA?function(e){return e==null?[]:(e=Object(e),_G(KA(e),function(t){return wG.call(e,t)}))}:xG,PG=SG;function TG(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var kG=TG,EG=Ks,AG=Xs,CG="[object Arguments]";function MG(e){return AG(e)&&EG(e)==CG}var IG=MG,XA=IG,jG=Xs,tN=Object.prototype,OG=tN.hasOwnProperty,DG=tN.propertyIsEnumerable,RG=XA(function(){return arguments}())?XA:function(e){return jG(e)&&OG.call(e,"callee")&&!DG.call(e,"callee")},OP=RG,vv={exports:{}};function NG(){return!1}var $G=NG;vv.exports;(function(e,t){var r=ts,n=$G,o=t&&!t.nodeType&&t,h=o&&!0&&e&&!e.nodeType&&e,d=h&&h.exports===o,s=d?r.Buffer:void 0,y=s?s.isBuffer:void 0,w=y||n;e.exports=w})(vv,vv.exports);var rN=vv.exports,zG=9007199254740991,LG=/^(?:0|[1-9]\d*)$/;function BG(e,t){var r=typeof e;return t=t??zG,!!t&&(r=="number"||r!="symbol"&&LG.test(e))&&e>-1&&e%1==0&&e<t}var DP=BG,FG=9007199254740991;function UG(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=FG}var RP=UG,VG=Ks,GG=RP,qG=Xs,WG="[object Arguments]",HG="[object Array]",ZG="[object Boolean]",KG="[object Date]",XG="[object Error]",YG="[object Function]",JG="[object Map]",QG="[object Number]",eq="[object Object]",tq="[object RegExp]",rq="[object Set]",nq="[object String]",iq="[object WeakMap]",aq="[object ArrayBuffer]",oq="[object DataView]",sq="[object Float32Array]",lq="[object Float64Array]",cq="[object Int8Array]",uq="[object Int16Array]",hq="[object Int32Array]",dq="[object Uint8Array]",fq="[object Uint8ClampedArray]",pq="[object Uint16Array]",mq="[object Uint32Array]",Hr={};Hr[sq]=Hr[lq]=Hr[cq]=Hr[uq]=Hr[hq]=Hr[dq]=Hr[fq]=Hr[pq]=Hr[mq]=!0;Hr[WG]=Hr[HG]=Hr[aq]=Hr[ZG]=Hr[oq]=Hr[KG]=Hr[XG]=Hr[YG]=Hr[JG]=Hr[QG]=Hr[eq]=Hr[tq]=Hr[rq]=Hr[nq]=Hr[iq]=!1;function gq(e){return qG(e)&&GG(e.length)&&!!Hr[VG(e)]}var yq=gq;function vq(e){return function(t){return e(t)}}var nN=vq,_v={exports:{}};_v.exports;(function(e,t){var r=hR,n=t&&!t.nodeType&&t,o=n&&!0&&e&&!e.nodeType&&e,h=o&&o.exports===n,d=h&&r.process,s=function(){try{var y=o&&o.require&&o.require("util").types;return y||d&&d.binding&&d.binding("util")}catch{}}();e.exports=s})(_v,_v.exports);var _q=_v.exports,xq=yq,bq=nN,YA=_q,JA=YA&&YA.isTypedArray,wq=JA?bq(JA):xq,iN=wq,Sq=kG,Pq=OP,Tq=ia,kq=rN,Eq=DP,Aq=iN,Cq=Object.prototype,Mq=Cq.hasOwnProperty;function Iq(e,t){var r=Tq(e),n=!r&&Pq(e),o=!r&&!n&&kq(e),h=!r&&!n&&!o&&Aq(e),d=r||n||o||h,s=d?Sq(e.length,String):[],y=s.length;for(var w in e)(t||Mq.call(e,w))&&!(d&&(w=="length"||o&&(w=="offset"||w=="parent")||h&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||Eq(w,y)))&&s.push(w);return s}var jq=Iq,Oq=Object.prototype;function Dq(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Oq;return e===r}var Rq=Dq;function Nq(e,t){return function(r){return e(t(r))}}var aN=Nq,$q=aN,zq=$q(Object.keys,Object),Lq=zq,Bq=Rq,Fq=Lq,Uq=Object.prototype,Vq=Uq.hasOwnProperty;function Gq(e){if(!Bq(e))return Fq(e);var t=[];for(var r in Object(e))Vq.call(e,r)&&r!="constructor"&&t.push(r);return t}var qq=Gq,Wq=gP,Hq=RP;function Zq(e){return e!=null&&Hq(e.length)&&!Wq(e)}var bg=Zq,Kq=jq,Xq=qq,Yq=bg;function Jq(e){return Yq(e)?Kq(e):Xq(e)}var G_=Jq,Qq=pG,eW=PG,tW=G_;function rW(e){return Qq(e,tW,eW)}var nW=rW,QA=nW,iW=1,aW=Object.prototype,oW=aW.hasOwnProperty;function sW(e,t,r,n,o,h){var d=r&iW,s=QA(e),y=s.length,w=QA(t),k=w.length;if(y!=k&&!d)return!1;for(var E=y;E--;){var I=s[E];if(!(d?I in t:oW.call(t,I)))return!1}var j=h.get(e),z=h.get(t);if(j&&z)return j==t&&z==e;var L=!0;h.set(e,t),h.set(t,e);for(var q=d;++E<y;){I=s[E];var F=e[I],U=t[I];if(n)var N=d?n(U,F,I,t,e,h):n(F,U,I,e,t,h);if(!(N===void 0?F===U||o(F,U,r,n,h):N)){L=!1;break}q||(q=I=="constructor")}if(L&&!q){var W=e.constructor,H=t.constructor;W!=H&&"constructor"in e&&"constructor"in t&&!(typeof W=="function"&&W instanceof W&&typeof H=="function"&&H instanceof H)&&(L=!1)}return h.delete(e),h.delete(t),L}var lW=sW,cW=Pu,uW=ts,hW=cW(uW,"DataView"),dW=hW,fW=Pu,pW=ts,mW=fW(pW,"Promise"),gW=mW,yW=Pu,vW=ts,_W=yW(vW,"Set"),oN=_W,xW=Pu,bW=ts,wW=xW(bW,"WeakMap"),SW=wW,t2=dW,r2=vP,n2=gW,i2=oN,a2=SW,sN=Ks,ef=fR,eC="[object Map]",PW="[object Object]",tC="[object Promise]",rC="[object Set]",nC="[object WeakMap]",iC="[object DataView]",TW=ef(t2),kW=ef(r2),EW=ef(n2),AW=ef(i2),CW=ef(a2),Xc=sN;(t2&&Xc(new t2(new ArrayBuffer(1)))!=iC||r2&&Xc(new r2)!=eC||n2&&Xc(n2.resolve())!=tC||i2&&Xc(new i2)!=rC||a2&&Xc(new a2)!=nC)&&(Xc=function(e){var t=sN(e),r=t==PW?e.constructor:void 0,n=r?ef(r):"";if(n)switch(n){case TW:return iC;case kW:return eC;case EW:return tC;case AW:return rC;case CW:return nC}return t});var MW=Xc,d1=KR,IW=QR,jW=cG,OW=lW,aC=MW,oC=ia,sC=rN,DW=iN,RW=1,lC="[object Arguments]",cC="[object Array]",l0="[object Object]",NW=Object.prototype,uC=NW.hasOwnProperty;function $W(e,t,r,n,o,h){var d=oC(e),s=oC(t),y=d?cC:aC(e),w=s?cC:aC(t);y=y==lC?l0:y,w=w==lC?l0:w;var k=y==l0,E=w==l0,I=y==w;if(I&&sC(e)){if(!sC(t))return!1;d=!0,k=!1}if(I&&!k)return h||(h=new d1),d||DW(e)?IW(e,t,r,n,o,h):jW(e,t,y,r,n,o,h);if(!(r&RW)){var j=k&&uC.call(e,"__wrapped__"),z=E&&uC.call(t,"__wrapped__");if(j||z){var L=j?e.value():e,q=z?t.value():t;return h||(h=new d1),o(L,q,r,n,h)}}return I?(h||(h=new d1),OW(e,t,r,n,o,h)):!1}var zW=$W,LW=zW,hC=Xs;function lN(e,t,r,n,o){return e===t?!0:e==null||t==null||!hC(e)&&!hC(t)?e!==e&&t!==t:LW(e,t,r,n,lN,o)}var NP=lN,BW=KR,FW=NP,UW=1,VW=2;function GW(e,t,r,n){var o=r.length,h=o,d=!n;if(e==null)return!h;for(e=Object(e);o--;){var s=r[o];if(d&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<h;){s=r[o];var y=s[0],w=e[y],k=s[1];if(d&&s[2]){if(w===void 0&&!(y in e))return!1}else{var E=new BW;if(n)var I=n(w,k,y,e,t,E);if(!(I===void 0?FW(k,w,UW|VW,n,E):I))return!1}}return!0}var qW=GW,WW=nc;function HW(e){return e===e&&!WW(e)}var cN=HW,ZW=cN,KW=G_;function XW(e){for(var t=KW(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,ZW(o)]}return t}var YW=XW;function JW(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var uN=JW,QW=qW,eH=YW,tH=uN;function rH(e){var t=eH(e);return t.length==1&&t[0][2]?tH(t[0][0],t[0][1]):function(r){return r===e||QW(r,e,t)}}var nH=rH;function iH(e,t){return e!=null&&t in Object(e)}var aH=iH,oH=vR,sH=OP,lH=ia,cH=DP,uH=RP,hH=A_;function dH(e,t,r){t=oH(t,e);for(var n=-1,o=t.length,h=!1;++n<o;){var d=hH(t[n]);if(!(h=e!=null&&r(e,d)))break;e=e[d]}return h||++n!=o?h:(o=e==null?0:e.length,!!o&&uH(o)&&cH(d,o)&&(lH(e)||sH(e)))}var fH=dH,pH=aH,mH=fH;function gH(e,t){return e!=null&&mH(e,t,pH)}var yH=gH,vH=NP,_H=_R,xH=yH,bH=mP,wH=cN,SH=uN,PH=A_,TH=1,kH=2;function EH(e,t){return bH(e)&&wH(t)?SH(PH(e),t):function(r){var n=_H(r,e);return n===void 0&&n===t?xH(r,e):vH(t,n,TH|kH)}}var AH=EH;function CH(e){return e}var tf=CH;function MH(e){return function(t){return t==null?void 0:t[e]}}var IH=MH,jH=wP;function OH(e){return function(t){return jH(t,e)}}var DH=OH,RH=IH,NH=DH,$H=mP,zH=A_;function LH(e){return $H(e)?RH(zH(e)):NH(e)}var BH=LH,FH=nH,UH=AH,VH=tf,GH=ia,qH=BH;function WH(e){return typeof e=="function"?e:e==null?VH:typeof e=="object"?GH(e)?UH(e[0],e[1]):FH(e):qH(e)}var ic=WH;function HH(e,t,r,n){for(var o=e.length,h=r+(n?1:-1);n?h--:++h<o;)if(t(e[h],h,e))return h;return-1}var hN=HH;function ZH(e){return e!==e}var KH=ZH;function XH(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}var YH=XH,JH=hN,QH=KH,eZ=YH;function tZ(e,t,r){return t===t?eZ(e,t,r):JH(e,QH,r)}var rZ=tZ,nZ=rZ;function iZ(e,t){var r=e==null?0:e.length;return!!r&&nZ(e,t,0)>-1}var aZ=iZ;function oZ(e,t,r){for(var n=-1,o=e==null?0:e.length;++n<o;)if(r(t,e[n]))return!0;return!1}var sZ=oZ;function lZ(){}var cZ=lZ,f1=oN,uZ=cZ,hZ=jP,dZ=1/0,fZ=f1&&1/hZ(new f1([,-0]))[1]==dZ?function(e){return new f1(e)}:uZ,pZ=fZ,mZ=XR,gZ=aZ,yZ=sZ,vZ=JR,_Z=pZ,xZ=jP,bZ=200;function wZ(e,t,r){var n=-1,o=gZ,h=e.length,d=!0,s=[],y=s;if(r)d=!1,o=yZ;else if(h>=bZ){var w=t?null:_Z(e);if(w)return xZ(w);d=!1,o=vZ,y=new mZ}else y=t?[]:s;e:for(;++n<h;){var k=e[n],E=t?t(k):k;if(k=r||k!==0?k:0,d&&E===E){for(var I=y.length;I--;)if(y[I]===E)continue e;t&&y.push(E),s.push(k)}else o(y,E,r)||(y!==s&&y.push(E),s.push(k))}return s}var SZ=wZ,PZ=ic,TZ=SZ;function kZ(e,t){return e&&e.length?TZ(e,PZ(t)):[]}var EZ=kZ;const dC=Rr(EZ);function dN(e,t,r){return t===!0?dC(e,r):ar(t)?dC(e,t):e}function Td(e){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Td(e)}var AZ=["ref"];function fC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ps(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fC(Object(r),!0).forEach(function(n){q_(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pN(n.key),n)}}function MZ(e,t,r){return t&&pC(e.prototype,t),r&&pC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function IZ(e,t,r){return t=xv(t),jZ(e,fN()?Reflect.construct(t,r||[],xv(e).constructor):t.apply(e,r))}function jZ(e,t){if(t&&(Td(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OZ(e)}function OZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fN=function(){return!!e})()}function xv(e){return xv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xv(e)}function DZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o2(e,t)}function o2(e,t){return o2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},o2(e,t)}function q_(e,t,r){return t=pN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pN(e){var t=RZ(e,"string");return Td(t)=="symbol"?t:t+""}function RZ(e,t){if(Td(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Td(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NZ(e,t){if(e==null)return{};var r=$Z(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $Z(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function zZ(e){return e.value}function LZ(e,t){if(Ie.isValidElement(e))return Ie.cloneElement(e,t);if(typeof e=="function")return Ie.createElement(e,t);t.ref;var r=NZ(t,AZ);return Ie.createElement(IP,r)}var mC=1,dd=function(e){function t(){var r;CZ(this,t);for(var n=arguments.length,o=new Array(n),h=0;h<n;h++)o[h]=arguments[h];return r=IZ(this,t,[].concat(o)),q_(r,"lastBoundingBox",{width:-1,height:-1}),r}return DZ(t,e),MZ(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,o=this.getBBox();o?(Math.abs(o.width-this.lastBoundingBox.width)>mC||Math.abs(o.height-this.lastBoundingBox.height)>mC)&&(this.lastBoundingBox.width=o.width,this.lastBoundingBox.height=o.height,n&&n(o)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Ps({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var o=this.props,h=o.layout,d=o.align,s=o.verticalAlign,y=o.margin,w=o.chartWidth,k=o.chartHeight,E,I;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(d==="center"&&h==="vertical"){var j=this.getBBoxSnapshot();E={left:((w||0)-j.width)/2}}else E=d==="right"?{right:y&&y.right||0}:{left:y&&y.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(s==="middle"){var z=this.getBBoxSnapshot();I={top:((k||0)-z.height)/2}}else I=s==="bottom"?{bottom:y&&y.bottom||0}:{top:y&&y.top||0};return Ps(Ps({},E),I)}},{key:"render",value:function(){var n=this,o=this.props,h=o.content,d=o.width,s=o.height,y=o.wrapperStyle,w=o.payloadUniqBy,k=o.payload,E=Ps(Ps({position:"absolute",width:d||"auto",height:s||"auto"},this.getDefaultPosition(y)),y);return Ie.createElement("div",{className:"recharts-legend-wrapper",style:E,ref:function(j){n.wrapperNode=j}},LZ(h,Ps(Ps({},this.props),{},{payload:dN(k,w,zZ)})))}}],[{key:"getWithHeight",value:function(n,o){var h=Ps(Ps({},this.defaultProps),n.props),d=h.layout;return d==="vertical"&&vt(n.props.height)?{height:n.props.height}:d==="horizontal"?{width:n.props.width||o}:null}}])}(be.PureComponent);q_(dd,"displayName","Legend");q_(dd,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var gC=_g,BZ=OP,FZ=ia,yC=gC?gC.isConcatSpreadable:void 0;function UZ(e){return FZ(e)||BZ(e)||!!(yC&&e&&e[yC])}var VZ=UZ,GZ=eN,qZ=VZ;function mN(e,t,r,n,o){var h=-1,d=e.length;for(r||(r=qZ),o||(o=[]);++h<d;){var s=e[h];t>0&&r(s)?t>1?mN(s,t-1,r,n,o):GZ(o,s):n||(o[o.length]=s)}return o}var gN=mN;function WZ(e){return function(t,r,n){for(var o=-1,h=Object(t),d=n(t),s=d.length;s--;){var y=d[e?s:++o];if(r(h[y],y,h)===!1)break}return t}}var HZ=WZ,ZZ=HZ,KZ=ZZ(),XZ=KZ,YZ=XZ,JZ=G_;function QZ(e,t){return e&&YZ(e,t,JZ)}var yN=QZ,eK=bg;function tK(e,t){return function(r,n){if(r==null)return r;if(!eK(r))return e(r,n);for(var o=r.length,h=t?o:-1,d=Object(r);(t?h--:++h<o)&&n(d[h],h,d)!==!1;);return r}}var rK=tK,nK=yN,iK=rK,aK=iK(nK),$P=aK,oK=$P,sK=bg;function lK(e,t){var r=-1,n=sK(e)?Array(e.length):[];return oK(e,function(o,h,d){n[++r]=t(o,h,d)}),n}var vN=lK;function cK(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var uK=cK,vC=Zd;function hK(e,t){if(e!==t){var r=e!==void 0,n=e===null,o=e===e,h=vC(e),d=t!==void 0,s=t===null,y=t===t,w=vC(t);if(!s&&!w&&!h&&e>t||h&&d&&y&&!s&&!w||n&&d&&y||!r&&y||!o)return 1;if(!n&&!h&&!w&&e<t||w&&r&&o&&!n&&!h||s&&r&&o||!d&&o||!y)return-1}return 0}var dK=hK,fK=dK;function pK(e,t,r){for(var n=-1,o=e.criteria,h=t.criteria,d=o.length,s=r.length;++n<d;){var y=fK(o[n],h[n]);if(y){if(n>=s)return y;var w=r[n];return y*(w=="desc"?-1:1)}}return e.index-t.index}var mK=pK,p1=bP,gK=wP,yK=ic,vK=vN,_K=uK,xK=nN,bK=mK,wK=tf,SK=ia;function PK(e,t,r){t.length?t=p1(t,function(h){return SK(h)?function(d){return gK(d,h.length===1?h[0]:h)}:h}):t=[wK];var n=-1;t=p1(t,xK(yK));var o=vK(e,function(h,d,s){var y=p1(t,function(w){return w(h)});return{criteria:y,index:++n,value:h}});return _K(o,function(h,d){return bK(h,d,r)})}var TK=PK;function kK(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var EK=kK,AK=EK,_C=Math.max;function CK(e,t,r){return t=_C(t===void 0?e.length-1:t,0),function(){for(var n=arguments,o=-1,h=_C(n.length-t,0),d=Array(h);++o<h;)d[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(d),AK(e,this,s)}}var MK=CK;function IK(e){return function(){return e}}var jK=IK,OK=Pu,DK=function(){try{var e=OK(Object,"defineProperty");return e({},"",{}),e}catch{}}(),_N=DK,RK=jK,xC=_N,NK=tf,$K=xC?function(e,t){return xC(e,"toString",{configurable:!0,enumerable:!1,value:RK(t),writable:!0})}:NK,zK=$K,LK=800,BK=16,FK=Date.now;function UK(e){var t=0,r=0;return function(){var n=FK(),o=BK-(n-r);if(r=n,o>0){if(++t>=LK)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var VK=UK,GK=zK,qK=VK,WK=qK(GK),HK=WK,ZK=tf,KK=MK,XK=HK;function YK(e,t){return XK(KK(e,t,ZK),e+"")}var JK=YK,QK=yP,eX=bg,tX=DP,rX=nc;function nX(e,t,r){if(!rX(r))return!1;var n=typeof t;return(n=="number"?eX(r)&&tX(t,r.length):n=="string"&&t in r)?QK(r[t],e):!1}var W_=nX,iX=gN,aX=TK,oX=JK,bC=W_,sX=oX(function(e,t){if(e==null)return[];var r=t.length;return r>1&&bC(e,t[0],t[1])?t=[]:r>2&&bC(t[0],t[1],t[2])&&(t=[t[0]]),aX(e,iX(t,1),[])}),lX=sX;const zP=Rr(lX);function Om(e){"@babel/helpers - typeof";return Om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Om(e)}function s2(){return s2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s2.apply(this,arguments)}function cX(e,t){return fX(e)||dX(e,t)||hX(e,t)||uX()}function uX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hX(e,t){if(e){if(typeof e=="string")return wC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wC(e,t)}}function wC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,h,d,s=[],y=!0,w=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;y=!1}else for(;!(y=(n=h.call(r)).done)&&(s.push(n.value),s.length!==t);y=!0);}catch(k){w=!0,o=k}finally{try{if(!y&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return s}}function fX(e){if(Array.isArray(e))return e}function SC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function m1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SC(Object(r),!0).forEach(function(n){pX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pX(e,t,r){return t=mX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mX(e){var t=gX(e,"string");return Om(t)=="symbol"?t:t+""}function gX(e,t){if(Om(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Om(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yX(e){return Array.isArray(e)&&Zn(e[0])&&Zn(e[1])?e.join(" ~ "):e}var vX=function(t){var r=t.separator,n=r===void 0?" : ":r,o=t.contentStyle,h=o===void 0?{}:o,d=t.itemStyle,s=d===void 0?{}:d,y=t.labelStyle,w=y===void 0?{}:y,k=t.payload,E=t.formatter,I=t.itemSorter,j=t.wrapperClassName,z=t.labelClassName,L=t.label,q=t.labelFormatter,F=t.accessibilityLayer,U=F===void 0?!1:F,N=function(){if(k&&k.length){var Se={padding:0,margin:0},Ue=(I?zP(k,I):k).map(function(We,qe){if(We.type==="none")return null;var Je=m1({display:"block",paddingTop:4,paddingBottom:4,color:We.color||"#000"},s),rt=We.formatter||E||yX,Le=We.value,Be=We.name,nt=Le,Xe=Be;if(rt&&nt!=null&&Xe!=null){var Ge=rt(Le,Be,We,qe,k);if(Array.isArray(Ge)){var it=cX(Ge,2);nt=it[0],Xe=it[1]}else nt=Ge}return Ie.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(qe),style:Je},Zn(Xe)?Ie.createElement("span",{className:"recharts-tooltip-item-name"},Xe):null,Zn(Xe)?Ie.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Ie.createElement("span",{className:"recharts-tooltip-item-value"},nt),Ie.createElement("span",{className:"recharts-tooltip-item-unit"},We.unit||""))});return Ie.createElement("ul",{className:"recharts-tooltip-item-list",style:Se},Ue)}return null},W=m1({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},h),H=m1({margin:0},w),Z=!Sr(L),re=Z?L:"",he=wr("recharts-default-tooltip",j),we=wr("recharts-tooltip-label",z);Z&&q&&k!==void 0&&k!==null&&(re=q(L,k));var Oe=U?{role:"status","aria-live":"assertive"}:{};return Ie.createElement("div",s2({className:he,style:W},Oe),Ie.createElement("p",{className:we,style:H},Ie.isValidElement(re)?re:"".concat(re)),N())};function Dm(e){"@babel/helpers - typeof";return Dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dm(e)}function c0(e,t,r){return t=_X(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _X(e){var t=xX(e,"string");return Dm(t)=="symbol"?t:t+""}function xX(e,t){if(Dm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ip="recharts-tooltip-wrapper",bX={visibility:"hidden"};function wX(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return wr(Ip,c0(c0(c0(c0({},"".concat(Ip,"-right"),vt(r)&&t&&vt(t.x)&&r>=t.x),"".concat(Ip,"-left"),vt(r)&&t&&vt(t.x)&&r<t.x),"".concat(Ip,"-bottom"),vt(n)&&t&&vt(t.y)&&n>=t.y),"".concat(Ip,"-top"),vt(n)&&t&&vt(t.y)&&n<t.y))}function PC(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,o=e.offsetTopLeft,h=e.position,d=e.reverseDirection,s=e.tooltipDimension,y=e.viewBox,w=e.viewBoxDimension;if(h&&vt(h[n]))return h[n];var k=r[n]-s-o,E=r[n]+o;if(t[n])return d[n]?k:E;if(d[n]){var I=k,j=y[n];return I<j?Math.max(E,y[n]):Math.max(k,y[n])}var z=E+s,L=y[n]+w;return z>L?Math.max(k,y[n]):Math.max(E,y[n])}function SX(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function PX(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,o=e.position,h=e.reverseDirection,d=e.tooltipBox,s=e.useTranslate3d,y=e.viewBox,w,k,E;return d.height>0&&d.width>0&&r?(k=PC({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:o,reverseDirection:h,tooltipDimension:d.width,viewBox:y,viewBoxDimension:y.width}),E=PC({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:o,reverseDirection:h,tooltipDimension:d.height,viewBox:y,viewBoxDimension:y.height}),w=SX({translateX:k,translateY:E,useTranslate3d:s})):w=bX,{cssProperties:w,cssClasses:wX({translateX:k,translateY:E,coordinate:r})}}function kd(e){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(e)}function TC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function kC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TC(Object(r),!0).forEach(function(n){c2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bN(n.key),n)}}function kX(e,t,r){return t&&EC(e.prototype,t),r&&EC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EX(e,t,r){return t=bv(t),AX(e,xN()?Reflect.construct(t,r||[],bv(e).constructor):t.apply(e,r))}function AX(e,t){if(t&&(kd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CX(e)}function CX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xN=function(){return!!e})()}function bv(e){return bv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bv(e)}function MX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l2(e,t)}function l2(e,t){return l2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},l2(e,t)}function c2(e,t,r){return t=bN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bN(e){var t=IX(e,"string");return kd(t)=="symbol"?t:t+""}function IX(e,t){if(kd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AC=1,jX=function(e){function t(){var r;TX(this,t);for(var n=arguments.length,o=new Array(n),h=0;h<n;h++)o[h]=arguments[h];return r=EX(this,t,[].concat(o)),c2(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),c2(r,"handleKeyDown",function(d){if(d.key==="Escape"){var s,y,w,k;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(s=(y=r.props.coordinate)===null||y===void 0?void 0:y.x)!==null&&s!==void 0?s:0,y:(w=(k=r.props.coordinate)===null||k===void 0?void 0:k.y)!==null&&w!==void 0?w:0}})}}),r}return MX(t,e),kX(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>AC||Math.abs(n.height-this.state.lastBoundingBox.height)>AC)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,o;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,o=this.props,h=o.active,d=o.allowEscapeViewBox,s=o.animationDuration,y=o.animationEasing,w=o.children,k=o.coordinate,E=o.hasPayload,I=o.isAnimationActive,j=o.offset,z=o.position,L=o.reverseDirection,q=o.useTranslate3d,F=o.viewBox,U=o.wrapperStyle,N=PX({allowEscapeViewBox:d,coordinate:k,offsetTopLeft:j,position:z,reverseDirection:L,tooltipBox:this.state.lastBoundingBox,useTranslate3d:q,viewBox:F}),W=N.cssClasses,H=N.cssProperties,Z=kC(kC({transition:I&&h?"transform ".concat(s,"ms ").concat(y):void 0},H),{},{pointerEvents:"none",visibility:!this.state.dismissed&&h&&E?"visible":"hidden",position:"absolute",top:0,left:0},U);return Ie.createElement("div",{tabIndex:-1,className:W,style:Z,ref:function(he){n.wrapperNode=he}},w)}}])}(be.PureComponent),OX=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Xl={isSsr:OX(),get:function(t){return Xl[t]},set:function(t,r){if(typeof t=="string")Xl[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(o){Xl[o]=t[o]})}}};function Ed(e){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ed(e)}function CC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function MC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CC(Object(r),!0).forEach(function(n){LP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SN(n.key),n)}}function RX(e,t,r){return t&&IC(e.prototype,t),r&&IC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NX(e,t,r){return t=wv(t),$X(e,wN()?Reflect.construct(t,r||[],wv(e).constructor):t.apply(e,r))}function $X(e,t){if(t&&(Ed(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zX(e)}function zX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wN=function(){return!!e})()}function wv(e){return wv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wv(e)}function LX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u2(e,t)}function u2(e,t){return u2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},u2(e,t)}function LP(e,t,r){return t=SN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SN(e){var t=BX(e,"string");return Ed(t)=="symbol"?t:t+""}function BX(e,t){if(Ed(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ed(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FX(e){return e.dataKey}function UX(e,t){return Ie.isValidElement(e)?Ie.cloneElement(e,t):typeof e=="function"?Ie.createElement(e,t):Ie.createElement(vX,t)}var go=function(e){function t(){return DX(this,t),NX(this,t,arguments)}return LX(t,e),RX(t,[{key:"render",value:function(){var n=this,o=this.props,h=o.active,d=o.allowEscapeViewBox,s=o.animationDuration,y=o.animationEasing,w=o.content,k=o.coordinate,E=o.filterNull,I=o.isAnimationActive,j=o.offset,z=o.payload,L=o.payloadUniqBy,q=o.position,F=o.reverseDirection,U=o.useTranslate3d,N=o.viewBox,W=o.wrapperStyle,H=z??[];E&&H.length&&(H=dN(z.filter(function(re){return re.value!=null&&(re.hide!==!0||n.props.includeHidden)}),L,FX));var Z=H.length>0;return Ie.createElement(jX,{allowEscapeViewBox:d,animationDuration:s,animationEasing:y,isAnimationActive:I,active:h,coordinate:k,hasPayload:Z,offset:j,position:q,reverseDirection:F,useTranslate3d:U,viewBox:N,wrapperStyle:W},UX(w,MC(MC({},this.props),{},{payload:H})))}}])}(be.PureComponent);LP(go,"displayName","Tooltip");LP(go,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Xl.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var VX=ts,GX=function(){return VX.Date.now()},qX=GX,WX=/\s/;function HX(e){for(var t=e.length;t--&&WX.test(e.charAt(t)););return t}var ZX=HX,KX=ZX,XX=/^\s+/;function YX(e){return e&&e.slice(0,KX(e)+1).replace(XX,"")}var JX=YX,QX=JX,jC=nc,eY=Zd,OC=0/0,tY=/^[-+]0x[0-9a-f]+$/i,rY=/^0b[01]+$/i,nY=/^0o[0-7]+$/i,iY=parseInt;function aY(e){if(typeof e=="number")return e;if(eY(e))return OC;if(jC(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=jC(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=QX(e);var r=rY.test(e);return r||nY.test(e)?iY(e.slice(2),r?2:8):tY.test(e)?OC:+e}var PN=aY,oY=nc,g1=qX,DC=PN,sY="Expected a function",lY=Math.max,cY=Math.min;function uY(e,t,r){var n,o,h,d,s,y,w=0,k=!1,E=!1,I=!0;if(typeof e!="function")throw new TypeError(sY);t=DC(t)||0,oY(r)&&(k=!!r.leading,E="maxWait"in r,h=E?lY(DC(r.maxWait)||0,t):h,I="trailing"in r?!!r.trailing:I);function j(Z){var re=n,he=o;return n=o=void 0,w=Z,d=e.apply(he,re),d}function z(Z){return w=Z,s=setTimeout(F,t),k?j(Z):d}function L(Z){var re=Z-y,he=Z-w,we=t-re;return E?cY(we,h-he):we}function q(Z){var re=Z-y,he=Z-w;return y===void 0||re>=t||re<0||E&&he>=h}function F(){var Z=g1();if(q(Z))return U(Z);s=setTimeout(F,L(Z))}function U(Z){return s=void 0,I&&n?j(Z):(n=o=void 0,d)}function N(){s!==void 0&&clearTimeout(s),w=0,n=y=o=s=void 0}function W(){return s===void 0?d:U(g1())}function H(){var Z=g1(),re=q(Z);if(n=arguments,o=this,y=Z,re){if(s===void 0)return z(y);if(E)return clearTimeout(s),s=setTimeout(F,t),j(y)}return s===void 0&&(s=setTimeout(F,t)),d}return H.cancel=N,H.flush=W,H}var hY=uY,dY=hY,fY=nc,pY="Expected a function";function mY(e,t,r){var n=!0,o=!0;if(typeof e!="function")throw new TypeError(pY);return fY(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),dY(e,t,{leading:n,maxWait:t,trailing:o})}var gY=mY;const TN=Rr(gY);function Rm(e){"@babel/helpers - typeof";return Rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rm(e)}function RC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function u0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RC(Object(r),!0).forEach(function(n){yY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yY(e,t,r){return t=vY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vY(e){var t=_Y(e,"string");return Rm(t)=="symbol"?t:t+""}function _Y(e,t){if(Rm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xY(e,t){return PY(e)||SY(e,t)||wY(e,t)||bY()}function bY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wY(e,t){if(e){if(typeof e=="string")return NC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NC(e,t)}}function NC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function SY(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,h,d,s=[],y=!0,w=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;y=!1}else for(;!(y=(n=h.call(r)).done)&&(s.push(n.value),s.length!==t);y=!0);}catch(k){w=!0,o=k}finally{try{if(!y&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return s}}function PY(e){if(Array.isArray(e))return e}var kN=be.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,o=n===void 0?{width:-1,height:-1}:n,h=e.width,d=h===void 0?"100%":h,s=e.height,y=s===void 0?"100%":s,w=e.minWidth,k=w===void 0?0:w,E=e.minHeight,I=e.maxHeight,j=e.children,z=e.debounce,L=z===void 0?0:z,q=e.id,F=e.className,U=e.onResize,N=e.style,W=N===void 0?{}:N,H=be.useRef(null),Z=be.useRef();Z.current=U,be.useImperativeHandle(t,function(){return Object.defineProperty(H.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),H.current},configurable:!0})});var re=be.useState({containerWidth:o.width,containerHeight:o.height}),he=xY(re,2),we=he[0],Oe=he[1],Me=be.useCallback(function(Ue,We){Oe(function(qe){var Je=Math.round(Ue),rt=Math.round(We);return qe.containerWidth===Je&&qe.containerHeight===rt?qe:{containerWidth:Je,containerHeight:rt}})},[]);be.useEffect(function(){var Ue=function(Be){var nt,Xe=Be[0].contentRect,Ge=Xe.width,it=Xe.height;Me(Ge,it),(nt=Z.current)===null||nt===void 0||nt.call(Z,Ge,it)};L>0&&(Ue=TN(Ue,L,{trailing:!0,leading:!1}));var We=new ResizeObserver(Ue),qe=H.current.getBoundingClientRect(),Je=qe.width,rt=qe.height;return Me(Je,rt),We.observe(H.current),function(){We.disconnect()}},[Me,L]);var Se=be.useMemo(function(){var Ue=we.containerWidth,We=we.containerHeight;if(Ue<0||We<0)return null;zs(nu(d)||nu(y),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,d,y),zs(!r||r>0,"The aspect(%s) must be greater than zero.",r);var qe=nu(d)?Ue:d,Je=nu(y)?We:y;r&&r>0&&(qe?Je=qe/r:Je&&(qe=Je*r),I&&Je>I&&(Je=I)),zs(qe>0||Je>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,qe,Je,d,y,k,E,r);var rt=!Array.isArray(j)&&$s(j.type).endsWith("Chart");return Ie.Children.map(j,function(Le){return Ie.isValidElement(Le)?be.cloneElement(Le,u0({width:qe,height:Je},rt?{style:u0({height:"100%",width:"100%",maxHeight:Je,maxWidth:qe},Le.props.style)}:{})):Le})},[r,j,y,I,E,k,we,d]);return Ie.createElement("div",{id:q?"".concat(q):void 0,className:wr("recharts-responsive-container",F),style:u0(u0({},W),{},{width:d,height:y,minWidth:k,minHeight:E,maxHeight:I}),ref:H},Se)}),EN=function(t){return null};EN.displayName="Cell";function Nm(e){"@babel/helpers - typeof";return Nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nm(e)}function $C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function h2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$C(Object(r),!0).forEach(function(n){TY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$C(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TY(e,t,r){return t=kY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kY(e){var t=EY(e,"string");return Nm(t)=="symbol"?t:t+""}function EY(e,t){if(Nm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oh={widthCache:{},cacheCount:0},AY=2e3,CY={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},zC="recharts_measurement_span";function MY(e){var t=h2({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var im=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Xl.isSsr)return{width:0,height:0};var n=MY(r),o=JSON.stringify({text:t,copyStyle:n});if(Oh.widthCache[o])return Oh.widthCache[o];try{var h=document.getElementById(zC);h||(h=document.createElement("span"),h.setAttribute("id",zC),h.setAttribute("aria-hidden","true"),document.body.appendChild(h));var d=h2(h2({},CY),n);Object.assign(h.style,d),h.textContent="".concat(t);var s=h.getBoundingClientRect(),y={width:s.width,height:s.height};return Oh.widthCache[o]=y,++Oh.cacheCount>AY&&(Oh.cacheCount=0,Oh.widthCache={}),y}catch{return{width:0,height:0}}},IY=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function $m(e){"@babel/helpers - typeof";return $m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$m(e)}function Sv(e,t){return RY(e)||DY(e,t)||OY(e,t)||jY()}function jY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OY(e,t){if(e){if(typeof e=="string")return LC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LC(e,t)}}function LC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function DY(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,h,d,s=[],y=!0,w=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;y=!1}else for(;!(y=(n=h.call(r)).done)&&(s.push(n.value),s.length!==t);y=!0);}catch(k){w=!0,o=k}finally{try{if(!y&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return s}}function RY(e){if(Array.isArray(e))return e}function NY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BC(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zY(n.key),n)}}function $Y(e,t,r){return t&&BC(e.prototype,t),r&&BC(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zY(e){var t=LY(e,"string");return $m(t)=="symbol"?t:t+""}function LY(e,t){if($m(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($m(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FC=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,UC=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,BY=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,FY=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,AN={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},UY=Object.keys(AN),rd="NaN";function VY(e,t){return e*AN[t]}var h0=function(){function e(t,r){NY(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!BY.test(r)&&(this.num=NaN,this.unit=""),UY.includes(r)&&(this.num=VY(t,r),this.unit="px")}return $Y(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,o=(n=FY.exec(r))!==null&&n!==void 0?n:[],h=Sv(o,3),d=h[1],s=h[2];return new e(parseFloat(d),s??"")}}])}();function CN(e){if(e.includes(rd))return rd;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=FC.exec(t))!==null&&r!==void 0?r:[],o=Sv(n,4),h=o[1],d=o[2],s=o[3],y=h0.parse(h??""),w=h0.parse(s??""),k=d==="*"?y.multiply(w):y.divide(w);if(k.isNaN())return rd;t=t.replace(FC,k.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var E,I=(E=UC.exec(t))!==null&&E!==void 0?E:[],j=Sv(I,4),z=j[1],L=j[2],q=j[3],F=h0.parse(z??""),U=h0.parse(q??""),N=L==="+"?F.add(U):F.subtract(U);if(N.isNaN())return rd;t=t.replace(UC,N.toString())}return t}var VC=/\(([^()]*)\)/;function GY(e){for(var t=e;t.includes("(");){var r=VC.exec(t),n=Sv(r,2),o=n[1];t=t.replace(VC,CN(o))}return t}function qY(e){var t=e.replace(/\s+/g,"");return t=GY(t),t=CN(t),t}function WY(e){try{return qY(e)}catch{return rd}}function y1(e){var t=WY(e.slice(5,-1));return t===rd?"":t}var HY=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],ZY=["dx","dy","angle","className","breakAll"];function d2(){return d2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d2.apply(this,arguments)}function GC(e,t){if(e==null)return{};var r=KY(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KY(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function qC(e,t){return QY(e)||JY(e,t)||YY(e,t)||XY()}function XY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YY(e,t){if(e){if(typeof e=="string")return WC(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WC(e,t)}}function WC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JY(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,h,d,s=[],y=!0,w=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;y=!1}else for(;!(y=(n=h.call(r)).done)&&(s.push(n.value),s.length!==t);y=!0);}catch(k){w=!0,o=k}finally{try{if(!y&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return s}}function QY(e){if(Array.isArray(e))return e}var MN=/[ \f\n\r\t\v\u2028\u2029]+/,IN=function(t){var r=t.children,n=t.breakAll,o=t.style;try{var h=[];Sr(r)||(n?h=r.toString().split(""):h=r.toString().split(MN));var d=h.map(function(y){return{word:y,width:im(y,o).width}}),s=n?0:im(" ",o).width;return{wordsWithComputedWidth:d,spaceWidth:s}}catch{return null}},eJ=function(t,r,n,o,h){var d=t.maxLines,s=t.children,y=t.style,w=t.breakAll,k=vt(d),E=s,I=function(){var qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return qe.reduce(function(Je,rt){var Le=rt.word,Be=rt.width,nt=Je[Je.length-1];if(nt&&(o==null||h||nt.width+Be+n<Number(o)))nt.words.push(Le),nt.width+=Be+n;else{var Xe={words:[Le],width:Be};Je.push(Xe)}return Je},[])},j=I(r),z=function(qe){return qe.reduce(function(Je,rt){return Je.width>rt.width?Je:rt})};if(!k)return j;for(var L="…",q=function(qe){var Je=E.slice(0,qe),rt=IN({breakAll:w,style:y,children:Je+L}).wordsWithComputedWidth,Le=I(rt),Be=Le.length>d||z(Le).width>Number(o);return[Be,Le]},F=0,U=E.length-1,N=0,W;F<=U&&N<=E.length-1;){var H=Math.floor((F+U)/2),Z=H-1,re=q(Z),he=qC(re,2),we=he[0],Oe=he[1],Me=q(H),Se=qC(Me,1),Ue=Se[0];if(!we&&!Ue&&(F=H+1),we&&Ue&&(U=H-1),!we&&Ue){W=Oe;break}N++}return W||j},HC=function(t){var r=Sr(t)?[]:t.toString().split(MN);return[{words:r}]},tJ=function(t){var r=t.width,n=t.scaleToFit,o=t.children,h=t.style,d=t.breakAll,s=t.maxLines;if((r||n)&&!Xl.isSsr){var y,w,k=IN({breakAll:d,children:o,style:h});if(k){var E=k.wordsWithComputedWidth,I=k.spaceWidth;y=E,w=I}else return HC(o);return eJ({breakAll:d,children:o,maxLines:s,style:h},y,w,r,n)}return HC(o)},ZC="#808080",Pv=function(t){var r=t.x,n=r===void 0?0:r,o=t.y,h=o===void 0?0:o,d=t.lineHeight,s=d===void 0?"1em":d,y=t.capHeight,w=y===void 0?"0.71em":y,k=t.scaleToFit,E=k===void 0?!1:k,I=t.textAnchor,j=I===void 0?"start":I,z=t.verticalAnchor,L=z===void 0?"end":z,q=t.fill,F=q===void 0?ZC:q,U=GC(t,HY),N=be.useMemo(function(){return tJ({breakAll:U.breakAll,children:U.children,maxLines:U.maxLines,scaleToFit:E,style:U.style,width:U.width})},[U.breakAll,U.children,U.maxLines,E,U.style,U.width]),W=U.dx,H=U.dy,Z=U.angle,re=U.className,he=U.breakAll,we=GC(U,ZY);if(!Zn(n)||!Zn(h))return null;var Oe=n+(vt(W)?W:0),Me=h+(vt(H)?H:0),Se;switch(L){case"start":Se=y1("calc(".concat(w,")"));break;case"middle":Se=y1("calc(".concat((N.length-1)/2," * -").concat(s," + (").concat(w," / 2))"));break;default:Se=y1("calc(".concat(N.length-1," * -").concat(s,")"));break}var Ue=[];if(E){var We=N[0].width,qe=U.width;Ue.push("scale(".concat((vt(qe)?qe/We:1)/We,")"))}return Z&&Ue.push("rotate(".concat(Z,", ").concat(Oe,", ").concat(Me,")")),Ue.length&&(we.transform=Ue.join(" ")),Ie.createElement("text",d2({},br(we,!0),{x:Oe,y:Me,className:wr("recharts-text",re),textAnchor:j,fill:F.includes("url")?ZC:F}),N.map(function(Je,rt){var Le=Je.words.join(he?"":" ");return Ie.createElement("tspan",{x:Oe,dy:rt===0?Se:s,key:"".concat(Le,"-").concat(rt)},Le)}))};function Yl(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function rJ(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function BP(e){let t,r,n;e.length!==2?(t=Yl,r=(s,y)=>Yl(e(s),y),n=(s,y)=>e(s)-y):(t=e===Yl||e===rJ?e:nJ,r=e,n=e);function o(s,y,w=0,k=s.length){if(w<k){if(t(y,y)!==0)return k;do{const E=w+k>>>1;r(s[E],y)<0?w=E+1:k=E}while(w<k)}return w}function h(s,y,w=0,k=s.length){if(w<k){if(t(y,y)!==0)return k;do{const E=w+k>>>1;r(s[E],y)<=0?w=E+1:k=E}while(w<k)}return w}function d(s,y,w=0,k=s.length){const E=o(s,y,w,k-1);return E>w&&n(s[E-1],y)>-n(s[E],y)?E-1:E}return{left:o,center:d,right:h}}function nJ(){return 0}function jN(e){return e===null?NaN:+e}function*iJ(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}const aJ=BP(Yl),oJ=aJ.right;BP(jN).center;const wg=oJ;class KC extends Map{constructor(t,r=cJ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,o]of t)this.set(n,o)}get(t){return super.get(XC(this,t))}has(t){return super.has(XC(this,t))}set(t,r){return super.set(sJ(this,t),r)}delete(t){return super.delete(lJ(this,t))}}function XC({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function sJ({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function lJ({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function cJ(e){return e!==null&&typeof e=="object"?e.valueOf():e}function uJ(e=Yl){if(e===Yl)return ON;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function ON(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const hJ=Math.sqrt(50),dJ=Math.sqrt(10),fJ=Math.sqrt(2);function Tv(e,t,r){const n=(t-e)/Math.max(0,r),o=Math.floor(Math.log10(n)),h=n/Math.pow(10,o),d=h>=hJ?10:h>=dJ?5:h>=fJ?2:1;let s,y,w;return o<0?(w=Math.pow(10,-o)/d,s=Math.round(e*w),y=Math.round(t*w),s/w<e&&++s,y/w>t&&--y,w=-w):(w=Math.pow(10,o)*d,s=Math.round(e/w),y=Math.round(t/w),s*w<e&&++s,y*w>t&&--y),y<s&&.5<=r&&r<2?Tv(e,t,r*2):[s,y,w]}function f2(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[o,h,d]=n?Tv(t,e,r):Tv(e,t,r);if(!(h>=o))return[];const s=h-o+1,y=new Array(s);if(n)if(d<0)for(let w=0;w<s;++w)y[w]=(h-w)/-d;else for(let w=0;w<s;++w)y[w]=(h-w)*d;else if(d<0)for(let w=0;w<s;++w)y[w]=(o+w)/-d;else for(let w=0;w<s;++w)y[w]=(o+w)*d;return y}function p2(e,t,r){return t=+t,e=+e,r=+r,Tv(e,t,r)[2]}function m2(e,t,r){t=+t,e=+e,r=+r;const n=t<e,o=n?p2(t,e,r):p2(e,t,r);return(n?-1:1)*(o<0?1/-o:o)}function YC(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&(r<o||r===void 0&&o>=o)&&(r=o)}return r}function JC(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&(r>o||r===void 0&&o>=o)&&(r=o)}return r}function DN(e,t,r=0,n=1/0,o){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(o=o===void 0?ON:uJ(o);n>r;){if(n-r>600){const y=n-r+1,w=t-r+1,k=Math.log(y),E=.5*Math.exp(2*k/3),I=.5*Math.sqrt(k*E*(y-E)/y)*(w-y/2<0?-1:1),j=Math.max(r,Math.floor(t-w*E/y+I)),z=Math.min(n,Math.floor(t+(y-w)*E/y+I));DN(e,t,j,z,o)}const h=e[t];let d=r,s=n;for(jp(e,r,t),o(e[n],h)>0&&jp(e,r,n);d<s;){for(jp(e,d,s),++d,--s;o(e[d],h)<0;)++d;for(;o(e[s],h)>0;)--s}o(e[r],h)===0?jp(e,r,s):(++s,jp(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}return e}function jp(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function pJ(e,t,r){if(e=Float64Array.from(iJ(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return JC(e);if(t>=1)return YC(e);var n,o=(n-1)*t,h=Math.floor(o),d=YC(DN(e,h).subarray(0,h+1)),s=JC(e.subarray(h+1));return d+(s-d)*(o-h)}}function mJ(e,t,r=jN){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,o=(n-1)*t,h=Math.floor(o),d=+r(e[h],h,e),s=+r(e[h+1],h+1,e);return d+(s-d)*(o-h)}}function gJ(e,t,r){e=+e,t=+t,r=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+r;for(var n=-1,o=Math.max(0,Math.ceil((t-e)/r))|0,h=new Array(o);++n<o;)h[n]=e+n*r;return h}function Qa(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ys(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const g2=Symbol("implicit");function FP(){var e=new KC,t=[],r=[],n=g2;function o(h){let d=e.get(h);if(d===void 0){if(n!==g2)return n;e.set(h,d=t.push(h)-1)}return r[d%r.length]}return o.domain=function(h){if(!arguments.length)return t.slice();t=[],e=new KC;for(const d of h)e.has(d)||e.set(d,t.push(d)-1);return o},o.range=function(h){return arguments.length?(r=Array.from(h),o):r.slice()},o.unknown=function(h){return arguments.length?(n=h,o):n},o.copy=function(){return FP(t,r).unknown(n)},Qa.apply(o,arguments),o}function zm(){var e=FP().unknown(void 0),t=e.domain,r=e.range,n=0,o=1,h,d,s=!1,y=0,w=0,k=.5;delete e.unknown;function E(){var I=t().length,j=o<n,z=j?o:n,L=j?n:o;h=(L-z)/Math.max(1,I-y+w*2),s&&(h=Math.floor(h)),z+=(L-z-h*(I-y))*k,d=h*(1-y),s&&(z=Math.round(z),d=Math.round(d));var q=gJ(I).map(function(F){return z+h*F});return r(j?q.reverse():q)}return e.domain=function(I){return arguments.length?(t(I),E()):t()},e.range=function(I){return arguments.length?([n,o]=I,n=+n,o=+o,E()):[n,o]},e.rangeRound=function(I){return[n,o]=I,n=+n,o=+o,s=!0,E()},e.bandwidth=function(){return d},e.step=function(){return h},e.round=function(I){return arguments.length?(s=!!I,E()):s},e.padding=function(I){return arguments.length?(y=Math.min(1,w=+I),E()):y},e.paddingInner=function(I){return arguments.length?(y=Math.min(1,I),E()):y},e.paddingOuter=function(I){return arguments.length?(w=+I,E()):w},e.align=function(I){return arguments.length?(k=Math.max(0,Math.min(1,I)),E()):k},e.copy=function(){return zm(t(),[n,o]).round(s).paddingInner(y).paddingOuter(w).align(k)},Qa.apply(E(),arguments)}function RN(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return RN(t())},e}function am(){return RN(zm.apply(null,arguments).paddingInner(1))}function UP(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function NN(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Sg(){}var Lm=.7,kv=1/Lm,fd="\\s*([+-]?\\d+)\\s*",Bm="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Yo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",yJ=/^#([0-9a-f]{3,8})$/,vJ=new RegExp(`^rgb\\(${fd},${fd},${fd}\\)$`),_J=new RegExp(`^rgb\\(${Yo},${Yo},${Yo}\\)$`),xJ=new RegExp(`^rgba\\(${fd},${fd},${fd},${Bm}\\)$`),bJ=new RegExp(`^rgba\\(${Yo},${Yo},${Yo},${Bm}\\)$`),wJ=new RegExp(`^hsl\\(${Bm},${Yo},${Yo}\\)$`),SJ=new RegExp(`^hsla\\(${Bm},${Yo},${Yo},${Bm}\\)$`),QC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};UP(Sg,Fm,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:eM,formatHex:eM,formatHex8:PJ,formatHsl:TJ,formatRgb:tM,toString:tM});function eM(){return this.rgb().formatHex()}function PJ(){return this.rgb().formatHex8()}function TJ(){return $N(this).formatHsl()}function tM(){return this.rgb().formatRgb()}function Fm(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=yJ.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?rM(t):r===3?new ea(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?d0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?d0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=vJ.exec(e))?new ea(t[1],t[2],t[3],1):(t=_J.exec(e))?new ea(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=xJ.exec(e))?d0(t[1],t[2],t[3],t[4]):(t=bJ.exec(e))?d0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=wJ.exec(e))?aM(t[1],t[2]/100,t[3]/100,1):(t=SJ.exec(e))?aM(t[1],t[2]/100,t[3]/100,t[4]):QC.hasOwnProperty(e)?rM(QC[e]):e==="transparent"?new ea(NaN,NaN,NaN,0):null}function rM(e){return new ea(e>>16&255,e>>8&255,e&255,1)}function d0(e,t,r,n){return n<=0&&(e=t=r=NaN),new ea(e,t,r,n)}function kJ(e){return e instanceof Sg||(e=Fm(e)),e?(e=e.rgb(),new ea(e.r,e.g,e.b,e.opacity)):new ea}function y2(e,t,r,n){return arguments.length===1?kJ(e):new ea(e,t,r,n??1)}function ea(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}UP(ea,y2,NN(Sg,{brighter(e){return e=e==null?kv:Math.pow(kv,e),new ea(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Lm:Math.pow(Lm,e),new ea(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ea(cu(this.r),cu(this.g),cu(this.b),Ev(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nM,formatHex:nM,formatHex8:EJ,formatRgb:iM,toString:iM}));function nM(){return`#${iu(this.r)}${iu(this.g)}${iu(this.b)}`}function EJ(){return`#${iu(this.r)}${iu(this.g)}${iu(this.b)}${iu((isNaN(this.opacity)?1:this.opacity)*255)}`}function iM(){const e=Ev(this.opacity);return`${e===1?"rgb(":"rgba("}${cu(this.r)}, ${cu(this.g)}, ${cu(this.b)}${e===1?")":`, ${e})`}`}function Ev(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function cu(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function iu(e){return e=cu(e),(e<16?"0":"")+e.toString(16)}function aM(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new xo(e,t,r,n)}function $N(e){if(e instanceof xo)return new xo(e.h,e.s,e.l,e.opacity);if(e instanceof Sg||(e=Fm(e)),!e)return new xo;if(e instanceof xo)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,o=Math.min(t,r,n),h=Math.max(t,r,n),d=NaN,s=h-o,y=(h+o)/2;return s?(t===h?d=(r-n)/s+(r<n)*6:r===h?d=(n-t)/s+2:d=(t-r)/s+4,s/=y<.5?h+o:2-h-o,d*=60):s=y>0&&y<1?0:d,new xo(d,s,y,e.opacity)}function AJ(e,t,r,n){return arguments.length===1?$N(e):new xo(e,t,r,n??1)}function xo(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}UP(xo,AJ,NN(Sg,{brighter(e){return e=e==null?kv:Math.pow(kv,e),new xo(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Lm:Math.pow(Lm,e),new xo(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,o=2*r-n;return new ea(v1(e>=240?e-240:e+120,o,n),v1(e,o,n),v1(e<120?e+240:e-120,o,n),this.opacity)},clamp(){return new xo(oM(this.h),f0(this.s),f0(this.l),Ev(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ev(this.opacity);return`${e===1?"hsl(":"hsla("}${oM(this.h)}, ${f0(this.s)*100}%, ${f0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function oM(e){return e=(e||0)%360,e<0?e+360:e}function f0(e){return Math.max(0,Math.min(1,e||0))}function v1(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const VP=e=>()=>e;function CJ(e,t){return function(r){return e+r*t}}function MJ(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function IJ(e){return(e=+e)==1?zN:function(t,r){return r-t?MJ(t,r,e):VP(isNaN(t)?r:t)}}function zN(e,t){var r=t-e;return r?CJ(e,r):VP(isNaN(e)?t:e)}const sM=function e(t){var r=IJ(t);function n(o,h){var d=r((o=y2(o)).r,(h=y2(h)).r),s=r(o.g,h.g),y=r(o.b,h.b),w=zN(o.opacity,h.opacity);return function(k){return o.r=d(k),o.g=s(k),o.b=y(k),o.opacity=w(k),o+""}}return n.gamma=e,n}(1);function jJ(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),o;return function(h){for(o=0;o<r;++o)n[o]=e[o]*(1-h)+t[o]*h;return n}}function OJ(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function DJ(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,o=new Array(n),h=new Array(r),d;for(d=0;d<n;++d)o[d]=rf(e[d],t[d]);for(;d<r;++d)h[d]=t[d];return function(s){for(d=0;d<n;++d)h[d]=o[d](s);return h}}function RJ(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Av(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function NJ(e,t){var r={},n={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?r[o]=rf(e[o],t[o]):n[o]=t[o];return function(h){for(o in r)n[o]=r[o](h);return n}}var v2=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_1=new RegExp(v2.source,"g");function $J(e){return function(){return e}}function zJ(e){return function(t){return e(t)+""}}function LJ(e,t){var r=v2.lastIndex=_1.lastIndex=0,n,o,h,d=-1,s=[],y=[];for(e=e+"",t=t+"";(n=v2.exec(e))&&(o=_1.exec(t));)(h=o.index)>r&&(h=t.slice(r,h),s[d]?s[d]+=h:s[++d]=h),(n=n[0])===(o=o[0])?s[d]?s[d]+=o:s[++d]=o:(s[++d]=null,y.push({i:d,x:Av(n,o)})),r=_1.lastIndex;return r<t.length&&(h=t.slice(r),s[d]?s[d]+=h:s[++d]=h),s.length<2?y[0]?zJ(y[0].x):$J(t):(t=y.length,function(w){for(var k=0,E;k<t;++k)s[(E=y[k]).i]=E.x(w);return s.join("")})}function rf(e,t){var r=typeof t,n;return t==null||r==="boolean"?VP(t):(r==="number"?Av:r==="string"?(n=Fm(t))?(t=n,sM):LJ:t instanceof Fm?sM:t instanceof Date?RJ:OJ(t)?jJ:Array.isArray(t)?DJ:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?NJ:Av)(e,t)}function GP(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function BJ(e,t){t===void 0&&(t=e,e=rf);for(var r=0,n=t.length-1,o=t[0],h=new Array(n<0?0:n);r<n;)h[r]=e(o,o=t[++r]);return function(d){var s=Math.max(0,Math.min(n-1,Math.floor(d*=n)));return h[s](d-s)}}function FJ(e){return function(){return e}}function Cv(e){return+e}var lM=[0,1];function Ui(e){return e}function _2(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:FJ(isNaN(t)?NaN:.5)}function UJ(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function VJ(e,t,r){var n=e[0],o=e[1],h=t[0],d=t[1];return o<n?(n=_2(o,n),h=r(d,h)):(n=_2(n,o),h=r(h,d)),function(s){return h(n(s))}}function GJ(e,t,r){var n=Math.min(e.length,t.length)-1,o=new Array(n),h=new Array(n),d=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++d<n;)o[d]=_2(e[d],e[d+1]),h[d]=r(t[d],t[d+1]);return function(s){var y=wg(e,s,1,n)-1;return h[y](o[y](s))}}function Pg(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function H_(){var e=lM,t=lM,r=rf,n,o,h,d=Ui,s,y,w;function k(){var I=Math.min(e.length,t.length);return d!==Ui&&(d=UJ(e[0],e[I-1])),s=I>2?GJ:VJ,y=w=null,E}function E(I){return I==null||isNaN(I=+I)?h:(y||(y=s(e.map(n),t,r)))(n(d(I)))}return E.invert=function(I){return d(o((w||(w=s(t,e.map(n),Av)))(I)))},E.domain=function(I){return arguments.length?(e=Array.from(I,Cv),k()):e.slice()},E.range=function(I){return arguments.length?(t=Array.from(I),k()):t.slice()},E.rangeRound=function(I){return t=Array.from(I),r=GP,k()},E.clamp=function(I){return arguments.length?(d=I?!0:Ui,k()):d!==Ui},E.interpolate=function(I){return arguments.length?(r=I,k()):r},E.unknown=function(I){return arguments.length?(h=I,E):h},function(I,j){return n=I,o=j,k()}}function qP(){return H_()(Ui,Ui)}function qJ(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Mv(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Ad(e){return e=Mv(Math.abs(e)),e?e[1]:NaN}function WJ(e,t){return function(r,n){for(var o=r.length,h=[],d=0,s=e[0],y=0;o>0&&s>0&&(y+s+1>n&&(s=Math.max(1,n-y)),h.push(r.substring(o-=s,o+s)),!((y+=s+1)>n));)s=e[d=(d+1)%e.length];return h.reverse().join(t)}}function HJ(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var ZJ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Um(e){if(!(t=ZJ.exec(e)))throw new Error("invalid format: "+e);var t;return new WP({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Um.prototype=WP.prototype;function WP(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}WP.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function KJ(e){e:for(var t=e.length,r=1,n=-1,o;r<t;++r)switch(e[r]){case".":n=o=r;break;case"0":n===0&&(n=r),o=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(o+1):e}var LN;function XJ(e,t){var r=Mv(e,t);if(!r)return e+"";var n=r[0],o=r[1],h=o-(LN=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,d=n.length;return h===d?n:h>d?n+new Array(h-d+1).join("0"):h>0?n.slice(0,h)+"."+n.slice(h):"0."+new Array(1-h).join("0")+Mv(e,Math.max(0,t+h-1))[0]}function cM(e,t){var r=Mv(e,t);if(!r)return e+"";var n=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+n:n.length>o+1?n.slice(0,o+1)+"."+n.slice(o+1):n+new Array(o-n.length+2).join("0")}const uM={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:qJ,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>cM(e*100,t),r:cM,s:XJ,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function hM(e){return e}var dM=Array.prototype.map,fM=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function YJ(e){var t=e.grouping===void 0||e.thousands===void 0?hM:WJ(dM.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",h=e.numerals===void 0?hM:HJ(dM.call(e.numerals,String)),d=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"−":e.minus+"",y=e.nan===void 0?"NaN":e.nan+"";function w(E){E=Um(E);var I=E.fill,j=E.align,z=E.sign,L=E.symbol,q=E.zero,F=E.width,U=E.comma,N=E.precision,W=E.trim,H=E.type;H==="n"?(U=!0,H="g"):uM[H]||(N===void 0&&(N=12),W=!0,H="g"),(q||I==="0"&&j==="=")&&(q=!0,I="0",j="=");var Z=L==="$"?r:L==="#"&&/[boxX]/.test(H)?"0"+H.toLowerCase():"",re=L==="$"?n:/[%p]/.test(H)?d:"",he=uM[H],we=/[defgprs%]/.test(H);N=N===void 0?6:/[gprs]/.test(H)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function Oe(Me){var Se=Z,Ue=re,We,qe,Je;if(H==="c")Ue=he(Me)+Ue,Me="";else{Me=+Me;var rt=Me<0||1/Me<0;if(Me=isNaN(Me)?y:he(Math.abs(Me),N),W&&(Me=KJ(Me)),rt&&+Me==0&&z!=="+"&&(rt=!1),Se=(rt?z==="("?z:s:z==="-"||z==="("?"":z)+Se,Ue=(H==="s"?fM[8+LN/3]:"")+Ue+(rt&&z==="("?")":""),we){for(We=-1,qe=Me.length;++We<qe;)if(Je=Me.charCodeAt(We),48>Je||Je>57){Ue=(Je===46?o+Me.slice(We+1):Me.slice(We))+Ue,Me=Me.slice(0,We);break}}}U&&!q&&(Me=t(Me,1/0));var Le=Se.length+Me.length+Ue.length,Be=Le<F?new Array(F-Le+1).join(I):"";switch(U&&q&&(Me=t(Be+Me,Be.length?F-Ue.length:1/0),Be=""),j){case"<":Me=Se+Me+Ue+Be;break;case"=":Me=Se+Be+Me+Ue;break;case"^":Me=Be.slice(0,Le=Be.length>>1)+Se+Me+Ue+Be.slice(Le);break;default:Me=Be+Se+Me+Ue;break}return h(Me)}return Oe.toString=function(){return E+""},Oe}function k(E,I){var j=w((E=Um(E),E.type="f",E)),z=Math.max(-8,Math.min(8,Math.floor(Ad(I)/3)))*3,L=Math.pow(10,-z),q=fM[8+z/3];return function(F){return j(L*F)+q}}return{format:w,formatPrefix:k}}var p0,HP,BN;JJ({thousands:",",grouping:[3],currency:["$",""]});function JJ(e){return p0=YJ(e),HP=p0.format,BN=p0.formatPrefix,p0}function QJ(e){return Math.max(0,-Ad(Math.abs(e)))}function eQ(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ad(t)/3)))*3-Ad(Math.abs(e)))}function tQ(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ad(t)-Ad(e))+1}function FN(e,t,r,n){var o=m2(e,t,r),h;switch(n=Um(n??",f"),n.type){case"s":{var d=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(h=eQ(o,d))&&(n.precision=h),BN(n,d)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(h=tQ(o,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=h-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(h=QJ(o))&&(n.precision=h-(n.type==="%")*2);break}}return HP(n)}function ac(e){var t=e.domain;return e.ticks=function(r){var n=t();return f2(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var o=t();return FN(o[0],o[o.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),o=0,h=n.length-1,d=n[o],s=n[h],y,w,k=10;for(s<d&&(w=d,d=s,s=w,w=o,o=h,h=w);k-- >0;){if(w=p2(d,s,r),w===y)return n[o]=d,n[h]=s,t(n);if(w>0)d=Math.floor(d/w)*w,s=Math.ceil(s/w)*w;else if(w<0)d=Math.ceil(d*w)/w,s=Math.floor(s*w)/w;else break;y=w}return e},e}function Iv(){var e=qP();return e.copy=function(){return Pg(e,Iv())},Qa.apply(e,arguments),ac(e)}function UN(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Cv),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return UN(e).unknown(t)},e=arguments.length?Array.from(e,Cv):[0,1],ac(r)}function VN(e,t){e=e.slice();var r=0,n=e.length-1,o=e[r],h=e[n],d;return h<o&&(d=r,r=n,n=d,d=o,o=h,h=d),e[r]=t.floor(o),e[n]=t.ceil(h),e}function pM(e){return Math.log(e)}function mM(e){return Math.exp(e)}function rQ(e){return-Math.log(-e)}function nQ(e){return-Math.exp(-e)}function iQ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function aQ(e){return e===10?iQ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function oQ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function gM(e){return(t,r)=>-e(-t,r)}function ZP(e){const t=e(pM,mM),r=t.domain;let n=10,o,h;function d(){return o=oQ(n),h=aQ(n),r()[0]<0?(o=gM(o),h=gM(h),e(rQ,nQ)):e(pM,mM),t}return t.base=function(s){return arguments.length?(n=+s,d()):n},t.domain=function(s){return arguments.length?(r(s),d()):r()},t.ticks=s=>{const y=r();let w=y[0],k=y[y.length-1];const E=k<w;E&&([w,k]=[k,w]);let I=o(w),j=o(k),z,L;const q=s==null?10:+s;let F=[];if(!(n%1)&&j-I<q){if(I=Math.floor(I),j=Math.ceil(j),w>0){for(;I<=j;++I)for(z=1;z<n;++z)if(L=I<0?z/h(-I):z*h(I),!(L<w)){if(L>k)break;F.push(L)}}else for(;I<=j;++I)for(z=n-1;z>=1;--z)if(L=I>0?z/h(-I):z*h(I),!(L<w)){if(L>k)break;F.push(L)}F.length*2<q&&(F=f2(w,k,q))}else F=f2(I,j,Math.min(j-I,q)).map(h);return E?F.reverse():F},t.tickFormat=(s,y)=>{if(s==null&&(s=10),y==null&&(y=n===10?"s":","),typeof y!="function"&&(!(n%1)&&(y=Um(y)).precision==null&&(y.trim=!0),y=HP(y)),s===1/0)return y;const w=Math.max(1,n*s/t.ticks().length);return k=>{let E=k/h(Math.round(o(k)));return E*n<n-.5&&(E*=n),E<=w?y(k):""}},t.nice=()=>r(VN(r(),{floor:s=>h(Math.floor(o(s))),ceil:s=>h(Math.ceil(o(s)))})),t}function GN(){const e=ZP(H_()).domain([1,10]);return e.copy=()=>Pg(e,GN()).base(e.base()),Qa.apply(e,arguments),e}function yM(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function vM(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function KP(e){var t=1,r=e(yM(t),vM(t));return r.constant=function(n){return arguments.length?e(yM(t=+n),vM(t)):t},ac(r)}function qN(){var e=KP(H_());return e.copy=function(){return Pg(e,qN()).constant(e.constant())},Qa.apply(e,arguments)}function _M(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function sQ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function lQ(e){return e<0?-e*e:e*e}function XP(e){var t=e(Ui,Ui),r=1;function n(){return r===1?e(Ui,Ui):r===.5?e(sQ,lQ):e(_M(r),_M(1/r))}return t.exponent=function(o){return arguments.length?(r=+o,n()):r},ac(t)}function YP(){var e=XP(H_());return e.copy=function(){return Pg(e,YP()).exponent(e.exponent())},Qa.apply(e,arguments),e}function cQ(){return YP.apply(null,arguments).exponent(.5)}function xM(e){return Math.sign(e)*e*e}function uQ(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function WN(){var e=qP(),t=[0,1],r=!1,n;function o(h){var d=uQ(e(h));return isNaN(d)?n:r?Math.round(d):d}return o.invert=function(h){return e.invert(xM(h))},o.domain=function(h){return arguments.length?(e.domain(h),o):e.domain()},o.range=function(h){return arguments.length?(e.range((t=Array.from(h,Cv)).map(xM)),o):t.slice()},o.rangeRound=function(h){return o.range(h).round(!0)},o.round=function(h){return arguments.length?(r=!!h,o):r},o.clamp=function(h){return arguments.length?(e.clamp(h),o):e.clamp()},o.unknown=function(h){return arguments.length?(n=h,o):n},o.copy=function(){return WN(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Qa.apply(o,arguments),ac(o)}function HN(){var e=[],t=[],r=[],n;function o(){var d=0,s=Math.max(1,t.length);for(r=new Array(s-1);++d<s;)r[d-1]=mJ(e,d/s);return h}function h(d){return d==null||isNaN(d=+d)?n:t[wg(r,d)]}return h.invertExtent=function(d){var s=t.indexOf(d);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},h.domain=function(d){if(!arguments.length)return e.slice();e=[];for(let s of d)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Yl),o()},h.range=function(d){return arguments.length?(t=Array.from(d),o()):t.slice()},h.unknown=function(d){return arguments.length?(n=d,h):n},h.quantiles=function(){return r.slice()},h.copy=function(){return HN().domain(e).range(t).unknown(n)},Qa.apply(h,arguments)}function ZN(){var e=0,t=1,r=1,n=[.5],o=[0,1],h;function d(y){return y!=null&&y<=y?o[wg(n,y,0,r)]:h}function s(){var y=-1;for(n=new Array(r);++y<r;)n[y]=((y+1)*t-(y-r)*e)/(r+1);return d}return d.domain=function(y){return arguments.length?([e,t]=y,e=+e,t=+t,s()):[e,t]},d.range=function(y){return arguments.length?(r=(o=Array.from(y)).length-1,s()):o.slice()},d.invertExtent=function(y){var w=o.indexOf(y);return w<0?[NaN,NaN]:w<1?[e,n[0]]:w>=r?[n[r-1],t]:[n[w-1],n[w]]},d.unknown=function(y){return arguments.length&&(h=y),d},d.thresholds=function(){return n.slice()},d.copy=function(){return ZN().domain([e,t]).range(o).unknown(h)},Qa.apply(ac(d),arguments)}function KN(){var e=[.5],t=[0,1],r,n=1;function o(h){return h!=null&&h<=h?t[wg(e,h,0,n)]:r}return o.domain=function(h){return arguments.length?(e=Array.from(h),n=Math.min(e.length,t.length-1),o):e.slice()},o.range=function(h){return arguments.length?(t=Array.from(h),n=Math.min(e.length,t.length-1),o):t.slice()},o.invertExtent=function(h){var d=t.indexOf(h);return[e[d-1],e[d]]},o.unknown=function(h){return arguments.length?(r=h,o):r},o.copy=function(){return KN().domain(e).range(t).unknown(r)},Qa.apply(o,arguments)}const x1=new Date,b1=new Date;function Kn(e,t,r,n){function o(h){return e(h=arguments.length===0?new Date:new Date(+h)),h}return o.floor=h=>(e(h=new Date(+h)),h),o.ceil=h=>(e(h=new Date(h-1)),t(h,1),e(h),h),o.round=h=>{const d=o(h),s=o.ceil(h);return h-d<s-h?d:s},o.offset=(h,d)=>(t(h=new Date(+h),d==null?1:Math.floor(d)),h),o.range=(h,d,s)=>{const y=[];if(h=o.ceil(h),s=s==null?1:Math.floor(s),!(h<d)||!(s>0))return y;let w;do y.push(w=new Date(+h)),t(h,s),e(h);while(w<h&&h<d);return y},o.filter=h=>Kn(d=>{if(d>=d)for(;e(d),!h(d);)d.setTime(d-1)},(d,s)=>{if(d>=d)if(s<0)for(;++s<=0;)for(;t(d,-1),!h(d););else for(;--s>=0;)for(;t(d,1),!h(d););}),r&&(o.count=(h,d)=>(x1.setTime(+h),b1.setTime(+d),e(x1),e(b1),Math.floor(r(x1,b1))),o.every=h=>(h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?o.filter(n?d=>n(d)%h===0:d=>o.count(0,d)%h===0):o)),o}const jv=Kn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);jv.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Kn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):jv);jv.range;const Os=1e3,qa=Os*60,Ds=qa*60,qs=Ds*24,JP=qs*7,bM=qs*30,w1=qs*365,au=Kn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Os)},(e,t)=>(t-e)/Os,e=>e.getUTCSeconds());au.range;const QP=Kn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Os)},(e,t)=>{e.setTime(+e+t*qa)},(e,t)=>(t-e)/qa,e=>e.getMinutes());QP.range;const eT=Kn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*qa)},(e,t)=>(t-e)/qa,e=>e.getUTCMinutes());eT.range;const tT=Kn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Os-e.getMinutes()*qa)},(e,t)=>{e.setTime(+e+t*Ds)},(e,t)=>(t-e)/Ds,e=>e.getHours());tT.range;const rT=Kn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ds)},(e,t)=>(t-e)/Ds,e=>e.getUTCHours());rT.range;const Tg=Kn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*qa)/qs,e=>e.getDate()-1);Tg.range;const Z_=Kn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/qs,e=>e.getUTCDate()-1);Z_.range;const XN=Kn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/qs,e=>Math.floor(e/qs));XN.range;function Tu(e){return Kn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*qa)/JP)}const K_=Tu(0),Ov=Tu(1),hQ=Tu(2),dQ=Tu(3),Cd=Tu(4),fQ=Tu(5),pQ=Tu(6);K_.range;Ov.range;hQ.range;dQ.range;Cd.range;fQ.range;pQ.range;function ku(e){return Kn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/JP)}const X_=ku(0),Dv=ku(1),mQ=ku(2),gQ=ku(3),Md=ku(4),yQ=ku(5),vQ=ku(6);X_.range;Dv.range;mQ.range;gQ.range;Md.range;yQ.range;vQ.range;const nT=Kn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());nT.range;const iT=Kn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());iT.range;const Ws=Kn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ws.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Kn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Ws.range;const Hs=Kn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Hs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Kn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Hs.range;function YN(e,t,r,n,o,h){const d=[[au,1,Os],[au,5,5*Os],[au,15,15*Os],[au,30,30*Os],[h,1,qa],[h,5,5*qa],[h,15,15*qa],[h,30,30*qa],[o,1,Ds],[o,3,3*Ds],[o,6,6*Ds],[o,12,12*Ds],[n,1,qs],[n,2,2*qs],[r,1,JP],[t,1,bM],[t,3,3*bM],[e,1,w1]];function s(w,k,E){const I=k<w;I&&([w,k]=[k,w]);const j=E&&typeof E.range=="function"?E:y(w,k,E),z=j?j.range(w,+k+1):[];return I?z.reverse():z}function y(w,k,E){const I=Math.abs(k-w)/E,j=BP(([,,q])=>q).right(d,I);if(j===d.length)return e.every(m2(w/w1,k/w1,E));if(j===0)return jv.every(Math.max(m2(w,k,E),1));const[z,L]=d[I/d[j-1][2]<d[j][2]/I?j-1:j];return z.every(L)}return[s,y]}const[_Q,xQ]=YN(Hs,iT,X_,XN,rT,eT),[bQ,wQ]=YN(Ws,nT,K_,Tg,tT,QP);function S1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function P1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Op(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function SQ(e){var t=e.dateTime,r=e.date,n=e.time,o=e.periods,h=e.days,d=e.shortDays,s=e.months,y=e.shortMonths,w=Dp(o),k=Rp(o),E=Dp(h),I=Rp(h),j=Dp(d),z=Rp(d),L=Dp(s),q=Rp(s),F=Dp(y),U=Rp(y),N={a:rt,A:Le,b:Be,B:nt,c:null,d:EM,e:EM,f:WQ,g:ree,G:iee,H:VQ,I:GQ,j:qQ,L:JN,m:HQ,M:ZQ,p:Xe,q:Ge,Q:MM,s:IM,S:KQ,u:XQ,U:YQ,V:JQ,w:QQ,W:eee,x:null,X:null,y:tee,Y:nee,Z:aee,"%":CM},W={a:it,A:gt,b:Pt,B:Nt,c:null,d:AM,e:AM,f:cee,g:_ee,G:bee,H:oee,I:see,j:lee,L:e5,m:uee,M:hee,p:or,q:rr,Q:MM,s:IM,S:dee,u:fee,U:pee,V:mee,w:gee,W:yee,x:null,X:null,y:vee,Y:xee,Z:wee,"%":CM},H={a:Oe,A:Me,b:Se,B:Ue,c:We,d:TM,e:TM,f:LQ,g:PM,G:SM,H:kM,I:kM,j:RQ,L:zQ,m:DQ,M:NQ,p:we,q:OQ,Q:FQ,s:UQ,S:$Q,u:AQ,U:CQ,V:MQ,w:EQ,W:IQ,x:qe,X:Je,y:PM,Y:SM,Z:jQ,"%":BQ};N.x=Z(r,N),N.X=Z(n,N),N.c=Z(t,N),W.x=Z(r,W),W.X=Z(n,W),W.c=Z(t,W);function Z(pt,Dt){return function(zt){var et=[],Vt=-1,It=0,fr=pt.length,mr,Yr,yn;for(zt instanceof Date||(zt=new Date(+zt));++Vt<fr;)pt.charCodeAt(Vt)===37&&(et.push(pt.slice(It,Vt)),(Yr=wM[mr=pt.charAt(++Vt)])!=null?mr=pt.charAt(++Vt):Yr=mr==="e"?" ":"0",(yn=Dt[mr])&&(mr=yn(zt,Yr)),et.push(mr),It=Vt+1);return et.push(pt.slice(It,Vt)),et.join("")}}function re(pt,Dt){return function(zt){var et=Op(1900,void 0,1),Vt=he(et,pt,zt+="",0),It,fr;if(Vt!=zt.length)return null;if("Q"in et)return new Date(et.Q);if("s"in et)return new Date(et.s*1e3+("L"in et?et.L:0));if(Dt&&!("Z"in et)&&(et.Z=0),"p"in et&&(et.H=et.H%12+et.p*12),et.m===void 0&&(et.m="q"in et?et.q:0),"V"in et){if(et.V<1||et.V>53)return null;"w"in et||(et.w=1),"Z"in et?(It=P1(Op(et.y,0,1)),fr=It.getUTCDay(),It=fr>4||fr===0?Dv.ceil(It):Dv(It),It=Z_.offset(It,(et.V-1)*7),et.y=It.getUTCFullYear(),et.m=It.getUTCMonth(),et.d=It.getUTCDate()+(et.w+6)%7):(It=S1(Op(et.y,0,1)),fr=It.getDay(),It=fr>4||fr===0?Ov.ceil(It):Ov(It),It=Tg.offset(It,(et.V-1)*7),et.y=It.getFullYear(),et.m=It.getMonth(),et.d=It.getDate()+(et.w+6)%7)}else("W"in et||"U"in et)&&("w"in et||(et.w="u"in et?et.u%7:"W"in et?1:0),fr="Z"in et?P1(Op(et.y,0,1)).getUTCDay():S1(Op(et.y,0,1)).getDay(),et.m=0,et.d="W"in et?(et.w+6)%7+et.W*7-(fr+5)%7:et.w+et.U*7-(fr+6)%7);return"Z"in et?(et.H+=et.Z/100|0,et.M+=et.Z%100,P1(et)):S1(et)}}function he(pt,Dt,zt,et){for(var Vt=0,It=Dt.length,fr=zt.length,mr,Yr;Vt<It;){if(et>=fr)return-1;if(mr=Dt.charCodeAt(Vt++),mr===37){if(mr=Dt.charAt(Vt++),Yr=H[mr in wM?Dt.charAt(Vt++):mr],!Yr||(et=Yr(pt,zt,et))<0)return-1}else if(mr!=zt.charCodeAt(et++))return-1}return et}function we(pt,Dt,zt){var et=w.exec(Dt.slice(zt));return et?(pt.p=k.get(et[0].toLowerCase()),zt+et[0].length):-1}function Oe(pt,Dt,zt){var et=j.exec(Dt.slice(zt));return et?(pt.w=z.get(et[0].toLowerCase()),zt+et[0].length):-1}function Me(pt,Dt,zt){var et=E.exec(Dt.slice(zt));return et?(pt.w=I.get(et[0].toLowerCase()),zt+et[0].length):-1}function Se(pt,Dt,zt){var et=F.exec(Dt.slice(zt));return et?(pt.m=U.get(et[0].toLowerCase()),zt+et[0].length):-1}function Ue(pt,Dt,zt){var et=L.exec(Dt.slice(zt));return et?(pt.m=q.get(et[0].toLowerCase()),zt+et[0].length):-1}function We(pt,Dt,zt){return he(pt,t,Dt,zt)}function qe(pt,Dt,zt){return he(pt,r,Dt,zt)}function Je(pt,Dt,zt){return he(pt,n,Dt,zt)}function rt(pt){return d[pt.getDay()]}function Le(pt){return h[pt.getDay()]}function Be(pt){return y[pt.getMonth()]}function nt(pt){return s[pt.getMonth()]}function Xe(pt){return o[+(pt.getHours()>=12)]}function Ge(pt){return 1+~~(pt.getMonth()/3)}function it(pt){return d[pt.getUTCDay()]}function gt(pt){return h[pt.getUTCDay()]}function Pt(pt){return y[pt.getUTCMonth()]}function Nt(pt){return s[pt.getUTCMonth()]}function or(pt){return o[+(pt.getUTCHours()>=12)]}function rr(pt){return 1+~~(pt.getUTCMonth()/3)}return{format:function(pt){var Dt=Z(pt+="",N);return Dt.toString=function(){return pt},Dt},parse:function(pt){var Dt=re(pt+="",!1);return Dt.toString=function(){return pt},Dt},utcFormat:function(pt){var Dt=Z(pt+="",W);return Dt.toString=function(){return pt},Dt},utcParse:function(pt){var Dt=re(pt+="",!0);return Dt.toString=function(){return pt},Dt}}}var wM={"-":"",_:" ",0:"0"},si=/^\s*\d+/,PQ=/^%/,TQ=/[\\^$*+?|[\]().{}]/g;function yr(e,t,r){var n=e<0?"-":"",o=(n?-e:e)+"",h=o.length;return n+(h<r?new Array(r-h+1).join(t)+o:o)}function kQ(e){return e.replace(TQ,"\\$&")}function Dp(e){return new RegExp("^(?:"+e.map(kQ).join("|")+")","i")}function Rp(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function EQ(e,t,r){var n=si.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function AQ(e,t,r){var n=si.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function CQ(e,t,r){var n=si.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function MQ(e,t,r){var n=si.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function IQ(e,t,r){var n=si.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function SM(e,t,r){var n=si.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function PM(e,t,r){var n=si.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function jQ(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function OQ(e,t,r){var n=si.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function DQ(e,t,r){var n=si.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function TM(e,t,r){var n=si.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function RQ(e,t,r){var n=si.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function kM(e,t,r){var n=si.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function NQ(e,t,r){var n=si.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function $Q(e,t,r){var n=si.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function zQ(e,t,r){var n=si.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function LQ(e,t,r){var n=si.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function BQ(e,t,r){var n=PQ.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function FQ(e,t,r){var n=si.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function UQ(e,t,r){var n=si.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function EM(e,t){return yr(e.getDate(),t,2)}function VQ(e,t){return yr(e.getHours(),t,2)}function GQ(e,t){return yr(e.getHours()%12||12,t,2)}function qQ(e,t){return yr(1+Tg.count(Ws(e),e),t,3)}function JN(e,t){return yr(e.getMilliseconds(),t,3)}function WQ(e,t){return JN(e,t)+"000"}function HQ(e,t){return yr(e.getMonth()+1,t,2)}function ZQ(e,t){return yr(e.getMinutes(),t,2)}function KQ(e,t){return yr(e.getSeconds(),t,2)}function XQ(e){var t=e.getDay();return t===0?7:t}function YQ(e,t){return yr(K_.count(Ws(e)-1,e),t,2)}function QN(e){var t=e.getDay();return t>=4||t===0?Cd(e):Cd.ceil(e)}function JQ(e,t){return e=QN(e),yr(Cd.count(Ws(e),e)+(Ws(e).getDay()===4),t,2)}function QQ(e){return e.getDay()}function eee(e,t){return yr(Ov.count(Ws(e)-1,e),t,2)}function tee(e,t){return yr(e.getFullYear()%100,t,2)}function ree(e,t){return e=QN(e),yr(e.getFullYear()%100,t,2)}function nee(e,t){return yr(e.getFullYear()%1e4,t,4)}function iee(e,t){var r=e.getDay();return e=r>=4||r===0?Cd(e):Cd.ceil(e),yr(e.getFullYear()%1e4,t,4)}function aee(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+yr(t/60|0,"0",2)+yr(t%60,"0",2)}function AM(e,t){return yr(e.getUTCDate(),t,2)}function oee(e,t){return yr(e.getUTCHours(),t,2)}function see(e,t){return yr(e.getUTCHours()%12||12,t,2)}function lee(e,t){return yr(1+Z_.count(Hs(e),e),t,3)}function e5(e,t){return yr(e.getUTCMilliseconds(),t,3)}function cee(e,t){return e5(e,t)+"000"}function uee(e,t){return yr(e.getUTCMonth()+1,t,2)}function hee(e,t){return yr(e.getUTCMinutes(),t,2)}function dee(e,t){return yr(e.getUTCSeconds(),t,2)}function fee(e){var t=e.getUTCDay();return t===0?7:t}function pee(e,t){return yr(X_.count(Hs(e)-1,e),t,2)}function t5(e){var t=e.getUTCDay();return t>=4||t===0?Md(e):Md.ceil(e)}function mee(e,t){return e=t5(e),yr(Md.count(Hs(e),e)+(Hs(e).getUTCDay()===4),t,2)}function gee(e){return e.getUTCDay()}function yee(e,t){return yr(Dv.count(Hs(e)-1,e),t,2)}function vee(e,t){return yr(e.getUTCFullYear()%100,t,2)}function _ee(e,t){return e=t5(e),yr(e.getUTCFullYear()%100,t,2)}function xee(e,t){return yr(e.getUTCFullYear()%1e4,t,4)}function bee(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Md(e):Md.ceil(e),yr(e.getUTCFullYear()%1e4,t,4)}function wee(){return"+0000"}function CM(){return"%"}function MM(e){return+e}function IM(e){return Math.floor(+e/1e3)}var Dh,r5,n5;See({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function See(e){return Dh=SQ(e),r5=Dh.format,Dh.parse,n5=Dh.utcFormat,Dh.utcParse,Dh}function Pee(e){return new Date(e)}function Tee(e){return e instanceof Date?+e:+new Date(+e)}function aT(e,t,r,n,o,h,d,s,y,w){var k=qP(),E=k.invert,I=k.domain,j=w(".%L"),z=w(":%S"),L=w("%I:%M"),q=w("%I %p"),F=w("%a %d"),U=w("%b %d"),N=w("%B"),W=w("%Y");function H(Z){return(y(Z)<Z?j:s(Z)<Z?z:d(Z)<Z?L:h(Z)<Z?q:n(Z)<Z?o(Z)<Z?F:U:r(Z)<Z?N:W)(Z)}return k.invert=function(Z){return new Date(E(Z))},k.domain=function(Z){return arguments.length?I(Array.from(Z,Tee)):I().map(Pee)},k.ticks=function(Z){var re=I();return e(re[0],re[re.length-1],Z??10)},k.tickFormat=function(Z,re){return re==null?H:w(re)},k.nice=function(Z){var re=I();return(!Z||typeof Z.range!="function")&&(Z=t(re[0],re[re.length-1],Z??10)),Z?I(VN(re,Z)):k},k.copy=function(){return Pg(k,aT(e,t,r,n,o,h,d,s,y,w))},k}function kee(){return Qa.apply(aT(bQ,wQ,Ws,nT,K_,Tg,tT,QP,au,r5).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Eee(){return Qa.apply(aT(_Q,xQ,Hs,iT,X_,Z_,rT,eT,au,n5).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Y_(){var e=0,t=1,r,n,o,h,d=Ui,s=!1,y;function w(E){return E==null||isNaN(E=+E)?y:d(o===0?.5:(E=(h(E)-r)*o,s?Math.max(0,Math.min(1,E)):E))}w.domain=function(E){return arguments.length?([e,t]=E,r=h(e=+e),n=h(t=+t),o=r===n?0:1/(n-r),w):[e,t]},w.clamp=function(E){return arguments.length?(s=!!E,w):s},w.interpolator=function(E){return arguments.length?(d=E,w):d};function k(E){return function(I){var j,z;return arguments.length?([j,z]=I,d=E(j,z),w):[d(0),d(1)]}}return w.range=k(rf),w.rangeRound=k(GP),w.unknown=function(E){return arguments.length?(y=E,w):y},function(E){return h=E,r=E(e),n=E(t),o=r===n?0:1/(n-r),w}}function oc(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function i5(){var e=ac(Y_()(Ui));return e.copy=function(){return oc(e,i5())},Ys.apply(e,arguments)}function a5(){var e=ZP(Y_()).domain([1,10]);return e.copy=function(){return oc(e,a5()).base(e.base())},Ys.apply(e,arguments)}function o5(){var e=KP(Y_());return e.copy=function(){return oc(e,o5()).constant(e.constant())},Ys.apply(e,arguments)}function oT(){var e=XP(Y_());return e.copy=function(){return oc(e,oT()).exponent(e.exponent())},Ys.apply(e,arguments)}function Aee(){return oT.apply(null,arguments).exponent(.5)}function s5(){var e=[],t=Ui;function r(n){if(n!=null&&!isNaN(n=+n))return t((wg(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let o of n)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Yl),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,o)=>t(o/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(o,h)=>pJ(e,h/n))},r.copy=function(){return s5(t).domain(e)},Ys.apply(r,arguments)}function J_(){var e=0,t=.5,r=1,n=1,o,h,d,s,y,w=Ui,k,E=!1,I;function j(L){return isNaN(L=+L)?I:(L=.5+((L=+k(L))-h)*(n*L<n*h?s:y),w(E?Math.max(0,Math.min(1,L)):L))}j.domain=function(L){return arguments.length?([e,t,r]=L,o=k(e=+e),h=k(t=+t),d=k(r=+r),s=o===h?0:.5/(h-o),y=h===d?0:.5/(d-h),n=h<o?-1:1,j):[e,t,r]},j.clamp=function(L){return arguments.length?(E=!!L,j):E},j.interpolator=function(L){return arguments.length?(w=L,j):w};function z(L){return function(q){var F,U,N;return arguments.length?([F,U,N]=q,w=BJ(L,[F,U,N]),j):[w(0),w(.5),w(1)]}}return j.range=z(rf),j.rangeRound=z(GP),j.unknown=function(L){return arguments.length?(I=L,j):I},function(L){return k=L,o=L(e),h=L(t),d=L(r),s=o===h?0:.5/(h-o),y=h===d?0:.5/(d-h),n=h<o?-1:1,j}}function l5(){var e=ac(J_()(Ui));return e.copy=function(){return oc(e,l5())},Ys.apply(e,arguments)}function c5(){var e=ZP(J_()).domain([.1,1,10]);return e.copy=function(){return oc(e,c5()).base(e.base())},Ys.apply(e,arguments)}function u5(){var e=KP(J_());return e.copy=function(){return oc(e,u5()).constant(e.constant())},Ys.apply(e,arguments)}function sT(){var e=XP(J_());return e.copy=function(){return oc(e,sT()).exponent(e.exponent())},Ys.apply(e,arguments)}function Cee(){return sT.apply(null,arguments).exponent(.5)}const jM=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:zm,scaleDiverging:l5,scaleDivergingLog:c5,scaleDivergingPow:sT,scaleDivergingSqrt:Cee,scaleDivergingSymlog:u5,scaleIdentity:UN,scaleImplicit:g2,scaleLinear:Iv,scaleLog:GN,scaleOrdinal:FP,scalePoint:am,scalePow:YP,scaleQuantile:HN,scaleQuantize:ZN,scaleRadial:WN,scaleSequential:i5,scaleSequentialLog:a5,scaleSequentialPow:oT,scaleSequentialQuantile:s5,scaleSequentialSqrt:Aee,scaleSequentialSymlog:o5,scaleSqrt:cQ,scaleSymlog:qN,scaleThreshold:KN,scaleTime:kee,scaleUtc:Eee,tickFormat:FN},Symbol.toStringTag,{value:"Module"}));var Mee=Zd;function Iee(e,t,r){for(var n=-1,o=e.length;++n<o;){var h=e[n],d=t(h);if(d!=null&&(s===void 0?d===d&&!Mee(d):r(d,s)))var s=d,y=h}return y}var h5=Iee;function jee(e,t){return e>t}var Oee=jee,Dee=h5,Ree=Oee,Nee=tf;function $ee(e){return e&&e.length?Dee(e,Nee,Ree):void 0}var zee=$ee;const Q_=Rr(zee);function Lee(e,t){return e<t}var Bee=Lee,Fee=h5,Uee=Bee,Vee=tf;function Gee(e){return e&&e.length?Fee(e,Vee,Uee):void 0}var qee=Gee;const ex=Rr(qee);var Wee=bP,Hee=ic,Zee=vN,Kee=ia;function Xee(e,t){var r=Kee(e)?Wee:Zee;return r(e,Hee(t))}var Yee=Xee,Jee=gN,Qee=Yee;function ete(e,t){return Jee(Qee(e,t),1)}var tte=ete;const rte=Rr(tte);var nte=NP;function ite(e,t){return nte(e,t)}var ate=ite;const lT=Rr(ate);var nf=1e9,ote={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},uT,rn=!0,Xa="[DecimalError] ",uu=Xa+"Invalid argument: ",cT=Xa+"Exponent out of range: ",af=Math.floor,Yc=Math.pow,ste=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ta,ni=1e7,Zr=7,d5=9007199254740991,Rv=af(d5/Zr),Et={};Et.absoluteValue=Et.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Et.comparedTo=Et.cmp=function(e){var t,r,n,o,h=this;if(e=new h.constructor(e),h.s!==e.s)return h.s||-e.s;if(h.e!==e.e)return h.e>e.e^h.s<0?1:-1;for(n=h.d.length,o=e.d.length,t=0,r=n<o?n:o;t<r;++t)if(h.d[t]!==e.d[t])return h.d[t]>e.d[t]^h.s<0?1:-1;return n===o?0:n>o^h.s<0?1:-1};Et.decimalPlaces=Et.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Zr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Et.dividedBy=Et.div=function(e){return Ls(this,new this.constructor(e))};Et.dividedToIntegerBy=Et.idiv=function(e){var t=this,r=t.constructor;return Nr(Ls(t,new r(e),0,1),r.precision)};Et.equals=Et.eq=function(e){return!this.cmp(e)};Et.exponent=function(){return Rn(this)};Et.greaterThan=Et.gt=function(e){return this.cmp(e)>0};Et.greaterThanOrEqualTo=Et.gte=function(e){return this.cmp(e)>=0};Et.isInteger=Et.isint=function(){return this.e>this.d.length-2};Et.isNegative=Et.isneg=function(){return this.s<0};Et.isPositive=Et.ispos=function(){return this.s>0};Et.isZero=function(){return this.s===0};Et.lessThan=Et.lt=function(e){return this.cmp(e)<0};Et.lessThanOrEqualTo=Et.lte=function(e){return this.cmp(e)<1};Et.logarithm=Et.log=function(e){var t,r=this,n=r.constructor,o=n.precision,h=o+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ta))throw Error(Xa+"NaN");if(r.s<1)throw Error(Xa+(r.s?"NaN":"-Infinity"));return r.eq(Ta)?new n(0):(rn=!1,t=Ls(Vm(r,h),Vm(e,h),h),rn=!0,Nr(t,o))};Et.minus=Et.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?m5(t,e):f5(t,(e.s=-e.s,e))};Et.modulo=Et.mod=function(e){var t,r=this,n=r.constructor,o=n.precision;if(e=new n(e),!e.s)throw Error(Xa+"NaN");return r.s?(rn=!1,t=Ls(r,e,0,1).times(e),rn=!0,r.minus(t)):Nr(new n(r),o)};Et.naturalExponential=Et.exp=function(){return p5(this)};Et.naturalLogarithm=Et.ln=function(){return Vm(this)};Et.negated=Et.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Et.plus=Et.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?f5(t,e):m5(t,(e.s=-e.s,e))};Et.precision=Et.sd=function(e){var t,r,n,o=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(uu+e);if(t=Rn(o)+1,n=o.d.length-1,r=n*Zr+1,n=o.d[n],n){for(;n%10==0;n/=10)r--;for(n=o.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Et.squareRoot=Et.sqrt=function(){var e,t,r,n,o,h,d,s=this,y=s.constructor;if(s.s<1){if(!s.s)return new y(0);throw Error(Xa+"NaN")}for(e=Rn(s),rn=!1,o=Math.sqrt(+s),o==0||o==1/0?(t=Zo(s.d),(t.length+e)%2==0&&(t+="0"),o=Math.sqrt(t),e=af((e+1)/2)-(e<0||e%2),o==1/0?t="5e"+e:(t=o.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new y(t)):n=new y(o.toString()),r=y.precision,o=d=r+3;;)if(h=n,n=h.plus(Ls(s,h,d+2)).times(.5),Zo(h.d).slice(0,d)===(t=Zo(n.d)).slice(0,d)){if(t=t.slice(d-3,d+1),o==d&&t=="4999"){if(Nr(h,r+1,0),h.times(h).eq(s)){n=h;break}}else if(t!="9999")break;d+=4}return rn=!0,Nr(n,r)};Et.times=Et.mul=function(e){var t,r,n,o,h,d,s,y,w,k=this,E=k.constructor,I=k.d,j=(e=new E(e)).d;if(!k.s||!e.s)return new E(0);for(e.s*=k.s,r=k.e+e.e,y=I.length,w=j.length,y<w&&(h=I,I=j,j=h,d=y,y=w,w=d),h=[],d=y+w,n=d;n--;)h.push(0);for(n=w;--n>=0;){for(t=0,o=y+n;o>n;)s=h[o]+j[n]*I[o-n-1]+t,h[o--]=s%ni|0,t=s/ni|0;h[o]=(h[o]+t)%ni|0}for(;!h[--d];)h.pop();return t?++r:h.shift(),e.d=h,e.e=r,rn?Nr(e,E.precision):e};Et.toDecimalPlaces=Et.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Qo(e,0,nf),t===void 0?t=n.rounding:Qo(t,0,8),Nr(r,e+Rn(r)+1,t))};Et.toExponential=function(e,t){var r,n=this,o=n.constructor;return e===void 0?r=_u(n,!0):(Qo(e,0,nf),t===void 0?t=o.rounding:Qo(t,0,8),n=Nr(new o(n),e+1,t),r=_u(n,!0,e+1)),r};Et.toFixed=function(e,t){var r,n,o=this,h=o.constructor;return e===void 0?_u(o):(Qo(e,0,nf),t===void 0?t=h.rounding:Qo(t,0,8),n=Nr(new h(o),e+Rn(o)+1,t),r=_u(n.abs(),!1,e+Rn(n)+1),o.isneg()&&!o.isZero()?"-"+r:r)};Et.toInteger=Et.toint=function(){var e=this,t=e.constructor;return Nr(new t(e),Rn(e)+1,t.rounding)};Et.toNumber=function(){return+this};Et.toPower=Et.pow=function(e){var t,r,n,o,h,d,s=this,y=s.constructor,w=12,k=+(e=new y(e));if(!e.s)return new y(Ta);if(s=new y(s),!s.s){if(e.s<1)throw Error(Xa+"Infinity");return s}if(s.eq(Ta))return s;if(n=y.precision,e.eq(Ta))return Nr(s,n);if(t=e.e,r=e.d.length-1,d=t>=r,h=s.s,d){if((r=k<0?-k:k)<=d5){for(o=new y(Ta),t=Math.ceil(n/Zr+4),rn=!1;r%2&&(o=o.times(s),DM(o.d,t)),r=af(r/2),r!==0;)s=s.times(s),DM(s.d,t);return rn=!0,e.s<0?new y(Ta).div(o):Nr(o,n)}}else if(h<0)throw Error(Xa+"NaN");return h=h<0&&e.d[Math.max(t,r)]&1?-1:1,s.s=1,rn=!1,o=e.times(Vm(s,n+w)),rn=!0,o=p5(o),o.s=h,o};Et.toPrecision=function(e,t){var r,n,o=this,h=o.constructor;return e===void 0?(r=Rn(o),n=_u(o,r<=h.toExpNeg||r>=h.toExpPos)):(Qo(e,1,nf),t===void 0?t=h.rounding:Qo(t,0,8),o=Nr(new h(o),e,t),r=Rn(o),n=_u(o,e<=r||r<=h.toExpNeg,e)),n};Et.toSignificantDigits=Et.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Qo(e,1,nf),t===void 0?t=n.rounding:Qo(t,0,8)),Nr(new n(r),e,t)};Et.toString=Et.valueOf=Et.val=Et.toJSON=Et[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Rn(e),r=e.constructor;return _u(e,t<=r.toExpNeg||t>=r.toExpPos)};function f5(e,t){var r,n,o,h,d,s,y,w,k=e.constructor,E=k.precision;if(!e.s||!t.s)return t.s||(t=new k(e)),rn?Nr(t,E):t;if(y=e.d,w=t.d,d=e.e,o=t.e,y=y.slice(),h=d-o,h){for(h<0?(n=y,h=-h,s=w.length):(n=w,o=d,s=y.length),d=Math.ceil(E/Zr),s=d>s?d+1:s+1,h>s&&(h=s,n.length=1),n.reverse();h--;)n.push(0);n.reverse()}for(s=y.length,h=w.length,s-h<0&&(h=s,n=w,w=y,y=n),r=0;h;)r=(y[--h]=y[h]+w[h]+r)/ni|0,y[h]%=ni;for(r&&(y.unshift(r),++o),s=y.length;y[--s]==0;)y.pop();return t.d=y,t.e=o,rn?Nr(t,E):t}function Qo(e,t,r){if(e!==~~e||e<t||e>r)throw Error(uu+e)}function Zo(e){var t,r,n,o=e.length-1,h="",d=e[0];if(o>0){for(h+=d,t=1;t<o;t++)n=e[t]+"",r=Zr-n.length,r&&(h+=Ol(r)),h+=n;d=e[t],n=d+"",r=Zr-n.length,r&&(h+=Ol(r))}else if(d===0)return"0";for(;d%10===0;)d/=10;return h+d}var Ls=function(){function e(n,o){var h,d=0,s=n.length;for(n=n.slice();s--;)h=n[s]*o+d,n[s]=h%ni|0,d=h/ni|0;return d&&n.unshift(d),n}function t(n,o,h,d){var s,y;if(h!=d)y=h>d?1:-1;else for(s=y=0;s<h;s++)if(n[s]!=o[s]){y=n[s]>o[s]?1:-1;break}return y}function r(n,o,h){for(var d=0;h--;)n[h]-=d,d=n[h]<o[h]?1:0,n[h]=d*ni+n[h]-o[h];for(;!n[0]&&n.length>1;)n.shift()}return function(n,o,h,d){var s,y,w,k,E,I,j,z,L,q,F,U,N,W,H,Z,re,he,we=n.constructor,Oe=n.s==o.s?1:-1,Me=n.d,Se=o.d;if(!n.s)return new we(n);if(!o.s)throw Error(Xa+"Division by zero");for(y=n.e-o.e,re=Se.length,H=Me.length,j=new we(Oe),z=j.d=[],w=0;Se[w]==(Me[w]||0);)++w;if(Se[w]>(Me[w]||0)&&--y,h==null?U=h=we.precision:d?U=h+(Rn(n)-Rn(o))+1:U=h,U<0)return new we(0);if(U=U/Zr+2|0,w=0,re==1)for(k=0,Se=Se[0],U++;(w<H||k)&&U--;w++)N=k*ni+(Me[w]||0),z[w]=N/Se|0,k=N%Se|0;else{for(k=ni/(Se[0]+1)|0,k>1&&(Se=e(Se,k),Me=e(Me,k),re=Se.length,H=Me.length),W=re,L=Me.slice(0,re),q=L.length;q<re;)L[q++]=0;he=Se.slice(),he.unshift(0),Z=Se[0],Se[1]>=ni/2&&++Z;do k=0,s=t(Se,L,re,q),s<0?(F=L[0],re!=q&&(F=F*ni+(L[1]||0)),k=F/Z|0,k>1?(k>=ni&&(k=ni-1),E=e(Se,k),I=E.length,q=L.length,s=t(E,L,I,q),s==1&&(k--,r(E,re<I?he:Se,I))):(k==0&&(s=k=1),E=Se.slice()),I=E.length,I<q&&E.unshift(0),r(L,E,q),s==-1&&(q=L.length,s=t(Se,L,re,q),s<1&&(k++,r(L,re<q?he:Se,q))),q=L.length):s===0&&(k++,L=[0]),z[w++]=k,s&&L[0]?L[q++]=Me[W]||0:(L=[Me[W]],q=1);while((W++<H||L[0]!==void 0)&&U--)}return z[0]||z.shift(),j.e=y,Nr(j,d?h+Rn(j)+1:h)}}();function p5(e,t){var r,n,o,h,d,s,y=0,w=0,k=e.constructor,E=k.precision;if(Rn(e)>16)throw Error(cT+Rn(e));if(!e.s)return new k(Ta);for(t==null?(rn=!1,s=E):s=t,d=new k(.03125);e.abs().gte(.1);)e=e.times(d),w+=5;for(n=Math.log(Yc(2,w))/Math.LN10*2+5|0,s+=n,r=o=h=new k(Ta),k.precision=s;;){if(o=Nr(o.times(e),s),r=r.times(++y),d=h.plus(Ls(o,r,s)),Zo(d.d).slice(0,s)===Zo(h.d).slice(0,s)){for(;w--;)h=Nr(h.times(h),s);return k.precision=E,t==null?(rn=!0,Nr(h,E)):h}h=d}}function Rn(e){for(var t=e.e*Zr,r=e.d[0];r>=10;r/=10)t++;return t}function T1(e,t,r){if(t>e.LN10.sd())throw rn=!0,r&&(e.precision=r),Error(Xa+"LN10 precision limit exceeded");return Nr(new e(e.LN10),t)}function Ol(e){for(var t="";e--;)t+="0";return t}function Vm(e,t){var r,n,o,h,d,s,y,w,k,E=1,I=10,j=e,z=j.d,L=j.constructor,q=L.precision;if(j.s<1)throw Error(Xa+(j.s?"NaN":"-Infinity"));if(j.eq(Ta))return new L(0);if(t==null?(rn=!1,w=q):w=t,j.eq(10))return t==null&&(rn=!0),T1(L,w);if(w+=I,L.precision=w,r=Zo(z),n=r.charAt(0),h=Rn(j),Math.abs(h)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)j=j.times(e),r=Zo(j.d),n=r.charAt(0),E++;h=Rn(j),n>1?(j=new L("0."+r),h++):j=new L(n+"."+r.slice(1))}else return y=T1(L,w+2,q).times(h+""),j=Vm(new L(n+"."+r.slice(1)),w-I).plus(y),L.precision=q,t==null?(rn=!0,Nr(j,q)):j;for(s=d=j=Ls(j.minus(Ta),j.plus(Ta),w),k=Nr(j.times(j),w),o=3;;){if(d=Nr(d.times(k),w),y=s.plus(Ls(d,new L(o),w)),Zo(y.d).slice(0,w)===Zo(s.d).slice(0,w))return s=s.times(2),h!==0&&(s=s.plus(T1(L,w+2,q).times(h+""))),s=Ls(s,new L(E),w),L.precision=q,t==null?(rn=!0,Nr(s,q)):s;s=y,o+=2}}function OM(e,t){var r,n,o;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(o=t.length;t.charCodeAt(o-1)===48;)--o;if(t=t.slice(n,o),t){if(o-=n,r=r-n-1,e.e=af(r/Zr),e.d=[],n=(r+1)%Zr,r<0&&(n+=Zr),n<o){for(n&&e.d.push(+t.slice(0,n)),o-=Zr;n<o;)e.d.push(+t.slice(n,n+=Zr));t=t.slice(n),n=Zr-t.length}else n-=o;for(;n--;)t+="0";if(e.d.push(+t),rn&&(e.e>Rv||e.e<-Rv))throw Error(cT+r)}else e.s=0,e.e=0,e.d=[0];return e}function Nr(e,t,r){var n,o,h,d,s,y,w,k,E=e.d;for(d=1,h=E[0];h>=10;h/=10)d++;if(n=t-d,n<0)n+=Zr,o=t,w=E[k=0];else{if(k=Math.ceil((n+1)/Zr),h=E.length,k>=h)return e;for(w=h=E[k],d=1;h>=10;h/=10)d++;n%=Zr,o=n-Zr+d}if(r!==void 0&&(h=Yc(10,d-o-1),s=w/h%10|0,y=t<0||E[k+1]!==void 0||w%h,y=r<4?(s||y)&&(r==0||r==(e.s<0?3:2)):s>5||s==5&&(r==4||y||r==6&&(n>0?o>0?w/Yc(10,d-o):0:E[k-1])%10&1||r==(e.s<0?8:7))),t<1||!E[0])return y?(h=Rn(e),E.length=1,t=t-h-1,E[0]=Yc(10,(Zr-t%Zr)%Zr),e.e=af(-t/Zr)||0):(E.length=1,E[0]=e.e=e.s=0),e;if(n==0?(E.length=k,h=1,k--):(E.length=k+1,h=Yc(10,Zr-n),E[k]=o>0?(w/Yc(10,d-o)%Yc(10,o)|0)*h:0),y)for(;;)if(k==0){(E[0]+=h)==ni&&(E[0]=1,++e.e);break}else{if(E[k]+=h,E[k]!=ni)break;E[k--]=0,h=1}for(n=E.length;E[--n]===0;)E.pop();if(rn&&(e.e>Rv||e.e<-Rv))throw Error(cT+Rn(e));return e}function m5(e,t){var r,n,o,h,d,s,y,w,k,E,I=e.constructor,j=I.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new I(e),rn?Nr(t,j):t;if(y=e.d,E=t.d,n=t.e,w=e.e,y=y.slice(),d=w-n,d){for(k=d<0,k?(r=y,d=-d,s=E.length):(r=E,n=w,s=y.length),o=Math.max(Math.ceil(j/Zr),s)+2,d>o&&(d=o,r.length=1),r.reverse(),o=d;o--;)r.push(0);r.reverse()}else{for(o=y.length,s=E.length,k=o<s,k&&(s=o),o=0;o<s;o++)if(y[o]!=E[o]){k=y[o]<E[o];break}d=0}for(k&&(r=y,y=E,E=r,t.s=-t.s),s=y.length,o=E.length-s;o>0;--o)y[s++]=0;for(o=E.length;o>d;){if(y[--o]<E[o]){for(h=o;h&&y[--h]===0;)y[h]=ni-1;--y[h],y[o]+=ni}y[o]-=E[o]}for(;y[--s]===0;)y.pop();for(;y[0]===0;y.shift())--n;return y[0]?(t.d=y,t.e=n,rn?Nr(t,j):t):new I(0)}function _u(e,t,r){var n,o=Rn(e),h=Zo(e.d),d=h.length;return t?(r&&(n=r-d)>0?h=h.charAt(0)+"."+h.slice(1)+Ol(n):d>1&&(h=h.charAt(0)+"."+h.slice(1)),h=h+(o<0?"e":"e+")+o):o<0?(h="0."+Ol(-o-1)+h,r&&(n=r-d)>0&&(h+=Ol(n))):o>=d?(h+=Ol(o+1-d),r&&(n=r-o-1)>0&&(h=h+"."+Ol(n))):((n=o+1)<d&&(h=h.slice(0,n)+"."+h.slice(n)),r&&(n=r-d)>0&&(o+1===d&&(h+="."),h+=Ol(n))),e.s<0?"-"+h:h}function DM(e,t){if(e.length>t)return e.length=t,!0}function g5(e){var t,r,n;function o(h){var d=this;if(!(d instanceof o))return new o(h);if(d.constructor=o,h instanceof o){d.s=h.s,d.e=h.e,d.d=(h=h.d)?h.slice():h;return}if(typeof h=="number"){if(h*0!==0)throw Error(uu+h);if(h>0)d.s=1;else if(h<0)h=-h,d.s=-1;else{d.s=0,d.e=0,d.d=[0];return}if(h===~~h&&h<1e7){d.e=0,d.d=[h];return}return OM(d,h.toString())}else if(typeof h!="string")throw Error(uu+h);if(h.charCodeAt(0)===45?(h=h.slice(1),d.s=-1):d.s=1,ste.test(h))OM(d,h);else throw Error(uu+h)}if(o.prototype=Et,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=g5,o.config=o.set=lte,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return o.config(e),o}function lte(e){if(!e||typeof e!="object")throw Error(Xa+"Object expected");var t,r,n,o=["precision",1,nf,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<o.length;t+=3)if((n=e[r=o[t]])!==void 0)if(af(n)===n&&n>=o[t+1]&&n<=o[t+2])this[r]=n;else throw Error(uu+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(uu+r+": "+n);return this}var uT=g5(ote);Ta=new uT(1);const Dr=uT;function cte(e){return fte(e)||dte(e)||hte(e)||ute()}function ute(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hte(e,t){if(e){if(typeof e=="string")return x2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x2(e,t)}}function dte(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function fte(e){if(Array.isArray(e))return x2(e)}function x2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var pte=function(t){return t},y5={"@@functional/placeholder":!0},v5=function(t){return t===y5},RM=function(t){return function r(){return arguments.length===0||arguments.length===1&&v5(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},mte=function e(t,r){return t===1?r:RM(function(){for(var n=arguments.length,o=new Array(n),h=0;h<n;h++)o[h]=arguments[h];var d=o.filter(function(s){return s!==y5}).length;return d>=t?r.apply(void 0,o):e(t-d,RM(function(){for(var s=arguments.length,y=new Array(s),w=0;w<s;w++)y[w]=arguments[w];var k=o.map(function(E){return v5(E)?y.shift():E});return r.apply(void 0,cte(k).concat(y))}))})},tx=function(t){return mte(t.length,t)},b2=function(t,r){for(var n=[],o=t;o<r;++o)n[o-t]=o;return n},gte=tx(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),yte=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return pte;var o=r.reverse(),h=o[0],d=o.slice(1);return function(){return d.reduce(function(s,y){return y(s)},h.apply(void 0,arguments))}},w2=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},_5=function(t){var r=null,n=null;return function(){for(var o=arguments.length,h=new Array(o),d=0;d<o;d++)h[d]=arguments[d];return r&&h.every(function(s,y){return s===r[y]})||(r=h,n=t.apply(void 0,h)),n}};function vte(e){var t;return e===0?t=1:t=Math.floor(new Dr(e).abs().log(10).toNumber())+1,t}function _te(e,t,r){for(var n=new Dr(e),o=0,h=[];n.lt(t)&&o<1e5;)h.push(n.toNumber()),n=n.add(r),o++;return h}var xte=tx(function(e,t,r){var n=+e,o=+t;return n+r*(o-n)}),bte=tx(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),wte=tx(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const rx={rangeStep:_te,getDigitCount:vte,interpolateNumber:xte,uninterpolateNumber:bte,uninterpolateTruncation:wte};function S2(e){return Tte(e)||Pte(e)||x5(e)||Ste()}function Ste(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pte(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Tte(e){if(Array.isArray(e))return P2(e)}function Gm(e,t){return Ate(e)||Ete(e,t)||x5(e,t)||kte()}function kte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x5(e,t){if(e){if(typeof e=="string")return P2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P2(e,t)}}function P2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ete(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,o=!1,h=void 0;try{for(var d=e[Symbol.iterator](),s;!(n=(s=d.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(y){o=!0,h=y}finally{try{!n&&d.return!=null&&d.return()}finally{if(o)throw h}}return r}}function Ate(e){if(Array.isArray(e))return e}function b5(e){var t=Gm(e,2),r=t[0],n=t[1],o=r,h=n;return r>n&&(o=n,h=r),[o,h]}function w5(e,t,r){if(e.lte(0))return new Dr(0);var n=rx.getDigitCount(e.toNumber()),o=new Dr(10).pow(n),h=e.div(o),d=n!==1?.05:.1,s=new Dr(Math.ceil(h.div(d).toNumber())).add(r).mul(d),y=s.mul(o);return t?y:new Dr(Math.ceil(y))}function Cte(e,t,r){var n=1,o=new Dr(e);if(!o.isint()&&r){var h=Math.abs(e);h<1?(n=new Dr(10).pow(rx.getDigitCount(e)-1),o=new Dr(Math.floor(o.div(n).toNumber())).mul(n)):h>1&&(o=new Dr(Math.floor(e)))}else e===0?o=new Dr(Math.floor((t-1)/2)):r||(o=new Dr(Math.floor(e)));var d=Math.floor((t-1)/2),s=yte(gte(function(y){return o.add(new Dr(y-d).mul(n)).toNumber()}),b2);return s(0,t)}function S5(e,t,r,n){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Dr(0),tickMin:new Dr(0),tickMax:new Dr(0)};var h=w5(new Dr(t).sub(e).div(r-1),n,o),d;e<=0&&t>=0?d=new Dr(0):(d=new Dr(e).add(t).div(2),d=d.sub(new Dr(d).mod(h)));var s=Math.ceil(d.sub(e).div(h).toNumber()),y=Math.ceil(new Dr(t).sub(d).div(h).toNumber()),w=s+y+1;return w>r?S5(e,t,r,n,o+1):(w<r&&(y=t>0?y+(r-w):y,s=t>0?s:s+(r-w)),{step:h,tickMin:d.sub(new Dr(s).mul(h)),tickMax:d.add(new Dr(y).mul(h))})}function Mte(e){var t=Gm(e,2),r=t[0],n=t[1],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=Math.max(o,2),s=b5([r,n]),y=Gm(s,2),w=y[0],k=y[1];if(w===-1/0||k===1/0){var E=k===1/0?[w].concat(S2(b2(0,o-1).map(function(){return 1/0}))):[].concat(S2(b2(0,o-1).map(function(){return-1/0})),[k]);return r>n?w2(E):E}if(w===k)return Cte(w,o,h);var I=S5(w,k,d,h),j=I.step,z=I.tickMin,L=I.tickMax,q=rx.rangeStep(z,L.add(new Dr(.1).mul(j)),j);return r>n?w2(q):q}function Ite(e,t){var r=Gm(e,2),n=r[0],o=r[1],h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=b5([n,o]),s=Gm(d,2),y=s[0],w=s[1];if(y===-1/0||w===1/0)return[n,o];if(y===w)return[y];var k=Math.max(t,2),E=w5(new Dr(w).sub(y).div(k-1),h,0),I=[].concat(S2(rx.rangeStep(new Dr(y),new Dr(w).sub(new Dr(.99).mul(E)),E)),[w]);return n>o?w2(I):I}var jte=_5(Mte),Ote=_5(Ite),Dte=!0,k1="Invariant failed";function xu(e,t){if(!e){if(Dte)throw new Error(k1);var r=typeof t=="function"?t():t,n=r?"".concat(k1,": ").concat(r):k1;throw new Error(n)}}var Rte=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Id(e){"@babel/helpers - typeof";return Id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(e)}function Nv(){return Nv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nv.apply(this,arguments)}function Nte(e,t){return Bte(e)||Lte(e,t)||zte(e,t)||$te()}function $te(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zte(e,t){if(e){if(typeof e=="string")return NM(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NM(e,t)}}function NM(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lte(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,h,d,s=[],y=!0,w=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;y=!1}else for(;!(y=(n=h.call(r)).done)&&(s.push(n.value),s.length!==t);y=!0);}catch(k){w=!0,o=k}finally{try{if(!y&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return s}}function Bte(e){if(Array.isArray(e))return e}function Fte(e,t){if(e==null)return{};var r=Ute(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ute(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Vte(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k5(n.key),n)}}function Gte(e,t,r){return t&&$M(e.prototype,t),r&&$M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qte(e,t,r){return t=$v(t),Wte(e,P5()?Reflect.construct(t,r||[],$v(e).constructor):t.apply(e,r))}function Wte(e,t){if(t&&(Id(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hte(e)}function Hte(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P5(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(P5=function(){return!!e})()}function $v(e){return $v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$v(e)}function Zte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T2(e,t)}function T2(e,t){return T2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},T2(e,t)}function T5(e,t,r){return t=k5(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k5(e){var t=Kte(e,"string");return Id(t)=="symbol"?t:t+""}function Kte(e,t){if(Id(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Id(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nx=function(e){function t(){return Vte(this,t),qte(this,t,arguments)}return Zte(t,e),Gte(t,[{key:"render",value:function(){var n=this.props,o=n.offset,h=n.layout,d=n.width,s=n.dataKey,y=n.data,w=n.dataPointFormatter,k=n.xAxis,E=n.yAxis,I=Fte(n,Rte),j=br(I,!1);this.props.direction==="x"&&k.type!=="number"&&xu(!1);var z=y.map(function(L){var q=w(L,s),F=q.x,U=q.y,N=q.value,W=q.errorVal;if(!W)return null;var H=[],Z,re;if(Array.isArray(W)){var he=Nte(W,2);Z=he[0],re=he[1]}else Z=re=W;if(h==="vertical"){var we=k.scale,Oe=U+o,Me=Oe+d,Se=Oe-d,Ue=we(N-Z),We=we(N+re);H.push({x1:We,y1:Me,x2:We,y2:Se}),H.push({x1:Ue,y1:Oe,x2:We,y2:Oe}),H.push({x1:Ue,y1:Me,x2:Ue,y2:Se})}else if(h==="horizontal"){var qe=E.scale,Je=F+o,rt=Je-d,Le=Je+d,Be=qe(N-Z),nt=qe(N+re);H.push({x1:rt,y1:nt,x2:Le,y2:nt}),H.push({x1:Je,y1:Be,x2:Je,y2:nt}),H.push({x1:rt,y1:Be,x2:Le,y2:Be})}return Ie.createElement(ai,Nv({className:"recharts-errorBar",key:"bar-".concat(H.map(function(Xe){return"".concat(Xe.x1,"-").concat(Xe.x2,"-").concat(Xe.y1,"-").concat(Xe.y2)}))},j),H.map(function(Xe){return Ie.createElement("line",Nv({},Xe,{key:"line-".concat(Xe.x1,"-").concat(Xe.x2,"-").concat(Xe.y1,"-").concat(Xe.y2)}))}))});return Ie.createElement(ai,{className:"recharts-errorBars"},z)}}])}(Ie.Component);T5(nx,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});T5(nx,"displayName","ErrorBar");function qm(e){"@babel/helpers - typeof";return qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qm(e)}function zM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Gc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zM(Object(r),!0).forEach(function(n){Xte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xte(e,t,r){return t=Yte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yte(e){var t=Jte(e,"string");return qm(t)=="symbol"?t:t+""}function Jte(e,t){if(qm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E5=function(t){var r=t.children,n=t.formattedGraphicalItems,o=t.legendWidth,h=t.legendContent,d=Pa(r,dd);if(!d)return null;var s=dd.defaultProps,y=s!==void 0?Gc(Gc({},s),d.props):{},w;return d.props&&d.props.payload?w=d.props&&d.props.payload:h==="children"?w=(n||[]).reduce(function(k,E){var I=E.item,j=E.props,z=j.sectors||j.data||[];return k.concat(z.map(function(L){return{type:d.props.iconType||I.props.legendType,value:L.name,color:L.fill,payload:L}}))},[]):w=(n||[]).map(function(k){var E=k.item,I=E.type.defaultProps,j=I!==void 0?Gc(Gc({},I),E.props):{},z=j.dataKey,L=j.name,q=j.legendType,F=j.hide;return{inactive:F,dataKey:z,type:y.iconType||q||"square",color:hT(E),value:L||z,payload:j}}),Gc(Gc(Gc({},y),dd.getWithHeight(d,o)),{},{payload:w,item:d})};function Wm(e){"@babel/helpers - typeof";return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wm(e)}function LM(e){return rre(e)||tre(e)||ere(e)||Qte()}function Qte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ere(e,t){if(e){if(typeof e=="string")return k2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k2(e,t)}}function tre(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rre(e){if(Array.isArray(e))return k2(e)}function k2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function gn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BM(Object(r),!0).forEach(function(n){pd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pd(e,t,r){return t=nre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nre(e){var t=ire(e,"string");return Wm(t)=="symbol"?t:t+""}function ire(e,t){if(Wm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function es(e,t,r){return Sr(e)||Sr(t)?r:Zn(t)?Ha(e,t,r):ar(t)?t(e):r}function om(e,t,r,n){var o=rte(e,function(s){return es(s,t)});if(r==="number"){var h=o.filter(function(s){return vt(s)||parseFloat(s)});return h.length?[ex(h),Q_(h)]:[1/0,-1/0]}var d=n?o.filter(function(s){return!Sr(s)}):o;return d.map(function(s){return Zn(s)||s instanceof Date?s:""})}var are=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0,h=arguments.length>3?arguments[3]:void 0,d=-1,s=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(s<=1)return 0;if(h&&h.axisType==="angleAxis"&&Math.abs(Math.abs(h.range[1]-h.range[0])-360)<=1e-6)for(var y=h.range,w=0;w<s;w++){var k=w>0?o[w-1].coordinate:o[s-1].coordinate,E=o[w].coordinate,I=w>=s-1?o[0].coordinate:o[w+1].coordinate,j=void 0;if(bo(E-k)!==bo(I-E)){var z=[];if(bo(I-E)===bo(y[1]-y[0])){j=I;var L=E+y[1]-y[0];z[0]=Math.min(L,(L+k)/2),z[1]=Math.max(L,(L+k)/2)}else{j=k;var q=I+y[1]-y[0];z[0]=Math.min(E,(q+E)/2),z[1]=Math.max(E,(q+E)/2)}var F=[Math.min(E,(j+E)/2),Math.max(E,(j+E)/2)];if(t>F[0]&&t<=F[1]||t>=z[0]&&t<=z[1]){d=o[w].index;break}}else{var U=Math.min(k,I),N=Math.max(k,I);if(t>(U+E)/2&&t<=(N+E)/2){d=o[w].index;break}}}else for(var W=0;W<s;W++)if(W===0&&t<=(n[W].coordinate+n[W+1].coordinate)/2||W>0&&W<s-1&&t>(n[W].coordinate+n[W-1].coordinate)/2&&t<=(n[W].coordinate+n[W+1].coordinate)/2||W===s-1&&t>(n[W].coordinate+n[W-1].coordinate)/2){d=n[W].index;break}return d},hT=function(t){var r,n=t,o=n.type.displayName,h=(r=t.type)!==null&&r!==void 0&&r.defaultProps?gn(gn({},t.type.defaultProps),t.props):t.props,d=h.stroke,s=h.fill,y;switch(o){case"Line":y=d;break;case"Area":case"Radar":y=d&&d!=="none"?d:s;break;default:y=s;break}return y},ore=function(t){var r=t.barSize,n=t.totalSize,o=t.stackGroups,h=o===void 0?{}:o;if(!h)return{};for(var d={},s=Object.keys(h),y=0,w=s.length;y<w;y++)for(var k=h[s[y]].stackGroups,E=Object.keys(k),I=0,j=E.length;I<j;I++){var z=k[E[I]],L=z.items,q=z.cateAxisId,F=L.filter(function(re){return $s(re.type).indexOf("Bar")>=0});if(F&&F.length){var U=F[0].type.defaultProps,N=U!==void 0?gn(gn({},U),F[0].props):F[0].props,W=N.barSize,H=N[q];d[H]||(d[H]=[]);var Z=Sr(W)?r:W;d[H].push({item:F[0],stackList:F.slice(1),barSize:Sr(Z)?void 0:vu(Z,n,0)})}}return d},sre=function(t){var r=t.barGap,n=t.barCategoryGap,o=t.bandSize,h=t.sizeList,d=h===void 0?[]:h,s=t.maxBarSize,y=d.length;if(y<1)return null;var w=vu(r,o,0,!0),k,E=[];if(d[0].barSize===+d[0].barSize){var I=!1,j=o/y,z=d.reduce(function(W,H){return W+H.barSize||0},0);z+=(y-1)*w,z>=o&&(z-=(y-1)*w,w=0),z>=o&&j>0&&(I=!0,j*=.9,z=y*j);var L=(o-z)/2>>0,q={offset:L-w,size:0};k=d.reduce(function(W,H){var Z={item:H.item,position:{offset:q.offset+q.size+w,size:I?j:H.barSize}},re=[].concat(LM(W),[Z]);return q=re[re.length-1].position,H.stackList&&H.stackList.length&&H.stackList.forEach(function(he){re.push({item:he,position:q})}),re},E)}else{var F=vu(n,o,0,!0);o-2*F-(y-1)*w<=0&&(w=0);var U=(o-2*F-(y-1)*w)/y;U>1&&(U>>=0);var N=s===+s?Math.min(U,s):U;k=d.reduce(function(W,H,Z){var re=[].concat(LM(W),[{item:H.item,position:{offset:F+(U+w)*Z+(U-N)/2,size:N}}]);return H.stackList&&H.stackList.length&&H.stackList.forEach(function(he){re.push({item:he,position:re[re.length-1].position})}),re},E)}return k},lre=function(t,r,n,o){var h=n.children,d=n.width,s=n.margin,y=d-(s.left||0)-(s.right||0),w=E5({children:h,legendWidth:y});if(w){var k=o||{},E=k.width,I=k.height,j=w.align,z=w.verticalAlign,L=w.layout;if((L==="vertical"||L==="horizontal"&&z==="middle")&&j!=="center"&&vt(t[j]))return gn(gn({},t),{},pd({},j,t[j]+(E||0)));if((L==="horizontal"||L==="vertical"&&j==="center")&&z!=="middle"&&vt(t[z]))return gn(gn({},t),{},pd({},z,t[z]+(I||0)))}return t},cre=function(t,r,n){return Sr(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},A5=function(t,r,n,o,h){var d=r.props.children,s=Po(d,nx).filter(function(w){return cre(o,h,w.props.direction)});if(s&&s.length){var y=s.map(function(w){return w.props.dataKey});return t.reduce(function(w,k){var E=es(k,n);if(Sr(E))return w;var I=Array.isArray(E)?[ex(E),Q_(E)]:[E,E],j=y.reduce(function(z,L){var q=es(k,L,0),F=I[0]-Math.abs(Array.isArray(q)?q[0]:q),U=I[1]+Math.abs(Array.isArray(q)?q[1]:q);return[Math.min(F,z[0]),Math.max(U,z[1])]},[1/0,-1/0]);return[Math.min(j[0],w[0]),Math.max(j[1],w[1])]},[1/0,-1/0])}return null},ure=function(t,r,n,o,h){var d=r.map(function(s){return A5(t,s,n,h,o)}).filter(function(s){return!Sr(s)});return d&&d.length?d.reduce(function(s,y){return[Math.min(s[0],y[0]),Math.max(s[1],y[1])]},[1/0,-1/0]):null},C5=function(t,r,n,o,h){var d=r.map(function(y){var w=y.props.dataKey;return n==="number"&&w&&A5(t,y,w,o)||om(t,w,n,h)});if(n==="number")return d.reduce(function(y,w){return[Math.min(y[0],w[0]),Math.max(y[1],w[1])]},[1/0,-1/0]);var s={};return d.reduce(function(y,w){for(var k=0,E=w.length;k<E;k++)s[w[k]]||(s[w[k]]=!0,y.push(w[k]));return y},[])},M5=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},I5=function(t,r,n,o){if(o)return t.map(function(y){return y.coordinate});var h,d,s=t.map(function(y){return y.coordinate===r&&(h=!0),y.coordinate===n&&(d=!0),y.coordinate});return h||s.push(r),d||s.push(n),s},Rs=function(t,r,n){if(!t)return null;var o=t.scale,h=t.duplicateDomain,d=t.type,s=t.range,y=t.realScaleType==="scaleBand"?o.bandwidth()/2:2,w=(r||n)&&d==="category"&&o.bandwidth?o.bandwidth()/y:0;if(w=t.axisType==="angleAxis"&&(s==null?void 0:s.length)>=2?bo(s[0]-s[1])*2*w:w,r&&(t.ticks||t.niceTicks)){var k=(t.ticks||t.niceTicks).map(function(E){var I=h?h.indexOf(E):E;return{coordinate:o(I)+w,value:E,offset:w}});return k.filter(function(E){return!xg(E.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(E,I){return{coordinate:o(E)+w,value:E,index:I,offset:w}}):o.ticks&&!n?o.ticks(t.tickCount).map(function(E){return{coordinate:o(E)+w,value:E,offset:w}}):o.domain().map(function(E,I){return{coordinate:o(E)+w,value:h?h[E]:E,index:I,offset:w}})},E1=new WeakMap,m0=function(t,r){if(typeof r!="function")return t;E1.has(t)||E1.set(t,new WeakMap);var n=E1.get(t);if(n.has(r))return n.get(r);var o=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,o),o},hre=function(t,r,n){var o=t.scale,h=t.type,d=t.layout,s=t.axisType;if(o==="auto")return d==="radial"&&s==="radiusAxis"?{scale:zm(),realScaleType:"band"}:d==="radial"&&s==="angleAxis"?{scale:Iv(),realScaleType:"linear"}:h==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:am(),realScaleType:"point"}:h==="category"?{scale:zm(),realScaleType:"band"}:{scale:Iv(),realScaleType:"linear"};if(yu(o)){var y="scale".concat(B_(o));return{scale:(jM[y]||am)(),realScaleType:jM[y]?y:"point"}}return ar(o)?{scale:o}:{scale:am(),realScaleType:"point"}},FM=1e-4,dre=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,o=t.range(),h=Math.min(o[0],o[1])-FM,d=Math.max(o[0],o[1])+FM,s=t(r[0]),y=t(r[n-1]);(s<h||s>d||y<h||y>d)&&t.domain([r[0],r[n-1]])}},fre=function(t,r){if(!t)return null;for(var n=0,o=t.length;n<o;n++)if(t[n].item===r)return t[n].position;return null},pre=function(t,r){if(!r||r.length!==2||!vt(r[0])||!vt(r[1]))return t;var n=Math.min(r[0],r[1]),o=Math.max(r[0],r[1]),h=[t[0],t[1]];return(!vt(t[0])||t[0]<n)&&(h[0]=n),(!vt(t[1])||t[1]>o)&&(h[1]=o),h[0]>o&&(h[0]=o),h[1]<n&&(h[1]=n),h},mre=function(t){var r=t.length;if(!(r<=0))for(var n=0,o=t[0].length;n<o;++n)for(var h=0,d=0,s=0;s<r;++s){var y=xg(t[s][n][1])?t[s][n][0]:t[s][n][1];y>=0?(t[s][n][0]=h,t[s][n][1]=h+y,h=t[s][n][1]):(t[s][n][0]=d,t[s][n][1]=d+y,d=t[s][n][1])}},gre=function(t){var r=t.length;if(!(r<=0))for(var n=0,o=t[0].length;n<o;++n)for(var h=0,d=0;d<r;++d){var s=xg(t[d][n][1])?t[d][n][0]:t[d][n][1];s>=0?(t[d][n][0]=h,t[d][n][1]=h+s,h=t[d][n][1]):(t[d][n][0]=0,t[d][n][1]=0)}},yre={sign:mre,expand:R9,none:Sd,silhouette:N9,wiggle:$9,positive:gre},vre=function(t,r,n){var o=r.map(function(s){return s.props.dataKey}),h=yre[n],d=D9().keys(o).value(function(s,y){return+es(s,y,0)}).order(Yw).offset(h);return d(t)},_re=function(t,r,n,o,h,d){if(!t)return null;var s=d?r.reverse():r,y={},w=s.reduce(function(E,I){var j,z=(j=I.type)!==null&&j!==void 0&&j.defaultProps?gn(gn({},I.type.defaultProps),I.props):I.props,L=z.stackId,q=z.hide;if(q)return E;var F=z[n],U=E[F]||{hasStack:!1,stackGroups:{}};if(Zn(L)){var N=U.stackGroups[L]||{numericAxisId:n,cateAxisId:o,items:[]};N.items.push(I),U.hasStack=!0,U.stackGroups[L]=N}else U.stackGroups[L_("_stackId_")]={numericAxisId:n,cateAxisId:o,items:[I]};return gn(gn({},E),{},pd({},F,U))},y),k={};return Object.keys(w).reduce(function(E,I){var j=w[I];if(j.hasStack){var z={};j.stackGroups=Object.keys(j.stackGroups).reduce(function(L,q){var F=j.stackGroups[q];return gn(gn({},L),{},pd({},q,{numericAxisId:n,cateAxisId:o,items:F.items,stackedData:vre(t,F.items,h)}))},z)}return gn(gn({},E),{},pd({},I,j))},k)},xre=function(t,r){var n=r.realScaleType,o=r.type,h=r.tickCount,d=r.originalDomain,s=r.allowDecimals,y=n||r.scale;if(y!=="auto"&&y!=="linear")return null;if(h&&o==="number"&&d&&(d[0]==="auto"||d[1]==="auto")){var w=t.domain();if(!w.length)return null;var k=jte(w,h,s);return t.domain([ex(k),Q_(k)]),{niceTicks:k}}if(h&&o==="number"){var E=t.domain(),I=Ote(E,h,s);return{niceTicks:I}}return null},UM=function(t){var r=t.axis,n=t.ticks,o=t.offset,h=t.bandSize,d=t.entry,s=t.index;if(r.type==="category")return n[s]?n[s].coordinate+o:null;var y=es(d,r.dataKey,r.domain[s]);return Sr(y)?null:r.scale(y)-h/2+o},bre=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var o=Math.min(n[0],n[1]),h=Math.max(n[0],n[1]);return o<=0&&h>=0?0:h<0?h:o}return n[0]},wre=function(t,r){var n,o=(n=t.type)!==null&&n!==void 0&&n.defaultProps?gn(gn({},t.type.defaultProps),t.props):t.props,h=o.stackId;if(Zn(h)){var d=r[h];if(d){var s=d.items.indexOf(t);return s>=0?d.stackedData[s]:null}}return null},Sre=function(t){return t.reduce(function(r,n){return[ex(n.concat([r[0]]).filter(vt)),Q_(n.concat([r[1]]).filter(vt))]},[1/0,-1/0])},j5=function(t,r,n){return Object.keys(t).reduce(function(o,h){var d=t[h],s=d.stackedData,y=s.reduce(function(w,k){var E=Sre(k.slice(r,n+1));return[Math.min(w[0],E[0]),Math.max(w[1],E[1])]},[1/0,-1/0]);return[Math.min(y[0],o[0]),Math.max(y[1],o[1])]},[1/0,-1/0]).map(function(o){return o===1/0||o===-1/0?0:o})},VM=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,GM=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,E2=function(t,r,n){if(ar(t))return t(r,n);if(!Array.isArray(t))return r;var o=[];if(vt(t[0]))o[0]=n?t[0]:Math.min(t[0],r[0]);else if(VM.test(t[0])){var h=+VM.exec(t[0])[1];o[0]=r[0]-h}else ar(t[0])?o[0]=t[0](r[0]):o[0]=r[0];if(vt(t[1]))o[1]=n?t[1]:Math.max(t[1],r[1]);else if(GM.test(t[1])){var d=+GM.exec(t[1])[1];o[1]=r[1]+d}else ar(t[1])?o[1]=t[1](r[1]):o[1]=r[1];return o},zv=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var o=t.scale.bandwidth();if(!n||o>0)return o}if(t&&r&&r.length>=2){for(var h=zP(r,function(E){return E.coordinate}),d=1/0,s=1,y=h.length;s<y;s++){var w=h[s],k=h[s-1];d=Math.min((w.coordinate||0)-(k.coordinate||0),d)}return d===1/0?0:d}return n?void 0:0},qM=function(t,r,n){return!t||!t.length||lT(t,Ha(n,"type.defaultProps.domain"))?r:t},O5=function(t,r){var n=t.type.defaultProps?gn(gn({},t.type.defaultProps),t.props):t.props,o=n.dataKey,h=n.name,d=n.unit,s=n.formatter,y=n.tooltipType,w=n.chartType,k=n.hide;return gn(gn({},br(t,!1)),{},{dataKey:o,unit:d,formatter:s,name:h||o,color:hT(t),value:es(r,o),type:y,payload:r,chartType:w,hide:k})};function Hm(e){"@babel/helpers - typeof";return Hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hm(e)}function WM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function HM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WM(Object(r),!0).forEach(function(n){Pre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pre(e,t,r){return t=Tre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tre(e){var t=kre(e,"string");return Hm(t)=="symbol"?t:t+""}function kre(e,t){if(Hm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lv=Math.PI/180,Ere=function(t){return t*180/Math.PI},vi=function(t,r,n,o){return{x:t+Math.cos(-Lv*o)*n,y:r+Math.sin(-Lv*o)*n}},Are=function(t,r){var n=t.x,o=t.y,h=r.x,d=r.y;return Math.sqrt(Math.pow(n-h,2)+Math.pow(o-d,2))},Cre=function(t,r){var n=t.x,o=t.y,h=r.cx,d=r.cy,s=Are({x:n,y:o},{x:h,y:d});if(s<=0)return{radius:s};var y=(n-h)/s,w=Math.acos(y);return o>d&&(w=2*Math.PI-w),{radius:s,angle:Ere(w),angleInRadian:w}},Mre=function(t){var r=t.startAngle,n=t.endAngle,o=Math.floor(r/360),h=Math.floor(n/360),d=Math.min(o,h);return{startAngle:r-d*360,endAngle:n-d*360}},Ire=function(t,r){var n=r.startAngle,o=r.endAngle,h=Math.floor(n/360),d=Math.floor(o/360),s=Math.min(h,d);return t+s*360},ZM=function(t,r){var n=t.x,o=t.y,h=Cre({x:n,y:o},r),d=h.radius,s=h.angle,y=r.innerRadius,w=r.outerRadius;if(d<y||d>w)return!1;if(d===0)return!0;var k=Mre(r),E=k.startAngle,I=k.endAngle,j=s,z;if(E<=I){for(;j>I;)j-=360;for(;j<E;)j+=360;z=j>=E&&j<=I}else{for(;j>E;)j-=360;for(;j<I;)j+=360;z=j>=I&&j<=E}return z?HM(HM({},r),{},{radius:d,angle:Ire(j,r)}):null};function Zm(e){"@babel/helpers - typeof";return Zm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zm(e)}var jre=["offset"];function Ore(e){return $re(e)||Nre(e)||Rre(e)||Dre()}function Dre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rre(e,t){if(e){if(typeof e=="string")return A2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A2(e,t)}}function Nre(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $re(e){if(Array.isArray(e))return A2(e)}function A2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zre(e,t){if(e==null)return{};var r=Lre(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Lre(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function KM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Vn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KM(Object(r),!0).forEach(function(n){Bre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bre(e,t,r){return t=Fre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fre(e){var t=Ure(e,"string");return Zm(t)=="symbol"?t:t+""}function Ure(e,t){if(Zm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Km(){return Km=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Km.apply(this,arguments)}var Vre=function(t){var r=t.value,n=t.formatter,o=Sr(t.children)?r:t.children;return ar(n)?n(o):o},Gre=function(t,r){var n=bo(r-t),o=Math.min(Math.abs(r-t),360);return n*o},qre=function(t,r,n){var o=t.position,h=t.viewBox,d=t.offset,s=t.className,y=h,w=y.cx,k=y.cy,E=y.innerRadius,I=y.outerRadius,j=y.startAngle,z=y.endAngle,L=y.clockWise,q=(E+I)/2,F=Gre(j,z),U=F>=0?1:-1,N,W;o==="insideStart"?(N=j+U*d,W=L):o==="insideEnd"?(N=z-U*d,W=!L):o==="end"&&(N=z+U*d,W=L),W=F<=0?W:!W;var H=vi(w,k,q,N),Z=vi(w,k,q,N+(W?1:-1)*359),re="M".concat(H.x,",").concat(H.y,`
    A`).concat(q,",").concat(q,",0,1,").concat(W?0:1,`,
    `).concat(Z.x,",").concat(Z.y),he=Sr(t.id)?L_("recharts-radial-line-"):t.id;return Ie.createElement("text",Km({},n,{dominantBaseline:"central",className:wr("recharts-radial-bar-label",s)}),Ie.createElement("defs",null,Ie.createElement("path",{id:he,d:re})),Ie.createElement("textPath",{xlinkHref:"#".concat(he)},r))},Wre=function(t){var r=t.viewBox,n=t.offset,o=t.position,h=r,d=h.cx,s=h.cy,y=h.innerRadius,w=h.outerRadius,k=h.startAngle,E=h.endAngle,I=(k+E)/2;if(o==="outside"){var j=vi(d,s,w+n,I),z=j.x,L=j.y;return{x:z,y:L,textAnchor:z>=d?"start":"end",verticalAnchor:"middle"}}if(o==="center")return{x:d,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(o==="centerTop")return{x:d,y:s,textAnchor:"middle",verticalAnchor:"start"};if(o==="centerBottom")return{x:d,y:s,textAnchor:"middle",verticalAnchor:"end"};var q=(y+w)/2,F=vi(d,s,q,I),U=F.x,N=F.y;return{x:U,y:N,textAnchor:"middle",verticalAnchor:"middle"}},Hre=function(t){var r=t.viewBox,n=t.parentViewBox,o=t.offset,h=t.position,d=r,s=d.x,y=d.y,w=d.width,k=d.height,E=k>=0?1:-1,I=E*o,j=E>0?"end":"start",z=E>0?"start":"end",L=w>=0?1:-1,q=L*o,F=L>0?"end":"start",U=L>0?"start":"end";if(h==="top"){var N={x:s+w/2,y:y-E*o,textAnchor:"middle",verticalAnchor:j};return Vn(Vn({},N),n?{height:Math.max(y-n.y,0),width:w}:{})}if(h==="bottom"){var W={x:s+w/2,y:y+k+I,textAnchor:"middle",verticalAnchor:z};return Vn(Vn({},W),n?{height:Math.max(n.y+n.height-(y+k),0),width:w}:{})}if(h==="left"){var H={x:s-q,y:y+k/2,textAnchor:F,verticalAnchor:"middle"};return Vn(Vn({},H),n?{width:Math.max(H.x-n.x,0),height:k}:{})}if(h==="right"){var Z={x:s+w+q,y:y+k/2,textAnchor:U,verticalAnchor:"middle"};return Vn(Vn({},Z),n?{width:Math.max(n.x+n.width-Z.x,0),height:k}:{})}var re=n?{width:w,height:k}:{};return h==="insideLeft"?Vn({x:s+q,y:y+k/2,textAnchor:U,verticalAnchor:"middle"},re):h==="insideRight"?Vn({x:s+w-q,y:y+k/2,textAnchor:F,verticalAnchor:"middle"},re):h==="insideTop"?Vn({x:s+w/2,y:y+I,textAnchor:"middle",verticalAnchor:z},re):h==="insideBottom"?Vn({x:s+w/2,y:y+k-I,textAnchor:"middle",verticalAnchor:j},re):h==="insideTopLeft"?Vn({x:s+q,y:y+I,textAnchor:U,verticalAnchor:z},re):h==="insideTopRight"?Vn({x:s+w-q,y:y+I,textAnchor:F,verticalAnchor:z},re):h==="insideBottomLeft"?Vn({x:s+q,y:y+k-I,textAnchor:U,verticalAnchor:j},re):h==="insideBottomRight"?Vn({x:s+w-q,y:y+k-I,textAnchor:F,verticalAnchor:j},re):Kd(h)&&(vt(h.x)||nu(h.x))&&(vt(h.y)||nu(h.y))?Vn({x:s+vu(h.x,w),y:y+vu(h.y,k),textAnchor:"end",verticalAnchor:"end"},re):Vn({x:s+w/2,y:y+k/2,textAnchor:"middle",verticalAnchor:"middle"},re)},Zre=function(t){return"cx"in t&&vt(t.cx)};function Mi(e){var t=e.offset,r=t===void 0?5:t,n=zre(e,jre),o=Vn({offset:r},n),h=o.viewBox,d=o.position,s=o.value,y=o.children,w=o.content,k=o.className,E=k===void 0?"":k,I=o.textBreakAll;if(!h||Sr(s)&&Sr(y)&&!be.isValidElement(w)&&!ar(w))return null;if(be.isValidElement(w))return be.cloneElement(w,o);var j;if(ar(w)){if(j=be.createElement(w,o),be.isValidElement(j))return j}else j=Vre(o);var z=Zre(h),L=br(o,!0);if(z&&(d==="insideStart"||d==="insideEnd"||d==="end"))return qre(o,j,L);var q=z?Wre(o):Hre(o);return Ie.createElement(Pv,Km({className:wr("recharts-label",E)},L,q,{breakAll:I}),j)}Mi.displayName="Label";var D5=function(t){var r=t.cx,n=t.cy,o=t.angle,h=t.startAngle,d=t.endAngle,s=t.r,y=t.radius,w=t.innerRadius,k=t.outerRadius,E=t.x,I=t.y,j=t.top,z=t.left,L=t.width,q=t.height,F=t.clockWise,U=t.labelViewBox;if(U)return U;if(vt(L)&&vt(q)){if(vt(E)&&vt(I))return{x:E,y:I,width:L,height:q};if(vt(j)&&vt(z))return{x:j,y:z,width:L,height:q}}return vt(E)&&vt(I)?{x:E,y:I,width:0,height:0}:vt(r)&&vt(n)?{cx:r,cy:n,startAngle:h||o||0,endAngle:d||o||0,innerRadius:w||0,outerRadius:k||y||s||0,clockWise:F}:t.viewBox?t.viewBox:{}},Kre=function(t,r){return t?t===!0?Ie.createElement(Mi,{key:"label-implicit",viewBox:r}):Zn(t)?Ie.createElement(Mi,{key:"label-implicit",viewBox:r,value:t}):be.isValidElement(t)?t.type===Mi?be.cloneElement(t,{key:"label-implicit",viewBox:r}):Ie.createElement(Mi,{key:"label-implicit",content:t,viewBox:r}):ar(t)?Ie.createElement(Mi,{key:"label-implicit",content:t,viewBox:r}):Kd(t)?Ie.createElement(Mi,Km({viewBox:r},t,{key:"label-implicit"})):null:null},Xre=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var o=t.children,h=D5(t),d=Po(o,Mi).map(function(y,w){return be.cloneElement(y,{viewBox:r||h,key:"label-".concat(w)})});if(!n)return d;var s=Kre(t.label,r||h);return[s].concat(Ore(d))};Mi.parseViewBox=D5;Mi.renderCallByParent=Xre;function Yre(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Jre=Yre;const Qre=Rr(Jre);function Xm(e){"@babel/helpers - typeof";return Xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xm(e)}var ene=["valueAccessor"],tne=["data","dataKey","clockWise","id","textBreakAll"];function rne(e){return one(e)||ane(e)||ine(e)||nne()}function nne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ine(e,t){if(e){if(typeof e=="string")return C2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C2(e,t)}}function ane(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function one(e){if(Array.isArray(e))return C2(e)}function C2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bv(){return Bv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bv.apply(this,arguments)}function XM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function YM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XM(Object(r),!0).forEach(function(n){sne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sne(e,t,r){return t=lne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lne(e){var t=cne(e,"string");return Xm(t)=="symbol"?t:t+""}function cne(e,t){if(Xm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JM(e,t){if(e==null)return{};var r=une(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function une(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var hne=function(t){return Array.isArray(t.value)?Qre(t.value):t.value};function hu(e){var t=e.valueAccessor,r=t===void 0?hne:t,n=JM(e,ene),o=n.data,h=n.dataKey,d=n.clockWise,s=n.id,y=n.textBreakAll,w=JM(n,tne);return!o||!o.length?null:Ie.createElement(ai,{className:"recharts-label-list"},o.map(function(k,E){var I=Sr(h)?r(k,E):es(k&&k.payload,h),j=Sr(s)?{}:{id:"".concat(s,"-").concat(E)};return Ie.createElement(Mi,Bv({},br(k,!0),w,j,{parentViewBox:k.parentViewBox,value:I,textBreakAll:y,viewBox:Mi.parseViewBox(Sr(d)?k:YM(YM({},k),{},{clockWise:d})),key:"label-".concat(E),index:E}))}))}hu.displayName="LabelList";function dne(e,t){return e?e===!0?Ie.createElement(hu,{key:"labelList-implicit",data:t}):Ie.isValidElement(e)||ar(e)?Ie.createElement(hu,{key:"labelList-implicit",data:t,content:e}):Kd(e)?Ie.createElement(hu,Bv({data:t},e,{key:"labelList-implicit"})):null:null}function fne(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,o=Po(n,hu).map(function(d,s){return be.cloneElement(d,{data:t,key:"labelList-".concat(s)})});if(!r)return o;var h=dne(e.label,t);return[h].concat(rne(o))}hu.renderCallByParent=fne;function Ym(e){"@babel/helpers - typeof";return Ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ym(e)}function M2(){return M2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M2.apply(this,arguments)}function QM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function eI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QM(Object(r),!0).forEach(function(n){pne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pne(e,t,r){return t=mne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mne(e){var t=gne(e,"string");return Ym(t)=="symbol"?t:t+""}function gne(e,t){if(Ym(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ym(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yne=function(t,r){var n=bo(r-t),o=Math.min(Math.abs(r-t),359.999);return n*o},g0=function(t){var r=t.cx,n=t.cy,o=t.radius,h=t.angle,d=t.sign,s=t.isExternal,y=t.cornerRadius,w=t.cornerIsExternal,k=y*(s?1:-1)+o,E=Math.asin(y/k)/Lv,I=w?h:h+d*E,j=vi(r,n,k,I),z=vi(r,n,o,I),L=w?h-d*E:h,q=vi(r,n,k*Math.cos(E*Lv),L);return{center:j,circleTangency:z,lineTangency:q,theta:E}},R5=function(t){var r=t.cx,n=t.cy,o=t.innerRadius,h=t.outerRadius,d=t.startAngle,s=t.endAngle,y=yne(d,s),w=d+y,k=vi(r,n,h,d),E=vi(r,n,h,w),I="M ".concat(k.x,",").concat(k.y,`
    A `).concat(h,",").concat(h,`,0,
    `).concat(+(Math.abs(y)>180),",").concat(+(d>w),`,
    `).concat(E.x,",").concat(E.y,`
  `);if(o>0){var j=vi(r,n,o,d),z=vi(r,n,o,w);I+="L ".concat(z.x,",").concat(z.y,`
            A `).concat(o,",").concat(o,`,0,
            `).concat(+(Math.abs(y)>180),",").concat(+(d<=w),`,
            `).concat(j.x,",").concat(j.y," Z")}else I+="L ".concat(r,",").concat(n," Z");return I},vne=function(t){var r=t.cx,n=t.cy,o=t.innerRadius,h=t.outerRadius,d=t.cornerRadius,s=t.forceCornerRadius,y=t.cornerIsExternal,w=t.startAngle,k=t.endAngle,E=bo(k-w),I=g0({cx:r,cy:n,radius:h,angle:w,sign:E,cornerRadius:d,cornerIsExternal:y}),j=I.circleTangency,z=I.lineTangency,L=I.theta,q=g0({cx:r,cy:n,radius:h,angle:k,sign:-E,cornerRadius:d,cornerIsExternal:y}),F=q.circleTangency,U=q.lineTangency,N=q.theta,W=y?Math.abs(w-k):Math.abs(w-k)-L-N;if(W<0)return s?"M ".concat(z.x,",").concat(z.y,`
        a`).concat(d,",").concat(d,",0,0,1,").concat(d*2,`,0
        a`).concat(d,",").concat(d,",0,0,1,").concat(-d*2,`,0
      `):R5({cx:r,cy:n,innerRadius:o,outerRadius:h,startAngle:w,endAngle:k});var H="M ".concat(z.x,",").concat(z.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(E<0),",").concat(j.x,",").concat(j.y,`
    A`).concat(h,",").concat(h,",0,").concat(+(W>180),",").concat(+(E<0),",").concat(F.x,",").concat(F.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(E<0),",").concat(U.x,",").concat(U.y,`
  `);if(o>0){var Z=g0({cx:r,cy:n,radius:o,angle:w,sign:E,isExternal:!0,cornerRadius:d,cornerIsExternal:y}),re=Z.circleTangency,he=Z.lineTangency,we=Z.theta,Oe=g0({cx:r,cy:n,radius:o,angle:k,sign:-E,isExternal:!0,cornerRadius:d,cornerIsExternal:y}),Me=Oe.circleTangency,Se=Oe.lineTangency,Ue=Oe.theta,We=y?Math.abs(w-k):Math.abs(w-k)-we-Ue;if(We<0&&d===0)return"".concat(H,"L").concat(r,",").concat(n,"Z");H+="L".concat(Se.x,",").concat(Se.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(E<0),",").concat(Me.x,",").concat(Me.y,`
      A`).concat(o,",").concat(o,",0,").concat(+(We>180),",").concat(+(E>0),",").concat(re.x,",").concat(re.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(E<0),",").concat(he.x,",").concat(he.y,"Z")}else H+="L".concat(r,",").concat(n,"Z");return H},_ne={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},N5=function(t){var r=eI(eI({},_ne),t),n=r.cx,o=r.cy,h=r.innerRadius,d=r.outerRadius,s=r.cornerRadius,y=r.forceCornerRadius,w=r.cornerIsExternal,k=r.startAngle,E=r.endAngle,I=r.className;if(d<h||k===E)return null;var j=wr("recharts-sector",I),z=d-h,L=vu(s,z,0,!0),q;return L>0&&Math.abs(k-E)<360?q=vne({cx:n,cy:o,innerRadius:h,outerRadius:d,cornerRadius:Math.min(L,z/2),forceCornerRadius:y,cornerIsExternal:w,startAngle:k,endAngle:E}):q=R5({cx:n,cy:o,innerRadius:h,outerRadius:d,startAngle:k,endAngle:E}),Ie.createElement("path",M2({},br(r,!0),{className:j,d:q,role:"img"}))};function Jm(e){"@babel/helpers - typeof";return Jm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jm(e)}function I2(){return I2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I2.apply(this,arguments)}function tI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function rI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tI(Object(r),!0).forEach(function(n){xne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xne(e,t,r){return t=bne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bne(e){var t=wne(e,"string");return Jm(t)=="symbol"?t:t+""}function wne(e,t){if(Jm(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nI={curveBasisClosed:S9,curveBasisOpen:P9,curveBasis:w9,curveBumpX:l9,curveBumpY:c9,curveLinearClosed:T9,curveLinear:U_,curveMonotoneX:k9,curveMonotoneY:E9,curveNatural:A9,curveStep:C9,curveStepAfter:I9,curveStepBefore:M9},y0=function(t){return t.x===+t.x&&t.y===+t.y},Np=function(t){return t.x},$p=function(t){return t.y},Sne=function(t,r){if(ar(t))return t;var n="curve".concat(B_(t));return(n==="curveMonotone"||n==="curveBump")&&r?nI["".concat(n).concat(r==="vertical"?"Y":"X")]:nI[n]||U_},Pne=function(t){var r=t.type,n=r===void 0?"linear":r,o=t.points,h=o===void 0?[]:o,d=t.baseLine,s=t.layout,y=t.connectNulls,w=y===void 0?!1:y,k=Sne(n,s),E=w?h.filter(function(L){return y0(L)}):h,I;if(Array.isArray(d)){var j=w?d.filter(function(L){return y0(L)}):d,z=E.map(function(L,q){return rI(rI({},L),{},{base:j[q]})});return s==="vertical"?I=s0().y($p).x1(Np).x0(function(L){return L.base.x}):I=s0().x(Np).y1($p).y0(function(L){return L.base.y}),I.defined(y0).curve(k),I(z)}return s==="vertical"&&vt(d)?I=s0().y($p).x1(Np).x0(d):vt(d)?I=s0().x(Np).y1($p).y0(d):I=RR().x(Np).y($p),I.defined(y0).curve(k),I(E)},iI=function(t){var r=t.className,n=t.points,o=t.path,h=t.pathRef;if((!n||!n.length)&&!o)return null;var d=n&&n.length?Pne(t):o;return be.createElement("path",I2({},br(t,!1),cv(t),{className:wr("recharts-curve",r),d,ref:h}))},$5={exports:{}},Tne="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",kne=Tne,Ene=kne;function z5(){}function L5(){}L5.resetWarningCache=z5;var Ane=function(){function e(n,o,h,d,s,y){if(y!==Ene){var w=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw w.name="Invariant Violation",w}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:L5,resetWarningCache:z5};return r.PropTypes=r,r};$5.exports=Ane();var Cne=$5.exports;const Er=Rr(Cne);var Mne=Object.getOwnPropertyNames,Ine=Object.getOwnPropertySymbols,jne=Object.prototype.hasOwnProperty;function aI(e,t){return function(n,o,h){return e(n,o,h)&&t(n,o,h)}}function v0(e){return function(r,n,o){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,o);var h=o.cache,d=h.get(r),s=h.get(n);if(d&&s)return d===n&&s===r;h.set(r,n),h.set(n,r);var y=e(r,n,o);return h.delete(r),h.delete(n),y}}function oI(e){return Mne(e).concat(Ine(e))}var One=Object.hasOwn||function(e,t){return jne.call(e,t)};function Eu(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Dne="__v",Rne="__o",Nne="_owner",sI=Object.getOwnPropertyDescriptor,lI=Object.keys;function $ne(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function zne(e,t){return Eu(e.getTime(),t.getTime())}function Lne(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Bne(e,t){return e===t}function cI(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var o=new Array(n),h=e.entries(),d,s,y=0;(d=h.next())&&!d.done;){for(var w=t.entries(),k=!1,E=0;(s=w.next())&&!s.done;){if(o[E]){E++;continue}var I=d.value,j=s.value;if(r.equals(I[0],j[0],y,E,e,t,r)&&r.equals(I[1],j[1],I[0],j[0],e,t,r)){k=o[E]=!0;break}E++}if(!k)return!1;y++}return!0}var Fne=Eu;function Une(e,t,r){var n=lI(e),o=n.length;if(lI(t).length!==o)return!1;for(;o-- >0;)if(!B5(e,t,r,n[o]))return!1;return!0}function zp(e,t,r){var n=oI(e),o=n.length;if(oI(t).length!==o)return!1;for(var h,d,s;o-- >0;)if(h=n[o],!B5(e,t,r,h)||(d=sI(e,h),s=sI(t,h),(d||s)&&(!d||!s||d.configurable!==s.configurable||d.enumerable!==s.enumerable||d.writable!==s.writable)))return!1;return!0}function Vne(e,t){return Eu(e.valueOf(),t.valueOf())}function Gne(e,t){return e.source===t.source&&e.flags===t.flags}function uI(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var o=new Array(n),h=e.values(),d,s;(d=h.next())&&!d.done;){for(var y=t.values(),w=!1,k=0;(s=y.next())&&!s.done;){if(!o[k]&&r.equals(d.value,s.value,d.value,s.value,e,t,r)){w=o[k]=!0;break}k++}if(!w)return!1}return!0}function qne(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function Wne(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function B5(e,t,r,n){return(n===Nne||n===Rne||n===Dne)&&(e.$$typeof||t.$$typeof)?!0:One(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var Hne="[object Arguments]",Zne="[object Boolean]",Kne="[object Date]",Xne="[object Error]",Yne="[object Map]",Jne="[object Number]",Qne="[object Object]",eie="[object RegExp]",tie="[object Set]",rie="[object String]",nie="[object URL]",iie=Array.isArray,hI=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,dI=Object.assign,aie=Object.prototype.toString.call.bind(Object.prototype.toString);function oie(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,o=e.areFunctionsEqual,h=e.areMapsEqual,d=e.areNumbersEqual,s=e.areObjectsEqual,y=e.arePrimitiveWrappersEqual,w=e.areRegExpsEqual,k=e.areSetsEqual,E=e.areTypedArraysEqual,I=e.areUrlsEqual;return function(z,L,q){if(z===L)return!0;if(z==null||L==null)return!1;var F=typeof z;if(F!==typeof L)return!1;if(F!=="object")return F==="number"?d(z,L,q):F==="function"?o(z,L,q):!1;var U=z.constructor;if(U!==L.constructor)return!1;if(U===Object)return s(z,L,q);if(iie(z))return t(z,L,q);if(hI!=null&&hI(z))return E(z,L,q);if(U===Date)return r(z,L,q);if(U===RegExp)return w(z,L,q);if(U===Map)return h(z,L,q);if(U===Set)return k(z,L,q);var N=aie(z);return N===Kne?r(z,L,q):N===eie?w(z,L,q):N===Yne?h(z,L,q):N===tie?k(z,L,q):N===Qne?typeof z.then!="function"&&typeof L.then!="function"&&s(z,L,q):N===nie?I(z,L,q):N===Xne?n(z,L,q):N===Hne?s(z,L,q):N===Zne||N===Jne||N===rie?y(z,L,q):!1}}function sie(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,o={areArraysEqual:n?zp:$ne,areDatesEqual:zne,areErrorsEqual:Lne,areFunctionsEqual:Bne,areMapsEqual:n?aI(cI,zp):cI,areNumbersEqual:Fne,areObjectsEqual:n?zp:Une,arePrimitiveWrappersEqual:Vne,areRegExpsEqual:Gne,areSetsEqual:n?aI(uI,zp):uI,areTypedArraysEqual:n?zp:qne,areUrlsEqual:Wne};if(r&&(o=dI({},o,r(o))),t){var h=v0(o.areArraysEqual),d=v0(o.areMapsEqual),s=v0(o.areObjectsEqual),y=v0(o.areSetsEqual);o=dI({},o,{areArraysEqual:h,areMapsEqual:d,areObjectsEqual:s,areSetsEqual:y})}return o}function lie(e){return function(t,r,n,o,h,d,s){return e(t,r,s)}}function cie(e){var t=e.circular,r=e.comparator,n=e.createState,o=e.equals,h=e.strict;if(n)return function(y,w){var k=n(),E=k.cache,I=E===void 0?t?new WeakMap:void 0:E,j=k.meta;return r(y,w,{cache:I,equals:o,meta:j,strict:h})};if(t)return function(y,w){return r(y,w,{cache:new WeakMap,equals:o,meta:void 0,strict:h})};var d={cache:void 0,equals:o,meta:void 0,strict:h};return function(y,w){return r(y,w,d)}}var uie=sc();sc({strict:!0});sc({circular:!0});sc({circular:!0,strict:!0});sc({createInternalComparator:function(){return Eu}});sc({strict:!0,createInternalComparator:function(){return Eu}});sc({circular:!0,createInternalComparator:function(){return Eu}});sc({circular:!0,createInternalComparator:function(){return Eu},strict:!0});function sc(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,o=e.createState,h=e.strict,d=h===void 0?!1:h,s=sie(e),y=oie(s),w=n?n(y):lie(y);return cie({circular:r,comparator:y,createState:o,equals:w,strict:d})}function hie(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function fI(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function o(h){r<0&&(r=h),h-r>t?(e(h),r=-1):hie(o)};requestAnimationFrame(n)}function j2(e){"@babel/helpers - typeof";return j2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j2(e)}function die(e){return gie(e)||mie(e)||pie(e)||fie()}function fie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pie(e,t){if(e){if(typeof e=="string")return pI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pI(e,t)}}function pI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gie(e){if(Array.isArray(e))return e}function yie(){var e={},t=function(){return null},r=!1,n=function o(h){if(!r){if(Array.isArray(h)){if(!h.length)return;var d=h,s=die(d),y=s[0],w=s.slice(1);if(typeof y=="number"){fI(o.bind(null,w),y);return}o(y),fI(o.bind(null,w));return}j2(h)==="object"&&(e=h,t(e)),typeof h=="function"&&h()}};return{stop:function(){r=!0},start:function(h){r=!1,n(h)},subscribe:function(h){return t=h,function(){t=function(){return null}}}}}function Qm(e){"@babel/helpers - typeof";return Qm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qm(e)}function mI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function gI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mI(Object(r),!0).forEach(function(n){F5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F5(e,t,r){return t=vie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vie(e){var t=_ie(e,"string");return Qm(t)==="symbol"?t:String(t)}function _ie(e,t){if(Qm(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xie=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,o){return n.filter(function(h){return o.includes(h)})})},bie=function(t){return t},wie=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},sm=function(t,r){return Object.keys(r).reduce(function(n,o){return gI(gI({},n),{},F5({},o,t(o,r[o])))},{})},yI=function(t,r,n){return t.map(function(o){return"".concat(wie(o)," ").concat(r,"ms ").concat(n)}).join(",")};function Sie(e,t){return kie(e)||Tie(e,t)||U5(e,t)||Pie()}function Pie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tie(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,h,d,s=[],y=!0,w=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;y=!1}else for(;!(y=(n=h.call(r)).done)&&(s.push(n.value),s.length!==t);y=!0);}catch(k){w=!0,o=k}finally{try{if(!y&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return s}}function kie(e){if(Array.isArray(e))return e}function Eie(e){return Mie(e)||Cie(e)||U5(e)||Aie()}function Aie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U5(e,t){if(e){if(typeof e=="string")return O2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O2(e,t)}}function Cie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Mie(e){if(Array.isArray(e))return O2(e)}function O2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Fv=1e-4,V5=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},G5=function(t,r){return t.map(function(n,o){return n*Math.pow(r,o)}).reduce(function(n,o){return n+o})},vI=function(t,r){return function(n){var o=V5(t,r);return G5(o,n)}},Iie=function(t,r){return function(n){var o=V5(t,r),h=[].concat(Eie(o.map(function(d,s){return d*s}).slice(1)),[0]);return G5(h,n)}},_I=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0],h=r[1],d=r[2],s=r[3];if(r.length===1)switch(r[0]){case"linear":o=0,h=0,d=1,s=1;break;case"ease":o=.25,h=.1,d=.25,s=1;break;case"ease-in":o=.42,h=0,d=1,s=1;break;case"ease-out":o=.42,h=0,d=.58,s=1;break;case"ease-in-out":o=0,h=0,d=.58,s=1;break;default:{var y=r[0].split("(");if(y[0]==="cubic-bezier"&&y[1].split(")")[0].split(",").length===4){var w=y[1].split(")")[0].split(",").map(function(q){return parseFloat(q)}),k=Sie(w,4);o=k[0],h=k[1],d=k[2],s=k[3]}}}var E=vI(o,d),I=vI(h,s),j=Iie(o,d),z=function(F){return F>1?1:F<0?0:F},L=function(F){for(var U=F>1?1:F,N=U,W=0;W<8;++W){var H=E(N)-U,Z=j(N);if(Math.abs(H-U)<Fv||Z<Fv)return I(N);N=z(N-H/Z)}return I(N)};return L.isStepper=!1,L},jie=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,o=t.damping,h=o===void 0?8:o,d=t.dt,s=d===void 0?17:d,y=function(k,E,I){var j=-(k-E)*n,z=I*h,L=I+(j-z)*s/1e3,q=I*s/1e3+k;return Math.abs(q-E)<Fv&&Math.abs(L)<Fv?[E,0]:[q,L]};return y.isStepper=!0,y.dt=s,y},Oie=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0];if(typeof o=="string")switch(o){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return _I(o);case"spring":return jie();default:if(o.split("(")[0]==="cubic-bezier")return _I(o)}return typeof o=="function"?o:null};function eg(e){"@babel/helpers - typeof";return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eg(e)}function xI(e){return Nie(e)||Rie(e)||q5(e)||Die()}function Die(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Nie(e){if(Array.isArray(e))return R2(e)}function bI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function mi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bI(Object(r),!0).forEach(function(n){D2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D2(e,t,r){return t=$ie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ie(e){var t=zie(e,"string");return eg(t)==="symbol"?t:String(t)}function zie(e,t){if(eg(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(eg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lie(e,t){return Uie(e)||Fie(e,t)||q5(e,t)||Bie()}function Bie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q5(e,t){if(e){if(typeof e=="string")return R2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R2(e,t)}}function R2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fie(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,h,d,s=[],y=!0,w=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;y=!1}else for(;!(y=(n=h.call(r)).done)&&(s.push(n.value),s.length!==t);y=!0);}catch(k){w=!0,o=k}finally{try{if(!y&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return s}}function Uie(e){if(Array.isArray(e))return e}var Uv=function(t,r,n){return t+(r-t)*n},N2=function(t){var r=t.from,n=t.to;return r!==n},Vie=function e(t,r,n){var o=sm(function(h,d){if(N2(d)){var s=t(d.from,d.to,d.velocity),y=Lie(s,2),w=y[0],k=y[1];return mi(mi({},d),{},{from:w,velocity:k})}return d},r);return n<1?sm(function(h,d){return N2(d)?mi(mi({},d),{},{velocity:Uv(d.velocity,o[h].velocity,n),from:Uv(d.from,o[h].from,n)}):d},r):e(t,o,n-1)};const Gie=function(e,t,r,n,o){var h=xie(e,t),d=h.reduce(function(q,F){return mi(mi({},q),{},D2({},F,[e[F],t[F]]))},{}),s=h.reduce(function(q,F){return mi(mi({},q),{},D2({},F,{from:e[F],velocity:0,to:t[F]}))},{}),y=-1,w,k,E=function(){return null},I=function(){return sm(function(F,U){return U.from},s)},j=function(){return!Object.values(s).filter(N2).length},z=function(F){w||(w=F);var U=F-w,N=U/r.dt;s=Vie(r,s,N),o(mi(mi(mi({},e),t),I())),w=F,j()||(y=requestAnimationFrame(E))},L=function(F){k||(k=F);var U=(F-k)/n,N=sm(function(H,Z){return Uv.apply(void 0,xI(Z).concat([r(U)]))},d);if(o(mi(mi(mi({},e),t),N)),U<1)y=requestAnimationFrame(E);else{var W=sm(function(H,Z){return Uv.apply(void 0,xI(Z).concat([r(1)]))},d);o(mi(mi(mi({},e),t),W))}};return E=r.isStepper?z:L,function(){return requestAnimationFrame(E),function(){cancelAnimationFrame(y)}}};function jd(e){"@babel/helpers - typeof";return jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jd(e)}var qie=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Wie(e,t){if(e==null)return{};var r=Hie(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Hie(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,h;for(h=0;h<n.length;h++)o=n[h],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function A1(e){return Yie(e)||Xie(e)||Kie(e)||Zie()}function Zie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kie(e,t){if(e){if(typeof e=="string")return $2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $2(e,t)}}function Xie(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Yie(e){if(Array.isArray(e))return $2(e)}function $2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ho(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wI(Object(r),!0).forEach(function(n){Wp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wp(e,t,r){return t=W5(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W5(n.key),n)}}function Qie(e,t,r){return t&&SI(e.prototype,t),r&&SI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function W5(e){var t=eae(e,"string");return jd(t)==="symbol"?t:String(t)}function eae(e,t){if(jd(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(jd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z2(e,t)}function z2(e,t){return z2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},z2(e,t)}function rae(e){var t=nae();return function(){var n=Vv(e),o;if(t){var h=Vv(this).constructor;o=Reflect.construct(n,arguments,h)}else o=n.apply(this,arguments);return L2(this,o)}}function L2(e,t){if(t&&(jd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B2(e)}function B2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vv(e){return Vv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vv(e)}var ix=function(e){tae(r,e);var t=rae(r);function r(n,o){var h;Jie(this,r),h=t.call(this,n,o);var d=h.props,s=d.isActive,y=d.attributeName,w=d.from,k=d.to,E=d.steps,I=d.children,j=d.duration;if(h.handleStyleChange=h.handleStyleChange.bind(B2(h)),h.changeStyle=h.changeStyle.bind(B2(h)),!s||j<=0)return h.state={style:{}},typeof I=="function"&&(h.state={style:k}),L2(h);if(E&&E.length)h.state={style:E[0].style};else if(w){if(typeof I=="function")return h.state={style:w},L2(h);h.state={style:y?Wp({},y,w):w}}else h.state={style:{}};return h}return Qie(r,[{key:"componentDidMount",value:function(){var o=this.props,h=o.isActive,d=o.canBegin;this.mounted=!0,!(!h||!d)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(o){var h=this.props,d=h.isActive,s=h.canBegin,y=h.attributeName,w=h.shouldReAnimate,k=h.to,E=h.from,I=this.state.style;if(s){if(!d){var j={style:y?Wp({},y,k):k};this.state&&I&&(y&&I[y]!==k||!y&&I!==k)&&this.setState(j);return}if(!(uie(o.to,k)&&o.canBegin&&o.isActive)){var z=!o.canBegin||!o.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var L=z||w?E:o.to;if(this.state&&I){var q={style:y?Wp({},y,L):L};(y&&I[y]!==L||!y&&I!==L)&&this.setState(q)}this.runAnimation(ho(ho({},this.props),{},{from:L,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var o=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),o&&o()}},{key:"handleStyleChange",value:function(o){this.changeStyle(o)}},{key:"changeStyle",value:function(o){this.mounted&&this.setState({style:o})}},{key:"runJSAnimation",value:function(o){var h=this,d=o.from,s=o.to,y=o.duration,w=o.easing,k=o.begin,E=o.onAnimationEnd,I=o.onAnimationStart,j=Gie(d,s,Oie(w),y,this.changeStyle),z=function(){h.stopJSAnimation=j()};this.manager.start([I,k,z,y,E])}},{key:"runStepAnimation",value:function(o){var h=this,d=o.steps,s=o.begin,y=o.onAnimationStart,w=d[0],k=w.style,E=w.duration,I=E===void 0?0:E,j=function(L,q,F){if(F===0)return L;var U=q.duration,N=q.easing,W=N===void 0?"ease":N,H=q.style,Z=q.properties,re=q.onAnimationEnd,he=F>0?d[F-1]:q,we=Z||Object.keys(H);if(typeof W=="function"||W==="spring")return[].concat(A1(L),[h.runJSAnimation.bind(h,{from:he.style,to:H,duration:U,easing:W}),U]);var Oe=yI(we,U,W),Me=ho(ho(ho({},he.style),H),{},{transition:Oe});return[].concat(A1(L),[Me,U,re]).filter(bie)};return this.manager.start([y].concat(A1(d.reduce(j,[k,Math.max(I,s)])),[o.onAnimationEnd]))}},{key:"runAnimation",value:function(o){this.manager||(this.manager=yie());var h=o.begin,d=o.duration,s=o.attributeName,y=o.to,w=o.easing,k=o.onAnimationStart,E=o.onAnimationEnd,I=o.steps,j=o.children,z=this.manager;if(this.unSubscribe=z.subscribe(this.handleStyleChange),typeof w=="function"||typeof j=="function"||w==="spring"){this.runJSAnimation(o);return}if(I.length>1){this.runStepAnimation(o);return}var L=s?Wp({},s,y):y,q=yI(Object.keys(L),d,w);z.start([k,h,ho(ho({},L),{},{transition:q}),d,E])}},{key:"render",value:function(){var o=this.props,h=o.children;o.begin;var d=o.duration;o.attributeName,o.easing;var s=o.isActive;o.steps,o.from,o.to,o.canBegin,o.onAnimationEnd,o.shouldReAnimate,o.onAnimationReStart;var y=Wie(o,qie),w=be.Children.count(h),k=this.state.style;if(typeof h=="function")return h(k);if(!s||w===0||d<=0)return h;var E=function(j){var z=j.props,L=z.style,q=L===void 0?{}:L,F=z.className,U=be.cloneElement(j,ho(ho({},y),{},{style:ho(ho({},q),k),className:F}));return U};return w===1?E(be.Children.only(h)):Ie.createElement("div",null,be.Children.map(h,function(I){return E(I)}))}}]),r}(be.PureComponent);ix.displayName="Animate";ix.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};ix.propTypes={from:Er.oneOfType([Er.object,Er.string]),to:Er.oneOfType([Er.object,Er.string]),attributeName:Er.string,duration:Er.number,begin:Er.number,easing:Er.oneOfType([Er.string,Er.func]),steps:Er.arrayOf(Er.shape({duration:Er.number.isRequired,style:Er.object.isRequired,easing:Er.oneOfType([Er.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Er.func]),properties:Er.arrayOf("string"),onAnimationEnd:Er.func})),children:Er.oneOfType([Er.node,Er.func]),isActive:Er.bool,canBegin:Er.bool,onAnimationEnd:Er.func,shouldReAnimate:Er.bool,onAnimationStart:Er.func,onAnimationReStart:Er.func};const tg=ix;function rg(e){"@babel/helpers - typeof";return rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rg(e)}function Gv(){return Gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gv.apply(this,arguments)}function iae(e,t){return lae(e)||sae(e,t)||oae(e,t)||aae()}function aae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oae(e,t){if(e){if(typeof e=="string")return PI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PI(e,t)}}function PI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,h,d,s=[],y=!0,w=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;y=!1}else for(;!(y=(n=h.call(r)).done)&&(s.push(n.value),s.length!==t);y=!0);}catch(k){w=!0,o=k}finally{try{if(!y&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return s}}function lae(e){if(Array.isArray(e))return e}function TI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function kI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TI(Object(r),!0).forEach(function(n){cae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cae(e,t,r){return t=uae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uae(e){var t=hae(e,"string");return rg(t)=="symbol"?t:t+""}function hae(e,t){if(rg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(rg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EI=function(t,r,n,o,h){var d=Math.min(Math.abs(n)/2,Math.abs(o)/2),s=o>=0?1:-1,y=n>=0?1:-1,w=o>=0&&n>=0||o<0&&n<0?1:0,k;if(d>0&&h instanceof Array){for(var E=[0,0,0,0],I=0,j=4;I<j;I++)E[I]=h[I]>d?d:h[I];k="M".concat(t,",").concat(r+s*E[0]),E[0]>0&&(k+="A ".concat(E[0],",").concat(E[0],",0,0,").concat(w,",").concat(t+y*E[0],",").concat(r)),k+="L ".concat(t+n-y*E[1],",").concat(r),E[1]>0&&(k+="A ".concat(E[1],",").concat(E[1],",0,0,").concat(w,`,
        `).concat(t+n,",").concat(r+s*E[1])),k+="L ".concat(t+n,",").concat(r+o-s*E[2]),E[2]>0&&(k+="A ".concat(E[2],",").concat(E[2],",0,0,").concat(w,`,
        `).concat(t+n-y*E[2],",").concat(r+o)),k+="L ".concat(t+y*E[3],",").concat(r+o),E[3]>0&&(k+="A ".concat(E[3],",").concat(E[3],",0,0,").concat(w,`,
        `).concat(t,",").concat(r+o-s*E[3])),k+="Z"}else if(d>0&&h===+h&&h>0){var z=Math.min(d,h);k="M ".concat(t,",").concat(r+s*z,`
            A `).concat(z,",").concat(z,",0,0,").concat(w,",").concat(t+y*z,",").concat(r,`
            L `).concat(t+n-y*z,",").concat(r,`
            A `).concat(z,",").concat(z,",0,0,").concat(w,",").concat(t+n,",").concat(r+s*z,`
            L `).concat(t+n,",").concat(r+o-s*z,`
            A `).concat(z,",").concat(z,",0,0,").concat(w,",").concat(t+n-y*z,",").concat(r+o,`
            L `).concat(t+y*z,",").concat(r+o,`
            A `).concat(z,",").concat(z,",0,0,").concat(w,",").concat(t,",").concat(r+o-s*z," Z")}else k="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(o," h ").concat(-n," Z");return k},dae=function(t,r){if(!t||!r)return!1;var n=t.x,o=t.y,h=r.x,d=r.y,s=r.width,y=r.height;if(Math.abs(s)>0&&Math.abs(y)>0){var w=Math.min(h,h+s),k=Math.max(h,h+s),E=Math.min(d,d+y),I=Math.max(d,d+y);return n>=w&&n<=k&&o>=E&&o<=I}return!1},fae={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},dT=function(t){var r=kI(kI({},fae),t),n=be.useRef(),o=be.useState(-1),h=iae(o,2),d=h[0],s=h[1];be.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var W=n.current.getTotalLength();W&&s(W)}catch{}},[]);var y=r.x,w=r.y,k=r.width,E=r.height,I=r.radius,j=r.className,z=r.animationEasing,L=r.animationDuration,q=r.animationBegin,F=r.isAnimationActive,U=r.isUpdateAnimationActive;if(y!==+y||w!==+w||k!==+k||E!==+E||k===0||E===0)return null;var N=wr("recharts-rectangle",j);return U?Ie.createElement(tg,{canBegin:d>0,from:{width:k,height:E,x:y,y:w},to:{width:k,height:E,x:y,y:w},duration:L,animationEasing:z,isActive:U},function(W){var H=W.width,Z=W.height,re=W.x,he=W.y;return Ie.createElement(tg,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:q,duration:L,isActive:F,easing:z},Ie.createElement("path",Gv({},br(r,!0),{className:N,d:EI(re,he,H,Z,I),ref:n})))}):Ie.createElement("path",Gv({},br(r,!0),{className:N,d:EI(y,w,k,E,I)}))};function F2(){return F2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},F2.apply(this,arguments)}var H5=function(t){var r=t.cx,n=t.cy,o=t.r,h=t.className,d=wr("recharts-dot",h);return r===+r&&n===+n&&o===+o?be.createElement("circle",F2({},br(t,!1),cv(t),{className:d,cx:r,cy:n,r:o})):null};function ng(e){"@babel/helpers - typeof";return ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ng(e)}var pae=["x","y","top","left","width","height","className"];function U2(){return U2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U2.apply(this,arguments)}function AI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function mae(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AI(Object(r),!0).forEach(function(n){gae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gae(e,t,r){return t=yae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yae(e){var t=vae(e,"string");return ng(t)=="symbol"?t:t+""}function vae(e,t){if(ng(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ng(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _ae(e,t){if(e==null)return{};var r=xae(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var bae=function(t,r,n,o,h,d){return"M".concat(t,",").concat(h,"v").concat(o,"M").concat(d,",").concat(r,"h").concat(n)},wae=function(t){var r=t.x,n=r===void 0?0:r,o=t.y,h=o===void 0?0:o,d=t.top,s=d===void 0?0:d,y=t.left,w=y===void 0?0:y,k=t.width,E=k===void 0?0:k,I=t.height,j=I===void 0?0:I,z=t.className,L=_ae(t,pae),q=mae({x:n,y:h,top:s,left:w,width:E,height:j},L);return!vt(n)||!vt(h)||!vt(E)||!vt(j)||!vt(s)||!vt(w)?null:Ie.createElement("path",U2({},br(q,!0),{className:wr("recharts-cross",z),d:bae(n,h,E,j,s,w)}))},Sae=aN,Pae=Sae(Object.getPrototypeOf,Object),Tae=Pae,kae=Ks,Eae=Tae,Aae=Xs,Cae="[object Object]",Mae=Function.prototype,Iae=Object.prototype,Z5=Mae.toString,jae=Iae.hasOwnProperty,Oae=Z5.call(Object);function Dae(e){if(!Aae(e)||kae(e)!=Cae)return!1;var t=Eae(e);if(t===null)return!0;var r=jae.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Z5.call(r)==Oae}var Rae=Dae;const Nae=Rr(Rae);var $ae=Ks,zae=Xs,Lae="[object Boolean]";function Bae(e){return e===!0||e===!1||zae(e)&&$ae(e)==Lae}var Fae=Bae;const Uae=Rr(Fae);function ig(e){"@babel/helpers - typeof";return ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ig(e)}function qv(){return qv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qv.apply(this,arguments)}function Vae(e,t){return Hae(e)||Wae(e,t)||qae(e,t)||Gae()}function Gae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qae(e,t){if(e){if(typeof e=="string")return CI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CI(e,t)}}function CI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wae(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,h,d,s=[],y=!0,w=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;y=!1}else for(;!(y=(n=h.call(r)).done)&&(s.push(n.value),s.length!==t);y=!0);}catch(k){w=!0,o=k}finally{try{if(!y&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return s}}function Hae(e){if(Array.isArray(e))return e}function MI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function II(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MI(Object(r),!0).forEach(function(n){Zae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zae(e,t,r){return t=Kae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kae(e){var t=Xae(e,"string");return ig(t)=="symbol"?t:t+""}function Xae(e,t){if(ig(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ig(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jI=function(t,r,n,o,h){var d=n-o,s;return s="M ".concat(t,",").concat(r),s+="L ".concat(t+n,",").concat(r),s+="L ".concat(t+n-d/2,",").concat(r+h),s+="L ".concat(t+n-d/2-o,",").concat(r+h),s+="L ".concat(t,",").concat(r," Z"),s},Yae={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Jae=function(t){var r=II(II({},Yae),t),n=be.useRef(),o=be.useState(-1),h=Vae(o,2),d=h[0],s=h[1];be.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var N=n.current.getTotalLength();N&&s(N)}catch{}},[]);var y=r.x,w=r.y,k=r.upperWidth,E=r.lowerWidth,I=r.height,j=r.className,z=r.animationEasing,L=r.animationDuration,q=r.animationBegin,F=r.isUpdateAnimationActive;if(y!==+y||w!==+w||k!==+k||E!==+E||I!==+I||k===0&&E===0||I===0)return null;var U=wr("recharts-trapezoid",j);return F?Ie.createElement(tg,{canBegin:d>0,from:{upperWidth:0,lowerWidth:0,height:I,x:y,y:w},to:{upperWidth:k,lowerWidth:E,height:I,x:y,y:w},duration:L,animationEasing:z,isActive:F},function(N){var W=N.upperWidth,H=N.lowerWidth,Z=N.height,re=N.x,he=N.y;return Ie.createElement(tg,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:q,duration:L,easing:z},Ie.createElement("path",qv({},br(r,!0),{className:U,d:jI(re,he,W,H,Z),ref:n})))}):Ie.createElement("g",null,Ie.createElement("path",qv({},br(r,!0),{className:U,d:jI(y,w,k,E,I)})))},Qae=["option","shapeType","propTransformer","activeClassName","isActive"];function ag(e){"@babel/helpers - typeof";return ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ag(e)}function eoe(e,t){if(e==null)return{};var r=toe(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function toe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function OI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Wv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OI(Object(r),!0).forEach(function(n){roe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function roe(e,t,r){return t=noe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function noe(e){var t=ioe(e,"string");return ag(t)=="symbol"?t:t+""}function ioe(e,t){if(ag(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ag(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aoe(e,t){return Wv(Wv({},t),e)}function ooe(e,t){return e==="symbols"}function DI(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Ie.createElement(dT,r);case"trapezoid":return Ie.createElement(Jae,r);case"sector":return Ie.createElement(N5,r);case"symbols":if(ooe(t))return Ie.createElement(MP,r);break;default:return null}}function soe(e){return be.isValidElement(e)?e.props:e}function loe(e){var t=e.option,r=e.shapeType,n=e.propTransformer,o=n===void 0?aoe:n,h=e.activeClassName,d=h===void 0?"recharts-active-shape":h,s=e.isActive,y=eoe(e,Qae),w;if(be.isValidElement(t))w=be.cloneElement(t,Wv(Wv({},y),soe(t)));else if(ar(t))w=t(y);else if(Nae(t)&&!Uae(t)){var k=o(t,y);w=Ie.createElement(DI,{shapeType:r,elementProps:k})}else{var E=y;w=Ie.createElement(DI,{shapeType:r,elementProps:E})}return s?Ie.createElement(ai,{className:d},w):w}function ax(e,t){return t!=null&&"trapezoids"in e.props}function ox(e,t){return t!=null&&"sectors"in e.props}function og(e,t){return t!=null&&"points"in e.props}function coe(e,t){var r,n,o=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,h=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return o&&h}function uoe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function hoe(e,t){var r=e.x===t.x,n=e.y===t.y,o=e.z===t.z;return r&&n&&o}function doe(e,t){var r;return ax(e,t)?r=coe:ox(e,t)?r=uoe:og(e,t)&&(r=hoe),r}function foe(e,t){var r;return ax(e,t)?r="trapezoids":ox(e,t)?r="sectors":og(e,t)&&(r="points"),r}function poe(e,t){if(ax(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(ox(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return og(e,t)?t.payload:{}}function moe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,o=foe(r,t),h=poe(r,t),d=n.filter(function(y,w){var k=lT(h,y),E=r.props[o].filter(function(z){var L=doe(r,t);return L(z,t)}),I=r.props[o].indexOf(E[E.length-1]),j=w===I;return k&&j}),s=n.indexOf(d[d.length-1]);return s}var goe=Math.ceil,yoe=Math.max;function voe(e,t,r,n){for(var o=-1,h=yoe(goe((t-e)/(r||1)),0),d=Array(h);h--;)d[n?h:++o]=e,e+=r;return d}var _oe=voe,xoe=PN,RI=1/0,boe=17976931348623157e292;function woe(e){if(!e)return e===0?e:0;if(e=xoe(e),e===RI||e===-RI){var t=e<0?-1:1;return t*boe}return e===e?e:0}var K5=woe,Soe=_oe,Poe=W_,C1=K5;function Toe(e){return function(t,r,n){return n&&typeof n!="number"&&Poe(t,r,n)&&(r=n=void 0),t=C1(t),r===void 0?(r=t,t=0):r=C1(r),n=n===void 0?t<r?1:-1:C1(n),Soe(t,r,n,e)}}var koe=Toe,Eoe=koe,Aoe=Eoe(),Coe=Aoe;const Hv=Rr(Coe);function sg(e){"@babel/helpers - typeof";return sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sg(e)}function NI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function $I(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NI(Object(r),!0).forEach(function(n){X5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X5(e,t,r){return t=Moe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Moe(e){var t=Ioe(e,"string");return sg(t)=="symbol"?t:t+""}function Ioe(e,t){if(sg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var joe=["Webkit","Moz","O","ms"],Ooe=function(t,r){if(!t)return null;var n=t.replace(/(\w)/,function(h){return h.toUpperCase()}),o=joe.reduce(function(h,d){return $I($I({},h),{},X5({},d+n,r))},{});return o[t]=r,o};function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function Zv(){return Zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zv.apply(this,arguments)}function zI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function M1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zI(Object(r),!0).forEach(function(n){wa(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Doe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J5(n.key),n)}}function Roe(e,t,r){return t&&LI(e.prototype,t),r&&LI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Noe(e,t,r){return t=Kv(t),$oe(e,Y5()?Reflect.construct(t,r||[],Kv(e).constructor):t.apply(e,r))}function $oe(e,t){if(t&&(Od(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zoe(e)}function zoe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y5(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Y5=function(){return!!e})()}function Kv(e){return Kv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kv(e)}function Loe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V2(e,t)}function V2(e,t){return V2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},V2(e,t)}function wa(e,t,r){return t=J5(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J5(e){var t=Boe(e,"string");return Od(t)=="symbol"?t:t+""}function Boe(e,t){if(Od(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Od(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Foe=function(t){var r=t.data,n=t.startIndex,o=t.endIndex,h=t.x,d=t.width,s=t.travellerWidth;if(!r||!r.length)return{};var y=r.length,w=am().domain(Hv(0,y)).range([h,h+d-s]),k=w.domain().map(function(E){return w(E)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:w(n),endX:w(o),scale:w,scaleValues:k}},BI=function(t){return t.changedTouches&&!!t.changedTouches.length},Dd=function(e){function t(r){var n;return Doe(this,t),n=Noe(this,t,[r]),wa(n,"handleDrag",function(o){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(o):n.state.isSlideMoving&&n.handleSlideDrag(o)}),wa(n,"handleTouchMove",function(o){o.changedTouches!=null&&o.changedTouches.length>0&&n.handleDrag(o.changedTouches[0])}),wa(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var o=n.props,h=o.endIndex,d=o.onDragEnd,s=o.startIndex;d==null||d({endIndex:h,startIndex:s})}),n.detachDragEndListener()}),wa(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),wa(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),wa(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),wa(n,"handleSlideDragStart",function(o){var h=BI(o)?o.changedTouches[0]:o;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:h.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return Loe(t,e),Roe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var o=n.startX,h=n.endX,d=this.state.scaleValues,s=this.props,y=s.gap,w=s.data,k=w.length-1,E=Math.min(o,h),I=Math.max(o,h),j=t.getIndexInRange(d,E),z=t.getIndexInRange(d,I);return{startIndex:j-j%y,endIndex:z===k?k:z-z%y}}},{key:"getTextOfTick",value:function(n){var o=this.props,h=o.data,d=o.tickFormatter,s=o.dataKey,y=es(h[n],s,n);return ar(d)?d(y,n):y}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var o=this.state,h=o.slideMoveStartX,d=o.startX,s=o.endX,y=this.props,w=y.x,k=y.width,E=y.travellerWidth,I=y.startIndex,j=y.endIndex,z=y.onChange,L=n.pageX-h;L>0?L=Math.min(L,w+k-E-s,w+k-E-d):L<0&&(L=Math.max(L,w-d,w-s));var q=this.getIndex({startX:d+L,endX:s+L});(q.startIndex!==I||q.endIndex!==j)&&z&&z(q),this.setState({startX:d+L,endX:s+L,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,o){var h=BI(o)?o.changedTouches[0]:o;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:h.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var o=this.state,h=o.brushMoveStartX,d=o.movingTravellerId,s=o.endX,y=o.startX,w=this.state[d],k=this.props,E=k.x,I=k.width,j=k.travellerWidth,z=k.onChange,L=k.gap,q=k.data,F={startX:this.state.startX,endX:this.state.endX},U=n.pageX-h;U>0?U=Math.min(U,E+I-j-w):U<0&&(U=Math.max(U,E-w)),F[d]=w+U;var N=this.getIndex(F),W=N.startIndex,H=N.endIndex,Z=function(){var he=q.length-1;return d==="startX"&&(s>y?W%L===0:H%L===0)||s<y&&H===he||d==="endX"&&(s>y?H%L===0:W%L===0)||s>y&&H===he};this.setState(wa(wa({},d,w+U),"brushMoveStartX",n.pageX),function(){z&&Z()&&z(N)})}},{key:"handleTravellerMoveKeyboard",value:function(n,o){var h=this,d=this.state,s=d.scaleValues,y=d.startX,w=d.endX,k=this.state[o],E=s.indexOf(k);if(E!==-1){var I=E+n;if(!(I===-1||I>=s.length)){var j=s[I];o==="startX"&&j>=w||o==="endX"&&j<=y||this.setState(wa({},o,j),function(){h.props.onChange(h.getIndex({startX:h.state.startX,endX:h.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,o=n.x,h=n.y,d=n.width,s=n.height,y=n.fill,w=n.stroke;return Ie.createElement("rect",{stroke:w,fill:y,x:o,y:h,width:d,height:s})}},{key:"renderPanorama",value:function(){var n=this.props,o=n.x,h=n.y,d=n.width,s=n.height,y=n.data,w=n.children,k=n.padding,E=be.Children.only(w);return E?Ie.cloneElement(E,{x:o,y:h,width:d,height:s,margin:k,compact:!0,data:y}):null}},{key:"renderTravellerLayer",value:function(n,o){var h,d,s=this,y=this.props,w=y.y,k=y.travellerWidth,E=y.height,I=y.traveller,j=y.ariaLabel,z=y.data,L=y.startIndex,q=y.endIndex,F=Math.max(n,this.props.x),U=M1(M1({},br(this.props,!1)),{},{x:F,y:w,width:k,height:E}),N=j||"Min value: ".concat((h=z[L])===null||h===void 0?void 0:h.name,", Max value: ").concat((d=z[q])===null||d===void 0?void 0:d.name);return Ie.createElement(ai,{tabIndex:0,role:"slider","aria-label":N,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[o],onTouchStart:this.travellerDragStartHandlers[o],onKeyDown:function(H){["ArrowLeft","ArrowRight"].includes(H.key)&&(H.preventDefault(),H.stopPropagation(),s.handleTravellerMoveKeyboard(H.key==="ArrowRight"?1:-1,o))},onFocus:function(){s.setState({isTravellerFocused:!0})},onBlur:function(){s.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(I,U))}},{key:"renderSlide",value:function(n,o){var h=this.props,d=h.y,s=h.height,y=h.stroke,w=h.travellerWidth,k=Math.min(n,o)+w,E=Math.max(Math.abs(o-n)-w,0);return Ie.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:y,fillOpacity:.2,x:k,y:d,width:E,height:s})}},{key:"renderText",value:function(){var n=this.props,o=n.startIndex,h=n.endIndex,d=n.y,s=n.height,y=n.travellerWidth,w=n.stroke,k=this.state,E=k.startX,I=k.endX,j=5,z={pointerEvents:"none",fill:w};return Ie.createElement(ai,{className:"recharts-brush-texts"},Ie.createElement(Pv,Zv({textAnchor:"end",verticalAnchor:"middle",x:Math.min(E,I)-j,y:d+s/2},z),this.getTextOfTick(o)),Ie.createElement(Pv,Zv({textAnchor:"start",verticalAnchor:"middle",x:Math.max(E,I)+y+j,y:d+s/2},z),this.getTextOfTick(h)))}},{key:"render",value:function(){var n=this.props,o=n.data,h=n.className,d=n.children,s=n.x,y=n.y,w=n.width,k=n.height,E=n.alwaysShowText,I=this.state,j=I.startX,z=I.endX,L=I.isTextActive,q=I.isSlideMoving,F=I.isTravellerMoving,U=I.isTravellerFocused;if(!o||!o.length||!vt(s)||!vt(y)||!vt(w)||!vt(k)||w<=0||k<=0)return null;var N=wr("recharts-brush",h),W=Ie.Children.count(d)===1,H=Ooe("userSelect","none");return Ie.createElement(ai,{className:N,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:H},this.renderBackground(),W&&this.renderPanorama(),this.renderSlide(j,z),this.renderTravellerLayer(j,"startX"),this.renderTravellerLayer(z,"endX"),(L||q||F||U||E)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var o=n.x,h=n.y,d=n.width,s=n.height,y=n.stroke,w=Math.floor(h+s/2)-1;return Ie.createElement(Ie.Fragment,null,Ie.createElement("rect",{x:o,y:h,width:d,height:s,fill:y,stroke:"none"}),Ie.createElement("line",{x1:o+1,y1:w,x2:o+d-1,y2:w,fill:"none",stroke:"#fff"}),Ie.createElement("line",{x1:o+1,y1:w+2,x2:o+d-1,y2:w+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,o){var h;return Ie.isValidElement(n)?h=Ie.cloneElement(n,o):ar(n)?h=n(o):h=t.renderDefaultTraveller(o),h}},{key:"getDerivedStateFromProps",value:function(n,o){var h=n.data,d=n.width,s=n.x,y=n.travellerWidth,w=n.updateId,k=n.startIndex,E=n.endIndex;if(h!==o.prevData||w!==o.prevUpdateId)return M1({prevData:h,prevTravellerWidth:y,prevUpdateId:w,prevX:s,prevWidth:d},h&&h.length?Foe({data:h,width:d,x:s,travellerWidth:y,startIndex:k,endIndex:E}):{scale:null,scaleValues:null});if(o.scale&&(d!==o.prevWidth||s!==o.prevX||y!==o.prevTravellerWidth)){o.scale.range([s,s+d-y]);var I=o.scale.domain().map(function(j){return o.scale(j)});return{prevData:h,prevTravellerWidth:y,prevUpdateId:w,prevX:s,prevWidth:d,startX:o.scale(n.startIndex),endX:o.scale(n.endIndex),scaleValues:I}}return null}},{key:"getIndexInRange",value:function(n,o){for(var h=n.length,d=0,s=h-1;s-d>1;){var y=Math.floor((d+s)/2);n[y]>o?s=y:d=y}return o>=n[s]?s:d}}])}(be.PureComponent);wa(Dd,"displayName","Brush");wa(Dd,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Uoe=$P;function Voe(e,t){var r;return Uoe(e,function(n,o,h){return r=t(n,o,h),!r}),!!r}var Goe=Voe,qoe=YR,Woe=ic,Hoe=Goe,Zoe=ia,Koe=W_;function Xoe(e,t,r){var n=Zoe(e)?qoe:Hoe;return r&&Koe(e,t,r)&&(t=void 0),n(e,Woe(t))}var Yoe=Xoe;const Joe=Rr(Yoe);var Jo=function(t,r){var n=t.alwaysShow,o=t.ifOverflow;return n&&(o="extendDomain"),o===r},FI=_N;function Qoe(e,t,r){t=="__proto__"&&FI?FI(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var ese=Qoe,tse=ese,rse=yN,nse=ic;function ise(e,t){var r={};return t=nse(t),rse(e,function(n,o,h){tse(r,o,t(n,o,h))}),r}var ase=ise;const ose=Rr(ase);function sse(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var lse=sse,cse=$P;function use(e,t){var r=!0;return cse(e,function(n,o,h){return r=!!t(n,o,h),r}),r}var hse=use,dse=lse,fse=hse,pse=ic,mse=ia,gse=W_;function yse(e,t,r){var n=mse(e)?dse:fse;return r&&gse(e,t,r)&&(t=void 0),n(e,pse(t))}var vse=yse;const Q5=Rr(vse);var _se=["x","y"];function lg(e){"@babel/helpers - typeof";return lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lg(e)}function G2(){return G2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},G2.apply(this,arguments)}function UI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Lp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UI(Object(r),!0).forEach(function(n){xse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xse(e,t,r){return t=bse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bse(e){var t=wse(e,"string");return lg(t)=="symbol"?t:t+""}function wse(e,t){if(lg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(lg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sse(e,t){if(e==null)return{};var r=Pse(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Pse(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Tse(e,t){var r=e.x,n=e.y,o=Sse(e,_se),h="".concat(r),d=parseInt(h,10),s="".concat(n),y=parseInt(s,10),w="".concat(t.height||o.height),k=parseInt(w,10),E="".concat(t.width||o.width),I=parseInt(E,10);return Lp(Lp(Lp(Lp(Lp({},t),o),d?{x:d}:{}),y?{y}:{}),{},{height:k,width:I,name:t.name,radius:t.radius})}function VI(e){return Ie.createElement(loe,G2({shapeType:"rectangle",propTransformer:Tse,activeClassName:"recharts-active-bar"},e))}var kse=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,o){if(typeof t=="number")return t;var h=vt(n)||ZU(n);return h?t(n,o):(h||xu(!1),r)}},Ese=["value","background"],e$;function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function Ase(e,t){if(e==null)return{};var r=Cse(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Cse(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Xv(){return Xv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xv.apply(this,arguments)}function GI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function On(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GI(Object(r),!0).forEach(function(n){Bl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r$(n.key),n)}}function Ise(e,t,r){return t&&qI(e.prototype,t),r&&qI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jse(e,t,r){return t=Yv(t),Ose(e,t$()?Reflect.construct(t,r||[],Yv(e).constructor):t.apply(e,r))}function Ose(e,t){if(t&&(Rd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dse(e)}function Dse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t$=function(){return!!e})()}function Yv(e){return Yv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yv(e)}function Rse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q2(e,t)}function q2(e,t){return q2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},q2(e,t)}function Bl(e,t,r){return t=r$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r$(e){var t=Nse(e,"string");return Rd(t)=="symbol"?t:t+""}function Nse(e,t){if(Rd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lc=function(e){function t(){var r;Mse(this,t);for(var n=arguments.length,o=new Array(n),h=0;h<n;h++)o[h]=arguments[h];return r=jse(this,t,[].concat(o)),Bl(r,"state",{isAnimationFinished:!1}),Bl(r,"id",L_("recharts-bar-")),Bl(r,"handleAnimationEnd",function(){var d=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),d&&d()}),Bl(r,"handleAnimationStart",function(){var d=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),d&&d()}),r}return Rse(t,e),Ise(t,[{key:"renderRectanglesStatically",value:function(n){var o=this,h=this.props,d=h.shape,s=h.dataKey,y=h.activeIndex,w=h.activeBar,k=br(this.props,!1);return n&&n.map(function(E,I){var j=I===y,z=j?w:d,L=On(On(On({},k),E),{},{isActive:j,option:z,index:I,dataKey:s,onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd});return Ie.createElement(ai,Xv({className:"recharts-bar-rectangle"},uv(o.props,E,I),{key:"rectangle-".concat(E==null?void 0:E.x,"-").concat(E==null?void 0:E.y,"-").concat(E==null?void 0:E.value,"-").concat(I)}),Ie.createElement(VI,L))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,o=this.props,h=o.data,d=o.layout,s=o.isAnimationActive,y=o.animationBegin,w=o.animationDuration,k=o.animationEasing,E=o.animationId,I=this.state.prevData;return Ie.createElement(tg,{begin:y,duration:w,isActive:s,easing:k,from:{t:0},to:{t:1},key:"bar-".concat(E),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var z=j.t,L=h.map(function(q,F){var U=I&&I[F];if(U){var N=jh(U.x,q.x),W=jh(U.y,q.y),H=jh(U.width,q.width),Z=jh(U.height,q.height);return On(On({},q),{},{x:N(z),y:W(z),width:H(z),height:Z(z)})}if(d==="horizontal"){var re=jh(0,q.height),he=re(z);return On(On({},q),{},{y:q.y+q.height-he,height:he})}var we=jh(0,q.width),Oe=we(z);return On(On({},q),{},{width:Oe})});return Ie.createElement(ai,null,n.renderRectanglesStatically(L))})}},{key:"renderRectangles",value:function(){var n=this.props,o=n.data,h=n.isAnimationActive,d=this.state.prevData;return h&&o&&o.length&&(!d||!lT(d,o))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(o)}},{key:"renderBackground",value:function(){var n=this,o=this.props,h=o.data,d=o.dataKey,s=o.activeIndex,y=br(this.props.background,!1);return h.map(function(w,k){w.value;var E=w.background,I=Ase(w,Ese);if(!E)return null;var j=On(On(On(On(On({},I),{},{fill:"#eee"},E),y),uv(n.props,w,k)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:d,index:k,className:"recharts-bar-background-rectangle"});return Ie.createElement(VI,Xv({key:"background-bar-".concat(k),option:n.props.background,isActive:k===s},j))})}},{key:"renderErrorBar",value:function(n,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var h=this.props,d=h.data,s=h.xAxis,y=h.yAxis,w=h.layout,k=h.children,E=Po(k,nx);if(!E)return null;var I=w==="vertical"?d[0].height/2:d[0].width/2,j=function(q,F){var U=Array.isArray(q.value)?q.value[1]:q.value;return{x:q.x,y:q.y,value:U,errorVal:es(q,F)}},z={clipPath:n?"url(#clipPath-".concat(o,")"):null};return Ie.createElement(ai,z,E.map(function(L){return Ie.cloneElement(L,{key:"error-bar-".concat(o,"-").concat(L.props.dataKey),data:d,xAxis:s,yAxis:y,layout:w,offset:I,dataPointFormatter:j})}))}},{key:"render",value:function(){var n=this.props,o=n.hide,h=n.data,d=n.className,s=n.xAxis,y=n.yAxis,w=n.left,k=n.top,E=n.width,I=n.height,j=n.isAnimationActive,z=n.background,L=n.id;if(o||!h||!h.length)return null;var q=this.state.isAnimationFinished,F=wr("recharts-bar",d),U=s&&s.allowDataOverflow,N=y&&y.allowDataOverflow,W=U||N,H=Sr(L)?this.id:L;return Ie.createElement(ai,{className:F},U||N?Ie.createElement("defs",null,Ie.createElement("clipPath",{id:"clipPath-".concat(H)},Ie.createElement("rect",{x:U?w:w-E/2,y:N?k:k-I/2,width:U?E:E*2,height:N?I:I*2}))):null,Ie.createElement(ai,{className:"recharts-bar-rectangles",clipPath:W?"url(#clipPath-".concat(H,")"):null},z?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(W,H),(!j||q)&&hu.renderCallByParent(this.props,h))}}],[{key:"getDerivedStateFromProps",value:function(n,o){return n.animationId!==o.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:o.curData}:n.data!==o.curData?{curData:n.data}:null}}])}(be.PureComponent);e$=lc;Bl(lc,"displayName","Bar");Bl(lc,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Xl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Bl(lc,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,o=e.bandSize,h=e.xAxis,d=e.yAxis,s=e.xAxisTicks,y=e.yAxisTicks,w=e.stackedData,k=e.dataStartIndex,E=e.displayedData,I=e.offset,j=fre(n,r);if(!j)return null;var z=t.layout,L=r.type.defaultProps,q=L!==void 0?On(On({},L),r.props):r.props,F=q.dataKey,U=q.children,N=q.minPointSize,W=z==="horizontal"?d:h,H=w?W.scale.domain():null,Z=bre({numericAxis:W}),re=Po(U,EN),he=E.map(function(we,Oe){var Me,Se,Ue,We,qe,Je;w?Me=pre(w[k+Oe],H):(Me=es(we,F),Array.isArray(Me)||(Me=[Z,Me]));var rt=kse(N,e$.defaultProps.minPointSize)(Me[1],Oe);if(z==="horizontal"){var Le,Be=[d.scale(Me[0]),d.scale(Me[1])],nt=Be[0],Xe=Be[1];Se=UM({axis:h,ticks:s,bandSize:o,offset:j.offset,entry:we,index:Oe}),Ue=(Le=Xe??nt)!==null&&Le!==void 0?Le:void 0,We=j.size;var Ge=nt-Xe;if(qe=Number.isNaN(Ge)?0:Ge,Je={x:Se,y:d.y,width:We,height:d.height},Math.abs(rt)>0&&Math.abs(qe)<Math.abs(rt)){var it=bo(qe||rt)*(Math.abs(rt)-Math.abs(qe));Ue-=it,qe+=it}}else{var gt=[h.scale(Me[0]),h.scale(Me[1])],Pt=gt[0],Nt=gt[1];if(Se=Pt,Ue=UM({axis:d,ticks:y,bandSize:o,offset:j.offset,entry:we,index:Oe}),We=Nt-Pt,qe=j.size,Je={x:h.x,y:Ue,width:h.width,height:qe},Math.abs(rt)>0&&Math.abs(We)<Math.abs(rt)){var or=bo(We||rt)*(Math.abs(rt)-Math.abs(We));We+=or}}return On(On(On({},we),{},{x:Se,y:Ue,width:We,height:qe,value:w?Me:Me[1],payload:we,background:Je},re&&re[Oe]&&re[Oe].props),{},{tooltipPayload:[O5(r,we)],tooltipPosition:{x:Se+We/2,y:Ue+qe/2}})});return On({data:he,layout:z},I)});function cg(e){"@babel/helpers - typeof";return cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cg(e)}function $se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n$(n.key),n)}}function zse(e,t,r){return t&&WI(e.prototype,t),r&&WI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function yo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HI(Object(r),!0).forEach(function(n){sx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sx(e,t,r){return t=n$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n$(e){var t=Lse(e,"string");return cg(t)=="symbol"?t:t+""}function Lse(e,t){if(cg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bse=function(t,r,n,o,h){var d=t.width,s=t.height,y=t.layout,w=t.children,k=Object.keys(r),E={left:n.left,leftMirror:n.left,right:d-n.right,rightMirror:d-n.right,top:n.top,topMirror:n.top,bottom:s-n.bottom,bottomMirror:s-n.bottom},I=!!Pa(w,lc);return k.reduce(function(j,z){var L=r[z],q=L.orientation,F=L.domain,U=L.padding,N=U===void 0?{}:U,W=L.mirror,H=L.reversed,Z="".concat(q).concat(W?"Mirror":""),re,he,we,Oe,Me;if(L.type==="number"&&(L.padding==="gap"||L.padding==="no-gap")){var Se=F[1]-F[0],Ue=1/0,We=L.categoricalDomain.sort(YU);if(We.forEach(function(gt,Pt){Pt>0&&(Ue=Math.min((gt||0)-(We[Pt-1]||0),Ue))}),Number.isFinite(Ue)){var qe=Ue/Se,Je=L.layout==="vertical"?n.height:n.width;if(L.padding==="gap"&&(re=qe*Je/2),L.padding==="no-gap"){var rt=vu(t.barCategoryGap,qe*Je),Le=qe*Je/2;re=Le-rt-(Le-rt)/Je*rt}}}o==="xAxis"?he=[n.left+(N.left||0)+(re||0),n.left+n.width-(N.right||0)-(re||0)]:o==="yAxis"?he=y==="horizontal"?[n.top+n.height-(N.bottom||0),n.top+(N.top||0)]:[n.top+(N.top||0)+(re||0),n.top+n.height-(N.bottom||0)-(re||0)]:he=L.range,H&&(he=[he[1],he[0]]);var Be=hre(L,h,I),nt=Be.scale,Xe=Be.realScaleType;nt.domain(F).range(he),dre(nt);var Ge=xre(nt,yo(yo({},L),{},{realScaleType:Xe}));o==="xAxis"?(Me=q==="top"&&!W||q==="bottom"&&W,we=n.left,Oe=E[Z]-Me*L.height):o==="yAxis"&&(Me=q==="left"&&!W||q==="right"&&W,we=E[Z]-Me*L.width,Oe=n.top);var it=yo(yo(yo({},L),Ge),{},{realScaleType:Xe,x:we,y:Oe,scale:nt,width:o==="xAxis"?n.width:L.width,height:o==="yAxis"?n.height:L.height});return it.bandSize=zv(it,Ge),!L.hide&&o==="xAxis"?E[Z]+=(Me?-1:1)*it.height:L.hide||(E[Z]+=(Me?-1:1)*it.width),yo(yo({},j),{},sx({},z,it))},{})},i$=function(t,r){var n=t.x,o=t.y,h=r.x,d=r.y;return{x:Math.min(n,h),y:Math.min(o,d),width:Math.abs(h-n),height:Math.abs(d-o)}},Fse=function(t){var r=t.x1,n=t.y1,o=t.x2,h=t.y2;return i$({x:r,y:n},{x:o,y:h})},a$=function(){function e(t){$se(this,e),this.scale=t}return zse(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.bandAware,h=n.position;if(r!==void 0){if(h)switch(h){case"start":return this.scale(r);case"middle":{var d=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+d}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(r)+s}default:return this.scale(r)}if(o){var y=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+y}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),o=n[0],h=n[n.length-1];return o<=h?r>=o&&r<=h:r>=h&&r<=o}}],[{key:"create",value:function(r){return new e(r)}}])}();sx(a$,"EPS",1e-4);var fT=function(t){var r=Object.keys(t).reduce(function(n,o){return yo(yo({},n),{},sx({},o,a$.create(t[o])))},{});return yo(yo({},r),{},{apply:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=h.bandAware,s=h.position;return ose(o,function(y,w){return r[w].apply(y,{bandAware:d,position:s})})},isInRange:function(o){return Q5(o,function(h,d){return r[d].isInRange(h)})}})};function Use(e){return(e%180+180)%180}var Vse=function(t){var r=t.width,n=t.height,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=Use(o),d=h*Math.PI/180,s=Math.atan(n/r),y=d>s&&d<Math.PI-s?n/Math.sin(d):r/Math.cos(d);return Math.abs(y)},Gse=ic,qse=bg,Wse=G_;function Hse(e){return function(t,r,n){var o=Object(t);if(!qse(t)){var h=Gse(r);t=Wse(t),r=function(s){return h(o[s],s,o)}}var d=e(t,r,n);return d>-1?o[h?t[d]:d]:void 0}}var Zse=Hse,Kse=K5;function Xse(e){var t=Kse(e),r=t%1;return t===t?r?t-r:t:0}var Yse=Xse,Jse=hN,Qse=ic,ele=Yse,tle=Math.max;function rle(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var o=r==null?0:ele(r);return o<0&&(o=tle(n+o,0)),Jse(e,Qse(t),o)}var nle=rle,ile=Zse,ale=nle,ole=ile(ale),sle=ole;const lle=Rr(sle);var cle=J8(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),pT=be.createContext(void 0),mT=be.createContext(void 0),o$=be.createContext(void 0),s$=be.createContext({}),l$=be.createContext(void 0),c$=be.createContext(0),u$=be.createContext(0),ZI=function(t){var r=t.state,n=r.xAxisMap,o=r.yAxisMap,h=r.offset,d=t.clipPathId,s=t.children,y=t.width,w=t.height,k=cle(h);return Ie.createElement(pT.Provider,{value:n},Ie.createElement(mT.Provider,{value:o},Ie.createElement(s$.Provider,{value:h},Ie.createElement(o$.Provider,{value:k},Ie.createElement(l$.Provider,{value:d},Ie.createElement(c$.Provider,{value:w},Ie.createElement(u$.Provider,{value:y},s)))))))},ule=function(){return be.useContext(l$)},h$=function(t){var r=be.useContext(pT);r==null&&xu(!1);var n=r[t];return n==null&&xu(!1),n},hle=function(){var t=be.useContext(pT);return Nl(t)},dle=function(){var t=be.useContext(mT),r=lle(t,function(n){return Q5(n.domain,Number.isFinite)});return r||Nl(t)},d$=function(t){var r=be.useContext(mT);r==null&&xu(!1);var n=r[t];return n==null&&xu(!1),n},fle=function(){var t=be.useContext(o$);return t},ple=function(){return be.useContext(s$)},gT=function(){return be.useContext(u$)},yT=function(){return be.useContext(c$)};function Nd(e){"@babel/helpers - typeof";return Nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nd(e)}function mle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KI(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p$(n.key),n)}}function gle(e,t,r){return t&&KI(e.prototype,t),r&&KI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yle(e,t,r){return t=Jv(t),vle(e,f$()?Reflect.construct(t,r||[],Jv(e).constructor):t.apply(e,r))}function vle(e,t){if(t&&(Nd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _le(e)}function _le(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(f$=function(){return!!e})()}function Jv(e){return Jv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jv(e)}function xle(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W2(e,t)}function W2(e,t){return W2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},W2(e,t)}function XI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function YI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XI(Object(r),!0).forEach(function(n){vT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vT(e,t,r){return t=p$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p$(e){var t=ble(e,"string");return Nd(t)=="symbol"?t:t+""}function ble(e,t){if(Nd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wle(e,t){return kle(e)||Tle(e,t)||Ple(e,t)||Sle()}function Sle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ple(e,t){if(e){if(typeof e=="string")return JI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JI(e,t)}}function JI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tle(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,h,d,s=[],y=!0,w=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;y=!1}else for(;!(y=(n=h.call(r)).done)&&(s.push(n.value),s.length!==t);y=!0);}catch(k){w=!0,o=k}finally{try{if(!y&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return s}}function kle(e){if(Array.isArray(e))return e}function H2(){return H2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},H2.apply(this,arguments)}var Ele=function(t,r){var n;return Ie.isValidElement(t)?n=Ie.cloneElement(t,r):ar(t)?n=t(r):n=Ie.createElement("line",H2({},r,{className:"recharts-reference-line-line"})),n},Ale=function(t,r,n,o,h,d,s,y,w){var k=h.x,E=h.y,I=h.width,j=h.height;if(n){var z=w.y,L=t.y.apply(z,{position:d});if(Jo(w,"discard")&&!t.y.isInRange(L))return null;var q=[{x:k+I,y:L},{x:k,y:L}];return y==="left"?q.reverse():q}if(r){var F=w.x,U=t.x.apply(F,{position:d});if(Jo(w,"discard")&&!t.x.isInRange(U))return null;var N=[{x:U,y:E+j},{x:U,y:E}];return s==="top"?N.reverse():N}if(o){var W=w.segment,H=W.map(function(Z){return t.apply(Z,{position:d})});return Jo(w,"discard")&&Joe(H,function(Z){return!t.isInRange(Z)})?null:H}return null};function Cle(e){var t=e.x,r=e.y,n=e.segment,o=e.xAxisId,h=e.yAxisId,d=e.shape,s=e.className,y=e.alwaysShow,w=ule(),k=h$(o),E=d$(h),I=fle();if(!w||!I)return null;zs(y===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var j=fT({x:k.scale,y:E.scale}),z=Zn(t),L=Zn(r),q=n&&n.length===2,F=Ale(j,z,L,q,I,e.position,k.orientation,E.orientation,e);if(!F)return null;var U=wle(F,2),N=U[0],W=N.x,H=N.y,Z=U[1],re=Z.x,he=Z.y,we=Jo(e,"hidden")?"url(#".concat(w,")"):void 0,Oe=YI(YI({clipPath:we},br(e,!0)),{},{x1:W,y1:H,x2:re,y2:he});return Ie.createElement(ai,{className:wr("recharts-reference-line",s)},Ele(d,Oe),Mi.renderCallByParent(e,Fse({x1:W,y1:H,x2:re,y2:he})))}var _T=function(e){function t(){return mle(this,t),yle(this,t,arguments)}return xle(t,e),gle(t,[{key:"render",value:function(){return Ie.createElement(Cle,this.props)}}])}(Ie.Component);vT(_T,"displayName","ReferenceLine");vT(_T,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Z2(){return Z2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Z2.apply(this,arguments)}function $d(e){"@babel/helpers - typeof";return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$d(e)}function QI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ej(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QI(Object(r),!0).forEach(function(n){lx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g$(n.key),n)}}function Ile(e,t,r){return t&&tj(e.prototype,t),r&&tj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jle(e,t,r){return t=Qv(t),Ole(e,m$()?Reflect.construct(t,r||[],Qv(e).constructor):t.apply(e,r))}function Ole(e,t){if(t&&($d(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dle(e)}function Dle(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(m$=function(){return!!e})()}function Qv(e){return Qv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qv(e)}function Rle(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K2(e,t)}function K2(e,t){return K2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},K2(e,t)}function lx(e,t,r){return t=g$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g$(e){var t=Nle(e,"string");return $d(t)=="symbol"?t:t+""}function Nle(e,t){if($d(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($d(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $le=function(t){var r=t.x,n=t.y,o=t.xAxis,h=t.yAxis,d=fT({x:o.scale,y:h.scale}),s=d.apply({x:r,y:n},{bandAware:!0});return Jo(t,"discard")&&!d.isInRange(s)?null:s},cx=function(e){function t(){return Mle(this,t),jle(this,t,arguments)}return Rle(t,e),Ile(t,[{key:"render",value:function(){var n=this.props,o=n.x,h=n.y,d=n.r,s=n.alwaysShow,y=n.clipPathId,w=Zn(o),k=Zn(h);if(zs(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!w||!k)return null;var E=$le(this.props);if(!E)return null;var I=E.x,j=E.y,z=this.props,L=z.shape,q=z.className,F=Jo(this.props,"hidden")?"url(#".concat(y,")"):void 0,U=ej(ej({clipPath:F},br(this.props,!0)),{},{cx:I,cy:j});return Ie.createElement(ai,{className:wr("recharts-reference-dot",q)},t.renderDot(L,U),Mi.renderCallByParent(this.props,{x:I-d,y:j-d,width:2*d,height:2*d}))}}])}(Ie.Component);lx(cx,"displayName","ReferenceDot");lx(cx,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});lx(cx,"renderDot",function(e,t){var r;return Ie.isValidElement(e)?r=Ie.cloneElement(e,t):ar(e)?r=e(t):r=Ie.createElement(H5,Z2({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function X2(){return X2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},X2.apply(this,arguments)}function zd(e){"@babel/helpers - typeof";return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zd(e)}function rj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rj(Object(r),!0).forEach(function(n){ux(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zle(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ij(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v$(n.key),n)}}function Lle(e,t,r){return t&&ij(e.prototype,t),r&&ij(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ble(e,t,r){return t=e_(t),Fle(e,y$()?Reflect.construct(t,r||[],e_(e).constructor):t.apply(e,r))}function Fle(e,t){if(t&&(zd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ule(e)}function Ule(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(y$=function(){return!!e})()}function e_(e){return e_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},e_(e)}function Vle(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y2(e,t)}function Y2(e,t){return Y2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Y2(e,t)}function ux(e,t,r){return t=v$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v$(e){var t=Gle(e,"string");return zd(t)=="symbol"?t:t+""}function Gle(e,t){if(zd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qle=function(t,r,n,o,h){var d=h.x1,s=h.x2,y=h.y1,w=h.y2,k=h.xAxis,E=h.yAxis;if(!k||!E)return null;var I=fT({x:k.scale,y:E.scale}),j={x:t?I.x.apply(d,{position:"start"}):I.x.rangeMin,y:n?I.y.apply(y,{position:"start"}):I.y.rangeMin},z={x:r?I.x.apply(s,{position:"end"}):I.x.rangeMax,y:o?I.y.apply(w,{position:"end"}):I.y.rangeMax};return Jo(h,"discard")&&(!I.isInRange(j)||!I.isInRange(z))?null:i$(j,z)},hx=function(e){function t(){return zle(this,t),Ble(this,t,arguments)}return Vle(t,e),Lle(t,[{key:"render",value:function(){var n=this.props,o=n.x1,h=n.x2,d=n.y1,s=n.y2,y=n.className,w=n.alwaysShow,k=n.clipPathId;zs(w===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var E=Zn(o),I=Zn(h),j=Zn(d),z=Zn(s),L=this.props.shape;if(!E&&!I&&!j&&!z&&!L)return null;var q=qle(E,I,j,z,this.props);if(!q&&!L)return null;var F=Jo(this.props,"hidden")?"url(#".concat(k,")"):void 0;return Ie.createElement(ai,{className:wr("recharts-reference-area",y)},t.renderRect(L,nj(nj({clipPath:F},br(this.props,!0)),q)),Mi.renderCallByParent(this.props,q))}}])}(Ie.Component);ux(hx,"displayName","ReferenceArea");ux(hx,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});ux(hx,"renderRect",function(e,t){var r;return Ie.isValidElement(e)?r=Ie.cloneElement(e,t):ar(e)?r=e(t):r=Ie.createElement(dT,X2({},t,{className:"recharts-reference-area-rect"})),r});function _$(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],o=0;o<e.length;o+=t)if(r===void 0||r(e[o])===!0)n.push(e[o]);else return;return n}function Wle(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return Vse(n,r)}function Hle(e,t,r){var n=r==="width",o=e.x,h=e.y,d=e.width,s=e.height;return t===1?{start:n?o:h,end:n?o+d:h+s}:{start:n?o+d:h+s,end:n?o:h}}function t_(e,t,r,n,o){if(e*t<e*n||e*t>e*o)return!1;var h=r();return e*(t-e*h/2-n)>=0&&e*(t+e*h/2-o)<=0}function Zle(e,t){return _$(e,t+1)}function Kle(e,t,r,n,o){for(var h=(n||[]).slice(),d=t.start,s=t.end,y=0,w=1,k=d,E=function(){var z=n==null?void 0:n[y];if(z===void 0)return{v:_$(n,w)};var L=y,q,F=function(){return q===void 0&&(q=r(z,L)),q},U=z.coordinate,N=y===0||t_(e,U,F,k,s);N||(y=0,k=d,w+=1),N&&(k=U+e*(F()/2+o),y+=w)},I;w<=h.length;)if(I=E(),I)return I.v;return[]}function ug(e){"@babel/helpers - typeof";return ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ug(e)}function aj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ai(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aj(Object(r),!0).forEach(function(n){Xle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xle(e,t,r){return t=Yle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yle(e){var t=Jle(e,"string");return ug(t)=="symbol"?t:t+""}function Jle(e,t){if(ug(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ug(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qle(e,t,r,n,o){for(var h=(n||[]).slice(),d=h.length,s=t.start,y=t.end,w=function(I){var j=h[I],z,L=function(){return z===void 0&&(z=r(j,I)),z};if(I===d-1){var q=e*(j.coordinate+e*L()/2-y);h[I]=j=Ai(Ai({},j),{},{tickCoord:q>0?j.coordinate-q*e:j.coordinate})}else h[I]=j=Ai(Ai({},j),{},{tickCoord:j.coordinate});var F=t_(e,j.tickCoord,L,s,y);F&&(y=j.tickCoord-e*(L()/2+o),h[I]=Ai(Ai({},j),{},{isShow:!0}))},k=d-1;k>=0;k--)w(k);return h}function ece(e,t,r,n,o,h){var d=(n||[]).slice(),s=d.length,y=t.start,w=t.end;if(h){var k=n[s-1],E=r(k,s-1),I=e*(k.coordinate+e*E/2-w);d[s-1]=k=Ai(Ai({},k),{},{tickCoord:I>0?k.coordinate-I*e:k.coordinate});var j=t_(e,k.tickCoord,function(){return E},y,w);j&&(w=k.tickCoord-e*(E/2+o),d[s-1]=Ai(Ai({},k),{},{isShow:!0}))}for(var z=h?s-1:s,L=function(U){var N=d[U],W,H=function(){return W===void 0&&(W=r(N,U)),W};if(U===0){var Z=e*(N.coordinate-e*H()/2-y);d[U]=N=Ai(Ai({},N),{},{tickCoord:Z<0?N.coordinate-Z*e:N.coordinate})}else d[U]=N=Ai(Ai({},N),{},{tickCoord:N.coordinate});var re=t_(e,N.tickCoord,H,y,w);re&&(y=N.tickCoord+e*(H()/2+o),d[U]=Ai(Ai({},N),{},{isShow:!0}))},q=0;q<z;q++)L(q);return d}function xT(e,t,r){var n=e.tick,o=e.ticks,h=e.viewBox,d=e.minTickGap,s=e.orientation,y=e.interval,w=e.tickFormatter,k=e.unit,E=e.angle;if(!o||!o.length||!n)return[];if(vt(y)||Xl.isSsr)return Zle(o,typeof y=="number"&&vt(y)?y:0);var I=[],j=s==="top"||s==="bottom"?"width":"height",z=k&&j==="width"?im(k,{fontSize:t,letterSpacing:r}):{width:0,height:0},L=function(N,W){var H=ar(w)?w(N.value,W):N.value;return j==="width"?Wle(im(H,{fontSize:t,letterSpacing:r}),z,E):im(H,{fontSize:t,letterSpacing:r})[j]},q=o.length>=2?bo(o[1].coordinate-o[0].coordinate):1,F=Hle(h,q,j);return y==="equidistantPreserveStart"?Kle(q,F,L,o,d):(y==="preserveStart"||y==="preserveStartEnd"?I=ece(q,F,L,o,d,y==="preserveStartEnd"):I=Qle(q,F,L,o,d),I.filter(function(U){return U.isShow}))}var tce=["viewBox"],rce=["viewBox"],nce=["ticks"];function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(e)}function nd(){return nd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nd.apply(this,arguments)}function oj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Un(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oj(Object(r),!0).forEach(function(n){bT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I1(e,t){if(e==null)return{};var r=ice(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ice(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ace(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b$(n.key),n)}}function oce(e,t,r){return t&&sj(e.prototype,t),r&&sj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sce(e,t,r){return t=r_(t),lce(e,x$()?Reflect.construct(t,r||[],r_(e).constructor):t.apply(e,r))}function lce(e,t){if(t&&(Ld(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cce(e)}function cce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(x$=function(){return!!e})()}function r_(e){return r_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},r_(e)}function uce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J2(e,t)}function J2(e,t){return J2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},J2(e,t)}function bT(e,t,r){return t=b$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b$(e){var t=hce(e,"string");return Ld(t)=="symbol"?t:t+""}function hce(e,t){if(Ld(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ld(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var of=function(e){function t(r){var n;return ace(this,t),n=sce(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return uce(t,e),oce(t,[{key:"shouldComponentUpdate",value:function(n,o){var h=n.viewBox,d=I1(n,tce),s=this.props,y=s.viewBox,w=I1(s,rce);return!hd(h,y)||!hd(d,w)||!hd(o,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var o=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];o&&this.setState({fontSize:window.getComputedStyle(o).fontSize,letterSpacing:window.getComputedStyle(o).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var o=this.props,h=o.x,d=o.y,s=o.width,y=o.height,w=o.orientation,k=o.tickSize,E=o.mirror,I=o.tickMargin,j,z,L,q,F,U,N=E?-1:1,W=n.tickSize||k,H=vt(n.tickCoord)?n.tickCoord:n.coordinate;switch(w){case"top":j=z=n.coordinate,q=d+ +!E*y,L=q-N*W,U=L-N*I,F=H;break;case"left":L=q=n.coordinate,z=h+ +!E*s,j=z-N*W,F=j-N*I,U=H;break;case"right":L=q=n.coordinate,z=h+ +E*s,j=z+N*W,F=j+N*I,U=H;break;default:j=z=n.coordinate,q=d+ +E*y,L=q+N*W,U=L+N*I,F=H;break}return{line:{x1:j,y1:L,x2:z,y2:q},tick:{x:F,y:U}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,o=n.orientation,h=n.mirror,d;switch(o){case"left":d=h?"start":"end";break;case"right":d=h?"end":"start";break;default:d="middle";break}return d}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,o=n.orientation,h=n.mirror,d="end";switch(o){case"left":case"right":d="middle";break;case"top":d=h?"start":"end";break;default:d=h?"end":"start";break}return d}},{key:"renderAxisLine",value:function(){var n=this.props,o=n.x,h=n.y,d=n.width,s=n.height,y=n.orientation,w=n.mirror,k=n.axisLine,E=Un(Un(Un({},br(this.props,!1)),br(k,!1)),{},{fill:"none"});if(y==="top"||y==="bottom"){var I=+(y==="top"&&!w||y==="bottom"&&w);E=Un(Un({},E),{},{x1:o,y1:h+I*s,x2:o+d,y2:h+I*s})}else{var j=+(y==="left"&&!w||y==="right"&&w);E=Un(Un({},E),{},{x1:o+j*d,y1:h,x2:o+j*d,y2:h+s})}return Ie.createElement("line",nd({},E,{className:wr("recharts-cartesian-axis-line",Ha(k,"className"))}))}},{key:"renderTicks",value:function(n,o,h){var d=this,s=this.props,y=s.tickLine,w=s.stroke,k=s.tick,E=s.tickFormatter,I=s.unit,j=xT(Un(Un({},this.props),{},{ticks:n}),o,h),z=this.getTickTextAnchor(),L=this.getTickVerticalAnchor(),q=br(this.props,!1),F=br(k,!1),U=Un(Un({},q),{},{fill:"none"},br(y,!1)),N=j.map(function(W,H){var Z=d.getTickLineCoord(W),re=Z.line,he=Z.tick,we=Un(Un(Un(Un({textAnchor:z,verticalAnchor:L},q),{},{stroke:"none",fill:w},F),he),{},{index:H,payload:W,visibleTicksCount:j.length,tickFormatter:E});return Ie.createElement(ai,nd({className:"recharts-cartesian-axis-tick",key:"tick-".concat(W.value,"-").concat(W.coordinate,"-").concat(W.tickCoord)},uv(d.props,W,H)),y&&Ie.createElement("line",nd({},U,re,{className:wr("recharts-cartesian-axis-tick-line",Ha(y,"className"))})),k&&t.renderTickItem(k,we,"".concat(ar(E)?E(W.value,H):W.value).concat(I||"")))});return Ie.createElement("g",{className:"recharts-cartesian-axis-ticks"},N)}},{key:"render",value:function(){var n=this,o=this.props,h=o.axisLine,d=o.width,s=o.height,y=o.ticksGenerator,w=o.className,k=o.hide;if(k)return null;var E=this.props,I=E.ticks,j=I1(E,nce),z=I;return ar(y)&&(z=I&&I.length>0?y(this.props):y(j)),d<=0||s<=0||!z||!z.length?null:Ie.createElement(ai,{className:wr("recharts-cartesian-axis",w),ref:function(q){n.layerReference=q}},h&&this.renderAxisLine(),this.renderTicks(z,this.state.fontSize,this.state.letterSpacing),Mi.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,o,h){var d,s=wr(o.className,"recharts-cartesian-axis-tick-value");return Ie.isValidElement(n)?d=Ie.cloneElement(n,Un(Un({},o),{},{className:s})):ar(n)?d=n(Un(Un({},o),{},{className:s})):d=Ie.createElement(Pv,nd({},o,{className:"recharts-cartesian-axis-tick-value"}),h),d}}])}(be.Component);bT(of,"displayName","CartesianAxis");bT(of,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var dce=["x1","y1","x2","y2","key"],fce=["offset"];function bu(e){"@babel/helpers - typeof";return bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bu(e)}function lj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ii(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lj(Object(r),!0).forEach(function(n){pce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pce(e,t,r){return t=mce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mce(e){var t=gce(e,"string");return bu(t)=="symbol"?t:t+""}function gce(e,t){if(bu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ou(){return ou=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ou.apply(this,arguments)}function cj(e,t){if(e==null)return{};var r=yce(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yce(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var vce=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,o=t.x,h=t.y,d=t.width,s=t.height,y=t.ry;return Ie.createElement("rect",{x:o,y:h,ry:y,width:d,height:s,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function w$(e,t){var r;if(Ie.isValidElement(e))r=Ie.cloneElement(e,t);else if(ar(e))r=e(t);else{var n=t.x1,o=t.y1,h=t.x2,d=t.y2,s=t.key,y=cj(t,dce),w=br(y,!1);w.offset;var k=cj(w,fce);r=Ie.createElement("line",ou({},k,{x1:n,y1:o,x2:h,y2:d,fill:"none",key:s}))}return r}function _ce(e){var t=e.x,r=e.width,n=e.horizontal,o=n===void 0?!0:n,h=e.horizontalPoints;if(!o||!h||!h.length)return null;var d=h.map(function(s,y){var w=Ii(Ii({},e),{},{x1:t,y1:s,x2:t+r,y2:s,key:"line-".concat(y),index:y});return w$(o,w)});return Ie.createElement("g",{className:"recharts-cartesian-grid-horizontal"},d)}function xce(e){var t=e.y,r=e.height,n=e.vertical,o=n===void 0?!0:n,h=e.verticalPoints;if(!o||!h||!h.length)return null;var d=h.map(function(s,y){var w=Ii(Ii({},e),{},{x1:s,y1:t,x2:s,y2:t+r,key:"line-".concat(y),index:y});return w$(o,w)});return Ie.createElement("g",{className:"recharts-cartesian-grid-vertical"},d)}function bce(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,o=e.y,h=e.width,d=e.height,s=e.horizontalPoints,y=e.horizontal,w=y===void 0?!0:y;if(!w||!t||!t.length)return null;var k=s.map(function(I){return Math.round(I+o-o)}).sort(function(I,j){return I-j});o!==k[0]&&k.unshift(0);var E=k.map(function(I,j){var z=!k[j+1],L=z?o+d-I:k[j+1]-I;if(L<=0)return null;var q=j%t.length;return Ie.createElement("rect",{key:"react-".concat(j),y:I,x:n,height:L,width:h,stroke:"none",fill:t[q],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Ie.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},E)}function wce(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,o=e.fillOpacity,h=e.x,d=e.y,s=e.width,y=e.height,w=e.verticalPoints;if(!r||!n||!n.length)return null;var k=w.map(function(I){return Math.round(I+h-h)}).sort(function(I,j){return I-j});h!==k[0]&&k.unshift(0);var E=k.map(function(I,j){var z=!k[j+1],L=z?h+s-I:k[j+1]-I;if(L<=0)return null;var q=j%n.length;return Ie.createElement("rect",{key:"react-".concat(j),x:I,y:d,width:L,height:y,stroke:"none",fill:n[q],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return Ie.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},E)}var Sce=function(t,r){var n=t.xAxis,o=t.width,h=t.height,d=t.offset;return I5(xT(Ii(Ii(Ii({},of.defaultProps),n),{},{ticks:Rs(n,!0),viewBox:{x:0,y:0,width:o,height:h}})),d.left,d.left+d.width,r)},Pce=function(t,r){var n=t.yAxis,o=t.width,h=t.height,d=t.offset;return I5(xT(Ii(Ii(Ii({},of.defaultProps),n),{},{ticks:Rs(n,!0),viewBox:{x:0,y:0,width:o,height:h}})),d.top,d.top+d.height,r)},Rh={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function wT(e){var t,r,n,o,h,d,s=gT(),y=yT(),w=ple(),k=Ii(Ii({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Rh.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Rh.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Rh.horizontal,horizontalFill:(o=e.horizontalFill)!==null&&o!==void 0?o:Rh.horizontalFill,vertical:(h=e.vertical)!==null&&h!==void 0?h:Rh.vertical,verticalFill:(d=e.verticalFill)!==null&&d!==void 0?d:Rh.verticalFill,x:vt(e.x)?e.x:w.left,y:vt(e.y)?e.y:w.top,width:vt(e.width)?e.width:w.width,height:vt(e.height)?e.height:w.height}),E=k.x,I=k.y,j=k.width,z=k.height,L=k.syncWithTicks,q=k.horizontalValues,F=k.verticalValues,U=hle(),N=dle();if(!vt(j)||j<=0||!vt(z)||z<=0||!vt(E)||E!==+E||!vt(I)||I!==+I)return null;var W=k.verticalCoordinatesGenerator||Sce,H=k.horizontalCoordinatesGenerator||Pce,Z=k.horizontalPoints,re=k.verticalPoints;if((!Z||!Z.length)&&ar(H)){var he=q&&q.length,we=H({yAxis:N?Ii(Ii({},N),{},{ticks:he?q:N.ticks}):void 0,width:s,height:y,offset:w},he?!0:L);zs(Array.isArray(we),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(bu(we),"]")),Array.isArray(we)&&(Z=we)}if((!re||!re.length)&&ar(W)){var Oe=F&&F.length,Me=W({xAxis:U?Ii(Ii({},U),{},{ticks:Oe?F:U.ticks}):void 0,width:s,height:y,offset:w},Oe?!0:L);zs(Array.isArray(Me),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(bu(Me),"]")),Array.isArray(Me)&&(re=Me)}return Ie.createElement("g",{className:"recharts-cartesian-grid"},Ie.createElement(vce,{fill:k.fill,fillOpacity:k.fillOpacity,x:k.x,y:k.y,width:k.width,height:k.height,ry:k.ry}),Ie.createElement(_ce,ou({},k,{offset:w,horizontalPoints:Z,xAxis:U,yAxis:N})),Ie.createElement(xce,ou({},k,{offset:w,verticalPoints:re,xAxis:U,yAxis:N})),Ie.createElement(bce,ou({},k,{horizontalPoints:Z})),Ie.createElement(wce,ou({},k,{verticalPoints:re})))}wT.displayName="CartesianGrid";function Bd(e){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(e)}function Tce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T$(n.key),n)}}function kce(e,t,r){return t&&uj(e.prototype,t),r&&uj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ece(e,t,r){return t=n_(t),Ace(e,S$()?Reflect.construct(t,r||[],n_(e).constructor):t.apply(e,r))}function Ace(e,t){if(t&&(Bd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cce(e)}function Cce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(S$=function(){return!!e})()}function n_(e){return n_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},n_(e)}function Mce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q2(e,t)}function Q2(e,t){return Q2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Q2(e,t)}function P$(e,t,r){return t=T$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T$(e){var t=Ice(e,"string");return Bd(t)=="symbol"?t:t+""}function Ice(e,t){if(Bd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eS(){return eS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eS.apply(this,arguments)}function jce(e){var t=e.xAxisId,r=gT(),n=yT(),o=h$(t);return o==null?null:be.createElement(of,eS({},o,{className:wr("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(d){return Rs(d,!0)}}))}var kg=function(e){function t(){return Tce(this,t),Ece(this,t,arguments)}return Mce(t,e),kce(t,[{key:"render",value:function(){return be.createElement(jce,this.props)}}])}(be.Component);P$(kg,"displayName","XAxis");P$(kg,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Fd(e){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(e)}function Oce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A$(n.key),n)}}function Dce(e,t,r){return t&&hj(e.prototype,t),r&&hj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rce(e,t,r){return t=i_(t),Nce(e,k$()?Reflect.construct(t,r||[],i_(e).constructor):t.apply(e,r))}function Nce(e,t){if(t&&(Fd(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $ce(e)}function $ce(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(k$=function(){return!!e})()}function i_(e){return i_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},i_(e)}function zce(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tS(e,t)}function tS(e,t){return tS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},tS(e,t)}function E$(e,t,r){return t=A$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A$(e){var t=Lce(e,"string");return Fd(t)=="symbol"?t:t+""}function Lce(e,t){if(Fd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rS(){return rS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rS.apply(this,arguments)}var Bce=function(t){var r=t.yAxisId,n=gT(),o=yT(),h=d$(r);return h==null?null:be.createElement(of,rS({},h,{className:wr("recharts-".concat(h.axisType," ").concat(h.axisType),h.className),viewBox:{x:0,y:0,width:n,height:o},ticksGenerator:function(s){return Rs(s,!0)}}))},Eg=function(e){function t(){return Oce(this,t),Rce(this,t,arguments)}return zce(t,e),Dce(t,[{key:"render",value:function(){return be.createElement(Bce,this.props)}}])}(be.Component);E$(Eg,"displayName","YAxis");E$(Eg,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function dj(e){return Gce(e)||Vce(e)||Uce(e)||Fce()}function Fce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uce(e,t){if(e){if(typeof e=="string")return nS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nS(e,t)}}function Vce(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Gce(e){if(Array.isArray(e))return nS(e)}function nS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var iS=function(t,r,n,o,h){var d=Po(t,_T),s=Po(t,cx),y=[].concat(dj(d),dj(s)),w=Po(t,hx),k="".concat(o,"Id"),E=o[0],I=r;if(y.length&&(I=y.reduce(function(L,q){if(q.props[k]===n&&Jo(q.props,"extendDomain")&&vt(q.props[E])){var F=q.props[E];return[Math.min(L[0],F),Math.max(L[1],F)]}return L},I)),w.length){var j="".concat(E,"1"),z="".concat(E,"2");I=w.reduce(function(L,q){if(q.props[k]===n&&Jo(q.props,"extendDomain")&&vt(q.props[j])&&vt(q.props[z])){var F=q.props[j],U=q.props[z];return[Math.min(L[0],F,U),Math.max(L[1],F,U)]}return L},I)}return h&&h.length&&(I=h.reduce(function(L,q){return vt(q)?[Math.min(L[0],q),Math.max(L[1],q)]:L},I)),I},C$={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function o(y,w,k){this.fn=y,this.context=w,this.once=k||!1}function h(y,w,k,E,I){if(typeof k!="function")throw new TypeError("The listener must be a function");var j=new o(k,E||y,I),z=r?r+w:w;return y._events[z]?y._events[z].fn?y._events[z]=[y._events[z],j]:y._events[z].push(j):(y._events[z]=j,y._eventsCount++),y}function d(y,w){--y._eventsCount===0?y._events=new n:delete y._events[w]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var w=[],k,E;if(this._eventsCount===0)return w;for(E in k=this._events)t.call(k,E)&&w.push(r?E.slice(1):E);return Object.getOwnPropertySymbols?w.concat(Object.getOwnPropertySymbols(k)):w},s.prototype.listeners=function(w){var k=r?r+w:w,E=this._events[k];if(!E)return[];if(E.fn)return[E.fn];for(var I=0,j=E.length,z=new Array(j);I<j;I++)z[I]=E[I].fn;return z},s.prototype.listenerCount=function(w){var k=r?r+w:w,E=this._events[k];return E?E.fn?1:E.length:0},s.prototype.emit=function(w,k,E,I,j,z){var L=r?r+w:w;if(!this._events[L])return!1;var q=this._events[L],F=arguments.length,U,N;if(q.fn){switch(q.once&&this.removeListener(w,q.fn,void 0,!0),F){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,k),!0;case 3:return q.fn.call(q.context,k,E),!0;case 4:return q.fn.call(q.context,k,E,I),!0;case 5:return q.fn.call(q.context,k,E,I,j),!0;case 6:return q.fn.call(q.context,k,E,I,j,z),!0}for(N=1,U=new Array(F-1);N<F;N++)U[N-1]=arguments[N];q.fn.apply(q.context,U)}else{var W=q.length,H;for(N=0;N<W;N++)switch(q[N].once&&this.removeListener(w,q[N].fn,void 0,!0),F){case 1:q[N].fn.call(q[N].context);break;case 2:q[N].fn.call(q[N].context,k);break;case 3:q[N].fn.call(q[N].context,k,E);break;case 4:q[N].fn.call(q[N].context,k,E,I);break;default:if(!U)for(H=1,U=new Array(F-1);H<F;H++)U[H-1]=arguments[H];q[N].fn.apply(q[N].context,U)}}return!0},s.prototype.on=function(w,k,E){return h(this,w,k,E,!1)},s.prototype.once=function(w,k,E){return h(this,w,k,E,!0)},s.prototype.removeListener=function(w,k,E,I){var j=r?r+w:w;if(!this._events[j])return this;if(!k)return d(this,j),this;var z=this._events[j];if(z.fn)z.fn===k&&(!I||z.once)&&(!E||z.context===E)&&d(this,j);else{for(var L=0,q=[],F=z.length;L<F;L++)(z[L].fn!==k||I&&!z[L].once||E&&z[L].context!==E)&&q.push(z[L]);q.length?this._events[j]=q.length===1?q[0]:q:d(this,j)}return this},s.prototype.removeAllListeners=function(w){var k;return w?(k=r?r+w:w,this._events[k]&&d(this,k)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s})(C$);var qce=C$.exports;const Wce=Rr(qce);var j1=new Wce,O1="recharts.syncMouseEvents";function hg(e){"@babel/helpers - typeof";return hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hg(e)}function Hce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M$(n.key),n)}}function Zce(e,t,r){return t&&fj(e.prototype,t),r&&fj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D1(e,t,r){return t=M$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M$(e){var t=Kce(e,"string");return hg(t)=="symbol"?t:t+""}function Kce(e,t){if(hg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xce=function(){function e(){Hce(this,e),D1(this,"activeIndex",0),D1(this,"coordinateList",[]),D1(this,"layout","horizontal")}return Zce(e,[{key:"setDetails",value:function(r){var n,o=r.coordinateList,h=o===void 0?null:o,d=r.container,s=d===void 0?null:d,y=r.layout,w=y===void 0?null:y,k=r.offset,E=k===void 0?null:k,I=r.mouseHandlerCallback,j=I===void 0?null:I;this.coordinateList=(n=h??this.coordinateList)!==null&&n!==void 0?n:[],this.container=s??this.container,this.layout=w??this.layout,this.offset=E??this.offset,this.mouseHandlerCallback=j??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var o=this.container.getBoundingClientRect(),h=o.x,d=o.y,s=o.height,y=this.coordinateList[this.activeIndex].coordinate,w=((r=window)===null||r===void 0?void 0:r.scrollX)||0,k=((n=window)===null||n===void 0?void 0:n.scrollY)||0,E=h+y+w,I=d+this.offset.top+s/2+k;this.mouseHandlerCallback({pageX:E,pageY:I})}}}])}();function Yce(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],o=e==null?void 0:e[1];if(n&&o&&vt(n)&&vt(o))return!0}return!1}function Jce(e,t,r,n){var o=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-o:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-o,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function I$(e){var t=e.cx,r=e.cy,n=e.radius,o=e.startAngle,h=e.endAngle,d=vi(t,r,n,o),s=vi(t,r,n,h);return{points:[d,s],cx:t,cy:r,radius:n,startAngle:o,endAngle:h}}function Qce(e,t,r){var n,o,h,d;if(e==="horizontal")n=t.x,h=n,o=r.top,d=r.top+r.height;else if(e==="vertical")o=t.y,d=o,n=r.left,h=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var s=t.cx,y=t.cy,w=t.innerRadius,k=t.outerRadius,E=t.angle,I=vi(s,y,w,E),j=vi(s,y,k,E);n=I.x,o=I.y,h=j.x,d=j.y}else return I$(t);return[{x:n,y:o},{x:h,y:d}]}function dg(e){"@babel/helpers - typeof";return dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dg(e)}function pj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pj(Object(r),!0).forEach(function(n){eue(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eue(e,t,r){return t=tue(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tue(e){var t=rue(e,"string");return dg(t)=="symbol"?t:t+""}function rue(e,t){if(dg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nue(e){var t,r,n=e.element,o=e.tooltipEventType,h=e.isActive,d=e.activeCoordinate,s=e.activePayload,y=e.offset,w=e.activeTooltipIndex,k=e.tooltipAxisBandSize,E=e.layout,I=e.chartName,j=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!j||!h||!d||I!=="ScatterChart"&&o!=="axis")return null;var z,L=iI;if(I==="ScatterChart")z=d,L=wae;else if(I==="BarChart")z=Jce(E,d,y,k),L=dT;else if(E==="radial"){var q=I$(d),F=q.cx,U=q.cy,N=q.radius,W=q.startAngle,H=q.endAngle;z={cx:F,cy:U,startAngle:W,endAngle:H,innerRadius:N,outerRadius:N},L=N5}else z={points:Qce(E,d,y)},L=iI;var Z=_0(_0(_0(_0({stroke:"#ccc",pointerEvents:"none"},y),z),br(j,!1)),{},{payload:s,payloadIndex:w,className:wr("recharts-tooltip-cursor",j.className)});return be.isValidElement(j)?be.cloneElement(j,Z):be.createElement(L,Z)}var iue=["item"],aue=["children","className","width","height","style","compact","title","desc"];function Ud(e){"@babel/helpers - typeof";return Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ud(e)}function id(){return id=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},id.apply(this,arguments)}function mj(e,t){return lue(e)||sue(e,t)||O$(e,t)||oue()}function oue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sue(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,h,d,s=[],y=!0,w=!1;try{if(h=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;y=!1}else for(;!(y=(n=h.call(r)).done)&&(s.push(n.value),s.length!==t);y=!0);}catch(k){w=!0,o=k}finally{try{if(!y&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(w)throw o}}return s}}function lue(e){if(Array.isArray(e))return e}function gj(e,t){if(e==null)return{};var r=cue(e,t),n,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);for(o=0;o<h.length;o++)n=h[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cue(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function uue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yj(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D$(n.key),n)}}function hue(e,t,r){return t&&yj(e.prototype,t),r&&yj(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function due(e,t,r){return t=a_(t),fue(e,j$()?Reflect.construct(t,r||[],a_(e).constructor):t.apply(e,r))}function fue(e,t){if(t&&(Ud(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pue(e)}function pue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(j$=function(){return!!e})()}function a_(e){return a_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},a_(e)}function mue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aS(e,t)}function aS(e,t){return aS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},aS(e,t)}function Vd(e){return vue(e)||yue(e)||O$(e)||gue()}function gue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O$(e,t){if(e){if(typeof e=="string")return oS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oS(e,t)}}function yue(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vue(e){if(Array.isArray(e))return oS(e)}function oS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ke(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vj(Object(r),!0).forEach(function(n){Lt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lt(e,t,r){return t=D$(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D$(e){var t=_ue(e,"string");return Ud(t)=="symbol"?t:t+""}function _ue(e,t){if(Ud(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ud(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xue={xAxis:["bottom","top"],yAxis:["left","right"]},bue={width:"100%",height:"100%"},R$={x:0,y:0};function x0(e){return e}var wue=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},Sue=function(t,r,n,o){var h=r.find(function(k){return k&&k.index===n});if(h){if(t==="horizontal")return{x:h.coordinate,y:o.y};if(t==="vertical")return{x:o.x,y:h.coordinate};if(t==="centric"){var d=h.coordinate,s=o.radius;return Ke(Ke(Ke({},o),vi(o.cx,o.cy,s,d)),{},{angle:d,radius:s})}var y=h.coordinate,w=o.angle;return Ke(Ke(Ke({},o),vi(o.cx,o.cy,y,w)),{},{angle:w,radius:y})}return R$},dx=function(t,r){var n=r.graphicalItems,o=r.dataStartIndex,h=r.dataEndIndex,d=(n??[]).reduce(function(s,y){var w=y.props.data;return w&&w.length?[].concat(Vd(s),Vd(w)):s},[]);return d.length>0?d:t&&t.length&&vt(o)&&vt(h)?t.slice(o,h+1):[]};function N$(e){return e==="number"?[0,"auto"]:void 0}var sS=function(t,r,n,o){var h=t.graphicalItems,d=t.tooltipAxis,s=dx(r,t);return n<0||!h||!h.length||n>=s.length?null:h.reduce(function(y,w){var k,E=(k=w.props.data)!==null&&k!==void 0?k:r;E&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(E=E.slice(t.dataStartIndex,t.dataEndIndex+1));var I;if(d.dataKey&&!d.allowDuplicatedCategory){var j=E===void 0?s:E;I=Bw(j,d.dataKey,o)}else I=E&&E[n]||s[n];return I?[].concat(Vd(y),[O5(w,I)]):y},[])},_j=function(t,r,n,o){var h=o||{x:t.chartX,y:t.chartY},d=wue(h,n),s=t.orderedTooltipTicks,y=t.tooltipAxis,w=t.tooltipTicks,k=are(d,s,w,y);if(k>=0&&w){var E=w[k]&&w[k].value,I=sS(t,r,k,E),j=Sue(n,s,k,h);return{activeTooltipIndex:k,activeLabel:E,activePayload:I,activeCoordinate:j}}return null},Pue=function(t,r){var n=r.axes,o=r.graphicalItems,h=r.axisType,d=r.axisIdKey,s=r.stackGroups,y=r.dataStartIndex,w=r.dataEndIndex,k=t.layout,E=t.children,I=t.stackOffset,j=M5(k,h);return n.reduce(function(z,L){var q,F=L.type.defaultProps!==void 0?Ke(Ke({},L.type.defaultProps),L.props):L.props,U=F.type,N=F.dataKey,W=F.allowDataOverflow,H=F.allowDuplicatedCategory,Z=F.scale,re=F.ticks,he=F.includeHidden,we=F[d];if(z[we])return z;var Oe=dx(t.data,{graphicalItems:o.filter(function(Ge){var it,gt=d in Ge.props?Ge.props[d]:(it=Ge.type.defaultProps)===null||it===void 0?void 0:it[d];return gt===we}),dataStartIndex:y,dataEndIndex:w}),Me=Oe.length,Se,Ue,We;Yce(F.domain,W,U)&&(Se=E2(F.domain,null,W),j&&(U==="number"||Z!=="auto")&&(We=om(Oe,N,"category")));var qe=N$(U);if(!Se||Se.length===0){var Je,rt=(Je=F.domain)!==null&&Je!==void 0?Je:qe;if(N){if(Se=om(Oe,N,U),U==="category"&&j){var Le=XU(Se);H&&Le?(Ue=Se,Se=Hv(0,Me)):H||(Se=qM(rt,Se,L).reduce(function(Ge,it){return Ge.indexOf(it)>=0?Ge:[].concat(Vd(Ge),[it])},[]))}else if(U==="category")H?Se=Se.filter(function(Ge){return Ge!==""&&!Sr(Ge)}):Se=qM(rt,Se,L).reduce(function(Ge,it){return Ge.indexOf(it)>=0||it===""||Sr(it)?Ge:[].concat(Vd(Ge),[it])},[]);else if(U==="number"){var Be=ure(Oe,o.filter(function(Ge){var it,gt,Pt=d in Ge.props?Ge.props[d]:(it=Ge.type.defaultProps)===null||it===void 0?void 0:it[d],Nt="hide"in Ge.props?Ge.props.hide:(gt=Ge.type.defaultProps)===null||gt===void 0?void 0:gt.hide;return Pt===we&&(he||!Nt)}),N,h,k);Be&&(Se=Be)}j&&(U==="number"||Z!=="auto")&&(We=om(Oe,N,"category"))}else j?Se=Hv(0,Me):s&&s[we]&&s[we].hasStack&&U==="number"?Se=I==="expand"?[0,1]:j5(s[we].stackGroups,y,w):Se=C5(Oe,o.filter(function(Ge){var it=d in Ge.props?Ge.props[d]:Ge.type.defaultProps[d],gt="hide"in Ge.props?Ge.props.hide:Ge.type.defaultProps.hide;return it===we&&(he||!gt)}),U,k,!0);if(U==="number")Se=iS(E,Se,we,h,re),rt&&(Se=E2(rt,Se,W));else if(U==="category"&&rt){var nt=rt,Xe=Se.every(function(Ge){return nt.indexOf(Ge)>=0});Xe&&(Se=nt)}}return Ke(Ke({},z),{},Lt({},we,Ke(Ke({},F),{},{axisType:h,domain:Se,categoricalDomain:We,duplicateDomain:Ue,originalDomain:(q=F.domain)!==null&&q!==void 0?q:qe,isCategorical:j,layout:k})))},{})},Tue=function(t,r){var n=r.graphicalItems,o=r.Axis,h=r.axisType,d=r.axisIdKey,s=r.stackGroups,y=r.dataStartIndex,w=r.dataEndIndex,k=t.layout,E=t.children,I=dx(t.data,{graphicalItems:n,dataStartIndex:y,dataEndIndex:w}),j=I.length,z=M5(k,h),L=-1;return n.reduce(function(q,F){var U=F.type.defaultProps!==void 0?Ke(Ke({},F.type.defaultProps),F.props):F.props,N=U[d],W=N$("number");if(!q[N]){L++;var H;return z?H=Hv(0,j):s&&s[N]&&s[N].hasStack?(H=j5(s[N].stackGroups,y,w),H=iS(E,H,N,h)):(H=E2(W,C5(I,n.filter(function(Z){var re,he,we=d in Z.props?Z.props[d]:(re=Z.type.defaultProps)===null||re===void 0?void 0:re[d],Oe="hide"in Z.props?Z.props.hide:(he=Z.type.defaultProps)===null||he===void 0?void 0:he.hide;return we===N&&!Oe}),"number",k),o.defaultProps.allowDataOverflow),H=iS(E,H,N,h)),Ke(Ke({},q),{},Lt({},N,Ke(Ke({axisType:h},o.defaultProps),{},{hide:!0,orientation:Ha(xue,"".concat(h,".").concat(L%2),null),domain:H,originalDomain:W,isCategorical:z,layout:k})))}return q},{})},kue=function(t,r){var n=r.axisType,o=n===void 0?"xAxis":n,h=r.AxisComp,d=r.graphicalItems,s=r.stackGroups,y=r.dataStartIndex,w=r.dataEndIndex,k=t.children,E="".concat(o,"Id"),I=Po(k,h),j={};return I&&I.length?j=Pue(t,{axes:I,graphicalItems:d,axisType:o,axisIdKey:E,stackGroups:s,dataStartIndex:y,dataEndIndex:w}):d&&d.length&&(j=Tue(t,{Axis:h,graphicalItems:d,axisType:o,axisIdKey:E,stackGroups:s,dataStartIndex:y,dataEndIndex:w})),j},Eue=function(t){var r=Nl(t),n=Rs(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:zP(n,function(o){return o.coordinate}),tooltipAxis:r,tooltipAxisBandSize:zv(r,n)}},xj=function(t){var r=t.children,n=t.defaultShowTooltip,o=Pa(r,Dd),h=0,d=0;return t.data&&t.data.length!==0&&(d=t.data.length-1),o&&o.props&&(o.props.startIndex>=0&&(h=o.props.startIndex),o.props.endIndex>=0&&(d=o.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:h,dataEndIndex:d,activeTooltipIndex:-1,isTooltipActive:!!n}},Aue=function(t){return!t||!t.length?!1:t.some(function(r){var n=$s(r&&r.type);return n&&n.indexOf("Bar")>=0})},bj=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Cue=function(t,r){var n=t.props,o=t.graphicalItems,h=t.xAxisMap,d=h===void 0?{}:h,s=t.yAxisMap,y=s===void 0?{}:s,w=n.width,k=n.height,E=n.children,I=n.margin||{},j=Pa(E,Dd),z=Pa(E,dd),L=Object.keys(y).reduce(function(H,Z){var re=y[Z],he=re.orientation;return!re.mirror&&!re.hide?Ke(Ke({},H),{},Lt({},he,H[he]+re.width)):H},{left:I.left||0,right:I.right||0}),q=Object.keys(d).reduce(function(H,Z){var re=d[Z],he=re.orientation;return!re.mirror&&!re.hide?Ke(Ke({},H),{},Lt({},he,Ha(H,"".concat(he))+re.height)):H},{top:I.top||0,bottom:I.bottom||0}),F=Ke(Ke({},q),L),U=F.bottom;j&&(F.bottom+=j.props.height||Dd.defaultProps.height),z&&r&&(F=lre(F,o,n,r));var N=w-F.left-F.right,W=k-F.top-F.bottom;return Ke(Ke({brushBottom:U},F),{},{width:Math.max(N,0),height:Math.max(W,0)})},Mue=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},Iue=function(t){var r=t.chartName,n=t.GraphicalChild,o=t.defaultTooltipEventType,h=o===void 0?"axis":o,d=t.validateTooltipEventTypes,s=d===void 0?["axis"]:d,y=t.axisComponents,w=t.legendContent,k=t.formatAxisMap,E=t.defaultProps,I=function(F,U){var N=U.graphicalItems,W=U.stackGroups,H=U.offset,Z=U.updateId,re=U.dataStartIndex,he=U.dataEndIndex,we=F.barSize,Oe=F.layout,Me=F.barGap,Se=F.barCategoryGap,Ue=F.maxBarSize,We=bj(Oe),qe=We.numericAxisName,Je=We.cateAxisName,rt=Aue(N),Le=[];return N.forEach(function(Be,nt){var Xe=dx(F.data,{graphicalItems:[Be],dataStartIndex:re,dataEndIndex:he}),Ge=Be.type.defaultProps!==void 0?Ke(Ke({},Be.type.defaultProps),Be.props):Be.props,it=Ge.dataKey,gt=Ge.maxBarSize,Pt=Ge["".concat(qe,"Id")],Nt=Ge["".concat(Je,"Id")],or={},rr=y.reduce(function(Xn,Yn){var Wi=U["".concat(Yn.axisType,"Map")],Ia=Ge["".concat(Yn.axisType,"Id")];Wi&&Wi[Ia]||Yn.axisType==="zAxis"||xu(!1);var oa=Wi[Ia];return Ke(Ke({},Xn),{},Lt(Lt({},Yn.axisType,oa),"".concat(Yn.axisType,"Ticks"),Rs(oa)))},or),pt=rr[Je],Dt=rr["".concat(Je,"Ticks")],zt=W&&W[Pt]&&W[Pt].hasStack&&wre(Be,W[Pt].stackGroups),et=$s(Be.type).indexOf("Bar")>=0,Vt=zv(pt,Dt),It=[],fr=rt&&ore({barSize:we,stackGroups:W,totalSize:Mue(rr,Je)});if(et){var mr,Yr,yn=Sr(gt)?Ue:gt,Nn=(mr=(Yr=zv(pt,Dt,!0))!==null&&Yr!==void 0?Yr:yn)!==null&&mr!==void 0?mr:0;It=sre({barGap:Me,barCategoryGap:Se,bandSize:Nn!==Vt?Nn:Vt,sizeList:fr[Nt],maxBarSize:yn}),Nn!==Vt&&(It=It.map(function(Xn){return Ke(Ke({},Xn),{},{position:Ke(Ke({},Xn.position),{},{offset:Xn.position.offset-Nn/2})})}))}var aa=Be&&Be.type&&Be.type.getComposedData;aa&&Le.push({props:Ke(Ke({},aa(Ke(Ke({},rr),{},{displayedData:Xe,props:F,dataKey:it,item:Be,bandSize:Vt,barPosition:It,offset:H,stackedData:zt,layout:Oe,dataStartIndex:re,dataEndIndex:he}))),{},Lt(Lt(Lt({key:Be.key||"item-".concat(nt)},qe,rr[qe]),Je,rr[Je]),"animationId",Z)),childIndex:l7(Be,F.children),item:Be})}),Le},j=function(F,U){var N=F.props,W=F.dataStartIndex,H=F.dataEndIndex,Z=F.updateId;if(!RA({props:N}))return null;var re=N.children,he=N.layout,we=N.stackOffset,Oe=N.data,Me=N.reverseStackOrder,Se=bj(he),Ue=Se.numericAxisName,We=Se.cateAxisName,qe=Po(re,n),Je=_re(Oe,qe,"".concat(Ue,"Id"),"".concat(We,"Id"),we,Me),rt=y.reduce(function(Ge,it){var gt="".concat(it.axisType,"Map");return Ke(Ke({},Ge),{},Lt({},gt,kue(N,Ke(Ke({},it),{},{graphicalItems:qe,stackGroups:it.axisType===Ue&&Je,dataStartIndex:W,dataEndIndex:H}))))},{}),Le=Cue(Ke(Ke({},rt),{},{props:N,graphicalItems:qe}),U==null?void 0:U.legendBBox);Object.keys(rt).forEach(function(Ge){rt[Ge]=k(N,rt[Ge],Le,Ge.replace("Map",""),r)});var Be=rt["".concat(We,"Map")],nt=Eue(Be),Xe=I(N,Ke(Ke({},rt),{},{dataStartIndex:W,dataEndIndex:H,updateId:Z,graphicalItems:qe,stackGroups:Je,offset:Le}));return Ke(Ke({formattedGraphicalItems:Xe,graphicalItems:qe,offset:Le,stackGroups:Je},nt),rt)},z=function(q){function F(U){var N,W,H;return uue(this,F),H=due(this,F,[U]),Lt(H,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Lt(H,"accessibilityManager",new Xce),Lt(H,"handleLegendBBoxUpdate",function(Z){if(Z){var re=H.state,he=re.dataStartIndex,we=re.dataEndIndex,Oe=re.updateId;H.setState(Ke({legendBBox:Z},j({props:H.props,dataStartIndex:he,dataEndIndex:we,updateId:Oe},Ke(Ke({},H.state),{},{legendBBox:Z}))))}}),Lt(H,"handleReceiveSyncEvent",function(Z,re,he){if(H.props.syncId===Z){if(he===H.eventEmitterSymbol&&typeof H.props.syncMethod!="function")return;H.applySyncEvent(re)}}),Lt(H,"handleBrushChange",function(Z){var re=Z.startIndex,he=Z.endIndex;if(re!==H.state.dataStartIndex||he!==H.state.dataEndIndex){var we=H.state.updateId;H.setState(function(){return Ke({dataStartIndex:re,dataEndIndex:he},j({props:H.props,dataStartIndex:re,dataEndIndex:he,updateId:we},H.state))}),H.triggerSyncEvent({dataStartIndex:re,dataEndIndex:he})}}),Lt(H,"handleMouseEnter",function(Z){var re=H.getMouseInfo(Z);if(re){var he=Ke(Ke({},re),{},{isTooltipActive:!0});H.setState(he),H.triggerSyncEvent(he);var we=H.props.onMouseEnter;ar(we)&&we(he,Z)}}),Lt(H,"triggeredAfterMouseMove",function(Z){var re=H.getMouseInfo(Z),he=re?Ke(Ke({},re),{},{isTooltipActive:!0}):{isTooltipActive:!1};H.setState(he),H.triggerSyncEvent(he);var we=H.props.onMouseMove;ar(we)&&we(he,Z)}),Lt(H,"handleItemMouseEnter",function(Z){H.setState(function(){return{isTooltipActive:!0,activeItem:Z,activePayload:Z.tooltipPayload,activeCoordinate:Z.tooltipPosition||{x:Z.cx,y:Z.cy}}})}),Lt(H,"handleItemMouseLeave",function(){H.setState(function(){return{isTooltipActive:!1}})}),Lt(H,"handleMouseMove",function(Z){Z.persist(),H.throttleTriggeredAfterMouseMove(Z)}),Lt(H,"handleMouseLeave",function(Z){H.throttleTriggeredAfterMouseMove.cancel();var re={isTooltipActive:!1};H.setState(re),H.triggerSyncEvent(re);var he=H.props.onMouseLeave;ar(he)&&he(re,Z)}),Lt(H,"handleOuterEvent",function(Z){var re=s7(Z),he=Ha(H.props,"".concat(re));if(re&&ar(he)){var we,Oe;/.*touch.*/i.test(re)?Oe=H.getMouseInfo(Z.changedTouches[0]):Oe=H.getMouseInfo(Z),he((we=Oe)!==null&&we!==void 0?we:{},Z)}}),Lt(H,"handleClick",function(Z){var re=H.getMouseInfo(Z);if(re){var he=Ke(Ke({},re),{},{isTooltipActive:!0});H.setState(he),H.triggerSyncEvent(he);var we=H.props.onClick;ar(we)&&we(he,Z)}}),Lt(H,"handleMouseDown",function(Z){var re=H.props.onMouseDown;if(ar(re)){var he=H.getMouseInfo(Z);re(he,Z)}}),Lt(H,"handleMouseUp",function(Z){var re=H.props.onMouseUp;if(ar(re)){var he=H.getMouseInfo(Z);re(he,Z)}}),Lt(H,"handleTouchMove",function(Z){Z.changedTouches!=null&&Z.changedTouches.length>0&&H.throttleTriggeredAfterMouseMove(Z.changedTouches[0])}),Lt(H,"handleTouchStart",function(Z){Z.changedTouches!=null&&Z.changedTouches.length>0&&H.handleMouseDown(Z.changedTouches[0])}),Lt(H,"handleTouchEnd",function(Z){Z.changedTouches!=null&&Z.changedTouches.length>0&&H.handleMouseUp(Z.changedTouches[0])}),Lt(H,"handleDoubleClick",function(Z){var re=H.props.onDoubleClick;if(ar(re)){var he=H.getMouseInfo(Z);re(he,Z)}}),Lt(H,"handleContextMenu",function(Z){var re=H.props.onContextMenu;if(ar(re)){var he=H.getMouseInfo(Z);re(he,Z)}}),Lt(H,"triggerSyncEvent",function(Z){H.props.syncId!==void 0&&j1.emit(O1,H.props.syncId,Z,H.eventEmitterSymbol)}),Lt(H,"applySyncEvent",function(Z){var re=H.props,he=re.layout,we=re.syncMethod,Oe=H.state.updateId,Me=Z.dataStartIndex,Se=Z.dataEndIndex;if(Z.dataStartIndex!==void 0||Z.dataEndIndex!==void 0)H.setState(Ke({dataStartIndex:Me,dataEndIndex:Se},j({props:H.props,dataStartIndex:Me,dataEndIndex:Se,updateId:Oe},H.state)));else if(Z.activeTooltipIndex!==void 0){var Ue=Z.chartX,We=Z.chartY,qe=Z.activeTooltipIndex,Je=H.state,rt=Je.offset,Le=Je.tooltipTicks;if(!rt)return;if(typeof we=="function")qe=we(Le,Z);else if(we==="value"){qe=-1;for(var Be=0;Be<Le.length;Be++)if(Le[Be].value===Z.activeLabel){qe=Be;break}}var nt=Ke(Ke({},rt),{},{x:rt.left,y:rt.top}),Xe=Math.min(Ue,nt.x+nt.width),Ge=Math.min(We,nt.y+nt.height),it=Le[qe]&&Le[qe].value,gt=sS(H.state,H.props.data,qe),Pt=Le[qe]?{x:he==="horizontal"?Le[qe].coordinate:Xe,y:he==="horizontal"?Ge:Le[qe].coordinate}:R$;H.setState(Ke(Ke({},Z),{},{activeLabel:it,activeCoordinate:Pt,activePayload:gt,activeTooltipIndex:qe}))}else H.setState(Z)}),Lt(H,"renderCursor",function(Z){var re,he=H.state,we=he.isTooltipActive,Oe=he.activeCoordinate,Me=he.activePayload,Se=he.offset,Ue=he.activeTooltipIndex,We=he.tooltipAxisBandSize,qe=H.getTooltipEventType(),Je=(re=Z.props.active)!==null&&re!==void 0?re:we,rt=H.props.layout,Le=Z.key||"_recharts-cursor";return Ie.createElement(nue,{key:Le,activeCoordinate:Oe,activePayload:Me,activeTooltipIndex:Ue,chartName:r,element:Z,isActive:Je,layout:rt,offset:Se,tooltipAxisBandSize:We,tooltipEventType:qe})}),Lt(H,"renderPolarAxis",function(Z,re,he){var we=Ha(Z,"type.axisType"),Oe=Ha(H.state,"".concat(we,"Map")),Me=Z.type.defaultProps,Se=Me!==void 0?Ke(Ke({},Me),Z.props):Z.props,Ue=Oe&&Oe[Se["".concat(we,"Id")]];return be.cloneElement(Z,Ke(Ke({},Ue),{},{className:wr(we,Ue.className),key:Z.key||"".concat(re,"-").concat(he),ticks:Rs(Ue,!0)}))}),Lt(H,"renderPolarGrid",function(Z){var re=Z.props,he=re.radialLines,we=re.polarAngles,Oe=re.polarRadius,Me=H.state,Se=Me.radiusAxisMap,Ue=Me.angleAxisMap,We=Nl(Se),qe=Nl(Ue),Je=qe.cx,rt=qe.cy,Le=qe.innerRadius,Be=qe.outerRadius;return be.cloneElement(Z,{polarAngles:Array.isArray(we)?we:Rs(qe,!0).map(function(nt){return nt.coordinate}),polarRadius:Array.isArray(Oe)?Oe:Rs(We,!0).map(function(nt){return nt.coordinate}),cx:Je,cy:rt,innerRadius:Le,outerRadius:Be,key:Z.key||"polar-grid",radialLines:he})}),Lt(H,"renderLegend",function(){var Z=H.state.formattedGraphicalItems,re=H.props,he=re.children,we=re.width,Oe=re.height,Me=H.props.margin||{},Se=we-(Me.left||0)-(Me.right||0),Ue=E5({children:he,formattedGraphicalItems:Z,legendWidth:Se,legendContent:w});if(!Ue)return null;var We=Ue.item,qe=gj(Ue,iue);return be.cloneElement(We,Ke(Ke({},qe),{},{chartWidth:we,chartHeight:Oe,margin:Me,onBBoxUpdate:H.handleLegendBBoxUpdate}))}),Lt(H,"renderTooltip",function(){var Z,re=H.props,he=re.children,we=re.accessibilityLayer,Oe=Pa(he,go);if(!Oe)return null;var Me=H.state,Se=Me.isTooltipActive,Ue=Me.activeCoordinate,We=Me.activePayload,qe=Me.activeLabel,Je=Me.offset,rt=(Z=Oe.props.active)!==null&&Z!==void 0?Z:Se;return be.cloneElement(Oe,{viewBox:Ke(Ke({},Je),{},{x:Je.left,y:Je.top}),active:rt,label:qe,payload:rt?We:[],coordinate:Ue,accessibilityLayer:we})}),Lt(H,"renderBrush",function(Z){var re=H.props,he=re.margin,we=re.data,Oe=H.state,Me=Oe.offset,Se=Oe.dataStartIndex,Ue=Oe.dataEndIndex,We=Oe.updateId;return be.cloneElement(Z,{key:Z.key||"_recharts-brush",onChange:m0(H.handleBrushChange,Z.props.onChange),data:we,x:vt(Z.props.x)?Z.props.x:Me.left,y:vt(Z.props.y)?Z.props.y:Me.top+Me.height+Me.brushBottom-(he.bottom||0),width:vt(Z.props.width)?Z.props.width:Me.width,startIndex:Se,endIndex:Ue,updateId:"brush-".concat(We)})}),Lt(H,"renderReferenceElement",function(Z,re,he){if(!Z)return null;var we=H,Oe=we.clipPathId,Me=H.state,Se=Me.xAxisMap,Ue=Me.yAxisMap,We=Me.offset,qe=Z.type.defaultProps||{},Je=Z.props,rt=Je.xAxisId,Le=rt===void 0?qe.xAxisId:rt,Be=Je.yAxisId,nt=Be===void 0?qe.yAxisId:Be;return be.cloneElement(Z,{key:Z.key||"".concat(re,"-").concat(he),xAxis:Se[Le],yAxis:Ue[nt],viewBox:{x:We.left,y:We.top,width:We.width,height:We.height},clipPathId:Oe})}),Lt(H,"renderActivePoints",function(Z){var re=Z.item,he=Z.activePoint,we=Z.basePoint,Oe=Z.childIndex,Me=Z.isRange,Se=[],Ue=re.props.key,We=re.item.type.defaultProps!==void 0?Ke(Ke({},re.item.type.defaultProps),re.item.props):re.item.props,qe=We.activeDot,Je=We.dataKey,rt=Ke(Ke({index:Oe,dataKey:Je,cx:he.x,cy:he.y,r:4,fill:hT(re.item),strokeWidth:2,stroke:"#fff",payload:he.payload,value:he.value},br(qe,!1)),cv(qe));return Se.push(F.renderActiveDot(qe,rt,"".concat(Ue,"-activePoint-").concat(Oe))),we?Se.push(F.renderActiveDot(qe,Ke(Ke({},rt),{},{cx:we.x,cy:we.y}),"".concat(Ue,"-basePoint-").concat(Oe))):Me&&Se.push(null),Se}),Lt(H,"renderGraphicChild",function(Z,re,he){var we=H.filterFormatItem(Z,re,he);if(!we)return null;var Oe=H.getTooltipEventType(),Me=H.state,Se=Me.isTooltipActive,Ue=Me.tooltipAxis,We=Me.activeTooltipIndex,qe=Me.activeLabel,Je=H.props.children,rt=Pa(Je,go),Le=we.props,Be=Le.points,nt=Le.isRange,Xe=Le.baseLine,Ge=we.item.type.defaultProps!==void 0?Ke(Ke({},we.item.type.defaultProps),we.item.props):we.item.props,it=Ge.activeDot,gt=Ge.hide,Pt=Ge.activeBar,Nt=Ge.activeShape,or=!!(!gt&&Se&&rt&&(it||Pt||Nt)),rr={};Oe!=="axis"&&rt&&rt.props.trigger==="click"?rr={onClick:m0(H.handleItemMouseEnter,Z.props.onClick)}:Oe!=="axis"&&(rr={onMouseLeave:m0(H.handleItemMouseLeave,Z.props.onMouseLeave),onMouseEnter:m0(H.handleItemMouseEnter,Z.props.onMouseEnter)});var pt=be.cloneElement(Z,Ke(Ke({},we.props),rr));function Dt(Yn){return typeof Ue.dataKey=="function"?Ue.dataKey(Yn.payload):null}if(or)if(We>=0){var zt,et;if(Ue.dataKey&&!Ue.allowDuplicatedCategory){var Vt=typeof Ue.dataKey=="function"?Dt:"payload.".concat(Ue.dataKey.toString());zt=Bw(Be,Vt,qe),et=nt&&Xe&&Bw(Xe,Vt,qe)}else zt=Be==null?void 0:Be[We],et=nt&&Xe&&Xe[We];if(Nt||Pt){var It=Z.props.activeIndex!==void 0?Z.props.activeIndex:We;return[be.cloneElement(Z,Ke(Ke(Ke({},we.props),rr),{},{activeIndex:It})),null,null]}if(!Sr(zt))return[pt].concat(Vd(H.renderActivePoints({item:we,activePoint:zt,basePoint:et,childIndex:We,isRange:nt})))}else{var fr,mr=(fr=H.getItemByXY(H.state.activeCoordinate))!==null&&fr!==void 0?fr:{graphicalItem:pt},Yr=mr.graphicalItem,yn=Yr.item,Nn=yn===void 0?Z:yn,aa=Yr.childIndex,Xn=Ke(Ke(Ke({},we.props),rr),{},{activeIndex:aa});return[be.cloneElement(Nn,Xn),null,null]}return nt?[pt,null,null]:[pt,null]}),Lt(H,"renderCustomized",function(Z,re,he){return be.cloneElement(Z,Ke(Ke({key:"recharts-customized-".concat(he)},H.props),H.state))}),Lt(H,"renderMap",{CartesianGrid:{handler:x0,once:!0},ReferenceArea:{handler:H.renderReferenceElement},ReferenceLine:{handler:x0},ReferenceDot:{handler:H.renderReferenceElement},XAxis:{handler:x0},YAxis:{handler:x0},Brush:{handler:H.renderBrush,once:!0},Bar:{handler:H.renderGraphicChild},Line:{handler:H.renderGraphicChild},Area:{handler:H.renderGraphicChild},Radar:{handler:H.renderGraphicChild},RadialBar:{handler:H.renderGraphicChild},Scatter:{handler:H.renderGraphicChild},Pie:{handler:H.renderGraphicChild},Funnel:{handler:H.renderGraphicChild},Tooltip:{handler:H.renderCursor,once:!0},PolarGrid:{handler:H.renderPolarGrid,once:!0},PolarAngleAxis:{handler:H.renderPolarAxis},PolarRadiusAxis:{handler:H.renderPolarAxis},Customized:{handler:H.renderCustomized}}),H.clipPathId="".concat((N=U.id)!==null&&N!==void 0?N:L_("recharts"),"-clip"),H.throttleTriggeredAfterMouseMove=TN(H.triggeredAfterMouseMove,(W=U.throttleDelay)!==null&&W!==void 0?W:1e3/60),H.state={},H}return mue(F,q),hue(F,[{key:"componentDidMount",value:function(){var N,W;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(N=this.props.margin.left)!==null&&N!==void 0?N:0,top:(W=this.props.margin.top)!==null&&W!==void 0?W:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var N=this.props,W=N.children,H=N.data,Z=N.height,re=N.layout,he=Pa(W,go);if(he){var we=he.props.defaultIndex;if(!(typeof we!="number"||we<0||we>this.state.tooltipTicks.length-1)){var Oe=this.state.tooltipTicks[we]&&this.state.tooltipTicks[we].value,Me=sS(this.state,H,we,Oe),Se=this.state.tooltipTicks[we].coordinate,Ue=(this.state.offset.top+Z)/2,We=re==="horizontal",qe=We?{x:Se,y:Ue}:{y:Se,x:Ue},Je=this.state.formattedGraphicalItems.find(function(Le){var Be=Le.item;return Be.type.name==="Scatter"});Je&&(qe=Ke(Ke({},qe),Je.props.points[we].tooltipPosition),Me=Je.props.points[we].tooltipPayload);var rt={activeTooltipIndex:we,isTooltipActive:!0,activeLabel:Oe,activePayload:Me,activeCoordinate:qe};this.setState(rt),this.renderCursor(he),this.accessibilityManager.setIndex(we)}}}},{key:"getSnapshotBeforeUpdate",value:function(N,W){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==W.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==N.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==N.margin){var H,Z;this.accessibilityManager.setDetails({offset:{left:(H=this.props.margin.left)!==null&&H!==void 0?H:0,top:(Z=this.props.margin.top)!==null&&Z!==void 0?Z:0}})}return null}},{key:"componentDidUpdate",value:function(N){Uw([Pa(N.children,go)],[Pa(this.props.children,go)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var N=Pa(this.props.children,go);if(N&&typeof N.props.shared=="boolean"){var W=N.props.shared?"axis":"item";return s.indexOf(W)>=0?W:h}return h}},{key:"getMouseInfo",value:function(N){if(!this.container)return null;var W=this.container,H=W.getBoundingClientRect(),Z=IY(H),re={chartX:Math.round(N.pageX-Z.left),chartY:Math.round(N.pageY-Z.top)},he=H.width/W.offsetWidth||1,we=this.inRange(re.chartX,re.chartY,he);if(!we)return null;var Oe=this.state,Me=Oe.xAxisMap,Se=Oe.yAxisMap,Ue=this.getTooltipEventType(),We=_j(this.state,this.props.data,this.props.layout,we);if(Ue!=="axis"&&Me&&Se){var qe=Nl(Me).scale,Je=Nl(Se).scale,rt=qe&&qe.invert?qe.invert(re.chartX):null,Le=Je&&Je.invert?Je.invert(re.chartY):null;return Ke(Ke({},re),{},{xValue:rt,yValue:Le},We)}return We?Ke(Ke({},re),We):null}},{key:"inRange",value:function(N,W){var H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Z=this.props.layout,re=N/H,he=W/H;if(Z==="horizontal"||Z==="vertical"){var we=this.state.offset,Oe=re>=we.left&&re<=we.left+we.width&&he>=we.top&&he<=we.top+we.height;return Oe?{x:re,y:he}:null}var Me=this.state,Se=Me.angleAxisMap,Ue=Me.radiusAxisMap;if(Se&&Ue){var We=Nl(Se);return ZM({x:re,y:he},We)}return null}},{key:"parseEventsOfWrapper",value:function(){var N=this.props.children,W=this.getTooltipEventType(),H=Pa(N,go),Z={};H&&W==="axis"&&(H.props.trigger==="click"?Z={onClick:this.handleClick}:Z={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var re=cv(this.props,this.handleOuterEvent);return Ke(Ke({},re),Z)}},{key:"addListener",value:function(){j1.on(O1,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){j1.removeListener(O1,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(N,W,H){for(var Z=this.state.formattedGraphicalItems,re=0,he=Z.length;re<he;re++){var we=Z[re];if(we.item===N||we.props.key===N.key||W===$s(we.item.type)&&H===we.childIndex)return we}return null}},{key:"renderClipPath",value:function(){var N=this.clipPathId,W=this.state.offset,H=W.left,Z=W.top,re=W.height,he=W.width;return Ie.createElement("defs",null,Ie.createElement("clipPath",{id:N},Ie.createElement("rect",{x:H,y:Z,height:re,width:he})))}},{key:"getXScales",value:function(){var N=this.state.xAxisMap;return N?Object.entries(N).reduce(function(W,H){var Z=mj(H,2),re=Z[0],he=Z[1];return Ke(Ke({},W),{},Lt({},re,he.scale))},{}):null}},{key:"getYScales",value:function(){var N=this.state.yAxisMap;return N?Object.entries(N).reduce(function(W,H){var Z=mj(H,2),re=Z[0],he=Z[1];return Ke(Ke({},W),{},Lt({},re,he.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(N){var W;return(W=this.state.xAxisMap)===null||W===void 0||(W=W[N])===null||W===void 0?void 0:W.scale}},{key:"getYScaleByAxisId",value:function(N){var W;return(W=this.state.yAxisMap)===null||W===void 0||(W=W[N])===null||W===void 0?void 0:W.scale}},{key:"getItemByXY",value:function(N){var W=this.state,H=W.formattedGraphicalItems,Z=W.activeItem;if(H&&H.length)for(var re=0,he=H.length;re<he;re++){var we=H[re],Oe=we.props,Me=we.item,Se=Me.type.defaultProps!==void 0?Ke(Ke({},Me.type.defaultProps),Me.props):Me.props,Ue=$s(Me.type);if(Ue==="Bar"){var We=(Oe.data||[]).find(function(Le){return dae(N,Le)});if(We)return{graphicalItem:we,payload:We}}else if(Ue==="RadialBar"){var qe=(Oe.data||[]).find(function(Le){return ZM(N,Le)});if(qe)return{graphicalItem:we,payload:qe}}else if(ax(we,Z)||ox(we,Z)||og(we,Z)){var Je=moe({graphicalItem:we,activeTooltipItem:Z,itemData:Se.data}),rt=Se.activeIndex===void 0?Je:Se.activeIndex;return{graphicalItem:Ke(Ke({},we),{},{childIndex:rt}),payload:og(we,Z)?Se.data[Je]:we.props.data[Je]}}}return null}},{key:"render",value:function(){var N=this;if(!RA(this))return null;var W=this.props,H=W.children,Z=W.className,re=W.width,he=W.height,we=W.style,Oe=W.compact,Me=W.title,Se=W.desc,Ue=gj(W,aue),We=br(Ue,!1);if(Oe)return Ie.createElement(ZI,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ie.createElement(Gw,id({},We,{width:re,height:he,title:Me,desc:Se}),this.renderClipPath(),$A(H,this.renderMap)));if(this.props.accessibilityLayer){var qe,Je;We.tabIndex=(qe=this.props.tabIndex)!==null&&qe!==void 0?qe:0,We.role=(Je=this.props.role)!==null&&Je!==void 0?Je:"application",We.onKeyDown=function(Le){N.accessibilityManager.keyboardEvent(Le)},We.onFocus=function(){N.accessibilityManager.focus()}}var rt=this.parseEventsOfWrapper();return Ie.createElement(ZI,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ie.createElement("div",id({className:wr("recharts-wrapper",Z),style:Ke({position:"relative",cursor:"default",width:re,height:he},we)},rt,{ref:function(Be){N.container=Be}}),Ie.createElement(Gw,id({},We,{width:re,height:he,title:Me,desc:Se,style:bue}),this.renderClipPath(),$A(H,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(be.Component);Lt(z,"displayName",r),Lt(z,"defaultProps",Ke({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},E)),Lt(z,"getDerivedStateFromProps",function(q,F){var U=q.dataKey,N=q.data,W=q.children,H=q.width,Z=q.height,re=q.layout,he=q.stackOffset,we=q.margin,Oe=F.dataStartIndex,Me=F.dataEndIndex;if(F.updateId===void 0){var Se=xj(q);return Ke(Ke(Ke({},Se),{},{updateId:0},j(Ke(Ke({props:q},Se),{},{updateId:0}),F)),{},{prevDataKey:U,prevData:N,prevWidth:H,prevHeight:Z,prevLayout:re,prevStackOffset:he,prevMargin:we,prevChildren:W})}if(U!==F.prevDataKey||N!==F.prevData||H!==F.prevWidth||Z!==F.prevHeight||re!==F.prevLayout||he!==F.prevStackOffset||!hd(we,F.prevMargin)){var Ue=xj(q),We={chartX:F.chartX,chartY:F.chartY,isTooltipActive:F.isTooltipActive},qe=Ke(Ke({},_j(F,N,re)),{},{updateId:F.updateId+1}),Je=Ke(Ke(Ke({},Ue),We),qe);return Ke(Ke(Ke({},Je),j(Ke({props:q},Je),F)),{},{prevDataKey:U,prevData:N,prevWidth:H,prevHeight:Z,prevLayout:re,prevStackOffset:he,prevMargin:we,prevChildren:W})}if(!Uw(W,F.prevChildren)){var rt,Le,Be,nt,Xe=Pa(W,Dd),Ge=Xe&&(rt=(Le=Xe.props)===null||Le===void 0?void 0:Le.startIndex)!==null&&rt!==void 0?rt:Oe,it=Xe&&(Be=(nt=Xe.props)===null||nt===void 0?void 0:nt.endIndex)!==null&&Be!==void 0?Be:Me,gt=Ge!==Oe||it!==Me,Pt=!Sr(N),Nt=Pt&&!gt?F.updateId:F.updateId+1;return Ke(Ke({updateId:Nt},j(Ke(Ke({props:q},F),{},{updateId:Nt,dataStartIndex:Ge,dataEndIndex:it}),F)),{},{prevChildren:W,dataStartIndex:Ge,dataEndIndex:it})}return null}),Lt(z,"renderActiveDot",function(q,F,U){var N;return be.isValidElement(q)?N=be.cloneElement(q,F):ar(q)?N=q(F):N=Ie.createElement(H5,F),Ie.createElement(ai,{className:"recharts-active-dot",key:U},N)});var L=be.forwardRef(function(F,U){return Ie.createElement(z,id({},F,{ref:U}))});return L.displayName=z.displayName,L},$$=Iue({chartName:"BarChart",GraphicalChild:lc,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:kg},{axisType:"yAxis",AxisComp:Eg}],formatAxisMap:Bse});const dr=({variant:e="primary",size:t="md",className:r="",children:n,...o})=>{const{theme:h}=Mr(),d="inline-flex items-center justify-center rounded-md font-medium transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105",s={primary:h==="dark"?"bg-gradient-to-r from-purple-600 to-cyan-600 text-white hover:from-purple-700 hover:to-cyan-700 focus:ring-purple-500 shadow-lg shadow-purple-500/30":"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 focus:ring-blue-500 shadow-lg shadow-blue-500/30",secondary:h==="dark"?"bg-gray-700 text-gray-200 hover:bg-gray-600 focus:ring-gray-500 border border-gray-600":"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-gradient-to-r from-red-600 to-red-700 text-white hover:from-red-700 hover:to-red-800 focus:ring-red-500 shadow-lg shadow-red-500/30"},y={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return P.jsx("button",{className:`${d} ${s[e]} ${y[t]} ${r}`,...o,children:n})},Xr=({children:e,className:t="",title:r})=>{const{theme:n}=Mr();return P.jsxs("div",{className:`rounded-xl border shadow-lg transition-all duration-300 hover:shadow-xl ${n==="dark"?"bg-gray-800/50 backdrop-blur-sm border-gray-700 shadow-gray-900/30":"bg-white/70 backdrop-blur-sm border-gray-200 shadow-gray-500/10"} ${t}`,children:[r&&P.jsx("div",{className:`px-6 py-4 border-b ${n==="dark"?"border-gray-700":"border-gray-200"}`,children:P.jsx("h3",{className:`text-lg font-semibold ${n==="dark"?"text-white":"text-gray-900"}`,children:r})}),P.jsx("div",{className:"p-6",children:e})]})},Ag=({isOpen:e,onClose:t,title:r,children:n,maxWidth:o="md"})=>{const{theme:h}=Mr();if(!e)return null;const d={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"};return P.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:P.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[P.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:t}),P.jsxs("div",{className:`relative rounded-xl shadow-2xl w-full transition-all duration-300 ${h==="dark"?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"} ${d[o]}`,children:[P.jsxs("div",{className:`flex items-center justify-between p-6 border-b ${h==="dark"?"border-gray-700":"border-gray-200"}`,children:[P.jsx("h2",{className:`text-lg font-medium ${h==="dark"?"text-white":"text-gray-900"}`,children:r}),P.jsxs("button",{onClick:t,className:`p-1 rounded-lg transition-colors ${h==="dark"?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"} focus:outline-none`,children:[P.jsx("span",{className:"sr-only",children:"Close"}),P.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),P.jsx("div",{className:"p-6",children:n})]})]})})},Cg=({children:e,variant:t="default",className:r=""})=>{const{theme:n}=Mr(),o={success:n==="dark"?"bg-green-900/50 text-green-300 border border-green-700":"bg-green-100 text-green-800",warning:n==="dark"?"bg-yellow-900/50 text-yellow-300 border border-yellow-700":"bg-yellow-100 text-yellow-800",danger:n==="dark"?"bg-red-900/50 text-red-300 border border-red-700":"bg-red-100 text-red-800",info:n==="dark"?"bg-blue-900/50 text-blue-300 border border-blue-700":"bg-blue-100 text-blue-800",default:n==="dark"?"bg-gray-700 text-gray-300 border border-gray-600":"bg-gray-100 text-gray-800"};return P.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-all duration-300 ${o[t]} ${r}`,children:e})},sf=({children:e,className:t=""})=>{const{theme:r}=Mr();return P.jsx("div",{className:"overflow-x-auto rounded-xl",children:P.jsx("table",{className:`min-w-full divide-y transition-colors duration-300 ${r==="dark"?"divide-gray-700":"divide-gray-200"} ${t}`,children:e})})},lf=({children:e})=>{const{theme:t}=Mr();return P.jsx("thead",{className:`transition-colors duration-300 ${t==="dark"?"bg-gray-800":"bg-gray-50"}`,children:e})},cf=({children:e})=>{const{theme:t}=Mr();return P.jsx("tbody",{className:`divide-y transition-colors duration-300 ${t==="dark"?"bg-gray-800/50 divide-gray-700":"bg-white divide-gray-200"}`,children:e})},Ya=({children:e,className:t=""})=>{const{theme:r}=Mr();return P.jsx("tr",{className:`transition-colors duration-300 ${r==="dark"?"hover:bg-gray-700/50":"hover:bg-gray-50"} ${t}`,children:e})},_t=({children:e,className:t="",isHeader:r=!1})=>{const{theme:n}=Mr(),o="px-6 py-4 text-sm transition-colors duration-300",h=r?n==="dark"?"font-semibold text-gray-200":"font-semibold text-gray-900":n==="dark"?"text-gray-300":"text-gray-500",d=r?"th":"td";return P.jsx(d,{className:`${o} ${h} ${t}`,children:e})},Mg=({message:e,type:t,isVisible:r,onClose:n})=>{const{theme:o}=Mr();if(Ie.useEffect(()=>{if(r){const s=setTimeout(()=>{n()},4e3);return()=>clearTimeout(s)}},[r,n]),!r)return null;const h={success:o==="dark"?"bg-green-900/80 border-green-600 text-green-200":"bg-green-100 border-green-400 text-green-700",error:o==="dark"?"bg-red-900/80 border-red-600 text-red-200":"bg-red-100 border-red-400 text-red-700",warning:o==="dark"?"bg-yellow-900/80 border-yellow-600 text-yellow-200":"bg-yellow-100 border-yellow-400 text-yellow-700",info:o==="dark"?"bg-blue-900/80 border-blue-600 text-blue-200":"bg-blue-100 border-blue-400 text-blue-700"},d={success:"✅",error:"❌",warning:"⚠️",info:"ℹ️"};return P.jsx("div",{className:"fixed top-4 right-4 z-50 animate-in slide-in-from-right duration-300",children:P.jsx("div",{className:`${h[t]} border-l-4 p-4 rounded-xl shadow-xl backdrop-blur-sm max-w-md transition-all duration-300`,children:P.jsxs("div",{className:"flex items-center",children:[P.jsx("span",{className:"mr-2",children:d[t]}),P.jsx("p",{className:"font-medium",children:e}),P.jsx("button",{onClick:n,className:"ml-auto text-lg hover:opacity-70 transition-opacity",children:"×"})]})})})},jue=()=>{const e=Oi(),[t,r]=be.useState([]),[n,o]=be.useState(!0);be.useEffect(()=>{(async()=>{try{const s=await e.listPeakHours();r(s)}catch(s){console.error("Failed to load peak hours data:",s)}finally{o(!1)}})()},[e]);const h=d=>d===0?"12 AM":d===12?"12 PM":d<12?`${d} AM`:`${d-12} PM`;return n?P.jsx(Xr,{title:"Peak Hours",children:P.jsx("div",{className:"h-64 flex items-center justify-center",children:P.jsx("div",{className:"text-gray-500",children:"Loading chart..."})})}):P.jsx(Xr,{title:"Peak Hours",children:P.jsx("div",{className:"h-64",children:P.jsx(kN,{width:"100%",height:"100%",children:P.jsxs($$,{data:t,margin:{top:5,right:30,left:20,bottom:5},children:[P.jsx(wT,{strokeDasharray:"3 3"}),P.jsx(kg,{dataKey:"hour",tickFormatter:h,tick:{fontSize:12}}),P.jsx(Eg,{label:{value:"Riders",angle:-90,position:"insideLeft"},tick:{fontSize:12}}),P.jsx(go,{labelFormatter:d=>`Time: ${h(d)}`,formatter:d=>[d,"Riders"],contentStyle:{backgroundColor:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:"6px"}}),P.jsx(lc,{dataKey:"riders",fill:"#3b82f6",radius:[4,4,0,0]})]})})})})},Oue=()=>{const e=Oi(),[t,r]=be.useState([]),[n,o]=be.useState(!0);return be.useEffect(()=>{(async()=>{try{const d=await e.listPeakRoutes();r(d)}catch(d){console.error("Failed to load peak routes data:",d)}finally{o(!1)}})()},[e]),n?P.jsx(Xr,{title:"Peak Routes",children:P.jsx("div",{className:"h-64 flex items-center justify-center",children:P.jsx("div",{className:"text-gray-500",children:"Loading chart..."})})}):P.jsx(Xr,{title:"Peak Routes",children:P.jsx("div",{className:"h-64",children:P.jsx(kN,{width:"100%",height:"100%",children:P.jsxs($$,{data:t,layout:"horizontal",margin:{top:5,right:30,left:100,bottom:5},children:[P.jsx(wT,{strokeDasharray:"3 3"}),P.jsx(kg,{type:"number",tick:{fontSize:12}}),P.jsx(Eg,{type:"category",dataKey:"routeName",tick:{fontSize:10},width:90}),P.jsx(go,{formatter:h=>[h,"Riders"],contentStyle:{backgroundColor:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:"6px"}}),P.jsx(lc,{dataKey:"riders",fill:"#10b981",radius:[0,4,4,0]})]})})})})},z$=be.createContext(void 0),ST=()=>{const e=be.useContext(z$);if(!e)throw new Error("useNotifications must be used within NotificationProvider");return e},Due=({children:e})=>{const[t,r]=be.useState([]),n=w=>{const k={...w,id:`notification_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date,isRead:!1};r(E=>[k,...E]),w.autoRemove!==!1&&setTimeout(()=>{o(k.id)},5e3)},o=w=>{r(k=>k.filter(E=>E.id!==w))},h=w=>{r(k=>k.map(E=>E.id===w?{...E,isRead:!0}:E))},d=()=>{r([])},s=t.filter(w=>!w.isRead).length;be.useEffect(()=>As.onEvent(k=>{const E=Rue(k.type);n({type:E,title:Nue(k.type),message:k.message,autoRemove:k.type!=="emergency"})}),[]);const y={notifications:t,addNotification:n,removeNotification:o,markAsRead:h,clearAll:d,unreadCount:s};return P.jsx(z$.Provider,{value:y,children:e})},Rue=e=>{switch(e){case"emergency":return"error";case"delay":return"warning";case"completed":return"success";case"started":case"milestone":case"stopped":return"info";default:return"info"}},Nue=e=>{switch(e){case"started":return"Journey Started";case"stopped":return"Journey Stopped";case"emergency":return"Emergency Alert";case"delay":return"Delay Notification";case"completed":return"Journey Completed";case"milestone":return"Milestone Reached";default:return"Bus Update"}},wj=()=>{const{theme:e}=Mr(),{notifications:t}=ST(),[r,n]=be.useState(new Date),[o,h]=be.useState(null);be.useEffect(()=>{const k=setInterval(()=>n(new Date),1e3);return()=>clearInterval(k)},[]);const d=[{icon:Gs,label:"Active Buses",value:"24",change:"+12%",color:"from-blue-500 to-cyan-500",darkColor:"from-blue-400 to-cyan-400"},{icon:oR,label:"Online Drivers",value:"18",change:"+8%",color:"from-green-500 to-emerald-500",darkColor:"from-green-400 to-emerald-400"},{icon:Cm,label:"Active Routes",value:"6",change:"0%",color:"from-purple-500 to-violet-500",darkColor:"from-purple-400 to-violet-400"},{icon:wd,label:"SOS Alerts",value:"1",change:"-50%",color:"from-red-500 to-orange-500",darkColor:"from-red-400 to-orange-400"}],s=t.slice(0,4).map(k=>({time:k.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})+` (${Math.floor((Date.now()-k.timestamp.getTime())/6e4)} min ago)`,message:k.message,type:k.type})),y=[{time:"System Ready",message:"Dashboard initialized successfully",type:"success"},{time:"Awaiting Data",message:"Waiting for real-time events...",type:"info"}],w=s.length>0?s:y;return P.jsxs("div",{className:"space-y-8 relative",children:[P.jsxs("div",{className:`relative overflow-hidden rounded-3xl p-8 ${e==="dark"?"bg-gradient-to-br from-gray-800/50 to-gray-900/50 backdrop-blur-xl border border-gray-700/50":"bg-gradient-to-br from-white/50 to-gray-50/50 backdrop-blur-xl border border-gray-200/50"} shadow-2xl`,children:[P.jsx("div",{className:`absolute -top-20 -right-20 w-40 h-40 rounded-full blur-3xl opacity-30 animate-float ${e==="dark"?"bg-purple-500":"bg-blue-500"}`}),P.jsx("div",{className:`absolute -bottom-20 -left-20 w-40 h-40 rounded-full blur-3xl opacity-30 animate-float delay-1000 ${e==="dark"?"bg-cyan-500":"bg-indigo-500"}`}),P.jsxs("div",{className:"relative z-10 flex flex-col lg:flex-row justify-between items-start lg:items-center",children:[P.jsx("div",{className:"mb-6 lg:mb-0",children:P.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[P.jsx("div",{className:`p-3 rounded-2xl bg-gradient-to-br ${e==="dark"?"from-purple-500 to-cyan-500":"from-blue-500 to-indigo-600"} shadow-lg`,children:P.jsx(QB,{className:"text-white text-2xl"})}),P.jsxs("div",{children:[P.jsx("h1",{className:`text-4xl font-bold bg-gradient-to-r bg-clip-text text-transparent ${e==="dark"?"from-purple-400 to-cyan-400":"from-blue-600 to-indigo-600"}`,children:"Command Center"}),P.jsx("p",{className:`text-lg ${e==="dark"?"text-gray-300":"text-gray-600"}`,children:"Real-time NextStop operations overview"})]})]})}),P.jsx("div",{className:"flex flex-col items-end space-y-2",children:P.jsxs("div",{className:`px-6 py-3 rounded-2xl ${e==="dark"?"bg-gray-800/50 border border-gray-700/50":"bg-white/50 border border-gray-200/50"} backdrop-blur-sm`,children:[P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx(qB,{className:`${e==="dark"?"text-purple-400":"text-blue-600"}`}),P.jsx("span",{className:`font-mono text-lg font-bold ${e==="dark"?"text-white":"text-gray-900"}`,children:r.toLocaleTimeString()})]}),P.jsx("p",{className:`text-sm ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:r.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})})]})]}),P.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6",children:d.map((k,E)=>P.jsxs("div",{className:`group relative overflow-hidden rounded-2xl p-6 transition-all duration-500 hover:scale-105 hover:-translate-y-2 ${e==="dark"?"bg-gray-800/50 backdrop-blur-xl border border-gray-700/50":"bg-white/50 backdrop-blur-xl border border-gray-200/50"} shadow-xl hover:shadow-2xl animate-fade-in`,style:{animationDelay:`${E*100}ms`},children:[P.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${e==="dark"?k.darkColor:k.color} opacity-5 group-hover:opacity-10 transition-opacity duration-300`}),P.jsxs("div",{className:"relative z-10",children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${e==="dark"?k.darkColor:k.color} shadow-lg group-hover:scale-110 transition-transform duration-300`,children:P.jsx(k.icon,{className:"text-white text-xl"})}),P.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${k.change.startsWith("+")?"bg-green-500/20 text-green-500":k.change.startsWith("-")?"bg-red-500/20 text-red-500":"bg-gray-500/20 text-gray-500"}`,children:k.change})]}),P.jsx("h3",{className:`text-3xl font-bold mb-1 ${e==="dark"?"text-white":"text-gray-900"}`,children:k.value}),P.jsx("p",{className:`text-sm ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:k.label})]})]},E))}),P.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:P.jsx(s6,{})}),P.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[P.jsxs("div",{className:"xl:col-span-2 space-y-8",children:[P.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:P.jsx(m6,{showAllBuses:!0,selectedBusId:o||void 0,onBusSelect:h})}),P.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[P.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:P.jsx(jue,{})}),P.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:P.jsx(Oue,{})})]})]}),P.jsxs("div",{className:`rounded-2xl p-6 ${e==="dark"?"bg-gray-800/50 backdrop-blur-xl border border-gray-700/50":"bg-white/50 backdrop-blur-xl border border-gray-200/50"} shadow-xl`,children:[P.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[P.jsx("div",{className:`p-2 rounded-xl bg-gradient-to-br ${e==="dark"?"from-purple-500 to-cyan-500":"from-blue-500 to-indigo-600"}`,children:P.jsx(o6,{className:"text-white"})}),P.jsx("h2",{className:`text-xl font-bold ${e==="dark"?"text-white":"text-gray-900"}`,children:"Live Activity"})]}),P.jsx("div",{className:"space-y-4",children:w.map((k,E)=>P.jsx("div",{className:`p-4 rounded-xl transition-all duration-300 hover:scale-105 ${e==="dark"?"bg-gray-700/30 hover:bg-gray-700/50":"bg-gray-50/50 hover:bg-gray-100/70"} animate-fade-in`,style:{animationDelay:`${E*150}ms`},children:P.jsxs("div",{className:"flex items-start space-x-3",children:[P.jsx("div",{className:`w-2 h-2 rounded-full mt-2 animate-pulse ${k.type==="success"?"bg-green-500":k.type==="warning"?"bg-yellow-500":"bg-blue-500"}`}),P.jsxs("div",{className:"flex-1",children:[P.jsx("p",{className:`text-sm ${e==="dark"?"text-gray-200":"text-gray-800"}`,children:k.message}),P.jsx("p",{className:`text-xs mt-1 ${e==="dark"?"text-gray-500":"text-gray-400"}`,children:k.time})]})]})},E))}),P.jsx("button",{className:`w-full mt-6 py-3 rounded-xl font-medium transition-all duration-300 hover:scale-105 ${e==="dark"?"bg-gradient-to-r from-purple-600 to-cyan-600 text-white hover:from-purple-500 hover:to-cyan-500":"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-500 hover:to-indigo-500"} shadow-lg`,children:"View All Activities"})]})]}),P.jsxs("div",{className:`rounded-2xl p-8 ${e==="dark"?"bg-gradient-to-r from-gray-800/50 to-gray-900/50 backdrop-blur-xl border border-gray-700/50":"bg-gradient-to-r from-white/50 to-gray-50/50 backdrop-blur-xl border border-gray-200/50"} shadow-xl`,children:[P.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[P.jsx("div",{className:`p-2 rounded-xl bg-gradient-to-br ${e==="dark"?"from-purple-500 to-cyan-500":"from-blue-500 to-indigo-600"}`,children:P.jsx(rR,{className:"text-white"})}),P.jsx("h2",{className:`text-2xl font-bold ${e==="dark"?"text-white":"text-gray-900"}`,children:"Performance Overview"})]}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[P.jsxs("div",{className:`p-6 rounded-xl ${e==="dark"?"bg-gray-700/30":"bg-gray-50/50"}`,children:[P.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[P.jsx(iR,{className:`text-2xl ${e==="dark"?"text-blue-400":"text-blue-600"}`}),P.jsx("h3",{className:`font-semibold ${e==="dark"?"text-white":"text-gray-900"}`,children:"Fleet Efficiency"})]}),P.jsx("p",{className:`text-3xl font-bold mb-1 ${e==="dark"?"text-blue-400":"text-blue-600"}`,children:"94.2%"}),P.jsx("p",{className:`text-sm ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"+2.1% from last week"})]}),P.jsxs("div",{className:`p-6 rounded-xl ${e==="dark"?"bg-gray-700/30":"bg-gray-50/50"}`,children:[P.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[P.jsx(pP,{className:`text-2xl ${e==="dark"?"text-green-400":"text-green-600"}`}),P.jsx("h3",{className:`font-semibold ${e==="dark"?"text-white":"text-gray-900"}`,children:"Revenue Today"})]}),P.jsx("p",{className:`text-3xl font-bold mb-1 ${e==="dark"?"text-green-400":"text-green-600"}`,children:"₹12,430"}),P.jsx("p",{className:`text-sm ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"Target: ₹15,000"})]}),P.jsxs("div",{className:`p-6 rounded-xl ${e==="dark"?"bg-gray-700/30":"bg-gray-50/50"}`,children:[P.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[P.jsx(Cm,{className:`text-2xl ${e==="dark"?"text-purple-400":"text-purple-600"}`}),P.jsx("h3",{className:`font-semibold ${e==="dark"?"text-white":"text-gray-900"}`,children:"Avg Trip Time"})]}),P.jsx("p",{className:`text-3xl font-bold mb-1 ${e==="dark"?"text-purple-400":"text-purple-600"}`,children:"23 min"}),P.jsx("p",{className:`text-sm ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"-3 min improvement"})]})]})]})]})};function Fh(e){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:2}).format(e)}function fx(e){return new Intl.DateTimeFormat("en-IN",{day:"2-digit",month:"short",year:"numeric"}).format(e)}function PT(e){return new Intl.DateTimeFormat("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}).format(e)}function $ue(e){const r=new Date().getTime()-e.getTime(),n=Math.floor(r/(1e3*60)),o=Math.floor(r/(1e3*60*60)),h=Math.floor(r/(1e3*60*60*24));return n<1?"Just now":n<60?`${n} min${n>1?"s":""} ago`:o<24?`${o} hour${o>1?"s":""} ago`:h<7?`${h} day${h>1?"s":""} ago`:fx(e)}const zue=({isOpen:e,onClose:t,onAdd:r})=>{const{theme:n}=Mr(),[o,h]=be.useState(""),[d,s]=be.useState(""),[y,w]=be.useState(!1),k=async I=>{if(I.preventDefault(),!(!o.trim()||!d.trim())){w(!0);try{await r(o.trim(),d.trim()),h(""),s(""),t()}catch(j){console.error("Failed to add driver:",j)}finally{w(!1)}}},E=()=>{h(""),s(""),t()};return P.jsx(Ag,{isOpen:e,onClose:E,title:"Add New Driver",children:P.jsxs("form",{onSubmit:k,className:"space-y-4",children:[P.jsxs("div",{children:[P.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors duration-300 ${n==="dark"?"text-gray-200":"text-gray-700"}`,children:"Full Name"}),P.jsx("input",{type:"text",value:o,onChange:I=>h(I.target.value),required:!0,placeholder:"Enter driver's full name",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 transition-colors duration-300 ${n==="dark"?"bg-gray-700 border-gray-600 text-white focus:ring-purple-500 placeholder-gray-400":"bg-white border-gray-300 text-gray-900 focus:ring-blue-500 placeholder-gray-500"}`})]}),P.jsxs("div",{children:[P.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors duration-300 ${n==="dark"?"text-gray-200":"text-gray-700"}`,children:"Phone Number"}),P.jsx("input",{type:"tel",value:d,onChange:I=>s(I.target.value),required:!0,placeholder:"Enter phone number",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 transition-colors duration-300 ${n==="dark"?"bg-gray-700 border-gray-600 text-white focus:ring-purple-500 placeholder-gray-400":"bg-white border-gray-300 text-gray-900 focus:ring-blue-500 placeholder-gray-500"}`})]}),P.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[P.jsx(dr,{type:"button",variant:"secondary",onClick:E,disabled:y,children:"Cancel"}),P.jsx(dr,{type:"submit",variant:"primary",disabled:y||!o.trim()||!d.trim(),children:y?"Adding...":"Add Driver"})]})]})})},Lue=({isOpen:e,onClose:t,driver:r,onAssign:n})=>{const{theme:o}=Mr(),h=Oi(),[d,s]=be.useState([]),[y,w]=be.useState([]),[k,E]=be.useState(""),[I,j]=be.useState([]),[z,L]=be.useState(!1);be.useEffect(()=>{e&&q()},[e]);const q=async()=>{try{const[N,W]=await Promise.all([h.listBuses(),h.listRoutes()]);s(N.filter(H=>H.active)),w(W)}catch(N){console.error("Failed to load buses and routes:",N)}},F=N=>{j(W=>W.includes(N)?W.filter(H=>H!==N):[...W,N])},U=async N=>{if(N.preventDefault(),!(!r||!k||I.length===0)){L(!0);try{await n(r.id,k,I),t(),E(""),j([])}catch(W){console.error("Failed to assign driver:",W)}finally{L(!1)}}};return P.jsx(Ag,{isOpen:e,onClose:t,title:"Approve & Assign Driver",maxWidth:"lg",children:r&&P.jsxs("form",{onSubmit:U,className:"space-y-6",children:[P.jsxs("div",{className:`p-4 rounded-lg transition-colors duration-300 ${o==="dark"?"bg-gray-700/50":"bg-gray-50"}`,children:[P.jsx("h3",{className:`font-medium mb-2 transition-colors duration-300 ${o==="dark"?"text-white":"text-gray-900"}`,children:"Driver Information"}),P.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[P.jsxs("div",{className:`transition-colors duration-300 ${o==="dark"?"text-gray-300":"text-gray-700"}`,children:[P.jsx("span",{className:"font-medium",children:"Name:"})," ",r.fullName]}),P.jsxs("div",{className:`transition-colors duration-300 ${o==="dark"?"text-gray-300":"text-gray-700"}`,children:[P.jsx("span",{className:"font-medium",children:"Phone:"})," ",r.phone]}),P.jsxs("div",{className:`transition-colors duration-300 ${o==="dark"?"text-gray-300":"text-gray-700"}`,children:[P.jsx("span",{className:"font-medium",children:"Rating:"})," ",r.rating,"/5"]}),P.jsxs("div",{className:`transition-colors duration-300 ${o==="dark"?"text-gray-300":"text-gray-700"}`,children:[P.jsx("span",{className:"font-medium",children:"Joined:"})," ",fx(r.joinedAt)]})]})]}),P.jsxs("div",{children:[P.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors duration-300 ${o==="dark"?"text-gray-200":"text-gray-700"}`,children:"Assign Bus"}),P.jsxs("select",{value:k,onChange:N=>E(N.target.value),required:!0,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 transition-colors duration-300 ${o==="dark"?"bg-gray-700 border-gray-600 text-white focus:ring-purple-500":"bg-white border-gray-300 text-gray-900 focus:ring-blue-500"}`,children:[P.jsx("option",{value:"",children:"Select a bus..."}),d.map(N=>P.jsxs("option",{value:N.id,children:[N.busNumber," - ",N.vehicleType]},N.id))]})]}),P.jsxs("div",{children:[P.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors duration-300 ${o==="dark"?"text-gray-200":"text-gray-700"}`,children:"Assign Routes (select one or more)"}),P.jsx("div",{className:`max-h-40 overflow-y-auto border rounded-md p-3 space-y-2 transition-colors duration-300 ${o==="dark"?"border-gray-600 bg-gray-700/30":"border-gray-300 bg-white"}`,children:y.map(N=>P.jsxs("label",{className:"flex items-center space-x-2",children:[P.jsx("input",{type:"checkbox",checked:I.includes(N.id),onChange:()=>F(N.id),className:`h-4 w-4 rounded focus:ring-2 transition-colors duration-300 ${o==="dark"?"text-purple-600 focus:ring-purple-500 border-gray-500 bg-gray-600":"text-blue-600 focus:ring-blue-500 border-gray-300"}`}),P.jsxs("span",{className:`text-sm transition-colors duration-300 ${o==="dark"?"text-gray-300":"text-gray-700"}`,children:[N.name," (",N.code,") - Priority: ",N.priorityScore]})]},N.id))}),I.length===0&&P.jsx("p",{className:"text-sm text-red-600 mt-1",children:"Please select at least one route"})]}),P.jsxs("div",{className:"flex justify-end space-x-3",children:[P.jsx(dr,{type:"button",variant:"secondary",onClick:t,children:"Cancel"}),P.jsx(dr,{type:"submit",disabled:z||!k||I.length===0,children:z?"Assigning...":"Approve & Assign"})]})]})})},Bue=({highlightedItemId:e})=>{const{theme:t}=Mr(),r=Oi(),[n,o]=be.useState([]),[h,d]=be.useState(!0),[s,y]=be.useState(null),[w,k]=be.useState(!1),[E,I]=be.useState(!1),[j,z]=be.useState({message:"",type:"info",isVisible:!1});be.useEffect(()=>{L()},[]);const L=async()=>{try{const W=await r.listDrivers();o(W)}catch(W){console.error("Failed to load drivers:",W)}finally{d(!1)}},q=async(W,H,Z)=>{try{await r.approveAndAssignDriver({driverId:W,busId:H,routeIds:Z}),await L(),z({message:"Driver approved and assigned successfully!",type:"success",isVisible:!0})}catch(re){console.error("Failed to assign driver:",re),z({message:"Failed to assign driver. Please try again.",type:"error",isVisible:!0})}},F=W=>{y(W),k(!0)},U=async(W,H)=>{try{await r.createDriver({fullName:W,phone:H}),await L(),z({message:"Driver added successfully! Waiting for approval.",type:"success",isVisible:!0}),I(!1)}catch(Z){console.error("Failed to add driver:",Z),z({message:"Failed to add driver. Please try again.",type:"error",isVisible:!0})}},N=W=>{switch(W){case"approved":return"success";case"pending":return"warning";case"inactive":return"danger";default:return"default"}};return h?P.jsxs("div",{className:"space-y-6",children:[P.jsx("h1",{className:`text-2xl font-bold transition-colors duration-300 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Drivers"}),P.jsx(Xr,{children:P.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(W=>P.jsx("div",{className:"h-12 bg-gray-200 rounded"},W))})})]}):P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{className:"flex justify-between items-center",children:[P.jsxs("div",{children:[P.jsx("h1",{className:`text-2xl font-bold mb-2 transition-colors duration-300 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Drivers"}),P.jsx("p",{className:`transition-colors duration-300 ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Manage driver approvals and assignments"})]}),P.jsxs(dr,{onClick:()=>I(!0),variant:"primary",className:"flex items-center space-x-2",children:[P.jsx(fP,{className:"h-5 w-5"}),P.jsx("span",{children:"Add Driver"})]})]}),P.jsxs(Xr,{children:[P.jsxs(sf,{children:[P.jsx(lf,{children:P.jsxs(Ya,{children:[P.jsx(_t,{isHeader:!0,children:"Name"}),P.jsx(_t,{isHeader:!0,children:"Phone"}),P.jsx(_t,{isHeader:!0,children:"Rating"}),P.jsx(_t,{isHeader:!0,children:"Joined"}),P.jsx(_t,{isHeader:!0,children:"Status"}),P.jsx(_t,{isHeader:!0,children:"Assigned Bus"}),P.jsx(_t,{isHeader:!0,children:"Routes"}),P.jsx(_t,{isHeader:!0,children:"Actions"})]})}),P.jsx(cf,{children:n.map(W=>{var H;return P.jsxs(Ya,{className:e===W.id?`${t==="dark"?"bg-cyan-500/20 ring-2 ring-cyan-400/50":"bg-blue-50 ring-2 ring-blue-400/50"} transition-all duration-1000`:"",children:[P.jsx(_t,{children:P.jsxs("div",{children:[P.jsx("div",{className:`font-medium ${t==="dark"?"text-gray-100":"text-gray-900"}`,children:W.fullName}),P.jsxs("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["ID: ",W.id]})]})}),P.jsx(_t,{children:W.phone}),P.jsx(_t,{children:P.jsxs("div",{className:"flex items-center",children:[P.jsx("span",{className:"text-yellow-400 mr-1",children:"⭐"}),W.rating]})}),P.jsx(_t,{children:fx(W.joinedAt)}),P.jsx(_t,{children:P.jsx(Cg,{variant:N(W.status),children:W.status})}),P.jsx(_t,{children:W.assignedBusId||P.jsx("span",{className:`${t==="dark"?"text-gray-500":"text-gray-400"}`,children:"Not assigned"})}),P.jsx(_t,{children:(H=W.assignedRouteIds)!=null&&H.length?P.jsxs("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:[W.assignedRouteIds.length," route(s)"]}):P.jsx("span",{className:`${t==="dark"?"text-gray-500":"text-gray-400"}`,children:"No routes"})}),P.jsxs(_t,{children:[W.status==="pending"&&P.jsx(dr,{size:"sm",onClick:()=>F(W),children:"Approve & Assign"}),W.status==="approved"&&P.jsx("span",{className:`text-sm ${t==="dark"?"text-green-400":"text-green-600"}`,children:"✓ Approved"})]})]},W.id)})})]}),n.length===0&&P.jsx("div",{className:"text-center py-8 text-gray-500",children:"No drivers found"})]}),P.jsx(Lue,{isOpen:w,onClose:()=>k(!1),driver:s,onAssign:q}),P.jsx(zue,{isOpen:E,onClose:()=>I(!1),onAdd:U}),P.jsx(Mg,{message:j.message,type:j.type,isVisible:j.isVisible,onClose:()=>z(W=>({...W,isVisible:!1}))})]})},Fue=({busId:e,bus:t,driver:r})=>{const{theme:n}=Mr(),[o,h]=be.useState(),[d,s]=be.useState(!1),[y,w]=be.useState("");be.useEffect(()=>{const F=As.onUpdate(N=>{const W=N.find(H=>H.busId===e);h(W)}),U=As.getBusState(e);return h(U),F},[e]);const k=()=>{if(!y){s(!0);return}As.startBusJourney(e,y)&&s(!1)},E=()=>{As.stopBusJourney(e)},I=()=>{const F=Math.floor(Math.random()*15)+5;As.simulateDelay(e,F)},j=()=>{As.simulateEmergency(e)},z=()=>{As.resumeBusJourney(e)},L=F=>{if(!F)return"text-gray-500";switch(F){case"moving":return"text-green-500";case"stopped":return"text-orange-500";case"delayed":return"text-red-500";case"emergency":return"text-red-600";case"completed":return"text-blue-500";default:return"text-gray-500"}},q=F=>{if(!F)return P.jsx(Gs,{className:"text-gray-500"});switch(F){case"moving":return P.jsx(a1,{className:"text-green-500"});case"stopped":return P.jsx(XB,{className:"text-orange-500"});case"delayed":return P.jsx($0,{className:"text-red-500"});case"emergency":return P.jsx(wd,{className:"text-red-600"});case"completed":return P.jsx(Cm,{className:"text-blue-500"});default:return P.jsx(Gs,{className:"text-gray-500"})}};return P.jsxs("div",{className:`p-4 rounded-lg border ${n==="dark"?"bg-gray-800/50 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsxs("div",{className:"flex items-center space-x-3",children:[P.jsx("div",{className:"text-2xl",children:q(o==null?void 0:o.status)}),P.jsxs("div",{children:[P.jsxs("h3",{className:`font-semibold ${n==="dark"?"text-white":"text-gray-900"}`,children:["Bus ",t.busNumber]}),P.jsx("p",{className:`text-sm ${L(o==null?void 0:o.status)}`,children:o!=null&&o.status?o.status.charAt(0).toUpperCase()+o.status.slice(1):"Idle"})]})]}),o&&P.jsxs("div",{className:`text-right text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:[P.jsxs("p",{children:["Progress: ",o.progress.toFixed(1),"%"]}),P.jsxs("p",{children:["Speed: ",o.speed," km/h"]})]})]}),o&&P.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[P.jsxs("div",{className:`text-center p-2 rounded ${n==="dark"?"bg-gray-700/50":"bg-white"}`,children:[P.jsx(Cm,{className:"mx-auto mb-1 text-blue-500"}),P.jsx("p",{className:`text-xs ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:o.nextStop||"Destination"})]}),P.jsxs("div",{className:`text-center p-2 rounded ${n==="dark"?"bg-gray-700/50":"bg-white"}`,children:[P.jsx($0,{className:"mx-auto mb-1 text-orange-500"}),P.jsxs("p",{className:`text-xs ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:["ETA: ",Math.round(o.estimatedTimeRemaining),"m"]})]}),P.jsxs("div",{className:`text-center p-2 rounded ${n==="dark"?"bg-gray-700/50":"bg-white"}`,children:[P.jsx(Mm,{className:"mx-auto mb-1 text-green-500"}),P.jsxs("p",{className:`text-xs ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:[o.distanceToDestination.toFixed(1),"km"]})]})]}),P.jsx("div",{className:"space-y-2",children:o?o.status==="moving"?P.jsxs("div",{className:"space-y-2",children:[P.jsxs(dr,{onClick:E,className:"w-full bg-red-600 hover:bg-red-700 text-white",children:[P.jsx(bA,{className:"mr-2"}),"Stop Journey"]}),P.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[P.jsxs(dr,{onClick:I,className:"bg-orange-600 hover:bg-orange-700 text-white text-sm",children:[P.jsx($0,{className:"mr-1"}),"Delay"]}),P.jsxs(dr,{onClick:j,className:"bg-red-700 hover:bg-red-800 text-white text-sm",children:[P.jsx(wd,{className:"mr-1"}),"Emergency"]})]})]}):o.status==="emergency"||o.status==="delayed"?P.jsxs("div",{className:"space-y-2",children:[P.jsxs(dr,{onClick:z,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[P.jsx(a1,{className:"mr-2"}),"Resume Journey"]}),P.jsxs(dr,{onClick:E,className:"w-full bg-red-600 hover:bg-red-700 text-white",children:[P.jsx(bA,{className:"mr-2"}),"Stop Journey"]})]}):null:P.jsxs(dr,{onClick:k,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:[P.jsx(a1,{className:"mr-2"}),"Start Route"]})}),P.jsx(Ag,{isOpen:d,onClose:()=>s(!1),title:"Select Route",children:P.jsxs("div",{className:"space-y-4",children:[P.jsxs("p",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:["Choose a route for Bus ",t.busNumber," to begin simulation:"]}),P.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:cR.map(F=>P.jsxs("button",{onClick:()=>w(F.id),className:`w-full p-3 text-left rounded-lg border transition-colors ${y===F.id?n==="dark"?"bg-blue-600/20 border-blue-500 text-blue-300":"bg-blue-50 border-blue-500 text-blue-700":n==="dark"?"bg-gray-700 border-gray-600 text-gray-300 hover:bg-gray-600":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[P.jsx("h4",{className:"font-medium",children:F.name}),P.jsxs("p",{className:"text-sm opacity-75",children:[F.distance,"km • ~",F.estimatedDuration," minutes"]})]},F.id))}),P.jsxs("div",{className:"flex space-x-3",children:[P.jsx(dr,{onClick:()=>s(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white",children:"Cancel"}),P.jsx(dr,{onClick:k,disabled:!y,className:"flex-1 bg-green-600 hover:bg-green-700 text-white disabled:opacity-50",children:"Start Journey"})]})]})})]})},Uue=({highlightedItemId:e})=>{const{theme:t}=Mr(),r=Oi(),[n,o]=be.useState([]),[h,d]=be.useState([]),[s,y]=be.useState(!0),[w,k]=be.useState(!1),[E,I]=be.useState({busNumber:"",vehicleType:"bus",active:!0,notes:""}),[j,z]=be.useState({message:"",type:"info",isVisible:!1});be.useEffect(()=>{L()},[]);const L=async()=>{try{const[W,H]=await Promise.all([r.listBuses(),r.listDrivers()]);o(W),d(H)}catch(W){console.error("Failed to load buses:",W)}finally{y(!1)}},q=async()=>{if(!E.busNumber.trim()){z({message:"Please enter a bus number",type:"error",isVisible:!0});return}try{await r.createBus({busNumber:E.busNumber,vehicleType:E.vehicleType,notes:E.notes||void 0}),await L(),k(!1),I({busNumber:"",vehicleType:"bus",active:!0,notes:""}),z({message:"Bus added successfully!",type:"success",isVisible:!0})}catch(W){console.error("Failed to add bus:",W),z({message:"Failed to add bus. Please try again.",type:"error",isVisible:!0})}},F=W=>W?"success":"danger",U=W=>W.assignedDriverId?h.find(H=>H.id===W.assignedDriverId):null,N=W=>{switch(W){case"bus":return"🚌";case"miniBus":return"🚐";case"auto":return"🛺";case"other":return"🚗";default:return"🚗"}};return s?P.jsxs("div",{className:"space-y-6",children:[P.jsx("h1",{className:`text-2xl font-bold transition-colors duration-300 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Buses"}),P.jsx(Xr,{children:P.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(W=>P.jsx("div",{className:"h-12 bg-gray-200 rounded"},W))})})]}):P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{className:"flex justify-between items-center",children:[P.jsxs("div",{children:[P.jsx("h1",{className:`text-2xl font-bold mb-2 transition-colors duration-300 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Buses"}),P.jsx("p",{className:`transition-colors duration-300 ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Manage fleet vehicles and their status"})]}),P.jsxs(dr,{onClick:()=>k(!0),children:[P.jsx(fP,{className:"mr-2"}),"Add New Bus"]})]}),P.jsx(Xr,{children:P.jsxs("div",{className:"p-6",children:[P.jsxs("div",{className:"flex items-center justify-between mb-6",children:[P.jsxs("div",{children:[P.jsx("h2",{className:`text-xl font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"🚀 Real-Time GPS Simulation"}),P.jsx("p",{className:`text-sm mt-1 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Start bus journeys and track real-time GPS movement"})]}),P.jsx("div",{className:"flex items-center space-x-2",children:P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),P.jsx("span",{className:`text-sm font-medium ${t==="dark"?"text-green-400":"text-green-600"}`,children:"Simulation Ready"})]})})]}),P.jsxs("div",{className:"space-y-4",children:[n.filter(W=>W.active).map(W=>{const H=h.find(Z=>Z.assignedBusId===W.id);return P.jsx("div",{className:`border rounded-lg p-4 ${t==="dark"?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"}`,children:P.jsx(Fue,{busId:W.id,bus:W,driver:H})},W.id)}),n.filter(W=>W.active).length===0&&P.jsxs("div",{className:`text-center py-8 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[P.jsx("div",{className:"text-4xl mb-2",children:"🚌"}),P.jsx("p",{children:"No active buses available for simulation"}),P.jsx("p",{className:"text-sm mt-1",children:"Add buses and mark them as active to start simulations"})]})]})]})}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[P.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Total Buses"}),P.jsx("p",{className:"text-2xl font-bold text-blue-700 mt-1",children:n.length})]}),P.jsx("div",{className:"text-2xl",children:"🚌"})]})}),P.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-green-700",children:"Active Buses"}),P.jsx("p",{className:"text-2xl font-bold text-green-700 mt-1",children:n.filter(W=>W.active).length})]}),P.jsx("div",{className:"text-2xl",children:"✅"})]})}),P.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-red-700",children:"Inactive Buses"}),P.jsx("p",{className:"text-2xl font-bold text-red-700 mt-1",children:n.filter(W=>!W.active).length})]}),P.jsx("div",{className:"text-2xl",children:"❌"})]})}),P.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"Types"}),P.jsx("p",{className:"text-2xl font-bold text-yellow-700 mt-1",children:new Set(n.map(W=>W.vehicleType)).size})]}),P.jsx("div",{className:"text-2xl",children:"🚗"})]})})]}),P.jsxs(Xr,{children:[P.jsxs(sf,{children:[P.jsx(lf,{children:P.jsxs(Ya,{children:[P.jsx(_t,{isHeader:!0,children:"Bus Number"}),P.jsx(_t,{isHeader:!0,children:"Vehicle Type"}),P.jsx(_t,{isHeader:!0,children:"Status"}),P.jsx(_t,{isHeader:!0,children:"Assigned Driver"}),P.jsx(_t,{isHeader:!0,children:"Notes"})]})}),P.jsx(cf,{children:n.map(W=>P.jsxs(Ya,{className:e===W.id?`${t==="dark"?"bg-cyan-500/20 ring-2 ring-cyan-400/50":"bg-blue-50 ring-2 ring-blue-400/50"} transition-all duration-1000`:"",children:[P.jsx(_t,{children:P.jsxs("div",{children:[P.jsx("div",{className:`font-medium ${t==="dark"?"text-gray-100":"text-gray-900"}`,children:W.busNumber}),P.jsxs("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["ID: ",W.id]})]})}),P.jsx(_t,{children:P.jsxs("div",{className:"flex items-center",children:[P.jsx("span",{className:"mr-2 text-lg",children:N(W.vehicleType)}),P.jsx("span",{className:"capitalize",children:W.vehicleType})]})}),P.jsx(_t,{children:P.jsx(Cg,{variant:F(W.active),children:W.active?"Active":"Inactive"})}),P.jsx(_t,{children:(()=>{const H=U(W);return H?P.jsxs("div",{children:[P.jsx("div",{className:`font-medium ${t==="dark"?"text-gray-100":"text-gray-900"}`,children:H.fullName}),P.jsx("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:H.phone})]}):P.jsx("span",{className:`${t==="dark"?"text-gray-500":"text-gray-400"}`,children:"Not assigned"})})()}),P.jsx(_t,{children:W.notes?P.jsx("span",{className:`${t==="dark"?"text-gray-300":"text-gray-700"}`,children:W.notes}):P.jsx("span",{className:`${t==="dark"?"text-gray-500":"text-gray-400"}`,children:"No notes"})})]},W.id))})]}),n.length===0&&P.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"No buses found"})]}),P.jsx(Ag,{isOpen:w,onClose:()=>k(!1),title:"Add New Bus",children:P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{children:[P.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-200":"text-gray-700"}`,children:"Bus Number *"}),P.jsx("input",{type:"text",value:E.busNumber,onChange:W=>I(H=>({...H,busNumber:W.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:ring-purple-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-500 focus:ring-blue-500"}`,placeholder:"e.g., BUS001"})]}),P.jsxs("div",{children:[P.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-200":"text-gray-700"}`,children:"Vehicle Type"}),P.jsxs("select",{value:E.vehicleType,onChange:W=>I(H=>({...H,vehicleType:W.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${t==="dark"?"bg-gray-700 border-gray-600 text-white focus:ring-purple-500":"bg-white border-gray-300 text-gray-900 focus:ring-blue-500"}`,children:[P.jsx("option",{value:"bus",children:"Bus"}),P.jsx("option",{value:"miniBus",children:"Mini Bus"}),P.jsx("option",{value:"auto",children:"Auto"}),P.jsx("option",{value:"other",children:"Other"})]})]}),P.jsx("div",{children:P.jsxs("label",{className:"flex items-center",children:[P.jsx("input",{type:"checkbox",checked:E.active,onChange:W=>I(H=>({...H,active:W.target.checked})),className:"mr-2"}),P.jsx("span",{className:`text-sm font-medium ${t==="dark"?"text-gray-200":"text-gray-700"}`,children:"Active"})]})}),P.jsxs("div",{children:[P.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-200":"text-gray-700"}`,children:"Notes (Optional)"}),P.jsx("textarea",{value:E.notes,onChange:W=>I(H=>({...H,notes:W.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:ring-purple-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-500 focus:ring-blue-500"}`,rows:3,placeholder:"Any additional notes..."})]}),P.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[P.jsx(dr,{variant:"secondary",onClick:()=>k(!1),children:"Cancel"}),P.jsx(dr,{onClick:q,children:"Add Bus"})]})]})}),P.jsx(Mg,{message:j.message,type:j.type,isVisible:j.isVisible,onClose:()=>z(W=>({...W,isVisible:!1}))})]})},Vue=({highlightedItemId:e})=>{const{theme:t}=Mr(),r=Oi(),[n,o]=be.useState([]),[h,d]=be.useState([]),[s,y]=be.useState(!0),[w,k]=be.useState("priority"),[E,I]=be.useState("desc"),[j,z]=be.useState(""),[L,q]=be.useState(!1),[F,U]=be.useState({name:"",code:"",priorityScore:70}),[N,W]=be.useState({message:"",type:"info",isVisible:!1});be.useEffect(()=>{H()},[]);const H=async()=>{try{const[Se,Ue]=await Promise.all([r.listRoutes(),r.listDrivers()]);o(Se),d(Ue)}catch(Se){console.error("Failed to load routes:",Se)}finally{y(!1)}},Z=async()=>{if(!F.name.trim()||!F.code.trim()){W({message:"Please enter route name and code",type:"error",isVisible:!0});return}try{await r.createRoute({name:F.name,code:F.code,priorityScore:F.priorityScore}),await H(),q(!1),U({name:"",code:"",priorityScore:70}),W({message:"Route added successfully!",type:"success",isVisible:!0})}catch(Se){console.error("Failed to add route:",Se),W({message:"Failed to add route. Please try again.",type:"error",isVisible:!0})}},re=Se=>h.filter(Ue=>Ue.assignedRouteIds&&Ue.assignedRouteIds.includes(Se.id)),he=Se=>{w===Se?I(E==="asc"?"desc":"asc"):(k(Se),I("desc"))},we=n.filter(Se=>Se.name.toLowerCase().includes(j.toLowerCase())||Se.code.toLowerCase().includes(j.toLowerCase())).sort((Se,Ue)=>{let We,qe;return w==="name"?(We=Se.name.toLowerCase(),qe=Ue.name.toLowerCase()):(We=Se.priorityScore,qe=Ue.priorityScore),E==="asc"?We<qe?-1:We>qe?1:0:We>qe?-1:We<qe?1:0}),Oe=Se=>Se>=90?"text-red-600 bg-red-50":Se>=80?"text-orange-600 bg-orange-50":Se>=70?"text-yellow-600 bg-yellow-50":"text-green-600 bg-green-50",Me=Se=>Se>=90?"Critical":Se>=80?"High":Se>=70?"Medium":"Low";return s?P.jsxs("div",{className:"space-y-6",children:[P.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Routes"}),P.jsx(Xr,{children:P.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(Se=>P.jsx("div",{className:"h-12 bg-gray-200 rounded"},Se))})})]}):P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{className:"flex justify-between items-center",children:[P.jsxs("div",{children:[P.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Routes"}),P.jsx("p",{className:"text-gray-600",children:"Manage routes by priority and monitor performance"})]}),P.jsxs(dr,{onClick:()=>q(!0),children:[P.jsx(fP,{className:"mr-2"}),"Add New Route"]})]}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[P.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Total Routes"}),P.jsx("p",{className:"text-2xl font-bold text-blue-700 mt-1",children:n.length})]}),P.jsx("div",{className:"text-2xl",children:"🗺️"})]})}),P.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-red-700",children:"Critical Priority"}),P.jsx("p",{className:"text-2xl font-bold text-red-700 mt-1",children:n.filter(Se=>Se.priorityScore>=90).length})]}),P.jsx("div",{className:"text-2xl",children:"🔴"})]})}),P.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-orange-700",children:"High Priority"}),P.jsx("p",{className:"text-2xl font-bold text-orange-700 mt-1",children:n.filter(Se=>Se.priorityScore>=80&&Se.priorityScore<90).length})]}),P.jsx("div",{className:"text-2xl",children:"🟠"})]})}),P.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-green-700",children:"Avg Priority"}),P.jsx("p",{className:"text-2xl font-bold text-green-700 mt-1",children:n.length>0?Math.round(n.reduce((Se,Ue)=>Se+Ue.priorityScore,0)/n.length):0})]}),P.jsx("div",{className:"text-2xl",children:"📊"})]})})]}),P.jsxs(Xr,{children:[P.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 justify-between",children:[P.jsx("div",{className:"flex-1",children:P.jsx("input",{type:"text",placeholder:"Search routes by name or code...",value:j,onChange:Se=>z(Se.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:ring-purple-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-500 focus:ring-blue-500"}`})}),P.jsxs("div",{className:"flex gap-2",children:[P.jsxs(dr,{variant:w==="name"?"primary":"secondary",onClick:()=>he("name"),size:"sm",children:["Sort by Name ",w==="name"&&(E==="asc"?"↑":"↓")]}),P.jsxs(dr,{variant:w==="priority"?"primary":"secondary",onClick:()=>he("priority"),size:"sm",children:["Sort by Priority ",w==="priority"&&(E==="asc"?"↑":"↓")]})]})]}),P.jsxs(sf,{children:[P.jsx(lf,{children:P.jsxs(Ya,{children:[P.jsx(_t,{isHeader:!0,children:"Route Name"}),P.jsx(_t,{isHeader:!0,children:"Code"}),P.jsx(_t,{isHeader:!0,children:"Priority Score"}),P.jsx(_t,{isHeader:!0,children:"Priority Level"}),P.jsx(_t,{isHeader:!0,children:"Assigned Drivers"})]})}),P.jsx(cf,{children:we.map(Se=>P.jsxs(Ya,{className:e===Se.id?`${t==="dark"?"bg-cyan-500/20 ring-2 ring-cyan-400/50":"bg-blue-50 ring-2 ring-blue-400/50"} transition-all duration-1000`:"",children:[P.jsx(_t,{children:P.jsx("div",{className:`font-medium ${t==="dark"?"text-gray-100":"text-gray-900"}`,children:Se.name})}),P.jsx(_t,{children:P.jsx("span",{className:`font-mono text-sm px-2 py-1 rounded ${t==="dark"?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-800"}`,children:Se.code})}),P.jsx(_t,{children:P.jsxs("div",{className:"flex items-center",children:[P.jsx("span",{className:"font-medium",children:Se.priorityScore}),P.jsx("span",{className:`ml-1 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"/100"})]})}),P.jsx(_t,{children:P.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${Oe(Se.priorityScore)}`,children:Me(Se.priorityScore)})}),P.jsx(_t,{children:(()=>{const Ue=re(Se);return Ue.length>0?P.jsx("div",{className:"space-y-1",children:Ue.map((We,qe)=>P.jsxs("div",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[P.jsx("span",{className:"font-medium",children:We.fullName}),qe<Ue.length-1&&P.jsx("span",{className:"text-gray-400",children:", "})]},We.id))}):P.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-500":"text-gray-400"}`,children:"No drivers assigned"})})()})]},Se.id))})]}),we.length===0&&P.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:j?"No routes match your search":"No routes found"})]}),P.jsx(Ag,{isOpen:L,onClose:()=>q(!1),title:"Add New Route",children:P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{children:[P.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-200":"text-gray-700"}`,children:"Route Name *"}),P.jsx("input",{type:"text",value:F.name,onChange:Se=>U(Ue=>({...Ue,name:Se.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:ring-purple-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-500 focus:ring-blue-500"}`,placeholder:"e.g., Airport Express"})]}),P.jsxs("div",{children:[P.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-200":"text-gray-700"}`,children:"Route Code *"}),P.jsx("input",{type:"text",value:F.code,onChange:Se=>U(Ue=>({...Ue,code:Se.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:ring-purple-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-500 focus:ring-blue-500"}`,placeholder:"e.g., R001"})]}),P.jsxs("div",{children:[P.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-200":"text-gray-700"}`,children:"Priority Score (0-100)"}),P.jsx("input",{type:"number",min:"0",max:"100",value:F.priorityScore,onChange:Se=>U(Ue=>({...Ue,priorityScore:parseInt(Se.target.value)||0})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:ring-purple-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-500 focus:ring-blue-500"}`}),P.jsx("p",{className:`text-xs mt-1 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Higher scores indicate higher priority routes"})]}),P.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[P.jsx(dr,{variant:"secondary",onClick:()=>q(!1),children:"Cancel"}),P.jsx(dr,{onClick:Z,children:"Add Route"})]})]})}),P.jsx(Mg,{message:N.message,type:N.type,isVisible:N.isVisible,onClose:()=>W(Se=>({...Se,isVisible:!1}))})]})};function Gue(e,t,r){if(!e||!t||!r||e<=0||t<=0||r<=0)return;const n=e*r/t;return Math.round(n*100)/100}const que=2.68,Wue=({tripId:e,initialDistance:t,initialCost:r,initialFuelPrice:n})=>{const o=Oi(),[h,d]=be.useState(t||0),[s,y]=be.useState(r||0),[w,k]=be.useState(n||0),[E,I]=be.useState(!1),[j,z]=be.useState(!1);be.useEffect(()=>{(async()=>{if(!n)try{const H=await o.getSettings();k(H.fuelPricePerLitre)}catch(H){console.error("Failed to load fuel price setting:",H),k(100)}})()},[o,n]);const L=Gue(h,s,w),F=(()=>h<=0||s<=0||w<=0?void 0:s/w*que)(),U=async()=>{if(e){z(!0);try{await new Promise(W=>setTimeout(W,500)),I(!1)}catch(W){console.error("Failed to save fuel efficiency data:",W)}finally{z(!1)}}},N=()=>{d(t||0),y(r||0),k(n||100),I(!1)};return P.jsx(Xr,{title:"Fuel Efficiency Calculator",children:P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Distance (km)"}),P.jsx("input",{type:"number",min:"0",step:"0.1",value:h,onChange:W=>d(parseFloat(W.target.value)||0),disabled:!E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost (₹)"}),P.jsx("input",{type:"number",min:"0",step:"0.01",value:s,onChange:W=>y(parseFloat(W.target.value)||0),disabled:!E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuel Price per Litre (₹)"}),P.jsx("input",{type:"number",min:"0",step:"0.01",value:w,onChange:W=>k(parseFloat(W.target.value)||0),disabled:!E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"})]})]}),P.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("h4",{className:"font-medium text-blue-900",children:"Fuel Efficiency"}),P.jsx("p",{className:"text-2xl font-bold text-blue-700 mt-1",children:L!==void 0?`${L} km/L (est.)`:"N/A"}),L===void 0&&P.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Please enter valid distance, cost, and fuel price values"})]}),P.jsx("div",{className:"text-3xl",children:"⛽"})]})}),P.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("h4",{className:"font-medium text-green-900",children:"Carbon Emission"}),P.jsx("p",{className:"text-2xl font-bold text-green-700 mt-1",children:F!==void 0?`${F.toFixed(2)} kg CO₂`:"N/A"}),F===void 0&&P.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Requires valid distance, cost, and fuel price values"})]}),P.jsx("div",{className:"text-3xl",children:"🌱"})]})}),P.jsx("div",{className:"flex justify-end space-x-3",children:E?P.jsxs(P.Fragment,{children:[P.jsx(dr,{variant:"secondary",onClick:N,disabled:j,children:"Cancel"}),P.jsx(dr,{onClick:U,disabled:j,children:j?"Saving...":"Save"})]}):P.jsx(dr,{onClick:()=>I(!0),children:"Edit Values"})}),P.jsxs("div",{className:"text-xs text-gray-500 bg-gray-50 p-3 rounded-md",children:[P.jsx("strong",{children:"Fuel Efficiency Formula:"})," (Distance × Fuel Price per Litre) ÷ Cost",P.jsx("br",{}),P.jsx("strong",{children:"Carbon Emission Formula:"})," (Cost ÷ Fuel Price) × 2.68 kg CO₂/litre",P.jsx("br",{}),P.jsx("strong",{children:"Note:"})," These are estimated calculations based on trip cost and distance. Carbon emission factor assumes diesel fuel."]})]})})},Hue=()=>{const{theme:e}=Mr(),t=Oi(),[r,n]=be.useState([]),[o,h]=be.useState([]),[d,s]=be.useState([]),[y,w]=be.useState([]),[k,E]=be.useState(!0),[I,j]=be.useState(null),[z,L]=be.useState(!1);be.useEffect(()=>{q()},[]);const q=async()=>{try{const[Z,re,he,we]=await Promise.all([t.listTrips({limit:50}),t.listDrivers(),t.listBuses(),t.listRoutes()]);n(Z),h(re),s(he),w(we)}catch(Z){console.error("Failed to load trip data:",Z)}finally{E(!1)}},F=Z=>{const re=o.find(he=>he.id===Z);return(re==null?void 0:re.fullName)||"Unknown Driver"},U=Z=>{const re=d.find(he=>he.id===Z);return(re==null?void 0:re.busNumber)||"Unknown Bus"},N=Z=>{const re=y.find(he=>he.id===Z);return(re==null?void 0:re.name)||"Unknown Route"},W=Z=>Z.canceled?{label:"Canceled",variant:"danger"}:Z.tripCompleted?{label:"Completed",variant:"success"}:Z.reachedDestination?{label:"At Destination",variant:"info"}:Z.arrived?{label:"Arrived",variant:"info"}:Z.started?{label:"In Progress",variant:"warning"}:Z.accepted?{label:"Accepted",variant:"info"}:{label:"Pending",variant:"default"},H=Z=>{j(Z),L(!0)};return k?P.jsxs("div",{className:"space-y-6",children:[P.jsx("h1",{className:`text-2xl font-bold transition-colors duration-300 ${e==="dark"?"text-white":"text-gray-900"}`,children:"Trips"}),P.jsx(Xr,{children:P.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(Z=>P.jsx("div",{className:"h-12 bg-gray-200 rounded"},Z))})})]}):P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{children:[P.jsx("h1",{className:`text-2xl font-bold mb-2 transition-colors duration-300 ${e==="dark"?"text-white":"text-gray-900"}`,children:"Trips"}),P.jsx("p",{className:`transition-colors duration-300 ${e==="dark"?"text-gray-300":"text-gray-600"}`,children:"Monitor trip progress and Driver → Bus → Route assignments"})]}),P.jsx(Xr,{children:P.jsxs("div",{className:"p-6",children:[P.jsx("h2",{className:`text-lg font-semibold mb-4 ${e==="dark"?"text-white":"text-gray-900"}`,children:"Trip Assignment Flow"}),P.jsxs("div",{className:"flex items-center justify-center space-x-4 py-4",children:[P.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[P.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center text-white text-2xl font-bold ${e==="dark"?"bg-purple-600":"bg-blue-600"}`,children:"👤"}),P.jsxs("div",{className:"text-center",children:[P.jsx("div",{className:`font-medium text-sm ${e==="dark"?"text-gray-100":"text-gray-900"}`,children:"Driver"}),P.jsx("div",{className:`text-xs ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"Gets DriverID"})]})]}),P.jsx("div",{className:`text-2xl ${e==="dark"?"text-gray-400":"text-gray-600"}`,children:"→"}),P.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[P.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-white text-2xl font-bold bg-green-600",children:"🚌"}),P.jsxs("div",{className:"text-center",children:[P.jsx("div",{className:`font-medium text-sm ${e==="dark"?"text-gray-100":"text-gray-900"}`,children:"Bus"}),P.jsx("div",{className:`text-xs ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"Assigned BusID"})]})]}),P.jsx("div",{className:`text-2xl ${e==="dark"?"text-gray-400":"text-gray-600"}`,children:"→"}),P.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[P.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-white text-2xl font-bold bg-orange-600",children:"🛣️"}),P.jsxs("div",{className:"text-center",children:[P.jsx("div",{className:`font-medium text-sm ${e==="dark"?"text-gray-100":"text-gray-900"}`,children:"Route"}),P.jsx("div",{className:`text-xs ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"Selected Routes"})]})]}),P.jsx("div",{className:`text-2xl ${e==="dark"?"text-gray-400":"text-gray-600"}`,children:"→"}),P.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[P.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center text-white text-2xl font-bold ${e==="dark"?"bg-cyan-600":"bg-indigo-600"}`,children:"🚀"}),P.jsxs("div",{className:"text-center",children:[P.jsx("div",{className:`font-medium text-sm ${e==="dark"?"text-gray-100":"text-gray-900"}`,children:"Trip"}),P.jsx("div",{className:`text-xs ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"Active Journey"})]})]})]})]})}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[P.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Total Trips"}),P.jsx("p",{className:"text-2xl font-bold text-blue-700 mt-1",children:r.length})]}),P.jsx("div",{className:"text-2xl",children:"🚗"})]})}),P.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-green-700",children:"Completed"}),P.jsx("p",{className:"text-2xl font-bold text-green-700 mt-1",children:r.filter(Z=>Z.tripCompleted).length})]}),P.jsx("div",{className:"text-2xl",children:"✅"})]})}),P.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"In Progress"}),P.jsx("p",{className:"text-2xl font-bold text-yellow-700 mt-1",children:r.filter(Z=>Z.started&&!Z.tripCompleted&&!Z.canceled).length})]}),P.jsx("div",{className:"text-2xl",children:"🟡"})]})}),P.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-red-700",children:"Canceled"}),P.jsx("p",{className:"text-2xl font-bold text-red-700 mt-1",children:r.filter(Z=>Z.canceled).length})]}),P.jsx("div",{className:"text-2xl",children:"❌"})]})})]}),z?P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{className:"flex justify-between items-center",children:[P.jsx("h3",{className:`text-lg font-medium ${e==="dark"?"text-white":"text-gray-900"}`,children:"Fuel Efficiency Calculator"}),P.jsx(dr,{variant:"secondary",onClick:()=>L(!1),size:"sm",children:"Back to Trips"})]}),P.jsx(Wue,{tripId:I==null?void 0:I.id,initialDistance:I==null?void 0:I.distance,initialCost:I==null?void 0:I.cost,initialFuelPrice:I==null?void 0:I.fuelPricePerLitre}),I&&P.jsx(Xr,{title:"Trip Details",children:P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[P.jsxs("div",{children:[P.jsx("span",{className:`font-medium ${e==="dark"?"text-gray-300":"text-gray-700"}`,children:"Trip ID:"}),P.jsx("div",{className:`font-mono ${e==="dark"?"text-gray-100":"text-gray-900"}`,children:I.id})]}),P.jsxs("div",{children:[P.jsx("span",{className:`font-medium ${e==="dark"?"text-gray-300":"text-gray-700"}`,children:"Driver:"}),P.jsx("div",{className:`${e==="dark"?"text-gray-100":"text-gray-900"}`,children:F(I.driverId)})]}),P.jsxs("div",{children:[P.jsx("span",{className:`font-medium ${e==="dark"?"text-gray-300":"text-gray-700"}`,children:"Bus:"}),P.jsx("div",{className:`${e==="dark"?"text-gray-100":"text-gray-900"}`,children:U(I.busId)})]}),P.jsxs("div",{children:[P.jsx("span",{className:"font-medium text-gray-700",children:"Route:"}),P.jsx("div",{className:"text-gray-900",children:N(I.routeId)})]})]})})]}):P.jsxs(Xr,{children:[P.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Trips"}),P.jsx(dr,{onClick:()=>L(!0),size:"sm",children:"Show Fuel Efficiency Calculator"})]}),P.jsxs(sf,{children:[P.jsx(lf,{children:P.jsxs(Ya,{children:[P.jsx(_t,{isHeader:!0,children:"Trip ID"}),P.jsx(_t,{isHeader:!0,children:"Driver → Bus → Route"}),P.jsx(_t,{isHeader:!0,children:"Trip Details"}),P.jsx(_t,{isHeader:!0,children:"Status"}),P.jsx(_t,{isHeader:!0,children:"Started"}),P.jsx(_t,{isHeader:!0,children:"Actions"})]})}),P.jsx(cf,{children:r.map(Z=>{const re=W(Z);return P.jsxs(Ya,{children:[P.jsx(_t,{children:P.jsx("span",{className:"font-mono text-sm",children:Z.id})}),P.jsx(_t,{children:P.jsxs("div",{className:"space-y-1",children:[P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold ${e==="dark"?"bg-purple-600":"bg-blue-600"}`,children:"👤"}),P.jsxs("div",{children:[P.jsx("div",{className:`font-medium text-sm ${e==="dark"?"text-gray-100":"text-gray-900"}`,children:F(Z.driverId)}),P.jsx("div",{className:`text-xs ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"Driver"})]})]}),P.jsx("div",{className:"flex justify-center",children:P.jsx("span",{className:`text-xs ${e==="dark"?"text-gray-500":"text-gray-400"}`,children:"↓"})}),P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold bg-green-600",children:"🚌"}),P.jsxs("div",{children:[P.jsx("div",{className:`font-medium text-sm ${e==="dark"?"text-gray-100":"text-gray-900"}`,children:U(Z.busId)}),P.jsx("div",{className:`text-xs ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"Bus"})]})]}),P.jsx("div",{className:"flex justify-center",children:P.jsx("span",{className:`text-xs ${e==="dark"?"text-gray-500":"text-gray-400"}`,children:"↓"})}),P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold bg-orange-600",children:"🛣️"}),P.jsxs("div",{children:[P.jsx("div",{className:`font-medium text-sm ${e==="dark"?"text-gray-100":"text-gray-900"}`,children:N(Z.routeId)}),P.jsx("div",{className:`text-xs ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"Route"})]})]})]})}),P.jsx(_t,{children:P.jsxs("div",{className:"space-y-1",children:[P.jsxs("div",{className:`text-sm ${e==="dark"?"text-gray-300":"text-gray-700"}`,children:[P.jsx("span",{className:"font-medium",children:"Distance:"})," ",Z.distance?`${Z.distance} km`:"N/A"]}),P.jsxs("div",{className:`text-sm ${e==="dark"?"text-gray-300":"text-gray-700"}`,children:[P.jsx("span",{className:"font-medium",children:"Cost:"})," ",Z.cost?`₹${Z.cost}`:"N/A"]})]})}),P.jsx(_t,{children:P.jsx(Cg,{variant:re.variant,children:re.label})}),P.jsx(_t,{children:Z.startedAt?P.jsx("span",{className:`text-sm ${e==="dark"?"text-gray-400":"text-gray-600"}`,children:PT(Z.startedAt)}):P.jsx("span",{className:`${e==="dark"?"text-gray-500":"text-gray-400"}`,children:"Not started"})}),P.jsx(_t,{children:Z.distance&&Z.cost&&P.jsx(dr,{size:"sm",variant:"secondary",onClick:()=>H(Z),children:"Fuel Eff."})})]},Z.id)})})]}),r.length===0&&P.jsx("div",{className:`text-center py-8 ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"No trips found"})]})]})},Zue=()=>{const e=Oi(),[t,r]=be.useState({today:0,week:0,month:0}),[n,o]=be.useState(!0);be.useEffect(()=>{(async()=>{try{const s=await e.getRevenueSummary();r(s)}catch(s){console.error("Failed to load revenue data:",s)}finally{o(!1)}})()},[e]);const h=[{title:"Today's Revenue",amount:t.today,icon:"💰",bgColor:"bg-green-50",textColor:"text-green-700",borderColor:"border-green-200"},{title:"This Week",amount:t.week,icon:"📈",bgColor:"bg-blue-50",textColor:"text-blue-700",borderColor:"border-blue-200"},{title:"This Month",amount:t.month,icon:"💎",bgColor:"bg-purple-50",textColor:"text-purple-700",borderColor:"border-purple-200"}];return n?P.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(d=>P.jsx(Xr,{children:P.jsxs("div",{className:"animate-pulse",children:[P.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),P.jsx("div",{className:"h-8 bg-gray-200 rounded"})]})},d))}):P.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:h.map((d,s)=>P.jsx("div",{className:`${d.bgColor} ${d.borderColor} border rounded-lg p-6`,children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:`text-sm font-medium ${d.textColor}`,children:d.title}),P.jsx("p",{className:`text-2xl font-bold ${d.textColor} mt-1`,children:Fh(d.amount)})]}),P.jsx("div",{className:"text-2xl",children:d.icon})]})},s))})},Kue=()=>{const{theme:e}=Mr(),t=Oi(),[r,n]=be.useState([]),[o,h]=be.useState(!0);be.useEffect(()=>{d()},[]);const d=async()=>{try{const L=(await t.listPayments()).filter(q=>q.method==="UPI"||q.method==="Wallet");L.sort((q,F)=>F.createdAt.getTime()-q.createdAt.getTime()),n(L)}catch(z){console.error("Failed to load payments:",z)}finally{h(!1)}},s=z=>{switch(z){case"success":return"success";case"failed":return"danger";case"refunded":return"warning";default:return"default"}},y=z=>{switch(z){case"UPI":return"📱";case"Wallet":return"💳";default:return"💸"}};if(o)return P.jsxs("div",{className:"space-y-6",children:[P.jsx("h1",{className:`text-2xl font-bold transition-colors duration-300 ${e==="dark"?"text-white":"text-gray-900"}`,children:"Revenue"}),P.jsxs("div",{className:"animate-pulse space-y-4",children:[P.jsx("div",{className:"h-32 bg-gray-200 rounded"}),P.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})]});const w=r.filter(z=>z.status==="success"),k=r.filter(z=>z.status==="failed"),E=r.filter(z=>z.status==="refunded"),I=w.reduce((z,L)=>z+L.amount,0),j=E.reduce((z,L)=>z+L.amount,0);return P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{children:[P.jsx("h1",{className:`text-2xl font-bold mb-2 transition-colors duration-300 ${e==="dark"?"text-white":"text-gray-900"}`,children:"Revenue"}),P.jsx("p",{className:`transition-colors duration-300 ${e==="dark"?"text-gray-300":"text-gray-600"}`,children:"Track payments and revenue metrics"})]}),P.jsx(Zue,{}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[P.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-green-700",children:"Successful"}),P.jsx("p",{className:"text-2xl font-bold text-green-700 mt-1",children:w.length}),P.jsx("p",{className:"text-sm text-green-600",children:Fh(I)})]}),P.jsx("div",{className:"text-2xl",children:"✅"})]})}),P.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-red-700",children:"Failed"}),P.jsx("p",{className:"text-2xl font-bold text-red-700 mt-1",children:k.length}),P.jsx("p",{className:"text-sm text-red-600",children:Fh(k.reduce((z,L)=>z+L.amount,0))})]}),P.jsx("div",{className:"text-2xl",children:"❌"})]})}),P.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"Refunded"}),P.jsx("p",{className:"text-2xl font-bold text-yellow-700 mt-1",children:E.length}),P.jsx("p",{className:"text-sm text-yellow-600",children:Fh(j)})]}),P.jsx("div",{className:"text-2xl",children:"↩️"})]})}),P.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Success Rate"}),P.jsxs("p",{className:"text-2xl font-bold text-blue-700 mt-1",children:[r.length>0?Math.round(w.length/r.length*100):0,"%"]}),P.jsx("p",{className:"text-sm text-blue-600",children:"of all payments"})]}),P.jsx("div",{className:"text-2xl",children:"📊"})]})})]}),P.jsxs("div",{children:[P.jsx("h2",{className:`text-lg font-semibold mb-4 transition-colors duration-300 ${e==="dark"?"text-white":"text-gray-900"}`,children:"Payment Methods (UPI & Wallet)"}),P.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["UPI","Wallet"].map(z=>{const L=w.filter(F=>F.method===z),q=L.reduce((F,U)=>F+U.amount,0);return P.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-gray-700",children:z}),P.jsxs("p",{className:"text-xl font-bold text-gray-900 mt-1",children:[L.length," payments"]}),P.jsx("p",{className:"text-sm text-gray-600",children:Fh(q)})]}),P.jsx("div",{className:"text-2xl",children:y(z)})]})},z)})})]}),P.jsxs(Xr,{title:"Recent Payments",children:[P.jsxs(sf,{children:[P.jsx(lf,{children:P.jsxs(Ya,{children:[P.jsx(_t,{isHeader:!0,children:"Payment ID"}),P.jsx(_t,{isHeader:!0,children:"Trip ID"}),P.jsx(_t,{isHeader:!0,children:"Driver ID"}),P.jsx(_t,{isHeader:!0,children:"User ID"}),P.jsx(_t,{isHeader:!0,children:"Amount"}),P.jsx(_t,{isHeader:!0,children:"Method"}),P.jsx(_t,{isHeader:!0,children:"Status"}),P.jsx(_t,{isHeader:!0,children:"Date"})]})}),P.jsx(cf,{children:r.slice(0,20).map(z=>P.jsxs(Ya,{children:[P.jsx(_t,{children:P.jsx("span",{className:"font-mono text-sm",children:z.id})}),P.jsx(_t,{children:P.jsx("span",{className:`font-mono text-sm ${e==="dark"?"text-blue-400":"text-blue-600"}`,children:z.tripId})}),P.jsx(_t,{children:P.jsx("span",{className:`font-mono text-sm ${e==="dark"?"text-green-400":"text-green-600"}`,children:z.driverId})}),P.jsx(_t,{children:P.jsx("span",{className:`font-mono text-sm ${e==="dark"?"text-gray-400":"text-gray-600"}`,children:z.userId})}),P.jsx(_t,{children:P.jsx("span",{className:"font-medium",children:Fh(z.amount)})}),P.jsx(_t,{children:P.jsxs("div",{className:"flex items-center",children:[P.jsx("span",{className:"mr-2",children:y(z.method)}),P.jsx("span",{children:z.method})]})}),P.jsx(_t,{children:P.jsx(Cg,{variant:s(z.status),children:z.status})}),P.jsx(_t,{children:P.jsx("span",{className:`text-sm ${e==="dark"?"text-gray-400":"text-gray-600"}`,children:PT(z.createdAt)})})]},z.id))})]}),r.length===0&&P.jsx("div",{className:`text-center py-8 ${e==="dark"?"text-gray-400":"text-gray-500"}`,children:"No payments found"})]})]})},Xue=()=>{const e=Oi(),{theme:t}=Mr(),[r,n]=be.useState([]),[o,h]=be.useState(!0),[d,s]=be.useState({message:"",type:"info",isVisible:!1}),[y,w]=be.useState("all");be.useEffect(()=>{k()},[]);const k=async()=>{try{const N=await e.listSOSEvents();N.sort((W,H)=>H.createdAt.getTime()-W.createdAt.getTime()),n(N)}catch(N){console.error("Failed to load SOS events:",N)}finally{h(!1)}},E=async(N,W)=>{try{await e.updateSOS(N,W),await k(),s({message:"SOS status updated successfully!",type:"success",isVisible:!0})}catch(H){console.error("Failed to update SOS status:",H),s({message:"Failed to update SOS status. Please try again.",type:"error",isVisible:!0})}},I=N=>{switch(N){case"open":return"danger";case"ack":return"warning";case"closed":return"success";default:return"default"}},j=N=>{switch(N){case"open":return"🚨";case"ack":return"⏳";case"closed":return"✅";default:return"❓"}},z=N=>{if(t==="dark")switch(N){case"open":return"bg-red-900/30 border-red-700";case"ack":return"bg-yellow-900/30 border-yellow-700";case"closed":return"bg-green-900/30 border-green-700";default:return"bg-gray-800 border-gray-700"}else switch(N){case"open":return"bg-red-50 border-red-200";case"ack":return"bg-yellow-50 border-yellow-200";case"closed":return"bg-green-50 border-green-200";default:return"bg-gray-50 border-gray-200"}},L=r.filter(N=>y==="all"||N.status===y);if(o)return P.jsxs("div",{className:"space-y-6",children:[P.jsx("h1",{className:`text-2xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"SOS Events"}),P.jsx(Xr,{children:P.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(N=>P.jsx("div",{className:`h-16 rounded ${t==="dark"?"bg-gray-700":"bg-gray-200"}`},N))})})]});const q=r.filter(N=>N.status==="open"),F=r.filter(N=>N.status==="ack"),U=r.filter(N=>N.status==="closed");return P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{children:[P.jsx("h1",{className:`text-2xl font-bold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"SOS Events"}),P.jsx("p",{className:`${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Monitor and manage emergency situations"})]}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[P.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-red-700",children:"Open SOS"}),P.jsx("p",{className:"text-2xl font-bold text-red-700 mt-1",children:q.length}),P.jsx("p",{className:"text-xs text-red-600",children:"Requires immediate attention"})]}),P.jsx("div",{className:"text-2xl",children:"🚨"})]})}),P.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"Acknowledged"}),P.jsx("p",{className:"text-2xl font-bold text-yellow-700 mt-1",children:F.length}),P.jsx("p",{className:"text-xs text-yellow-600",children:"Being handled"})]}),P.jsx("div",{className:"text-2xl",children:"⏳"})]})}),P.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-green-700",children:"Closed"}),P.jsx("p",{className:"text-2xl font-bold text-green-700 mt-1",children:U.length}),P.jsx("p",{className:"text-xs text-green-600",children:"Resolved"})]}),P.jsx("div",{className:"text-2xl",children:"✅"})]})}),P.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Total Events"}),P.jsx("p",{className:"text-2xl font-bold text-blue-700 mt-1",children:r.length}),P.jsx("p",{className:"text-xs text-blue-600",children:"All time"})]}),P.jsx("div",{className:"text-2xl",children:"📊"})]})})]}),P.jsx("div",{className:"flex flex-wrap gap-2",children:["all","open","ack","closed"].map(N=>P.jsxs(dr,{variant:y===N?"primary":"secondary",size:"sm",onClick:()=>w(N),children:[N==="all"?"All Events":N.toUpperCase(),N!=="all"&&P.jsxs("span",{className:"ml-1",children:["(",r.filter(W=>W.status===N).length,")"]})]},N))}),P.jsx("div",{className:"space-y-4",children:L.map(N=>P.jsx("div",{className:`border rounded-lg p-6 ${z(N.status)}`,children:P.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[P.jsxs("div",{className:"flex-1",children:[P.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[P.jsx("span",{className:"text-2xl",children:j(N.status)}),P.jsxs("div",{children:[P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsxs("h3",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:["SOS Event #",N.id]}),P.jsx(Cg,{variant:I(N.status),children:N.status.toUpperCase()})]}),P.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:$ue(N.createdAt)})]})]}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[P.jsxs("div",{children:[P.jsx("span",{className:`font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Reason:"}),P.jsx("div",{className:`${t==="dark"?"text-gray-100":"text-gray-900"}`,children:N.reason})]}),N.driverId&&P.jsxs("div",{children:[P.jsx("span",{className:`font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Driver ID:"}),P.jsx("div",{className:`font-mono ${t==="dark"?"text-gray-100":"text-gray-900"}`,children:N.driverId})]}),N.busId&&P.jsxs("div",{children:[P.jsx("span",{className:`font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Bus ID:"}),P.jsx("div",{className:`font-mono ${t==="dark"?"text-gray-100":"text-gray-900"}`,children:N.busId})]}),N.tripId&&P.jsxs("div",{children:[P.jsx("span",{className:`font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Trip ID:"}),P.jsx("div",{className:`font-mono ${t==="dark"?"text-gray-100":"text-gray-900"}`,children:N.tripId})]}),P.jsxs("div",{children:[P.jsx("span",{className:`font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Location:"}),P.jsxs("div",{className:`${t==="dark"?"text-gray-100":"text-gray-900"}`,children:[N.lat.toFixed(4),", ",N.lng.toFixed(4)]})]}),P.jsxs("div",{children:[P.jsx("span",{className:`font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Reported:"}),P.jsx("div",{className:`${t==="dark"?"text-gray-100":"text-gray-900"}`,children:PT(N.createdAt)})]})]})]}),P.jsxs("div",{className:"flex space-x-2",children:[N.status==="open"&&P.jsx(dr,{variant:"secondary",size:"sm",onClick:()=>E(N.id,"ack"),children:"Acknowledge"}),(N.status==="open"||N.status==="ack")&&P.jsx(dr,{variant:"primary",size:"sm",onClick:()=>E(N.id,"closed"),children:"Close"}),N.status==="closed"&&P.jsx("div",{className:"text-sm text-green-600 font-medium px-3 py-1",children:"✓ Resolved"})]})]})},N.id))}),L.length===0&&P.jsx(Xr,{children:P.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:y==="all"?"No SOS events found":`No ${y} SOS events found`})}),P.jsx(Mg,{message:d.message,type:d.type,isVisible:d.isVisible,onClose:()=>s(N=>({...N,isVisible:!1}))})]})},Yue=()=>{var I,j,z;const e=Oi(),{theme:t}=Mr(),[r,n]=be.useState({byTenure:[],byDistance:[]}),[o,h]=be.useState(!0),[d,s]=be.useState("tenure");be.useEffect(()=>{y()},[]);const y=async()=>{try{const L=await e.listLeaderboard();n(L)}catch(L){console.error("Failed to load leaderboard:",L)}finally{h(!1)}},w=L=>{switch(L){case 1:return"🥇";case 2:return"🥈";case 3:return"🥉";default:return"🏅"}},k=L=>{const F=Math.abs(new Date().getTime()-L.getTime());return Math.ceil(F/(1e3*60*60*24))},E=d==="tenure"?r.byTenure:r.byDistance;return o?P.jsxs("div",{className:"space-y-6",children:[P.jsx("h1",{className:`text-2xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Leaderboard"}),P.jsx(Xr,{children:P.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(L=>P.jsx("div",{className:`h-16 rounded ${t==="dark"?"bg-gray-700":"bg-gray-200"}`},L))})})]}):P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{children:[P.jsx("h1",{className:`text-2xl font-bold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Leaderboard"}),P.jsx("p",{className:`${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Top performing drivers by tenure and distance traveled"})]}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[P.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"Most Senior"}),P.jsx("p",{className:"text-lg font-bold text-yellow-700 mt-1",children:((I=r.byTenure[0])==null?void 0:I.fullName)||"N/A"}),P.jsx("p",{className:"text-xs text-yellow-600",children:r.byTenure[0]?`${k(r.byTenure[0].joinedAt)} days`:"No data"})]}),P.jsx("div",{className:"text-2xl",children:"🥇"})]})}),P.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Top Distance"}),P.jsx("p",{className:"text-lg font-bold text-blue-700 mt-1",children:((j=r.byDistance[0])==null?void 0:j.fullName)||"N/A"}),P.jsx("p",{className:"text-xs text-blue-600",children:(z=r.byDistance[0])!=null&&z.totalDistanceKm?`${r.byDistance[0].totalDistanceKm} km`:"No data"})]}),P.jsx("div",{className:"text-2xl",children:"🚗"})]})}),P.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-green-700",children:"Total Drivers"}),P.jsx("p",{className:"text-2xl font-bold text-green-700 mt-1",children:r.byTenure.length}),P.jsx("p",{className:"text-xs text-green-600",children:"In leaderboard"})]}),P.jsx("div",{className:"text-2xl",children:"👥"})]})}),P.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-purple-700",children:"Avg Rating"}),P.jsx("p",{className:"text-2xl font-bold text-purple-700 mt-1",children:r.byTenure.length>0?(r.byTenure.reduce((L,q)=>L+q.rating,0)/r.byTenure.length).toFixed(1):"0.0"}),P.jsx("p",{className:"text-xs text-purple-600",children:"out of 5.0"})]}),P.jsx("div",{className:"text-2xl",children:"⭐"})]})})]}),P.jsxs("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg w-fit",children:[P.jsx(dr,{variant:d==="tenure"?"primary":"secondary",size:"sm",onClick:()=>s("tenure"),className:"rounded-md",children:"🏆 By Tenure"}),P.jsx(dr,{variant:d==="distance"?"primary":"secondary",size:"sm",onClick:()=>s("distance"),className:"rounded-md",children:"🚗 By Distance"})]}),P.jsxs(Xr,{title:`Leaderboard - ${d==="tenure"?"By Tenure":"By Distance Traveled"}`,children:[P.jsxs(sf,{children:[P.jsx(lf,{children:P.jsxs(Ya,{children:[P.jsx(_t,{isHeader:!0,children:"Rank"}),P.jsx(_t,{isHeader:!0,children:"Driver"}),P.jsx(_t,{isHeader:!0,children:"Rating"}),P.jsx(_t,{isHeader:!0,children:d==="tenure"?"Joined Date":"Total Distance"}),P.jsx(_t,{isHeader:!0,children:d==="tenure"?"Days of Service":"Total Trips"}),P.jsx(_t,{isHeader:!0,children:"Status"})]})}),P.jsx(cf,{children:E.map((L,q)=>{const F=q+1,U=k(L.joinedAt);return P.jsxs(Ya,{children:[P.jsx(_t,{children:P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("span",{className:"text-2xl",children:w(F)}),P.jsxs("span",{className:"font-bold text-lg",children:["#",F]})]})}),P.jsx(_t,{children:P.jsxs("div",{children:[P.jsx("div",{className:`font-medium ${t==="dark"?"text-gray-100":"text-gray-900"}`,children:L.fullName}),P.jsx("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:L.phone})]})}),P.jsx(_t,{children:P.jsxs("div",{className:"flex items-center",children:[P.jsx("span",{className:"text-yellow-400 mr-1",children:"⭐"}),P.jsx("span",{className:"font-medium",children:L.rating}),P.jsx("span",{className:"text-gray-500 text-sm ml-1",children:"/5"})]})}),P.jsx(_t,{children:d==="tenure"?P.jsx("div",{children:P.jsx("div",{className:"font-medium",children:fx(L.joinedAt)})}):P.jsxs("div",{children:[P.jsx("div",{className:"font-medium",children:L.totalDistanceKm?`${L.totalDistanceKm.toLocaleString()} km`:"0 km"}),P.jsx("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:L.totalDistanceKm&&L.totalTrips?`${(L.totalDistanceKm/L.totalTrips).toFixed(1)} km/trip`:"No data"})]})}),P.jsx(_t,{children:d==="tenure"?P.jsxs("div",{children:[P.jsxs("div",{className:"font-medium",children:[U," days"]}),P.jsx("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"of service"})]}):P.jsxs("div",{children:[P.jsxs("div",{className:"font-medium",children:[L.totalTrips||0," trips"]}),P.jsx("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"completed"})]})}),P.jsx(_t,{children:P.jsxs("div",{className:"flex flex-col space-y-1",children:[P.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${L.status==="approved"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:L.status}),L.assignedBusId&&P.jsxs("span",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Bus: ",L.assignedBusId]})]})})]},L.id)})})]}),E.length===0&&P.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"No approved drivers found"})]})]})},Jue=()=>{const e=Oi(),{theme:t}=Mr(),[r,n]=be.useState({fuelPricePerLitre:100}),[o,h]=be.useState({fuelPricePerLitre:100}),[d,s]=be.useState(!0),[y,w]=be.useState(!1),[k,E]=be.useState(!1),[I,j]=be.useState({message:"",type:"info",isVisible:!1});be.useEffect(()=>{z()},[]),be.useEffect(()=>{const U=o.fuelPricePerLitre!==r.fuelPricePerLitre;E(U)},[o,r]);const z=async()=>{try{const U=await e.getSettings();n(U),h(U)}catch(U){console.error("Failed to load settings:",U)}finally{s(!1)}},L=async()=>{w(!0);try{await e.updateSettings(o),n(o),E(!1),j({message:"Settings saved successfully!",type:"success",isVisible:!0})}catch(U){console.error("Failed to save settings:",U),j({message:"Failed to save settings. Please try again.",type:"error",isVisible:!0})}finally{w(!1)}},q=()=>{h(r),E(!1)},F=U=>{const N=parseFloat(U);!isNaN(N)&&N>=0&&h(W=>({...W,fuelPricePerLitre:N}))};return d?P.jsxs("div",{className:"space-y-6",children:[P.jsx("h1",{className:`text-2xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Settings"}),P.jsx(Xr,{children:P.jsxs("div",{className:"animate-pulse space-y-4",children:[P.jsx("div",{className:`h-4 rounded w-1/4 ${t==="dark"?"bg-gray-700":"bg-gray-200"}`}),P.jsx("div",{className:`h-10 rounded w-1/2 ${t==="dark"?"bg-gray-700":"bg-gray-200"}`})]})})]}):P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{children:[P.jsx("h1",{className:`text-2xl font-bold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Settings"}),P.jsx("p",{className:`${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Configure global application settings"})]}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[P.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Current Fuel Price"}),P.jsxs("p",{className:"text-2xl font-bold text-blue-700 mt-1",children:["₹",r.fuelPricePerLitre]}),P.jsx("p",{className:"text-xs text-blue-600",children:"per litre"})]}),P.jsx("div",{className:"text-2xl",children:"⛽"})]})}),P.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-green-700",children:"Settings Status"}),P.jsx("p",{className:"text-lg font-bold text-green-700 mt-1",children:k?"Modified":"Up to date"}),P.jsx("p",{className:"text-xs text-green-600",children:k?"Save to apply changes":"All settings saved"})]}),P.jsx("div",{className:"text-2xl",children:k?"⚠️":"✅"})]})}),P.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-6",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{children:[P.jsx("p",{className:"text-sm font-medium text-purple-700",children:"Data Storage"}),P.jsx("p",{className:"text-lg font-bold text-purple-700 mt-1",children:"Memory"}),P.jsx("p",{className:"text-xs text-purple-600",children:"Mock implementation"})]}),P.jsx("div",{className:"text-2xl",children:"💾"})]})})]}),P.jsx(Xr,{title:"Fuel Price Configuration",children:P.jsxs("div",{className:"space-y-6",children:[P.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:P.jsxs("div",{className:"flex items-start",children:[P.jsx("div",{className:"flex-shrink-0",children:P.jsx("span",{className:"text-yellow-400 text-xl",children:"ℹ️"})}),P.jsxs("div",{className:"ml-3",children:[P.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"About Fuel Price Setting"}),P.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[P.jsx("p",{children:"This setting is used as the default fuel price per litre for fuel efficiency calculations when trip-specific fuel prices are not available."}),P.jsx("p",{className:"mt-1",children:"Changes to this setting will affect all future fuel efficiency calculations and serve as the default value in the Fuel Efficiency Calculator."})]})]})]})}),P.jsxs("div",{className:"max-w-md",children:[P.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-200":"text-gray-700"}`,children:"Fuel Price per Litre (₹)"}),P.jsxs("div",{className:"relative",children:[P.jsx("span",{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"₹"}),P.jsx("input",{type:"number",min:"0",step:"0.01",value:o.fuelPricePerLitre,onChange:U=>F(U.target.value),className:`w-full pl-8 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:ring-purple-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-500 focus:ring-blue-500"}`,placeholder:"Enter fuel price"})]}),P.jsx("p",{className:`mt-1 text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Current market rate for fuel per litre"})]}),k&&P.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[P.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Pending Changes"}),P.jsx("div",{className:"text-sm text-blue-700",children:P.jsxs("p",{children:["Fuel Price: ₹",r.fuelPricePerLitre," → ₹",o.fuelPricePerLitre]})})]}),P.jsxs("div",{className:"flex justify-end space-x-3",children:[k&&P.jsx(dr,{variant:"secondary",onClick:q,disabled:y,children:"Reset Changes"}),P.jsx(dr,{onClick:L,disabled:!k||y,children:y?"Saving...":"Save Settings"})]})]})}),P.jsxs(Xr,{title:"System Information",children:[P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[P.jsxs("div",{children:[P.jsx("h4",{className:`text-sm font-medium mb-3 ${t==="dark"?"text-gray-100":"text-gray-900"}`,children:"Data Provider"}),P.jsxs("div",{className:"space-y-2 text-sm",children:[P.jsxs("div",{className:"flex justify-between",children:[P.jsx("span",{className:`${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Type:"}),P.jsx("span",{className:`font-mono px-2 py-1 rounded ${t==="dark"?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-900"}`,children:"MockDataProvider"})]}),P.jsxs("div",{className:"flex justify-between",children:[P.jsx("span",{className:`${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Storage:"}),P.jsx("span",{className:`${t==="dark"?"text-gray-100":"text-gray-900"}`,children:"In-Memory"})]}),P.jsxs("div",{className:"flex justify-between",children:[P.jsx("span",{className:`${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Persistence:"}),P.jsx("span",{className:"text-red-500",children:"Session Only"})]})]})]}),P.jsxs("div",{children:[P.jsx("h4",{className:`text-sm font-medium mb-3 ${t==="dark"?"text-gray-100":"text-gray-900"}`,children:"Map Provider"}),P.jsxs("div",{className:"space-y-2 text-sm",children:[P.jsxs("div",{className:"flex justify-between",children:[P.jsx("span",{className:`${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Type:"}),P.jsx("span",{className:`font-mono px-2 py-1 rounded ${t==="dark"?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-900"}`,children:"SimpleMockMapAdapter"})]}),P.jsxs("div",{className:"flex justify-between",children:[P.jsx("span",{className:`${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Rendering:"}),P.jsx("span",{className:`${t==="dark"?"text-gray-100":"text-gray-900"}`,children:"DOM Elements"})]}),P.jsxs("div",{className:"flex justify-between",children:[P.jsx("span",{className:`${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Real Map SDK:"}),P.jsx("span",{className:"text-red-500",children:"Not Integrated"})]})]})]})]}),P.jsxs("div",{className:`mt-6 p-4 rounded-lg ${t==="dark"?"bg-gray-800":"bg-gray-50"}`,children:[P.jsx("h5",{className:`text-sm font-medium mb-2 ${t==="dark"?"text-gray-100":"text-gray-900"}`,children:"Development Notes"}),P.jsxs("ul",{className:`text-sm space-y-1 list-disc list-inside ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:[P.jsx("li",{children:"This is a mock implementation for development and demonstration purposes"}),P.jsx("li",{children:"Settings are stored in memory and will reset when the application is refreshed"}),P.jsx("li",{children:"In production, these would be persisted to a database (Firebase/Supabase)"}),P.jsx("li",{children:"Map functionality uses a simple DOM-based mock instead of a real mapping service"}),P.jsx("li",{children:"TODO: Replace MockDataProvider with Firebase implementation"}),P.jsx("li",{children:"TODO: Replace SimpleMockMapAdapter with Mapbox/Google Maps"})]})]})]}),P.jsx(Mg,{message:I.message,type:I.type,isVisible:I.isVisible,onClose:()=>j(U=>({...U,isVisible:!1}))})]})},Que=({onNavigate:e})=>{const{theme:t}=Mr(),r=Oi(),n=be.useRef(null),[o,h]=be.useState(""),[d,s]=be.useState([]),[y,w]=be.useState(!1);be.useEffect(()=>{const I=j=>{n.current&&!n.current.contains(j.target)&&w(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),be.useEffect(()=>{if(o.trim()===""){s([]),w(!1);return}(async()=>{const j=o.toLowerCase().trim(),z=[],[L,q,F,U]=await Promise.all([r.listDrivers(),r.listBuses(),r.listRoutes(),r.listTrips()]);L.forEach(N=>{if(N.fullName.toLowerCase().includes(j)||N.phone.includes(j)||N.id.toLowerCase().includes(j)){const W=N.assignedBusId?q.find(re=>re.id===N.assignedBusId):void 0,H=N.assignedRouteIds?F.filter(re=>N.assignedRouteIds.includes(re.id)):[],Z=U.filter(re=>re.driverId===N.id);z.push({type:"driver",id:N.id,title:N.fullName,subtitle:`${N.phone} • ${N.status}`,data:N,relatedBuses:W?[W]:[],relatedRoutes:H,relatedTrips:Z})}}),q.forEach(N=>{if(N.id.toLowerCase().includes(j)||N.vehicleType.toLowerCase().includes(j)||N.busNumber.toLowerCase().includes(j)){const W=N.assignedDriverId?L.find(re=>re.id===N.assignedDriverId):void 0,H=F.filter(re=>U.some(he=>he.driverId===N.assignedDriverId&&he.routeId===re.id)),Z=U.filter(re=>re.driverId===N.assignedDriverId);z.push({type:"bus",id:N.id,title:`Bus ${N.busNumber}`,subtitle:`${N.vehicleType} • ${N.id}`,data:N,relatedDrivers:W?[W]:[],relatedRoutes:H,relatedTrips:Z})}}),F.forEach(N=>{if(N.id.toLowerCase().includes(j)||N.name.toLowerCase().includes(j)||N.code.toLowerCase().includes(j)){const W=U.filter(re=>re.routeId===N.id),H=W.map(re=>L.find(he=>he.id===re.driverId)).filter((re,he,we)=>re&&we.findIndex(Oe=>(Oe==null?void 0:Oe.id)===re.id)===he),Z=H.map(re=>re.assignedBusId?q.find(he=>he.id===re.assignedBusId):void 0).filter(Boolean);z.push({type:"route",id:N.id,title:N.name,subtitle:`${N.code}`,data:N,relatedDrivers:H,relatedBuses:Z,relatedTrips:W})}}),s(z.slice(0,6)),w(z.length>0)})()},[o,r]);const k=I=>{switch(w(!1),h(""),I.type){case"driver":e==null||e("drivers",I.id);break;case"bus":e==null||e("buses",I.id);break;case"route":e==null||e("routes",I.id);break}},E=I=>{switch(I){case"driver":return P.jsx(lv,{className:"text-cyan-400"});case"bus":return P.jsx(Gs,{className:"text-blue-400"});case"route":return P.jsx(Mm,{className:"text-orange-400"});default:return P.jsx(xA,{className:"text-gray-400"})}};return P.jsxs("div",{ref:n,className:"relative w-full",children:[P.jsxs("div",{className:`relative group ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:[P.jsx(xA,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-lg group-focus-within:text-cyan-500 transition-colors"}),P.jsx("input",{type:"text",placeholder:"Search drivers, buses, routes...",value:o,onChange:I=>h(I.target.value),onFocus:()=>w(o.trim()!==""&&d.length>0),className:`w-full pl-12 pr-4 py-3 rounded-2xl border-0 transition-all duration-300 focus:ring-2 focus:ring-offset-0 ${t==="dark"?"bg-gray-800/50 text-white placeholder-gray-400 focus:bg-gray-800/70 focus:ring-cyan-500/50":"bg-white/50 text-gray-900 placeholder-gray-500 focus:bg-white/70 focus:ring-blue-500/50"}`})]}),y&&d.length>0&&P.jsx("div",{className:`absolute top-full left-0 right-0 mt-2 z-50 rounded-2xl border backdrop-blur-md shadow-2xl max-h-96 overflow-y-auto ${t==="dark"?"bg-gray-900/95 border-gray-700":"bg-white/95 border-gray-200"}`,children:d.map(I=>P.jsx("div",{className:`p-4 border-b last:border-b-0 hover:bg-opacity-50 transition-colors cursor-pointer ${t==="dark"?"border-gray-700 hover:bg-gray-800":"border-gray-100 hover:bg-gray-50"}`,onClick:()=>k(I),children:P.jsxs("div",{className:"flex items-start space-x-3",children:[P.jsx("div",{className:"mt-1",children:E(I.type)}),P.jsxs("div",{className:"flex-1 min-w-0",children:[P.jsx("h3",{className:`font-semibold truncate ${t==="dark"?"text-white":"text-gray-900"}`,children:I.title}),P.jsx("p",{className:`text-sm truncate ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:I.subtitle}),P.jsxs("div",{className:"mt-2 space-y-1",children:[I.relatedDrivers&&I.relatedDrivers.length>0&&P.jsxs("div",{className:"text-xs flex items-center space-x-1 text-gray-500",children:[P.jsx(lv,{className:"h-3 w-3"}),P.jsxs("span",{children:["Drivers: ",I.relatedDrivers.map(j=>j.fullName).join(", ")]})]}),I.relatedBuses&&I.relatedBuses.length>0&&P.jsxs("div",{className:"text-xs flex items-center space-x-1 text-gray-500",children:[P.jsx(Gs,{className:"h-3 w-3"}),P.jsxs("span",{children:["Buses: ",I.relatedBuses.map(j=>j.id).join(", ")]})]}),I.relatedRoutes&&I.relatedRoutes.length>0&&P.jsxs("div",{className:"text-xs flex items-center space-x-1 text-gray-500",children:[P.jsx(Mm,{className:"h-3 w-3"}),P.jsxs("span",{children:["Routes: ",I.relatedRoutes.slice(0,2).map(j=>j.name).join(", ")]})]}),I.relatedTrips&&I.relatedTrips.length>0&&P.jsxs("div",{className:"text-xs flex items-center space-x-1 text-gray-500",children:[P.jsx(t6,{className:"h-3 w-3"}),P.jsxs("span",{children:[I.relatedTrips.length," trips"]})]})]})]})]})},`${I.type}-${I.id}`))})]})},ehe=({id:e,type:t,title:r,message:n,timestamp:o,onClose:h})=>{const{theme:d}=Mr(),[s,y]=be.useState(!1),[w,k]=be.useState(!1);be.useEffect(()=>{setTimeout(()=>y(!0),10)},[]);const E=()=>{k(!0),setTimeout(()=>{h()},300)},I=()=>{switch(t){case"success":return P.jsx(tR,{className:"text-green-500",size:20});case"error":return P.jsx(nR,{className:"text-red-500",size:20});case"warning":return P.jsx(wd,{className:"text-orange-500",size:20});case"info":return P.jsx(Lw,{className:"text-blue-500",size:20})}},j=()=>{switch(t){case"success":return"border-l-green-500";case"error":return"border-l-red-500";case"warning":return"border-l-orange-500";case"info":return"border-l-blue-500"}};return P.jsx("div",{"data-toast-id":e,className:`
        transform transition-all duration-300 ease-in-out border-l-4 ${j()}
        ${s&&!w?"translate-x-0 opacity-100":"translate-x-full opacity-0"}
        ${d==="dark"?"bg-gray-800 border-gray-700 shadow-xl":"bg-white border-gray-200 shadow-lg"}
        rounded-r-lg p-4 mb-3 min-w-[300px] max-w-[400px] backdrop-blur-sm
      `,children:P.jsxs("div",{className:"flex items-start justify-between",children:[P.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[P.jsx("div",{className:"flex-shrink-0 mt-0.5",children:I()}),P.jsxs("div",{className:"flex-1 min-w-0",children:[P.jsx("h4",{className:`text-sm font-semibold ${d==="dark"?"text-white":"text-gray-900"}`,children:r}),P.jsx("p",{className:`text-sm mt-1 ${d==="dark"?"text-gray-300":"text-gray-600"}`,children:n}),P.jsx("p",{className:`text-xs mt-2 ${d==="dark"?"text-gray-400":"text-gray-500"}`,children:o.toLocaleTimeString()})]})]}),P.jsx("button",{onClick:E,className:`flex-shrink-0 ml-3 p-1 rounded-full transition-colors ${d==="dark"?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:P.jsx(aR,{size:16})})]})})},the=()=>{const{notifications:e,removeNotification:t}=ST(),[r,n]=be.useState([]);return be.useEffect(()=>{const o=e.slice(0,5);n(o)},[e]),P.jsx("div",{className:"fixed top-4 right-4 z-[9999] space-y-2",children:r.map(o=>P.jsx(ehe,{id:o.id,type:o.type,title:o.title,message:o.message,timestamp:o.timestamp,onClose:()=>t(o.id)},o.id))})},rhe=()=>{const{notifications:e,unreadCount:t,markAsRead:r}=ST(),{theme:n}=Mr(),[o,h]=be.useState(!1),d=s=>{r(s)};return P.jsxs("div",{className:"relative",children:[P.jsxs("button",{onClick:()=>h(!o),className:`relative p-3 rounded-xl transition-all duration-300 hover:scale-110 transform ${n==="dark"?"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white":"bg-gray-100/50 text-gray-600 hover:bg-gray-200/50 hover:text-gray-900"}`,children:[P.jsx(Lw,{size:20}),t>0&&P.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center animate-pulse",children:t>9?"9+":t})]}),o&&P.jsxs("div",{className:`absolute top-full right-0 mt-2 w-80 max-h-96 overflow-y-auto rounded-xl border backdrop-blur-md shadow-2xl z-[9999] ${n==="dark"?"bg-gray-900/95 border-gray-700":"bg-white/95 border-gray-200"}`,children:[P.jsx("div",{className:`p-4 border-b ${n==="dark"?"border-gray-700":"border-gray-200"}`,children:P.jsx("h3",{className:`font-semibold ${n==="dark"?"text-white":"text-gray-900"}`,children:"Recent Activity"})}),P.jsx("div",{className:"max-h-64 overflow-y-auto",children:e.length===0?P.jsx("div",{className:`p-4 text-center ${n==="dark"?"text-gray-400":"text-gray-500"}`,children:"No notifications yet"}):e.slice(0,10).map(s=>P.jsx("div",{onClick:()=>d(s.id),className:`p-3 border-b last:border-b-0 cursor-pointer transition-colors ${n==="dark"?"border-gray-700 hover:bg-gray-800/50":"border-gray-100 hover:bg-gray-50"} ${s.isRead?"":"bg-blue-50/10"}`,children:P.jsxs("div",{className:"flex items-start space-x-2",children:[P.jsxs("div",{className:"flex-shrink-0 mt-1",children:[s.type==="success"&&P.jsx(tR,{className:"text-green-500",size:16}),s.type==="error"&&P.jsx(nR,{className:"text-red-500",size:16}),s.type==="warning"&&P.jsx(wd,{className:"text-orange-500",size:16}),s.type==="info"&&P.jsx(Lw,{className:"text-blue-500",size:16})]}),P.jsxs("div",{className:"flex-1 min-w-0",children:[P.jsx("h4",{className:`text-sm font-medium ${n==="dark"?"text-white":"text-gray-900"}`,children:s.title}),P.jsx("p",{className:`text-xs mt-1 ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:s.message}),P.jsx("p",{className:`text-xs mt-1 ${n==="dark"?"text-gray-400":"text-gray-500"}`,children:s.timestamp.toLocaleTimeString()})]}),!s.isRead&&P.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"})]})},s.id))})]})]})},nhe="modulepreload",ihe=function(e){return"/"+e},Sj={},Ig=function(t,r,n){if(!r||r.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(r.map(h=>{if(h=ihe(h),h in Sj)return;Sj[h]=!0;const d=h.endsWith(".css"),s=d?'[rel="stylesheet"]':"";if(!!n)for(let k=o.length-1;k>=0;k--){const E=o[k];if(E.href===h&&(!d||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${s}`))return;const w=document.createElement("link");if(w.rel=d?"stylesheet":nhe,d||(w.as="script",w.crossOrigin=""),w.href=h,document.head.appendChild(w),d)return new Promise((k,E)=>{w.addEventListener("load",k),w.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${h}`)))})})).then(()=>t()).catch(h=>{const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=h,window.dispatchEvent(d),!d.defaultPrevented)throw h})},ahe=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ig(()=>Promise.resolve().then(()=>uf),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class TT extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class ohe extends TT{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Pj extends TT{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Tj extends TT{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var lS;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(lS||(lS={}));var she=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(h){return h instanceof r?h:new r(function(d){d(h)})}return new(r||(r=Promise))(function(h,d){function s(k){try{w(n.next(k))}catch(E){d(E)}}function y(k){try{w(n.throw(k))}catch(E){d(E)}}function w(k){k.done?h(k.value):o(k.value).then(s,y)}w((n=n.apply(e,t||[])).next())})};class lhe{constructor(t,{headers:r={},customFetch:n,region:o=lS.Any}={}){this.url=t,this.headers=r,this.region=o,this.fetch=ahe(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return she(this,void 0,void 0,function*(){try{const{headers:o,method:h,body:d}=r;let s={},{region:y}=r;y||(y=this.region);const w=new URL(`${this.url}/${t}`);y&&y!=="any"&&(s["x-region"]=y,w.searchParams.set("forceFunctionRegion",y));let k;d&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(s["Content-Type"]="application/octet-stream",k=d):typeof d=="string"?(s["Content-Type"]="text/plain",k=d):typeof FormData<"u"&&d instanceof FormData?k=d:(s["Content-Type"]="application/json",k=JSON.stringify(d)));const E=yield this.fetch(w.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},s),this.headers),o),body:k}).catch(L=>{throw new ohe(L)}),I=E.headers.get("x-relay-error");if(I&&I==="true")throw new Pj(E);if(!E.ok)throw new Tj(E);let j=((n=E.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),z;return j==="application/json"?z=yield E.json():j==="application/octet-stream"?z=yield E.blob():j==="text/event-stream"?z=E:j==="multipart/form-data"?z=yield E.formData():z=yield E.text(),{data:z,error:null,response:E}}catch(o){return{data:null,error:o,response:o instanceof Tj||o instanceof Pj?o.context:void 0}}})}}var Ji={},kT={},px={},jg={},mx={},gx={},che=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Gd=che();const uhe=Gd.fetch,L$=Gd.fetch.bind(Gd),B$=Gd.Headers,hhe=Gd.Request,dhe=Gd.Response,uf=Object.freeze(Object.defineProperty({__proto__:null,Headers:B$,Request:hhe,Response:dhe,default:L$,fetch:uhe},Symbol.toStringTag,{value:"Module"})),fhe=oL(uf);var yx={};Object.defineProperty(yx,"__esModule",{value:!0});let phe=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};yx.default=phe;var F$=yi&&yi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gx,"__esModule",{value:!0});const mhe=F$(fhe),ghe=F$(yx);let yhe=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=mhe.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let o=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var d,s,y,w;let k=null,E=null,I=null,j=h.status,z=h.statusText;if(h.ok){if(this.method!=="HEAD"){const U=await h.text();U===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?E=U:E=JSON.parse(U))}const q=(s=this.headers.get("Prefer"))===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),F=(y=h.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");q&&F&&F.length>1&&(I=parseInt(F[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(k={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,I=null,j=406,z="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const q=await h.text();try{k=JSON.parse(q),Array.isArray(k)&&h.status===404&&(E=[],k=null,j=200,z="OK")}catch{h.status===404&&q===""?(j=204,z="No Content"):k={message:q}}if(k&&this.isMaybeSingle&&(!((w=k==null?void 0:k.details)===null||w===void 0)&&w.includes("0 rows"))&&(k=null,j=200,z="OK"),k&&this.shouldThrowOnError)throw new ghe.default(k)}return{error:k,data:E,count:I,status:j,statusText:z}});return this.shouldThrowOnError||(o=o.catch(h=>{var d,s,y;return{error:{message:`${(d=h==null?void 0:h.name)!==null&&d!==void 0?d:"FetchError"}: ${h==null?void 0:h.message}`,details:`${(s=h==null?void 0:h.stack)!==null&&s!==void 0?s:""}`,hint:"",code:`${(y=h==null?void 0:h.code)!==null&&y!==void 0?y:""}`},data:null,count:null,status:0,statusText:""}})),o.then(t,r)}returns(){return this}overrideTypes(){return this}};gx.default=yhe;var vhe=yi&&yi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(mx,"__esModule",{value:!0});const _he=vhe(gx);let xhe=class extends _he.default{select(t){let r=!1;const n=(t??"*").split("").map(o=>/\s/.test(o)&&!r?"":(o==='"'&&(r=!r),o)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:o,referencedTable:h=o}={}){const d=h?`${h}.order`:"order",s=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${s?`${s},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(o,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:o=n}={}){const h=typeof o>"u"?"offset":`${o}.offset`,d=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(h,`${t}`),this.url.searchParams.set(d,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:o=!1,wal:h=!1,format:d="text"}={}){var s;const y=[t?"analyze":null,r?"verbose":null,n?"settings":null,o?"buffers":null,h?"wal":null].filter(Boolean).join("|"),w=(s=this.headers.get("Accept"))!==null&&s!==void 0?s:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${w}"; options=${y};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};mx.default=xhe;var bhe=yi&&yi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jg,"__esModule",{value:!0});const whe=bhe(mx);let She=class extends whe.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:o}={}){let h="";o==="plain"?h="pl":o==="phrase"?h="ph":o==="websearch"&&(h="w");const d=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${h}fts${d}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const o=n?`${n}.or`:"or";return this.url.searchParams.append(o,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};jg.default=She;var Phe=yi&&yi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(px,"__esModule",{value:!0});const Bp=Phe(jg);let The=class{constructor(t,{headers:r={},schema:n,fetch:o}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=o}select(t,{head:r=!1,count:n}={}){const o=r?"HEAD":"GET";let h=!1;const d=(t??"*").split("").map(s=>/\s/.test(s)&&!h?"":(s==='"'&&(h=!h),s)).join("");return this.url.searchParams.set("select",d),n&&this.headers.append("Prefer",`count=${n}`),new Bp.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var o;const h="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const d=t.reduce((s,y)=>s.concat(Object.keys(y)),[]);if(d.length>0){const s=[...new Set(d)].map(y=>`"${y}"`);this.url.searchParams.set("columns",s.join(","))}}return new Bp.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:o,defaultToNull:h=!0}={}){var d;const s="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),o&&this.headers.append("Prefer",`count=${o}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const y=t.reduce((w,k)=>w.concat(Object.keys(k)),[]);if(y.length>0){const w=[...new Set(y)].map(k=>`"${k}"`);this.url.searchParams.set("columns",w.join(","))}}return new Bp.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(t,{count:r}={}){var n;const o="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Bp.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Bp.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};px.default=The;var U$=yi&&yi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(kT,"__esModule",{value:!0});const khe=U$(px),Ehe=U$(jg);let Ahe=class V${constructor(t,{headers:r={},schema:n,fetch:o}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=o}from(t){const r=new URL(`${this.url}/${t}`);return new khe.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new V$(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:o=!1,count:h}={}){var d;let s;const y=new URL(`${this.url}/rpc/${t}`);let w;n||o?(s=n?"HEAD":"GET",Object.entries(r).filter(([E,I])=>I!==void 0).map(([E,I])=>[E,Array.isArray(I)?`{${I.join(",")}}`:`${I}`]).forEach(([E,I])=>{y.searchParams.append(E,I)})):(s="POST",w=r);const k=new Headers(this.headers);return h&&k.set("Prefer",`count=${h}`),new Ehe.default({method:s,url:y,headers:k,schema:this.schemaName,body:w,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}};kT.default=Ahe;var hf=yi&&yi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ji,"__esModule",{value:!0});Ji.PostgrestError=Ji.PostgrestBuilder=Ji.PostgrestTransformBuilder=Ji.PostgrestFilterBuilder=Ji.PostgrestQueryBuilder=Ji.PostgrestClient=void 0;const G$=hf(kT);Ji.PostgrestClient=G$.default;const q$=hf(px);Ji.PostgrestQueryBuilder=q$.default;const W$=hf(jg);Ji.PostgrestFilterBuilder=W$.default;const H$=hf(mx);Ji.PostgrestTransformBuilder=H$.default;const Z$=hf(gx);Ji.PostgrestBuilder=Z$.default;const K$=hf(yx);Ji.PostgrestError=K$.default;var Che=Ji.default={PostgrestClient:G$.default,PostgrestQueryBuilder:q$.default,PostgrestFilterBuilder:W$.default,PostgrestTransformBuilder:H$.default,PostgrestBuilder:Z$.default,PostgrestError:K$.default};const{PostgrestClient:Mhe,PostgrestQueryBuilder:Cfe,PostgrestFilterBuilder:Mfe,PostgrestTransformBuilder:Ife,PostgrestBuilder:jfe,PostgrestError:Ofe}=Che;class Ihe{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const jhe="2.15.4",Ohe=`realtime-js/${jhe}`,Dhe="1.0.0",cS=1e4,Rhe=1e3,Nhe=100;var lm;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(lm||(lm={}));var Gn;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Gn||(Gn={}));var vo;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(vo||(vo={}));var uS;(function(e){e.websocket="websocket"})(uS||(uS={}));var Qc;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Qc||(Qc={}));class $he{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const o=r.getUint8(1),h=r.getUint8(2);let d=this.HEADER_LENGTH+2;const s=n.decode(t.slice(d,d+o));d=d+o;const y=n.decode(t.slice(d,d+h));d=d+h;const w=JSON.parse(n.decode(t.slice(d,t.byteLength)));return{ref:null,topic:s,event:y,payload:w}}}class X${constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Lr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Lr||(Lr={}));const kj=(e,t,r={})=>{var n;const o=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((h,d)=>(h[d]=zhe(d,e,t,o),h),{})},zhe=(e,t,r,n)=>{const o=t.find(s=>s.name===e),h=o==null?void 0:o.type,d=r[e];return h&&!n.includes(h)?Y$(h,d):hS(d)},Y$=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Uhe(t,r)}switch(e){case Lr.bool:return Lhe(t);case Lr.float4:case Lr.float8:case Lr.int2:case Lr.int4:case Lr.int8:case Lr.numeric:case Lr.oid:return Bhe(t);case Lr.json:case Lr.jsonb:return Fhe(t);case Lr.timestamp:return Vhe(t);case Lr.abstime:case Lr.date:case Lr.daterange:case Lr.int4range:case Lr.int8range:case Lr.money:case Lr.reltime:case Lr.text:case Lr.time:case Lr.timestamptz:case Lr.timetz:case Lr.tsrange:case Lr.tstzrange:return hS(t);default:return hS(t)}},hS=e=>e,Lhe=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Bhe=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Fhe=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Uhe=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let h;const d=e.slice(1,r);try{h=JSON.parse("["+d+"]")}catch{h=d?d.split(","):[]}return h.map(s=>Y$(t,s))}return e},Vhe=e=>typeof e=="string"?e.replace(" ","T"):e,J$=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class R1{constructor(t,r,n={},o=cS){this.channel=t,this.event=r,this.payload=n,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Ej;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Ej||(Ej={}));class cm{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},o=>{const{onJoin:h,onLeave:d,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=cm.syncState(this.state,o,h,d),this.pendingDiffs.forEach(y=>{this.state=cm.syncDiff(this.state,y,h,d)}),this.pendingDiffs=[],s()}),this.channel._on(n.diff,{},o=>{const{onJoin:h,onLeave:d,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=cm.syncDiff(this.state,o,h,d),s())}),this.onJoin((o,h,d)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:h,newPresences:d})}),this.onLeave((o,h,d)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:h,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,o){const h=this.cloneDeep(t),d=this.transformState(r),s={},y={};return this.map(h,(w,k)=>{d[w]||(y[w]=k)}),this.map(d,(w,k)=>{const E=h[w];if(E){const I=k.map(q=>q.presence_ref),j=E.map(q=>q.presence_ref),z=k.filter(q=>j.indexOf(q.presence_ref)<0),L=E.filter(q=>I.indexOf(q.presence_ref)<0);z.length>0&&(s[w]=z),L.length>0&&(y[w]=L)}else s[w]=k}),this.syncDiff(h,{joins:s,leaves:y},n,o)}static syncDiff(t,r,n,o){const{joins:h,leaves:d}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),o||(o=()=>{}),this.map(h,(s,y)=>{var w;const k=(w=t[s])!==null&&w!==void 0?w:[];if(t[s]=this.cloneDeep(y),k.length>0){const E=t[s].map(j=>j.presence_ref),I=k.filter(j=>E.indexOf(j.presence_ref)<0);t[s].unshift(...I)}n(s,k,y)}),this.map(d,(s,y)=>{let w=t[s];if(!w)return;const k=y.map(E=>E.presence_ref);w=w.filter(E=>k.indexOf(E.presence_ref)<0),t[s]=w,o(s,w,y),w.length===0&&delete t[s]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const o=t[n];return"metas"in o?r[n]=o.metas.map(h=>(h.presence_ref=h.phx_ref,delete h.phx_ref,delete h.phx_ref_prev,h)):r[n]=o,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Aj;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Aj||(Aj={}));var um;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(um||(um={}));var Cs;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Cs||(Cs={}));class ET{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Gn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new R1(this,vo.join,this.params,this.timeout),this.rejoinTimer=new X$(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Gn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Gn.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Gn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(vo.reply,{},(o,h)=>{this._trigger(this._replyEventName(h),o)}),this.presence=new cm(this),this.broadcastEndpointURL=J$(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,o,h;if(this.socket.isConnected()||this.socket.connect(),this.state==Gn.closed){const{config:{broadcast:d,presence:s,private:y}}=this.params,w=(o=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(j=>j.filter))!==null&&o!==void 0?o:[],k=!!this.bindings[um.PRESENCE]&&this.bindings[um.PRESENCE].length>0||((h=this.params.config.presence)===null||h===void 0?void 0:h.enabled)===!0,E={},I={broadcast:d,presence:Object.assign(Object.assign({},s),{enabled:k}),postgres_changes:w,private:y};this.socket.accessTokenValue&&(E.access_token=this.socket.accessTokenValue),this._onError(j=>t==null?void 0:t(Cs.CHANNEL_ERROR,j)),this._onClose(()=>t==null?void 0:t(Cs.CLOSED)),this.updateJoinPayload(Object.assign({config:I},E)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:j})=>{var z;if(this.socket.setAuth(),j===void 0){t==null||t(Cs.SUBSCRIBED);return}else{const L=this.bindings.postgres_changes,q=(z=L==null?void 0:L.length)!==null&&z!==void 0?z:0,F=[];for(let U=0;U<q;U++){const N=L[U],{filter:{event:W,schema:H,table:Z,filter:re}}=N,he=j&&j[U];if(he&&he.event===W&&he.schema===H&&he.table===Z&&he.filter===re)F.push(Object.assign(Object.assign({},N),{id:he.id}));else{this.unsubscribe(),this.state=Gn.errored,t==null||t(Cs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=F,t&&t(Cs.SUBSCRIBED);return}}).receive("error",j=>{this.state=Gn.errored,t==null||t(Cs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(j).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Cs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Gn.joined&&t===um.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,o;if(!this._canPush()&&t.type==="broadcast"){const{event:h,payload:d}=t,y={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:h,payload:d,private:this.private}]})};try{const w=await this._fetchWithTimeout(this.broadcastEndpointURL,y,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((o=w.body)===null||o===void 0?void 0:o.cancel()),w.ok?"ok":"error"}catch(w){return w.name==="AbortError"?"timed out":"error"}}else return new Promise(h=>{var d,s,y;const w=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((y=(s=(d=this.params)===null||d===void 0?void 0:d.config)===null||s===void 0?void 0:s.broadcast)===null||y===void 0)&&y.ack)&&h("ok"),w.receive("ok",()=>h("ok")),w.receive("error",()=>h("error")),w.receive("timeout",()=>h("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Gn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(vo.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(o=>{n=new R1(this,vo.leave,{},t),n.receive("ok",()=>{r(),o("ok")}).receive("timeout",()=>{r(),o("timed out")}).receive("error",()=>{o("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Gn.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const o=new AbortController,h=setTimeout(()=>o.abort(),n),d=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(h),d}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new R1(this,t,r,n);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Nhe){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var o,h;const d=t.toLocaleLowerCase(),{close:s,error:y,leave:w,join:k}=vo;if(n&&[s,y,w,k].indexOf(d)>=0&&n!==this._joinRef())return;let I=this._onMessage(d,r,n);if(r&&!I)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(j=>{var z,L,q;return((z=j.filter)===null||z===void 0?void 0:z.event)==="*"||((q=(L=j.filter)===null||L===void 0?void 0:L.event)===null||q===void 0?void 0:q.toLocaleLowerCase())===d}).map(j=>j.callback(I,n)):(h=this.bindings[d])===null||h===void 0||h.filter(j=>{var z,L,q,F,U,N;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in j){const W=j.id,H=(z=j.filter)===null||z===void 0?void 0:z.event;return W&&((L=r.ids)===null||L===void 0?void 0:L.includes(W))&&(H==="*"||(H==null?void 0:H.toLocaleLowerCase())===((q=r.data)===null||q===void 0?void 0:q.type.toLocaleLowerCase()))}else{const W=(U=(F=j==null?void 0:j.filter)===null||F===void 0?void 0:F.event)===null||U===void 0?void 0:U.toLocaleLowerCase();return W==="*"||W===((N=r==null?void 0:r.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return j.type.toLocaleLowerCase()===d}).map(j=>{if(typeof I=="object"&&"ids"in I){const z=I.data,{schema:L,table:q,commit_timestamp:F,type:U,errors:N}=z;I=Object.assign(Object.assign({},{schema:L,table:q,commit_timestamp:F,eventType:U,new:{},old:{},errors:N}),this._getPayloadRecords(z))}j.callback(I,n)})}_isClosed(){return this.state===Gn.closed}_isJoined(){return this.state===Gn.joined}_isJoining(){return this.state===Gn.joining}_isLeaving(){return this.state===Gn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const o=t.toLocaleLowerCase(),h={type:o,filter:r,callback:n};return this.bindings[o]?this.bindings[o].push(h):this.bindings[o]=[h],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(o=>{var h;return!(((h=o.type)===null||h===void 0?void 0:h.toLocaleLowerCase())===n&&ET.isEqual(o.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(vo.close,{},t)}_onError(t){this._on(vo.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Gn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=kj(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=kj(t.columns,t.old_record)),r}}const N1=()=>{},b0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ghe=[1e3,2e3,5e3,1e4],qhe=1e4,Whe=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Hhe{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=cS,this.transport=null,this.heartbeatIntervalMs=b0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=N1,this.ref=0,this.reconnectTimer=null,this.logger=N1,this.conn=null,this.sendBuffer=[],this.serializer=new $he,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let h;return o?h=o:typeof fetch>"u"?h=(...d)=>Ig(()=>Promise.resolve().then(()=>uf),void 0).then(({default:s})=>s(...d)).catch(s=>{throw new Error(`Failed to load @supabase/node-fetch: ${s.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):h=fetch,(...d)=>h(...d)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${uS.websocket}`,this.httpEndpoint=J$(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Ihe.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Dhe}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case lm.connecting:return Qc.Connecting;case lm.open:return Qc.Open;case lm.closing:return Qc.Closing;default:return Qc.Closed}}isConnected(){return this.connectionState()===Qc.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,o=this.getChannels().find(h=>h.topic===n);if(o)return o;{const h=new ET(`realtime:${t}`,r,this);return this.channels.push(h),h}}push(t){const{topic:r,event:n,payload:o,ref:h}=t,d=()=>{this.encode(t,s=>{var y;(y=this.conn)===null||y===void 0||y.send(s)})};this.log("push",`${r} ${n} (${h})`,o),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Rhe,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},b0.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(w){this.log("error","error in heartbeat callback",w)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:o,payload:h,ref:d}=r,s=d?`(${d})`:"",y=h.status||"";this.log("receive",`${y} ${n} ${o} ${s}`.trim(),h),this.channels.filter(w=>w._isMember(n)).forEach(w=>w._trigger(o,h,d)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(vo.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${t}${n}${o}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Whe],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const o={access_token:r,version:Ohe};r&&n.updateJoinPayload(o),n.joinedOnce&&n._isJoined()&&n._push(vo.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(o){this.log("error",`error in ${t} callback`,o)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new X$(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},b0.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,o,h,d,s,y,w,k;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:cS,this.heartbeatIntervalMs=(o=t==null?void 0:t.heartbeatIntervalMs)!==null&&o!==void 0?o:b0.HEARTBEAT_INTERVAL,this.worker=(h=t==null?void 0:t.worker)!==null&&h!==void 0?h:!1,this.accessToken=(d=t==null?void 0:t.accessToken)!==null&&d!==void 0?d:null,this.heartbeatCallback=(s=t==null?void 0:t.heartbeatCallback)!==null&&s!==void 0?s:N1,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(y=t==null?void 0:t.reconnectAfterMs)!==null&&y!==void 0?y:E=>Ghe[E-1]||qhe,this.encode=(w=t==null?void 0:t.encode)!==null&&w!==void 0?w:(E,I)=>I(JSON.stringify(E)),this.decode=(k=t==null?void 0:t.decode)!==null&&k!==void 0?k:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class AT extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function qn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Zhe extends AT{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class dS extends AT{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Khe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(h){return h instanceof r?h:new r(function(d){d(h)})}return new(r||(r=Promise))(function(h,d){function s(k){try{w(n.next(k))}catch(E){d(E)}}function y(k){try{w(n.throw(k))}catch(E){d(E)}}function w(k){k.done?h(k.value):o(k.value).then(s,y)}w((n=n.apply(e,t||[])).next())})};const Q$=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ig(()=>Promise.resolve().then(()=>uf),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Xhe=()=>Khe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ig(()=>Promise.resolve().then(()=>uf),void 0)).Response:Response}),fS=e=>{if(Array.isArray(e))return e.map(r=>fS(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const o=r.replace(/([-_][a-z])/gi,h=>h.toUpperCase().replace(/[-_]/g,""));t[o]=fS(n)}),t},Yhe=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Au=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(h){return h instanceof r?h:new r(function(d){d(h)})}return new(r||(r=Promise))(function(h,d){function s(k){try{w(n.next(k))}catch(E){d(E)}}function y(k){try{w(n.throw(k))}catch(E){d(E)}}function w(k){k.done?h(k.value):o(k.value).then(s,y)}w((n=n.apply(e,t||[])).next())})};const $1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Jhe=(e,t,r)=>Au(void 0,void 0,void 0,function*(){const n=yield Xhe();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(o=>{const h=e.status||500,d=(o==null?void 0:o.statusCode)||h+"";t(new Zhe($1(o),h,d))}).catch(o=>{t(new dS($1(o),o))}):t(new dS($1(e),e))}),Qhe=(e,t,r,n)=>{const o={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?o:(Yhe(n)?(o.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),o.body=JSON.stringify(n)):o.body=n,t!=null&&t.duplex&&(o.duplex=t.duplex),Object.assign(Object.assign({},o),r))};function Og(e,t,r,n,o,h){return Au(this,void 0,void 0,function*(){return new Promise((d,s)=>{e(r,Qhe(t,n,o,h)).then(y=>{if(!y.ok)throw y;return n!=null&&n.noResolveJson?y:y.json()}).then(y=>d(y)).catch(y=>Jhe(y,s,n))})})}function o_(e,t,r,n){return Au(this,void 0,void 0,function*(){return Og(e,"GET",t,r,n)})}function Wo(e,t,r,n,o){return Au(this,void 0,void 0,function*(){return Og(e,"POST",t,n,o,r)})}function pS(e,t,r,n,o){return Au(this,void 0,void 0,function*(){return Og(e,"PUT",t,n,o,r)})}function ede(e,t,r,n){return Au(this,void 0,void 0,function*(){return Og(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function ez(e,t,r,n,o){return Au(this,void 0,void 0,function*(){return Og(e,"DELETE",t,n,o,r)})}var Bi=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(h){return h instanceof r?h:new r(function(d){d(h)})}return new(r||(r=Promise))(function(h,d){function s(k){try{w(n.next(k))}catch(E){d(E)}}function y(k){try{w(n.throw(k))}catch(E){d(E)}}function w(k){k.done?h(k.value):o(k.value).then(s,y)}w((n=n.apply(e,t||[])).next())})};const tde={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Cj={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class rde{constructor(t,r={},n,o){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Q$(o)}uploadOrUpdate(t,r,n,o){return Bi(this,void 0,void 0,function*(){try{let h;const d=Object.assign(Object.assign({},Cj),o);let s=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(d.upsert)});const y=d.metadata;typeof Blob<"u"&&n instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),y&&h.append("metadata",this.encodeMetadata(y)),h.append("",n)):typeof FormData<"u"&&n instanceof FormData?(h=n,h.append("cacheControl",d.cacheControl),y&&h.append("metadata",this.encodeMetadata(y))):(h=n,s["cache-control"]=`max-age=${d.cacheControl}`,s["content-type"]=d.contentType,y&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(y)))),o!=null&&o.headers&&(s=Object.assign(Object.assign({},s),o.headers));const w=this._removeEmptyFolders(r),k=this._getFinalPath(w),E=yield(t=="PUT"?pS:Wo)(this.fetch,`${this.url}/object/${k}`,h,Object.assign({headers:s},d!=null&&d.duplex?{duplex:d.duplex}:{}));return{data:{path:w,id:E.Id,fullPath:E.Key},error:null}}catch(h){if(qn(h))return{data:null,error:h};throw h}})}upload(t,r,n){return Bi(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,o){return Bi(this,void 0,void 0,function*(){const h=this._removeEmptyFolders(t),d=this._getFinalPath(h),s=new URL(this.url+`/object/upload/sign/${d}`);s.searchParams.set("token",r);try{let y;const w=Object.assign({upsert:Cj.upsert},o),k=Object.assign(Object.assign({},this.headers),{"x-upsert":String(w.upsert)});typeof Blob<"u"&&n instanceof Blob?(y=new FormData,y.append("cacheControl",w.cacheControl),y.append("",n)):typeof FormData<"u"&&n instanceof FormData?(y=n,y.append("cacheControl",w.cacheControl)):(y=n,k["cache-control"]=`max-age=${w.cacheControl}`,k["content-type"]=w.contentType);const E=yield pS(this.fetch,s.toString(),y,{headers:k});return{data:{path:h,fullPath:E.Key},error:null}}catch(y){if(qn(y))return{data:null,error:y};throw y}})}createSignedUploadUrl(t,r){return Bi(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const o=Object.assign({},this.headers);r!=null&&r.upsert&&(o["x-upsert"]="true");const h=yield Wo(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:o}),d=new URL(this.url+h.url),s=d.searchParams.get("token");if(!s)throw new AT("No token returned by API");return{data:{signedUrl:d.toString(),path:t,token:s},error:null}}catch(n){if(qn(n))return{data:null,error:n};throw n}})}update(t,r,n){return Bi(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Bi(this,void 0,void 0,function*(){try{return{data:yield Wo(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(qn(o))return{data:null,error:o};throw o}})}copy(t,r,n){return Bi(this,void 0,void 0,function*(){try{return{data:{path:(yield Wo(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(qn(o))return{data:null,error:o};throw o}})}createSignedUrl(t,r,n){return Bi(this,void 0,void 0,function*(){try{let o=this._getFinalPath(t),h=yield Wo(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const d=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return h={signedUrl:encodeURI(`${this.url}${h.signedURL}${d}`)},{data:h,error:null}}catch(o){if(qn(o))return{data:null,error:o};throw o}})}createSignedUrls(t,r,n){return Bi(this,void 0,void 0,function*(){try{const o=yield Wo(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),h=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:o.map(d=>Object.assign(Object.assign({},d),{signedUrl:d.signedURL?encodeURI(`${this.url}${d.signedURL}${h}`):null})),error:null}}catch(o){if(qn(o))return{data:null,error:o};throw o}})}download(t,r){return Bi(this,void 0,void 0,function*(){const o=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",h=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),d=h?`?${h}`:"";try{const s=this._getFinalPath(t);return{data:yield(yield o_(this.fetch,`${this.url}/${o}/${s}${d}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(s){if(qn(s))return{data:null,error:s};throw s}})}info(t){return Bi(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield o_(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:fS(n),error:null}}catch(n){if(qn(n))return{data:null,error:n};throw n}})}exists(t){return Bi(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield ede(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(qn(n)&&n instanceof dS){const o=n.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),o=[],h=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";h!==""&&o.push(h);const s=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",y=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});y!==""&&o.push(y);let w=o.join("&");return w!==""&&(w=`?${w}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${n}${w}`)}}}remove(t){return Bi(this,void 0,void 0,function*(){try{return{data:yield ez(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(qn(r))return{data:null,error:r};throw r}})}list(t,r,n){return Bi(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},tde),r),{prefix:t||""});return{data:yield Wo(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},n),error:null}}catch(o){if(qn(o))return{data:null,error:o};throw o}})}listV2(t,r){return Bi(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Wo(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(qn(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const nde="2.11.0",ide={"X-Client-Info":`storage-js/${nde}`};var Nh=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(h){return h instanceof r?h:new r(function(d){d(h)})}return new(r||(r=Promise))(function(h,d){function s(k){try{w(n.next(k))}catch(E){d(E)}}function y(k){try{w(n.throw(k))}catch(E){d(E)}}function w(k){k.done?h(k.value):o(k.value).then(s,y)}w((n=n.apply(e,t||[])).next())})};class ade{constructor(t,r={},n,o){const h=new URL(t);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(h.hostname)&&!h.hostname.includes("storage.supabase.")&&(h.hostname=h.hostname.replace("supabase.","storage.supabase.")),this.url=h.href,this.headers=Object.assign(Object.assign({},ide),r),this.fetch=Q$(n)}listBuckets(){return Nh(this,void 0,void 0,function*(){try{return{data:yield o_(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(qn(t))return{data:null,error:t};throw t}})}getBucket(t){return Nh(this,void 0,void 0,function*(){try{return{data:yield o_(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(qn(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Nh(this,void 0,void 0,function*(){try{return{data:yield Wo(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(qn(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Nh(this,void 0,void 0,function*(){try{return{data:yield pS(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(qn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Nh(this,void 0,void 0,function*(){try{return{data:yield Wo(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(qn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Nh(this,void 0,void 0,function*(){try{return{data:yield ez(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(qn(r))return{data:null,error:r};throw r}})}}class ode extends ade{constructor(t,r={},n,o){super(t,r,n,o)}from(t){return new rde(this.url,this.headers,t,this.fetch)}}const sde="2.56.1";let Hp="";typeof Deno<"u"?Hp="deno":typeof document<"u"?Hp="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Hp="react-native":Hp="node";const lde={"X-Client-Info":`supabase-js-${Hp}/${sde}`},cde={headers:lde},ude={schema:"public"},hde={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},dde={};var fde=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(h){return h instanceof r?h:new r(function(d){d(h)})}return new(r||(r=Promise))(function(h,d){function s(k){try{w(n.next(k))}catch(E){d(E)}}function y(k){try{w(n.throw(k))}catch(E){d(E)}}function w(k){k.done?h(k.value):o(k.value).then(s,y)}w((n=n.apply(e,t||[])).next())})};const pde=e=>{let t;return e?t=e:typeof fetch>"u"?t=L$:t=fetch,(...r)=>t(...r)},mde=()=>typeof Headers>"u"?B$:Headers,gde=(e,t,r)=>{const n=pde(r),o=mde();return(h,d)=>fde(void 0,void 0,void 0,function*(){var s;const y=(s=yield t())!==null&&s!==void 0?s:e;let w=new o(d==null?void 0:d.headers);return w.has("apikey")||w.set("apikey",e),w.has("Authorization")||w.set("Authorization",`Bearer ${y}`),n(h,Object.assign(Object.assign({},d),{headers:w}))})};var yde=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(h){return h instanceof r?h:new r(function(d){d(h)})}return new(r||(r=Promise))(function(h,d){function s(k){try{w(n.next(k))}catch(E){d(E)}}function y(k){try{w(n.throw(k))}catch(E){d(E)}}function w(k){k.done?h(k.value):o(k.value).then(s,y)}w((n=n.apply(e,t||[])).next())})};function vde(e){return e.endsWith("/")?e:e+"/"}function _de(e,t){var r,n;const{db:o,auth:h,realtime:d,global:s}=e,{db:y,auth:w,realtime:k,global:E}=t,I={db:Object.assign(Object.assign({},y),o),auth:Object.assign(Object.assign({},w),h),realtime:Object.assign(Object.assign({},k),d),storage:{},global:Object.assign(Object.assign(Object.assign({},E),s),{headers:Object.assign(Object.assign({},(r=E==null?void 0:E.headers)!==null&&r!==void 0?r:{}),(n=s==null?void 0:s.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>yde(this,void 0,void 0,function*(){return""})};return e.accessToken?I.accessToken=e.accessToken:delete I.accessToken,I}const tz="2.71.1",Uh=30*1e3,mS=3,z1=mS*Uh,xde="http://localhost:9999",bde="supabase.auth.token",wde={"X-Client-Info":`gotrue-js/${tz}`},gS="X-Supabase-Api-Version",rz={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Sde=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Pde=10*60*1e3;class CT extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Qt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Tde extends CT{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function kde(e){return Qt(e)&&e.name==="AuthApiError"}class nz extends CT{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class cc extends CT{constructor(t,r,n,o){super(t,n,o),this.name=r,this.status=n}}class Ml extends cc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ede(e){return Qt(e)&&e.name==="AuthSessionMissingError"}class w0 extends cc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class S0 extends cc{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class P0 extends cc{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ade(e){return Qt(e)&&e.name==="AuthImplicitGrantRedirectError"}class Mj extends cc{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class yS extends cc{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function L1(e){return Qt(e)&&e.name==="AuthRetryableFetchError"}class Ij extends cc{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class vS extends cc{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const s_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),jj=` 	
\r=`.split(""),Cde=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<jj.length;t+=1)e[jj[t].charCodeAt(0)]=-2;for(let t=0;t<s_.length;t+=1)e[s_[t].charCodeAt(0)]=t;return e})();function Oj(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(s_[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(s_[n]),t.queuedBits-=6}}function iz(e,t,r){const n=Cde[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Dj(e){const t=[],r=d=>{t.push(String.fromCodePoint(d))},n={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},h=d=>{jde(d,n,r)};for(let d=0;d<e.length;d+=1)iz(e.charCodeAt(d),o,h);return t.join("")}function Mde(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Ide(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const o=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}Mde(n,t)}}function jde(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Ode(e){const t=[],r={queue:0,queuedBits:0},n=o=>{t.push(o)};for(let o=0;o<e.length;o+=1)iz(e.charCodeAt(o),r,n);return new Uint8Array(t)}function Dde(e){const t=[];return Ide(e,r=>t.push(r)),new Uint8Array(t)}function Rde(e){const t=[],r={queue:0,queuedBits:0},n=o=>{t.push(o)};return e.forEach(o=>Oj(o,r,n)),Oj(null,r,n),t.join("")}function Nde(e){return Math.round(Date.now()/1e3)+e}function $de(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const fo=()=>typeof window<"u"&&typeof document<"u",qc={tested:!1,writable:!1},az=()=>{if(!fo())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(qc.tested)return qc.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),qc.tested=!0,qc.writable=!0}catch{qc.tested=!0,qc.writable=!1}return qc.writable};function zde(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,h)=>{t[h]=o})}catch{}return r.searchParams.forEach((n,o)=>{t[o]=n}),t}const oz=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ig(()=>Promise.resolve().then(()=>uf),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Lde=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Vh=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Wc=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Cl=async(e,t)=>{await e.removeItem(t)};class vx{constructor(){this.promise=new vx.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}vx.promiseConstructor=Promise;function B1(e){const t=e.split(".");if(t.length!==3)throw new vS("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Sde.test(t[n]))throw new vS("JWT not in base64url format");return{header:JSON.parse(Dj(t[0])),payload:JSON.parse(Dj(t[1])),signature:Ode(t[2]),raw:{header:t[0],payload:t[1]}}}async function Bde(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Fde(e,t){return new Promise((n,o)=>{(async()=>{for(let h=0;h<1/0;h++)try{const d=await e(h);if(!t(h,null,d)){n(d);return}}catch(d){if(!t(h,d)){o(d);return}}})()})}function Ude(e){return("0"+e.toString(16)).substr(-2)}function Vde(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let o="";for(let h=0;h<56;h++)o+=r.charAt(Math.floor(Math.random()*n));return o}return crypto.getRandomValues(t),Array.from(t,Ude).join("")}async function Gde(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(n);return Array.from(o).map(h=>String.fromCharCode(h)).join("")}async function qde(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Gde(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $h(e,t,r=!1){const n=Vde();let o=n;r&&(o+="/PASSWORD_RECOVERY"),await Vh(e,`${t}-code-verifier`,o);const h=await qde(n);return[h,n===h?"plain":"s256"]}const Wde=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Hde(e){const t=e.headers.get(gS);if(!t||!t.match(Wde))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Zde(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Kde(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Xde=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function zh(e){if(!Xde.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function F1(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Rj(e){return JSON.parse(JSON.stringify(e))}var Yde=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};const Jc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Jde=[502,503,504];async function Nj(e){var t;if(!Lde(e))throw new yS(Jc(e),0);if(Jde.includes(e.status))throw new yS(Jc(e),e.status);let r;try{r=await e.json()}catch(h){throw new nz(Jc(h),h)}let n;const o=Hde(e);if(o&&o.getTime()>=rz["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Ij(Jc(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ml}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((h,d)=>h&&typeof d=="string",!0))throw new Ij(Jc(r),e.status,r.weak_password.reasons);throw new Tde(Jc(r),e.status||500,n)}const Qde=(e,t,r,n)=>{const o={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),o.body=JSON.stringify(n),Object.assign(Object.assign({},o),r))};async function sr(e,t,r,n){var o;const h=Object.assign({},n==null?void 0:n.headers);h[gS]||(h[gS]=rz["2024-01-01"].name),n!=null&&n.jwt&&(h.Authorization=`Bearer ${n.jwt}`);const d=(o=n==null?void 0:n.query)!==null&&o!==void 0?o:{};n!=null&&n.redirectTo&&(d.redirect_to=n.redirectTo);const s=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",y=await efe(e,t,r+s,{headers:h,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(y):{data:Object.assign({},y),error:null}}async function efe(e,t,r,n,o,h){const d=Qde(t,n,o,h);let s;try{s=await e(r,Object.assign({},d))}catch(y){throw console.error(y),new yS(Jc(y),0)}if(s.ok||await Nj(s),n!=null&&n.noResolveJson)return s;try{return await s.json()}catch(y){await Nj(y)}}function ks(e){var t;let r=null;ife(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Nde(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function $j(e){const t=ks(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function $l(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function tfe(e){return{data:e,error:null}}function rfe(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:o,verification_type:h}=e,d=Yde(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),s={action_link:t,email_otp:r,hashed_token:n,redirect_to:o,verification_type:h},y=Object.assign({},d);return{data:{properties:s,user:y},error:null}}function nfe(e){return e}function ife(e){return e.access_token&&e.refresh_token&&e.expires_in}const U1=["global","local","others"];var afe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};class ofe{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=oz(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=U1[0]){if(U1.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${U1.join(", ")}`);try{return await sr(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Qt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await sr(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:$l})}catch(n){if(Qt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=afe(t,["options"]),o=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(o.new_email=n==null?void 0:n.newEmail,delete o.newEmail),await sr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:rfe,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Qt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await sr(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:$l})}catch(r){if(Qt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,o,h,d,s,y;try{const w={nextPage:null,lastPage:0,total:0},k=await sr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(h=(o=t==null?void 0:t.perPage)===null||o===void 0?void 0:o.toString())!==null&&h!==void 0?h:""},xform:nfe});if(k.error)throw k.error;const E=await k.json(),I=(d=k.headers.get("x-total-count"))!==null&&d!==void 0?d:0,j=(y=(s=k.headers.get("link"))===null||s===void 0?void 0:s.split(","))!==null&&y!==void 0?y:[];return j.length>0&&(j.forEach(z=>{const L=parseInt(z.split(";")[0].split("=")[1].substring(0,1)),q=JSON.parse(z.split(";")[1].split("=")[1]);w[`${q}Page`]=L}),w.total=parseInt(I)),{data:Object.assign(Object.assign({},E),w),error:null}}catch(w){if(Qt(w))return{data:{users:[]},error:w};throw w}}async getUserById(t){zh(t);try{return await sr(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:$l})}catch(r){if(Qt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){zh(t);try{return await sr(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:$l})}catch(n){if(Qt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){zh(t);try{return await sr(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:$l})}catch(n){if(Qt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){zh(t.userId);try{const{data:r,error:n}=await sr(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:n}}catch(r){if(Qt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){zh(t.userId),zh(t.id);try{return{data:await sr(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Qt(r))return{data:null,error:r};throw r}}}function zj(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function sfe(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Lh={debug:!!(globalThis&&az()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class sz extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class lfe extends sz{}async function cfe(e,t,r){Lh.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Lh.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async o=>{if(o){Lh.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,o.name);try{return await r()}finally{Lh.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,o.name)}}else{if(t===0)throw Lh.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new lfe(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Lh.debug)try{const h=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(h,null,"  "))}catch(h){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",h)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}sfe();const ufe={url:xde,storageKey:bde,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wde,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Lj(e,t,r){return await r()}const Bh={};class fg{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=fg.nextInstanceID,fg.nextInstanceID+=1,this.instanceID>0&&fo()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},ufe),t);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new ofe({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=oz(o.fetch),this.lock=o.lock||Lj,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:fo()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=cfe:this.lock=Lj,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:az()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=zj(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=zj(this.memoryStorage)),fo()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(h){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",h)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async h=>{this._debug("received broadcast notification from other tab or client",h),await this._notifyAllSubscribers(h.data.event,h.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=Bh[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Bh[this.storageKey]=Object.assign(Object.assign({},Bh[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Bh[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Bh[this.storageKey]=Object.assign(Object.assign({},Bh[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${tz}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=zde(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),fo()&&this.detectSessionInUrl&&n!=="none"){const{data:o,error:h}=await this._getSessionFromURL(r,n);if(h){if(this._debug("#_initialize()","error detecting session from URL",h),Ade(h)){const y=(t=h.details)===null||t===void 0?void 0:t.code;if(y==="identity_already_exists"||y==="identity_not_found"||y==="single_identity_not_deletable")return{error:h}}return await this._removeSession(),{error:h}}const{session:d,redirectType:s}=o;return this._debug("#_initialize()","detected session in URL",d,"redirect type",s),await this._saveSession(d),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Qt(r)?{error:r}:{error:new nz("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,o;try{const h=await sr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(o=t==null?void 0:t.options)===null||o===void 0?void 0:o.captchaToken}},xform:ks}),{data:d,error:s}=h;if(s||!d)return{data:{user:null,session:null},error:s};const y=d.session,w=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",y)),{data:{user:w,session:y},error:null}}catch(h){if(Qt(h))return{data:{user:null,session:null},error:h};throw h}}async signUp(t){var r,n,o;try{let h;if("email"in t){const{email:k,password:E,options:I}=t;let j=null,z=null;this.flowType==="pkce"&&([j,z]=await $h(this.storage,this.storageKey)),h=await sr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:I==null?void 0:I.emailRedirectTo,body:{email:k,password:E,data:(r=I==null?void 0:I.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:I==null?void 0:I.captchaToken},code_challenge:j,code_challenge_method:z},xform:ks})}else if("phone"in t){const{phone:k,password:E,options:I}=t;h=await sr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:k,password:E,data:(n=I==null?void 0:I.data)!==null&&n!==void 0?n:{},channel:(o=I==null?void 0:I.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:I==null?void 0:I.captchaToken}},xform:ks})}else throw new S0("You must provide either an email or phone number and a password");const{data:d,error:s}=h;if(s||!d)return{data:{user:null,session:null},error:s};const y=d.session,w=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",y)),{data:{user:w,session:y},error:null}}catch(h){if(Qt(h))return{data:{user:null,session:null},error:h};throw h}}async signInWithPassword(t){try{let r;if("email"in t){const{email:h,password:d,options:s}=t;r=await sr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:h,password:d,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:$j})}else if("phone"in t){const{phone:h,password:d,options:s}=t;r=await sr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:h,password:d,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:$j})}else throw new S0("You must provide either an email or phone number and a password");const{data:n,error:o}=r;return o?{data:{user:null,session:null},error:o}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new w0}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:o})}catch(r){if(Qt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,o,h;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(o=t.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(h=t.options)===null||h===void 0?void 0:h.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,o,h,d,s,y,w,k,E,I,j;let z,L;if("message"in t)z=t.message,L=t.signature;else{const{chain:q,wallet:F,statement:U,options:N}=t;let W;if(fo())if(typeof F=="object")W=F;else{const Z=window;if("solana"in Z&&typeof Z.solana=="object"&&("signIn"in Z.solana&&typeof Z.solana.signIn=="function"||"signMessage"in Z.solana&&typeof Z.solana.signMessage=="function"))W=Z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof F!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");W=F}const H=new URL((r=N==null?void 0:N.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in W&&W.signIn){const Z=await W.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:H.host,uri:H.href}),U?{statement:U}:null));let re;if(Array.isArray(Z)&&Z[0]&&typeof Z[0]=="object")re=Z[0];else if(Z&&typeof Z=="object"&&"signedMessage"in Z&&"signature"in Z)re=Z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in re&&"signature"in re&&(typeof re.signedMessage=="string"||re.signedMessage instanceof Uint8Array)&&re.signature instanceof Uint8Array)z=typeof re.signedMessage=="string"?re.signedMessage:new TextDecoder().decode(re.signedMessage),L=re.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in W)||typeof W.signMessage!="function"||!("publicKey"in W)||typeof W!="object"||!W.publicKey||!("toBase58"in W.publicKey)||typeof W.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");z=[`${H.host} wants you to sign in with your Solana account:`,W.publicKey.toBase58(),...U?["",U,""]:[""],"Version: 1",`URI: ${H.href}`,`Issued At: ${(o=(n=N==null?void 0:N.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((h=N==null?void 0:N.signInWithSolana)===null||h===void 0)&&h.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((d=N==null?void 0:N.signInWithSolana)===null||d===void 0)&&d.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((s=N==null?void 0:N.signInWithSolana)===null||s===void 0)&&s.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((y=N==null?void 0:N.signInWithSolana)===null||y===void 0)&&y.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((w=N==null?void 0:N.signInWithSolana)===null||w===void 0)&&w.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((E=(k=N==null?void 0:N.signInWithSolana)===null||k===void 0?void 0:k.resources)===null||E===void 0)&&E.length?["Resources",...N.signInWithSolana.resources.map(re=>`- ${re}`)]:[]].join(`
`);const Z=await W.signMessage(new TextEncoder().encode(z),"utf8");if(!Z||!(Z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");L=Z}}try{const{data:q,error:F}=await sr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:z,signature:Rde(L)},!((I=t.options)===null||I===void 0)&&I.captchaToken?{gotrue_meta_security:{captcha_token:(j=t.options)===null||j===void 0?void 0:j.captchaToken}}:null),xform:ks});if(F)throw F;return!q||!q.session||!q.user?{data:{user:null,session:null},error:new w0}:(q.session&&(await this._saveSession(q.session),await this._notifyAllSubscribers("SIGNED_IN",q.session)),{data:Object.assign({},q),error:F})}catch(q){if(Qt(q))return{data:{user:null,session:null},error:q};throw q}}async _exchangeCodeForSession(t){const r=await Wc(this.storage,`${this.storageKey}-code-verifier`),[n,o]=(r??"").split("/");try{const{data:h,error:d}=await sr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:ks});if(await Cl(this.storage,`${this.storageKey}-code-verifier`),d)throw d;return!h||!h.session||!h.user?{data:{user:null,session:null,redirectType:null},error:new w0}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:Object.assign(Object.assign({},h),{redirectType:o??null}),error:d})}catch(h){if(Qt(h))return{data:{user:null,session:null,redirectType:null},error:h};throw h}}async signInWithIdToken(t){try{const{options:r,provider:n,token:o,access_token:h,nonce:d}=t,s=await sr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:o,access_token:h,nonce:d,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ks}),{data:y,error:w}=s;return w?{data:{user:null,session:null},error:w}:!y||!y.session||!y.user?{data:{user:null,session:null},error:new w0}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:y,error:w})}catch(r){if(Qt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,o,h,d;try{if("email"in t){const{email:s,options:y}=t;let w=null,k=null;this.flowType==="pkce"&&([w,k]=await $h(this.storage,this.storageKey));const{error:E}=await sr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:(r=y==null?void 0:y.data)!==null&&r!==void 0?r:{},create_user:(n=y==null?void 0:y.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken},code_challenge:w,code_challenge_method:k},redirectTo:y==null?void 0:y.emailRedirectTo});return{data:{user:null,session:null},error:E}}if("phone"in t){const{phone:s,options:y}=t,{data:w,error:k}=await sr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:s,data:(o=y==null?void 0:y.data)!==null&&o!==void 0?o:{},create_user:(h=y==null?void 0:y.shouldCreateUser)!==null&&h!==void 0?h:!0,gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken},channel:(d=y==null?void 0:y.channel)!==null&&d!==void 0?d:"sms"}});return{data:{user:null,session:null,messageId:w==null?void 0:w.message_id},error:k}}throw new S0("You must provide either an email or phone number.")}catch(s){if(Qt(s))return{data:{user:null,session:null},error:s};throw s}}async verifyOtp(t){var r,n;try{let o,h;"options"in t&&(o=(r=t.options)===null||r===void 0?void 0:r.redirectTo,h=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:d,error:s}=await sr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:h}}),redirectTo:o,xform:ks});if(s)throw s;if(!d)throw new Error("An error occurred on token verification.");const y=d.session,w=d.user;return y!=null&&y.access_token&&(await this._saveSession(y),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",y)),{data:{user:w,session:y},error:null}}catch(o){if(Qt(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(t){var r,n,o;try{let h=null,d=null;return this.flowType==="pkce"&&([h,d]=await $h(this.storage,this.storageKey)),await sr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((o=t==null?void 0:t.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:h,code_challenge_method:d}),headers:this.headers,xform:tfe})}catch(h){if(Qt(h))return{data:null,error:h};throw h}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ml;const{error:o}=await sr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:o}})}catch(t){if(Qt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:o,options:h}=t,{error:d}=await sr(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:o,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},redirectTo:h==null?void 0:h.emailRedirectTo});return{data:{user:null,session:null},error:d}}else if("phone"in t){const{phone:n,type:o,options:h}=t,{data:d,error:s}=await sr(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:o,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:s}}throw new S0("You must provide either an email or phone number and a type")}catch(r){if(Qt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Wc(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<z1:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const d=await Wc(this.userStorage,this.storageKey+"-user");d!=null&&d.user?t.user=d.user:t.user=F1()}if(this.storage.isServer&&t.user){let d=this.suppressGetSessionWarning;t=new Proxy(t,{get:(y,w,k)=>(!d&&w==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),d=!0,this.suppressGetSessionWarning=!0),Reflect.get(y,w,k))})}return{data:{session:t},error:null}}const{session:o,error:h}=await this._callRefreshToken(t.refresh_token);return h?{data:{session:null},error:h}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await sr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:$l}):await this._useSession(async r=>{var n,o,h;const{data:d,error:s}=r;if(s)throw s;return!(!((n=d.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ml}:await sr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(h=(o=d.session)===null||o===void 0?void 0:o.access_token)!==null&&h!==void 0?h:void 0,xform:$l})})}catch(r){if(Qt(r))return Ede(r)&&(await this._removeSession(),await Cl(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:o,error:h}=n;if(h)throw h;if(!o.session)throw new Ml;const d=o.session;let s=null,y=null;this.flowType==="pkce"&&t.email!=null&&([s,y]=await $h(this.storage,this.storageKey));const{data:w,error:k}=await sr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:s,code_challenge_method:y}),jwt:d.access_token,xform:$l});if(k)throw k;return d.user=w.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),{data:{user:d.user},error:null}})}catch(n){if(Qt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ml;const r=Date.now()/1e3;let n=r,o=!0,h=null;const{payload:d}=B1(t.access_token);if(d.exp&&(n=d.exp,o=n<=r),o){const{session:s,error:y}=await this._callRefreshToken(t.refresh_token);if(y)return{data:{user:null,session:null},error:y};if(!s)return{data:{user:null,session:null},error:null};h=s}else{const{data:s,error:y}=await this._getUser(t.access_token);if(y)throw y;h={access_token:t.access_token,refresh_token:t.refresh_token,user:s.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(h),await this._notifyAllSubscribers("SIGNED_IN",h)}return{data:{user:h.user,session:h},error:null}}catch(r){if(Qt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:d,error:s}=r;if(s)throw s;t=(n=d.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ml;const{session:o,error:h}=await this._callRefreshToken(t.refresh_token);return h?{data:{user:null,session:null},error:h}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Qt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!fo())throw new P0("No browser detected.");if(t.error||t.error_description||t.error_code)throw new P0(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Mj("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new P0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Mj("No code detected.");const{data:U,error:N}=await this._exchangeCodeForSession(t.code);if(N)throw N;const W=new URL(window.location.href);return W.searchParams.delete("code"),window.history.replaceState(window.history.state,"",W.toString()),{data:{session:U.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:o,access_token:h,refresh_token:d,expires_in:s,expires_at:y,token_type:w}=t;if(!h||!s||!d||!w)throw new P0("No session defined in URL");const k=Math.round(Date.now()/1e3),E=parseInt(s);let I=k+E;y&&(I=parseInt(y));const j=I-k;j*1e3<=Uh&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${j}s, should have been closer to ${E}s`);const z=I-E;k-z>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",z,I,k):k-z<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",z,I,k);const{data:L,error:q}=await this._getUser(h);if(q)throw q;const F={provider_token:n,provider_refresh_token:o,access_token:h,expires_in:E,expires_at:I,refresh_token:d,token_type:w,user:L.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:F,redirectType:t.type},error:null}}catch(n){if(Qt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Wc(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:o,error:h}=r;if(h)return{error:h};const d=(n=o.session)===null||n===void 0?void 0:n.access_token;if(d){const{error:s}=await this.admin.signOut(d,t);if(s&&!(kde(s)&&(s.status===404||s.status===401||s.status===403)))return{error:s}}return t!=="others"&&(await this._removeSession(),await Cl(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=$de(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,o;try{const{data:{session:h},error:d}=r;if(d)throw d;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",h)),this._debug("INITIAL_SESSION","callback id",t,"session",h)}catch(h){await((o=this.stateChangeEmitters.get(t))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",h),console.error(h)}})}async resetPasswordForEmail(t,r={}){let n=null,o=null;this.flowType==="pkce"&&([n,o]=await $h(this.storage,this.storageKey,!0));try{return await sr(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(h){if(Qt(h))return{data:null,error:h};throw h}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Qt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:o}=await this._useSession(async h=>{var d,s,y,w,k;const{data:E,error:I}=h;if(I)throw I;const j=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(d=t.options)===null||d===void 0?void 0:d.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(y=t.options)===null||y===void 0?void 0:y.queryParams,skipBrowserRedirect:!0});return await sr(this.fetch,"GET",j,{headers:this.headers,jwt:(k=(w=E.session)===null||w===void 0?void 0:w.access_token)!==null&&k!==void 0?k:void 0})});if(o)throw o;return fo()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Qt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,o;const{data:h,error:d}=r;if(d)throw d;return await sr(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(o=(n=h.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(Qt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Fde(async o=>(o>0&&await Bde(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await sr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ks})),(o,h)=>{const d=200*Math.pow(2,o);return h&&L1(h)&&Date.now()+d-n<Uh})}catch(n){if(this._debug(r,"error",n),Qt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),fo()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const o=await Wc(this.storage,this.storageKey);if(o&&this.userStorage){let d=await Wc(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!d&&(d={user:o.user},await Vh(this.userStorage,this.storageKey+"-user",d)),o.user=(t=d==null?void 0:d.user)!==null&&t!==void 0?t:F1()}else if(o&&!o.user&&!o.user){const d=await Wc(this.storage,this.storageKey+"-user");d&&(d!=null&&d.user)?(o.user=d.user,await Cl(this.storage,this.storageKey+"-user"),await Vh(this.storage,this.storageKey,o)):o.user=F1()}if(this._debug(n,"session from storage",o),!this._isValidSession(o)){this._debug(n,"session is not valid"),o!==null&&await this._removeSession();return}const h=((r=o.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<z1;if(this._debug(n,`session has${h?"":" not"} expired with margin of ${z1}s`),h){if(this.autoRefreshToken&&o.refresh_token){const{error:d}=await this._callRefreshToken(o.refresh_token);d&&(console.error(d),L1(d)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",d),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:d,error:s}=await this._getUser(o.access_token);!s&&(d!=null&&d.user)?(o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(d){console.error("Error getting user data:",d),this._debug(n,"error getting user data, skipping SIGNED_IN notification",d)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(n,"error",o),console.error(o);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ml;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new vx;const{data:h,error:d}=await this._refreshAccessToken(t);if(d)throw d;if(!h.session)throw new Ml;await this._saveSession(h.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",h.session);const s={session:h.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(h){if(this._debug(o,"error",h),Qt(h)){const d={session:null,error:h};return L1(h)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(d),d}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(h),h}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(t,r,n=!0){const o=`#_notifyAllSubscribers(${t})`;this._debug(o,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const h=[],d=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(t,r)}catch(y){h.push(y)}});if(await Promise.all(d),h.length>0){for(let s=0;s<h.length;s+=1)console.error(h[s]);throw h[0]}}finally{this._debug(o,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Vh(this.userStorage,this.storageKey+"-user",{user:r.user});const o=Object.assign({},r);delete o.user;const h=Rj(o);await Vh(this.storage,this.storageKey,h)}else{const o=Rj(r);await Vh(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await Cl(this.storage,this.storageKey),await Cl(this.storage,this.storageKey+"-code-verifier"),await Cl(this.storage,this.storageKey+"-user"),this.userStorage&&await Cl(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&fo()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Uh);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((n.expires_at*1e3-t)/Uh);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${Uh}ms, refresh threshold is ${mS} ticks`),o<=mS&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof sz)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!fo()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const o=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&o.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&o.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[h,d]=await $h(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(h)}`,code_challenge_method:`${encodeURIComponent(d)}`});o.push(s.toString())}if(n!=null&&n.queryParams){const h=new URLSearchParams(n.queryParams);o.push(h.toString())}return n!=null&&n.skipBrowserRedirect&&o.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${o.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:o,error:h}=r;return h?{data:null,error:h}:await sr(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Qt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,o;const{data:h,error:d}=r;if(d)return{data:null,error:d};const s=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:y,error:w}=await sr(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:(n=h==null?void 0:h.session)===null||n===void 0?void 0:n.access_token});return w?{data:null,error:w}:(t.factorType==="totp"&&(!((o=y==null?void 0:y.totp)===null||o===void 0)&&o.qr_code)&&(y.totp.qr_code=`data:image/svg+xml;utf-8,${y.totp.qr_code}`),{data:y,error:null})})}catch(r){if(Qt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:h}=r;if(h)return{data:null,error:h};const{data:d,error:s}=await sr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:s})})}catch(r){if(Qt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:o,error:h}=r;return h?{data:null,error:h}:await sr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Qt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],o=n.filter(d=>d.factor_type==="totp"&&d.status==="verified"),h=n.filter(d=>d.factor_type==="phone"&&d.status==="verified");return{data:{all:n,totp:o,phone:h},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:o},error:h}=t;if(h)return{data:null,error:h};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=B1(o.access_token);let s=null;d.aal&&(s=d.aal);let y=s;((n=(r=o.user.factors)===null||r===void 0?void 0:r.filter(E=>E.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(y="aal2");const k=d.amr||[];return{data:{currentLevel:s,nextLevel:y,currentAuthenticationMethods:k},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(s=>s.kid===t);if(n)return n;const o=Date.now();if(n=this.jwks.keys.find(s=>s.kid===t),n&&this.jwks_cached_at+Pde>o)return n;const{data:h,error:d}=await sr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(d)throw d;return!h.keys||h.keys.length===0||(this.jwks=h,this.jwks_cached_at=o,n=h.keys.find(s=>s.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:j,error:z}=await this.getSession();if(z||!j.session)return{data:null,error:z};n=j.session.access_token}const{header:o,payload:h,signature:d,raw:{header:s,payload:y}}=B1(n);r!=null&&r.allowExpired||Zde(h.exp);const w=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!w){const{error:j}=await this.getUser(n);if(j)throw j;return{data:{claims:h,header:o,signature:d},error:null}}const k=Kde(o.alg),E=await crypto.subtle.importKey("jwk",w,k,!0,["verify"]);if(!await crypto.subtle.verify(k,E,d,Dde(`${s}.${y}`)))throw new vS("Invalid JWT signature");return{data:{claims:h,header:o,signature:d},error:null}}catch(n){if(Qt(n))return{data:null,error:n};throw n}}}fg.nextInstanceID=0;const hfe=fg;class dfe extends hfe{constructor(t){super(t)}}var ffe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function o(h){return h instanceof r?h:new r(function(d){d(h)})}return new(r||(r=Promise))(function(h,d){function s(k){try{w(n.next(k))}catch(E){d(E)}}function y(k){try{w(n.throw(k))}catch(E){d(E)}}function w(k){k.done?h(k.value):o(k.value).then(s,y)}w((n=n.apply(e,t||[])).next())})};class pfe{constructor(t,r,n){var o,h,d;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const s=vde(t),y=new URL(s);this.realtimeUrl=new URL("realtime/v1",y),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",y),this.storageUrl=new URL("storage/v1",y),this.functionsUrl=new URL("functions/v1",y);const w=`sb-${y.hostname.split(".")[0]}-auth-token`,k={db:ude,realtime:dde,auth:Object.assign(Object.assign({},hde),{storageKey:w}),global:cde},E=_de(n??{},k);this.storageKey=(o=E.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(h=E.global.headers)!==null&&h!==void 0?h:{},E.accessToken?(this.accessToken=E.accessToken,this.auth=new Proxy({},{get:(I,j)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(j)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((d=E.auth)!==null&&d!==void 0?d:{},this.headers,E.global.fetch),this.fetch=gde(r,this._getAccessToken.bind(this),E.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},E.realtime)),this.rest=new Mhe(new URL("rest/v1",y).href,{headers:this.headers,schema:E.db.schema,fetch:this.fetch}),this.storage=new ode(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),E.accessToken||this._listenForAuthEvents()}get functions(){return new lhe(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return ffe(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:o,storageKey:h,flowType:d,lock:s,debug:y},w,k){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new dfe({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),w),storageKey:h,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:o,flowType:d,lock:s,debug:y,fetch:k,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Hhe(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const mfe=(e,t,r)=>new pfe(e,t,r);function gfe(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}gfe()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const yfe="https://igdvqkiyajwrjevuoskl.supabase.co",vfe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlnZHZxa2l5YWp3cmpldnVvc2tsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY1MDY5ODAsImV4cCI6MjA3MjA4Mjk4MH0.psO706EX16G7yJSEHJrPpZ6WwvPmsuLLgUAtXikmubs",Ts=mfe(yfe,vfe,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),lz=be.createContext(void 0),cz=()=>{const e=be.useContext(lz);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},_fe=({children:e})=>{const[t,r]=be.useState(null),[n,o]=be.useState(null),[h,d]=be.useState(!0);be.useEffect(()=>{(async()=>{const{data:{session:j}}=await Ts.auth.getSession();o(j),r((j==null?void 0:j.user)??null),d(!1)})();const{data:{subscription:I}}=Ts.auth.onAuthStateChange(async(j,z)=>{var L,q,F,U;if(console.log("Auth state change:",j,(L=z==null?void 0:z.user)==null?void 0:L.email),o(z),r((z==null?void 0:z.user)??null),d(!1),j==="SIGNED_IN"&&(z!=null&&z.user)){console.log("User signed in:",z.user.email);try{const{error:Z}=await Ts.rpc("sync_auth_users_to_profiles");Z?console.warn("Sync function error:",Z):console.log("User sync completed")}catch{console.warn("Sync function not available, user should be synced by trigger")}const{data:N,error:W}=await Ts.from("profiles").select("*").eq("id",z.user.id).single();if(W&&W.code==="PGRST116"){console.log("Profile not found, attempting manual insert...");const{error:Z}=await Ts.from("profiles").insert({id:z.user.id,email:z.user.email,full_name:((q=z.user.user_metadata)==null?void 0:q.full_name)||((F=z.user.user_metadata)==null?void 0:F.name)||((U=z.user.email)==null?void 0:U.split("@")[0])});Z?console.error("Failed to create profile:",Z):console.log("Profile created manually")}else N&&console.log("Profile found:",N);const{data:H}=await Ts.rpc("is_admin");console.log("Is admin:",H)}else j==="SIGNED_OUT"&&console.log("User signed out")});return()=>I.unsubscribe()},[]);const k={user:t,session:n,loading:h,signInWithGoogle:async()=>{try{const{error:E}=await Ts.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/dashboard`,queryParams:{access_type:"offline",prompt:"consent"}}});return{error:E}}catch(E){return{error:E}}},signInWithEmail:async E=>{try{const{error:I}=await Ts.auth.signInWithOtp({email:E,options:{emailRedirectTo:`${window.location.origin}/dashboard`}});return{error:I}}catch(I){return{error:I}}},signOut:async()=>{try{d(!0);const{error:E}=await Ts.auth.signOut();return E||(r(null),o(null),console.log("Sign out successful")),{error:E}}catch(E){return console.error("Sign out error:",E),{error:E}}finally{d(!1)}}};return P.jsx(lz.Provider,{value:k,children:e})};function xfe(e){return cr({tag:"svg",attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r
	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}},{tag:"path",attr:{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r
	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}},{tag:"path",attr:{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}},{tag:"path",attr:{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`}}]})(e)}const bfe=()=>{const{theme:e}=Mr(),{signInWithGoogle:t,signInWithEmail:r,loading:n}=cz(),[o,h]=be.useState(""),[d,s]=be.useState(!1),y=async()=>{await t()},w=async k=>{if(k.preventDefault(),!o)return;const{error:E}=await r(o);E||s(!0)};return P.jsx("div",{className:`min-h-screen flex items-center justify-center px-6 ${e==="dark"?"bg-gradient-to-br from-slate-900 via-purple-900/20 to-slate-900":"bg-gradient-to-br from-blue-50/50 via-indigo-50/30 to-purple-50/50"}`,children:P.jsxs("div",{className:`w-full max-w-md rounded-2xl p-8 shadow-2xl backdrop-blur-xl border ${e==="dark"?"bg-gray-900/50 border-gray-800":"bg-white/70 border-gray-200"}`,children:[P.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[P.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center text-white font-bold text-lg shadow-lg ${e==="dark"?"bg-gradient-to-br from-purple-500 to-cyan-600":"bg-gradient-to-br from-blue-500 to-indigo-600"}`,children:"N"}),P.jsxs("div",{children:[P.jsx("h1",{className:`text-2xl font-bold ${e==="dark"?"text-white":"text-gray-900"}`,children:"NextStop Admin"}),P.jsx("p",{className:`${e==="dark"?"text-gray-400":"text-gray-600"}`,children:"Sign in to continue"})]})]}),P.jsxs("form",{onSubmit:w,className:"space-y-3 mb-6",children:[P.jsx("label",{className:`block text-sm ${e==="dark"?"text-gray-300":"text-gray-700"}`,children:"Work email"}),P.jsx("input",{type:"email",value:o,onChange:k=>h(k.target.value),placeholder:"you@company.com",className:`w-full px-4 py-3 rounded-xl outline-none border ${e==="dark"?"bg-gray-800/70 border-gray-700 text-white":"bg-white border-gray-200 text-gray-900"}`,required:!0}),P.jsx("button",{type:"submit",disabled:n,className:"w-full py-3 rounded-xl transition-all duration-300 hover:scale-[1.01] bg-indigo-600 text-white hover:bg-indigo-500",children:d?"Magic link sent ✓":n?"Sending…":"Email me a magic link"})]}),P.jsxs("div",{className:"relative my-4",children:[P.jsx("div",{className:"absolute inset-0 flex items-center",children:P.jsx("div",{className:`${e==="dark"?"border-gray-700":"border-gray-200"} w-full border-t`})}),P.jsx("div",{className:"relative flex justify-center text-xs",children:P.jsx("span",{className:`${e==="dark"?"bg-gray-900/50 text-gray-400":"bg-white/70 text-gray-500"} px-2`,children:"or"})})]}),P.jsxs("button",{onClick:y,disabled:n,className:`w-full flex items-center justify-center space-x-3 py-3 rounded-xl border transition-all duration-300 hover:scale-[1.01] ${e==="dark"?"bg-gray-800/70 border-gray-700 hover:bg-gray-800 text-white":"bg-white border-gray-200 hover:bg-gray-50 text-gray-800"}`,children:[P.jsx(xfe,{size:22}),P.jsx("span",{children:n?"Preparing…":"Continue with Google"})]}),P.jsx("p",{className:"text-xs mt-4 text-center text-gray-500",children:"By continuing, you agree to our Terms and Privacy Policy."})]})})},wfe=()=>{var L;const{user:e,loading:t,signOut:r}=cz(),[n,o]=be.useState("dashboard"),[h,d]=be.useState(!1),[s,y]=be.useState(),{theme:w,toggleTheme:k}=Mr(),E=async()=>{try{console.log("Attempting to sign out...");const{error:q}=await r();q?(console.error("Sign out error:",q),alert("Error signing out: "+q.message)):(console.log("Successfully signed out - should redirect to login"),window.location.reload())}catch(q){console.error("Unexpected sign out error:",q),alert("Unexpected error during sign out")}},I=(q,F)=>{o(q),y(F),F&&setTimeout(()=>y(void 0),3e3)},j=[{id:"dashboard",name:"Dashboard",icon:VB,badge:null},{id:"drivers",name:"Drivers",icon:lv,badge:"2"},{id:"buses",name:"Buses",icon:Gs,badge:null},{id:"routes",name:"Routes",icon:r6,badge:null},{id:"trips",name:"Trips",icon:e6,badge:"18"},{id:"revenue",name:"Revenue",icon:pP,badge:null},{id:"sos",name:"SOS",icon:n6,badge:"1"},{id:"leaderboard",name:"Leaderboard",icon:GB,badge:null},{id:"settings",name:"Settings",icon:WB,badge:null}],z=()=>{switch(n){case"dashboard":return P.jsx(wj,{});case"drivers":return P.jsx(Bue,{highlightedItemId:s});case"buses":return P.jsx(Uue,{highlightedItemId:s});case"routes":return P.jsx(Vue,{highlightedItemId:s});case"trips":return P.jsx(Hue,{});case"revenue":return P.jsx(Kue,{});case"sos":return P.jsx(Xue,{});case"leaderboard":return P.jsx(Yue,{});case"settings":return P.jsx(Jue,{});default:return P.jsx(wj,{})}};return!e&&!t?P.jsx(bfe,{}):P.jsx(Due,{children:P.jsxs("div",{className:`min-h-screen transition-all duration-500 ${w==="dark"?"bg-gradient-to-br from-slate-900 via-purple-900/20 to-slate-900":"bg-gradient-to-br from-blue-50/50 via-indigo-50/30 to-purple-50/50"}`,children:[P.jsx(the,{}),P.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[P.jsx("div",{className:`absolute -top-40 -right-40 w-80 h-80 rounded-full blur-3xl animate-pulse ${w==="dark"?"bg-purple-500/10":"bg-blue-400/10"}`}),P.jsx("div",{className:`absolute -bottom-40 -left-40 w-80 h-80 rounded-full blur-3xl animate-pulse delay-1000 ${w==="dark"?"bg-cyan-500/10":"bg-indigo-400/10"}`})]}),P.jsx("nav",{className:`relative z-50 backdrop-blur-2xl border-b transition-all duration-500 ${w==="dark"?"bg-gray-900/40 border-gray-700/50 shadow-2xl shadow-purple-500/10":"bg-white/40 border-gray-200/50 shadow-2xl shadow-blue-500/10"}`,children:P.jsx("div",{className:"max-w-full mx-auto px-6",children:P.jsxs("div",{className:"flex justify-between items-center h-20",children:[P.jsxs("div",{className:"flex items-center space-x-4",children:[P.jsx("button",{onClick:()=>d(!h),className:`p-3 rounded-xl transition-all duration-300 hover:scale-110 transform ${w==="dark"?"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50 hover:text-white":"bg-gray-100/50 text-gray-600 hover:bg-gray-200/50 hover:text-gray-900"}`,children:P.jsx(a6,{size:20})}),P.jsxs("div",{className:"flex items-center space-x-3",children:[P.jsx("div",{className:`w-10 h-10 rounded-2xl flex items-center justify-center text-white font-bold text-lg shadow-lg ${w==="dark"?"bg-gradient-to-br from-purple-500 to-cyan-600":"bg-gradient-to-br from-blue-500 to-indigo-600"}`,children:"N"}),P.jsxs("div",{children:[P.jsx("h1",{className:`text-2xl font-bold bg-gradient-to-r bg-clip-text text-transparent ${w==="dark"?"from-purple-400 to-cyan-400":"from-blue-600 to-indigo-600"}`,children:"NextStop Admin"}),P.jsx("p",{className:`text-xs ${w==="dark"?"text-gray-400":"text-gray-500"}`,children:"Smart Transit Management"})]})]})]}),P.jsx("div",{className:"flex-1 max-w-xl mx-8",children:P.jsx(Que,{onNavigate:I})}),P.jsxs("div",{className:"flex items-center space-x-3",children:[P.jsx(rhe,{}),P.jsx("button",{onClick:k,className:`p-3 rounded-xl transition-all duration-300 hover:scale-110 transform hover:rotate-180 ${w==="dark"?"bg-yellow-500/20 text-yellow-400 hover:bg-yellow-500/30 shadow-lg shadow-yellow-500/20":"bg-indigo-500/20 text-indigo-600 hover:bg-indigo-500/30 shadow-lg shadow-indigo-500/20"}`,title:`Switch to ${w==="dark"?"light":"dark"} mode`,children:w==="dark"?P.jsx(JB,{size:20}):P.jsx(YB,{size:20})}),P.jsx("div",{className:"relative group",children:P.jsxs("div",{className:`flex items-center space-x-3 p-2 rounded-xl ${w==="dark"?"bg-gray-800/50":"bg-gray-100/50"}`,children:[P.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-white font-medium shadow-lg ${w==="dark"?"bg-gradient-to-br from-purple-500 to-cyan-600":"bg-gradient-to-br from-blue-500 to-indigo-600"}`,children:(((L=e==null?void 0:e.email)==null?void 0:L[0])||"A").toUpperCase()}),P.jsxs("div",{className:"text-left",children:[P.jsx("p",{className:`text-sm font-medium ${w==="dark"?"text-white":"text-gray-900"}`,children:(e==null?void 0:e.email)??"Admin"}),P.jsx("p",{className:`text-xs ${w==="dark"?"text-gray-400":"text-gray-500"}`,children:"Signed in"})]}),P.jsx("button",{onClick:E,className:`ml-2 px-3 py-2 rounded-lg text-xs transition-colors hover:scale-105 ${w==="dark"?"bg-red-600 text-white hover:bg-red-500":"bg-red-500 text-white hover:bg-red-600"}`,children:"Sign out"})]})})]})]})})}),P.jsxs("div",{className:"flex relative",children:[P.jsx("aside",{className:`${h?"w-20":"w-72"} min-h-screen transition-all duration-500 relative z-40 ${w==="dark"?"bg-gray-900/50 backdrop-blur-xl":"bg-white/50 backdrop-blur-xl"}`,children:P.jsx("div",{className:`p-6 ${h?"px-3":""}`,children:P.jsx("nav",{className:"space-y-2",children:j.map((q,F)=>P.jsx("div",{style:{animationDelay:`${F*50}ms`},className:"animate-fade-in",children:P.jsxs("button",{onClick:()=>o(q.id),className:`w-full flex items-center px-4 py-4 text-sm font-medium rounded-2xl transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 group relative overflow-hidden ${n===q.id?w==="dark"?"bg-gradient-to-r from-purple-600 to-cyan-600 text-white shadow-2xl shadow-purple-500/50":"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-2xl shadow-blue-500/50":w==="dark"?"text-gray-300 hover:bg-gray-800/50 hover:text-white":"text-gray-700 hover:bg-gray-100/70 hover:text-gray-900"}`,children:[n===q.id&&P.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent transform -skew-x-12 group-hover:animate-shimmer"}),P.jsxs("div",{className:"relative flex items-center w-full",children:[P.jsx(q.icon,{className:`text-xl ${h?"mx-auto":"mr-4"} transition-transform group-hover:scale-110`}),!h&&P.jsxs(P.Fragment,{children:[P.jsx("span",{className:"flex-1 text-left",children:q.name}),q.badge&&P.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${n===q.id?"bg-white/20 text-white":"bg-red-500 text-white"} animate-pulse`,children:q.badge})]})]})]})},q.id))})})}),P.jsx("main",{className:"flex-1 relative",children:P.jsx("div",{className:"p-8",children:P.jsx("div",{className:"max-w-full mx-auto",children:P.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.005]",children:z()})})})})]})]})})};V1.createRoot(document.getElementById("root")).render(P.jsx(Ie.StrictMode,{children:P.jsx(BB,{children:P.jsx(_fe,{children:P.jsx(wfe,{})})})}));
